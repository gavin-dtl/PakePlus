import{d as K,r as m,bf as O,p as Q,a4 as X,b as Y,c as y,o as s,f as x,j as e,s as o,x as c,y as Z,H as ee,a5 as ae,C,aR as le,aS as oe,D as re,F as I,i as R,G as te,aq as ue,az as ne,v as de,aa as ie,t as me,b6 as se,a6 as pe,a as ce,a9 as ve,aw as fe,at as V,_ as we}from"./index-DwcZmOlQ.js";import{_ as Ve}from"./ContentWrap.vue_vue_type_script_setup_true_lang-D9OUn0sG.js";import{t as v}from"./index-B-Kwihxi.js";import be from"./presetPositionDialog-FVN2qDgS.js";import"./Dialog.vue_vue_type_style_index_0_lang-BhpXB9km.js";import"./index-DQsPolDK.js";import"./index-4uYp2Pll.js";import"./mitt-CI7Qv1RY.js";import"./index-CGfLz2yR.js";const ge={class:"verification"},_e={key:0,class:"error-tip"},ye={class:"dialog-footer"},ke=K({name:"TrackingSettings",__name:"index",setup(he){const L=m(),{t:q}=O.useI18n(),k=m(!0),P=m([]),f=m(!1),U=m(),h=Q(),t=m({cameraLevel:1,open:!1,name:"",durationMs:100}),T=m([]),z=/^(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)){3}$/,E=n=>!z.test(n.cameraIp)&&n.cameraIp?(n.ipError="\u8BF7\u8F93\u5165\u6709\u6548\u7684IP\u5730\u5740 (\u5982: 192.168.1.1)",!1):(n.ipError="",!0),b=async()=>{k.value=!0;try{const n=await v.getTrackingList();P.value=n.map(l=>({...l,ipError:""}))}finally{k.value=!1}},B=X({name:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:["blur","change"]}]}),$=async()=>{try{if(!U.value||!await U.value.validate())return;await v.addTracking(t.value),V.success("\u65B0\u589E\u6210\u529F"),f.value=!1,await b()}catch{}},M=async n=>{if((l=>E(l))(n))try{await v.updataTrackingAddList(n),V.success("\u4FDD\u5B58\u6210\u529F"),await b()}catch(l){V.error("\u4FDD\u5B58\u5931\u8D25: "+l.message)}else V.warning("\u8BF7\u4FEE\u6B63\u9519\u8BEF\u540E\u518D\u4FDD\u5B58")},S=m("");return Y(()=>{b(),(async()=>S.value=await v.cameraType())()}),(n,l)=>{const j=Z,p=ee,d=oe,u=te,g=re,A=ue,w=ne,F=ie,G=le,H=Ve,_=ve,N=pe,W=fe,J=se;return s(),y(I,null,[x("div",null,[e(p,{type:"primary",onClick:l[0]||(l[0]=a=>(async()=>{try{T.value=await v.getTrackingAddList(),f.value=!0,t.value.open=!1,t.value.name="",t.value.cameraLevel=1,t.value.durationMs=100}catch(r){V.error("\u83B7\u53D6\u8F93\u5165\u6E90\u5931\u8D25: "+r.message)}})())},{default:o(()=>[e(j,{icon:"ep:plus",class:"mr-5px"}),l[7]||(l[7]=c(" \u65B0\u589E "))]),_:1}),e(H,{style:{"margin-top":"15px"}},{default:o(()=>[ae((s(),C(G,{data:P.value,stripe:!0,"show-overflow-tooltip":!1,style:{"margin-top":"15px"}},{default:o(()=>[e(d,{label:"\u540D\u79F0",align:"center",prop:"name"}),e(d,{label:"\u6444\u50CF\u673A\u7C7B\u578B",align:"center",prop:"open"},{default:o(a=>[e(g,{modelValue:a.row.cameraType,"onUpdate:modelValue":r=>a.row.cameraType=r},{default:o(()=>[(s(!0),y(I,null,R(S.value,(r,i)=>(s(),C(u,{key:i,label:r.info,value:r.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(d,{label:"\u5F00\u5173",align:"center",prop:"open"},{default:o(a=>[e(A,{modelValue:a.row.open,"onUpdate:modelValue":r=>a.row.open=r},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(d,{label:"\u6301\u7EED\u65F6\u95F4",align:"center",width:"140px",prop:"durationMs"},{default:o(a=>[e(w,{modelValue:a.row.durationMs,"onUpdate:modelValue":r=>a.row.durationMs=r,class:"!w-110px",min:100,max:1e4,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(d,{label:"\u7B49\u7EA7\uFF081>6\uFF09",align:"center",prop:"cameraLevel",width:"110px"},{default:o(a=>[e(g,{modelValue:a.row.cameraLevel,"onUpdate:modelValue":r=>a.row.cameraLevel=r,placeholder:"\u8BF7\u9009\u62E9\u6444\u50CF\u5934\u7B49\u7EA7"},{default:o(()=>[e(u,{label:"1",value:1}),e(u,{label:"2",value:2}),e(u,{label:"3",value:3}),e(u,{label:"4",value:4}),e(u,{label:"5",value:5}),e(u,{label:"6",value:6})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(d,{label:"\u53D1\u9001\u5730\u5740",align:"center",prop:"cameraIp"},{default:o(a=>[x("div",ge,[e(F,{modelValue:a.row.cameraIp,"onUpdate:modelValue":r=>a.row.cameraIp=r,onBlur:r=>E(a.row),onInput:r=>{var i;(i=a.row).ipError&&(i.ipError="")},placeholder:"\u8BF7\u8F93\u5165IP\u5730\u5740"},null,8,["modelValue","onUpdate:modelValue","onBlur","onInput"]),a.row.ipError?(s(),y("span",_e,me(a.row.ipError),1)):de("",!0)])]),_:1}),e(d,{label:"\u53D1\u9001\u7AEF\u53E3",align:"center",prop:"cameraSendPort"},{default:o(a=>[e(w,{modelValue:a.row.cameraSendPort,"onUpdate:modelValue":r=>a.row.cameraSendPort=r,class:"!w-110px",min:1,max:65535,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(d,{label:"\u5730\u5740\u7801",align:"center",prop:"cameraAddr"},{default:o(a=>[e(w,{modelValue:a.row.cameraAddr,"onUpdate:modelValue":r=>a.row.cameraAddr=r,class:"!w-110px",min:0,max:255,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(d,{label:"\u5168\u666F\u9884\u7F6E\u4F4D",align:"center",prop:"keyValue"},{default:o(a=>[e(w,{class:"!w-110px",modelValue:a.row.cameraDefaultPosition,"onUpdate:modelValue":r=>a.row.cameraDefaultPosition=r,min:0,max:255,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(d,{label:"\u64CD\u4F5C",align:"center","min-width":"120px"},{default:o(a=>[e(p,{link:"",type:"primary",onClick:r=>M(a.row),disabled:!!a.row.ipError},{default:o(()=>l[8]||(l[8]=[c(" \u4FDD\u5B58 ")])),_:2},1032,["onClick","disabled"]),e(p,{link:"",type:"primary",onClick:r=>(async i=>{M(i),L.value.open(i)})(a.row)},{default:o(()=>l[9]||(l[9]=[c(" \u8BBE\u7F6E\u9884\u7559\u4F4D ")])),_:2},1032,["onClick"]),e(p,{link:"",type:"danger",onClick:r=>(async i=>{try{await h.delConfirm("\u786E\u5B9A\u8981\u5220\u9664\u6B64\u9879\u5417?"),await v.deleteTrackingitem({name:i}),h.success(q("common.delSuccess")),await b()}catch(D){D!=="cancel"&&h.error("\u5220\u9664\u5931\u8D25: "+D.message)}})(a.row.name)},{default:o(()=>l[10]||(l[10]=[c(" \u5220\u9664 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[J,k.value]])]),_:1}),e(W,{modelValue:f.value,"onUpdate:modelValue":l[6]||(l[6]=a=>f.value=a),title:"\u65B0\u589E\u8DDF\u8E2A",width:"500"},{footer:o(()=>[x("div",ye,[e(p,{onClick:l[5]||(l[5]=a=>f.value=!1)},{default:o(()=>l[11]||(l[11]=[c("\u53D6\u6D88")])),_:1}),e(p,{type:"primary",onClick:$},{default:o(()=>l[12]||(l[12]=[c("\u786E\u8BA4")])),_:1})])]),default:o(()=>[e(N,{ref_key:"formRef",ref:U,model:t.value,rules:ce(B)},{default:o(()=>[e(_,{label:"\u540D\u79F0",prop:"name"},{default:o(()=>[e(g,{modelValue:t.value.name,"onUpdate:modelValue":l[1]||(l[1]=a=>t.value.name=a),placeholder:"\u8BF7\u9009\u62E9\u540D\u79F0"},{default:o(()=>[(s(!0),y(I,null,R(T.value,(a,r)=>(s(),C(u,{key:r,label:a.showName,value:a.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"\u5F00\u5173"},{default:o(()=>[e(A,{modelValue:t.value.open,"onUpdate:modelValue":l[2]||(l[2]=a=>t.value.open=a)},null,8,["modelValue"])]),_:1}),e(_,{label:"\u6301\u7EED\u65F6\u95F4"},{default:o(()=>[e(w,{modelValue:t.value.durationMs,"onUpdate:modelValue":l[3]||(l[3]=a=>t.value.durationMs=a),min:100,max:1e4},null,8,["modelValue"])]),_:1}),e(_,{label:"\u7B49\u7EA7"},{default:o(()=>[e(g,{modelValue:t.value.cameraLevel,"onUpdate:modelValue":l[4]||(l[4]=a=>t.value.cameraLevel=a),placeholder:"\u8BF7\u9009\u62E9\u6444\u50CF\u5934\u7B49\u7EA7"},{default:o(()=>[e(u,{label:"1",value:1}),e(u,{label:"2",value:2}),e(u,{label:"3",value:3}),e(u,{label:"4",value:4}),e(u,{label:"5",value:5}),e(u,{label:"6",value:6})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])]),e(be,{ref_key:"PresetPositionDialogRef",ref:L},null,512)],64)}}}),Ue=we(ke,[["__scopeId","data-v-fda1e609"]]);export{Ue as default};

import{d as C,l as B,r as d,u as G,a1 as O,a2 as X,a as e,a3 as Y,ar as $,b as A,a4 as D,ad as H,z as c,o as f,w as l,m as t,a6 as J,p as V,a7 as K,a8 as M,a9 as Q,a5 as W,bX as Z,bY as ee,aj as ae,al as re,ag as te,am as le,an as se,_ as ie}from"./index-h2IMwmcw.js";import{_ as oe}from"./Verify-DL1ztpma.js";import{_ as ne}from"./XButton-DPaNGTeH.js";import{u as pe,L as de,_ as me}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang-a3o7WOc9.js";import{u as h}from"./useIcon-SKcaitAM.js";const ge=ie(C({name:"RegisterForm",__name:"RegisterForm",setup(ue){const{t:p}=B(),k=h({icon:"ep:house"}),w=h({icon:"ep:avatar"}),x=h({icon:"ep:lock"}),v=d(),{handleBackLogin:E,getLoginState:z}=pe(),{currentRoute:P,push:q}=G(),N=O(),m=d(""),b=d(!1),y=d(),R=d("blockPuzzle"),S=X(()=>e(z)===de.REGISTER),U={tenantName:[{required:!0,trigger:"blur",message:"\u8BF7\u8F93\u5165\u60A8\u6240\u5C5E\u7684\u79DF\u6237"},{min:2,max:20,message:"\u79DF\u6237\u8D26\u53F7\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 2 \u548C 20 \u4E4B\u95F4",trigger:"blur"}],username:[{required:!0,trigger:"blur",message:"\u8BF7\u8F93\u5165\u60A8\u7684\u8D26\u53F7"},{min:4,max:30,message:"\u7528\u6237\u8D26\u53F7\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 4 \u548C 30 \u4E4B\u95F4",trigger:"blur"}],nickname:[{required:!0,trigger:"blur",message:"\u8BF7\u8F93\u5165\u60A8\u7684\u6635\u79F0"},{min:0,max:30,message:"\u6635\u79F0\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 0 \u548C 30 \u4E4B\u95F4",trigger:"blur"}],password:[{required:!0,trigger:"blur",message:"\u8BF7\u8F93\u5165\u60A8\u7684\u5BC6\u7801"},{min:5,max:20,message:"\u7528\u6237\u5BC6\u7801\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 5 \u548C 20 \u4E4B\u95F4",trigger:"blur"},{pattern:/^[^<>"'|\\]+$/,message:`\u4E0D\u80FD\u5305\u542B\u975E\u6CD5\u5B57\u7B26\uFF1A< > " ' \\ |`,trigger:"blur"}],confirmPassword:[{required:!0,trigger:"blur",message:"\u8BF7\u518D\u6B21\u8F93\u5165\u60A8\u7684\u5BC6\u7801"},{required:!0,validator:(o,r,i)=>{a.registerForm.password!==r?i(new Error("\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4")):i()},trigger:"blur"}]},a=Y({isShowPassword:!1,captchaEnable:"false",tenantEnable:"true",registerForm:{tenantName:"avswitch",nickname:"",tenantId:0,username:"",password:"",confirmPassword:"",captchaVerification:""}}),_=async o=>{u.value=!0;try{a.tenantEnable&&(await I(),a.registerForm.tenantId=Z()),a.captchaEnable&&(a.registerForm.captchaVerification=o.captchaVerification);const r=await ee(a.registerForm);if(!r)return;u.value=ae.service({lock:!0,text:"\u6B63\u5728\u52A0\u8F7D\u7CFB\u7EDF\u4E2D...",background:"rgba(0, 0, 0, 0.7)"}),re(),te(r),m.value||(m.value="/"),m.value.indexOf("sso")!==-1?window.location.href=window.location.href.replace("/login?redirect=",""):q({path:m.value||N.addRouters[0].path})}finally{b.value=!1,u.value.close()}},I=async()=>{if(a.tenantEnable==="true"){const o=await le(a.registerForm.tenantName);se(o)}},u=d();return $(()=>P.value,o=>{var r;m.value=(r=o==null?void 0:o.query)==null?void 0:r.redirect},{immediate:!0}),A(()=>{}),(o,r)=>{const i=M,n=K,g=Q,F=ne,L=oe,T=J,j=W;return D((f(),c(j,{ref_key:"formLogin",ref:v,model:e(a).registerForm,rules:U,class:"login-form","label-position":"top","label-width":"120px",size:"large"},{default:l(()=>[t(T,{style:{"margin-right":"-10px","margin-left":"-10px"}},{default:l(()=>[t(n,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[t(i,null,{default:l(()=>[t(me,{style:{width:"100%"}})]),_:1})]),_:1}),t(n,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[e(a).tenantEnable==="true"?(f(),c(i,{key:0,prop:"tenantName"},{default:l(()=>[t(g,{modelValue:e(a).registerForm.tenantName,"onUpdate:modelValue":r[0]||(r[0]=s=>e(a).registerForm.tenantName=s),placeholder:e(p)("login.tenantname"),"prefix-icon":e(k),link:"",type:"primary",size:"large"},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})):V("",!0)]),_:1}),t(n,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[t(i,{prop:"username"},{default:l(()=>[t(g,{modelValue:e(a).registerForm.username,"onUpdate:modelValue":r[1]||(r[1]=s=>e(a).registerForm.username=s),placeholder:e(p)("login.username"),size:"large","prefix-icon":e(w)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),t(n,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[t(i,{prop:"username"},{default:l(()=>[t(g,{modelValue:e(a).registerForm.nickname,"onUpdate:modelValue":r[2]||(r[2]=s=>e(a).registerForm.nickname=s),placeholder:"\u6635\u79F0",size:"large","prefix-icon":e(w)},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),t(n,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[t(i,{prop:"password"},{default:l(()=>[t(g,{modelValue:e(a).registerForm.password,"onUpdate:modelValue":r[3]||(r[3]=s=>e(a).registerForm.password=s),type:"password","auto-complete":"off",placeholder:e(p)("login.password"),size:"large","prefix-icon":e(x),"show-password":""},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),t(n,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[t(i,{prop:"confirmPassword"},{default:l(()=>[t(g,{modelValue:e(a).registerForm.confirmPassword,"onUpdate:modelValue":r[4]||(r[4]=s=>e(a).registerForm.confirmPassword=s),type:"password",size:"large","auto-complete":"off",placeholder:e(p)("login.checkPassword"),"prefix-icon":e(x),"show-password":""},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),t(n,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:l(()=>[t(i,null,{default:l(()=>[t(F,{loading:e(b),title:e(p)("login.register"),class:"w-[100%]",type:"primary",onClick:r[5]||(r[5]=s=>(async()=>{a.captchaEnable==="false"?await _({}):y.value.show()})())},null,8,["loading","title"])]),_:1})]),_:1}),e(a).captchaEnable==="true"?(f(),c(L,{key:0,ref_key:"verify",ref:y,captchaType:e(R),imgSize:{width:"400px",height:"200px"},mode:"pop",onSuccess:_},null,8,["captchaType"])):V("",!0)]),_:1}),t(F,{title:e(p)("login.hasUser"),class:"w-[100%]",onClick:r[6]||(r[6]=s=>e(E)())},null,8,["title"])]),_:1},8,["model"])),[[H,e(S)]])}}}),[["__scopeId","data-v-9d6bef10"]]);export{ge as default};

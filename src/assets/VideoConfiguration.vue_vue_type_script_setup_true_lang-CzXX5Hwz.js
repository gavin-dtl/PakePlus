import{d as B,q as J,p as Q,r as m,a4 as X,b as Y,c as y,o as r,F as w,j as t,s as o,aO as Z,f as $,a9 as ee,S as le,aa as ae,a as e,aK as j,U as te,i as R,C as c,V as ue,x as V,t as z,H as oe,a6 as se,v as _,aq as ie,D as ne,G as re}from"./index-Cv_H95TD.js";import{S as K}from"./index-PedePqaI.js";import{c as f}from"./index-DZZPDAJY.js";const de=B({name:"Convention",__name:"VideoConfiguration",setup(pe){const{t:C}=J(),k=Q(),n=m({basicResolution:"",outputResolution:"",commonFrameRates:""}),g=m(),F=async()=>{const s=await K.getVideoSettings();n.value.basicResolution=s.baseWidth+"x"+s.baseHeight,n.value.outputResolution=s.outputWidth+"x"+s.outputHeight,n.value.commonFrameRates=s.fps},A=m([{label:"3440x1440",value:"3440x1440"},{label:"1920x1080",value:"1920x1080"},{label:"1280x720",value:"1280x720"}]),G=m([{label:"20",value:"20"},{label:"25 PAL",value:"25"},{label:"30",value:"30"},{label:"60",value:"60"}]),S=(s,l,i)=>{if(!l)return i(new Error("\u8BF7\u8F93\u5165\u5206\u8FA8\u7387"));if(!/^\d+x\d+$/.test(l))return i(new Error("\u683C\u5F0F\u5E94\u4E3A \u5BBD\u5EA6x\u9AD8\u5EA6\uFF08\u5982 1920x1080\uFF09"));const[d,x]=l.split("x").map(Number);if(d<=0||x<=0)return i(new Error("\u5BBD\u5EA6\u548C\u9AD8\u5EA6\u5FC5\u987B\u5927\u4E8E0"));i()},E=X({basicResolution:[{required:!0,validator:S,trigger:"blur"}],outputResolution:[{required:!0,validator:S,trigger:"blur"}],commonFrameRates:[{required:!0,validator:(s,l,i)=>{if(!l)return i(new Error("\u4E0D\u80FD\u4E3A\u7A7A"));if(!/^\d+$/.test(l))return i(new Error("\u5FC5\u987B\u4E3A\u7EAF\u6570\u5B57"));const d=Number(l);return d<=0?i(new Error("\u5FC5\u987B\u5927\u4E8E0")):d>9999?i(new Error("\u4E0D\u80FD\u8D85\u8FC79999")):void i()},trigger:"blur"}]}),I=async()=>{if(g&&await g.value.validate())try{const s=n.value.basicResolution.split("x");await K.setVideoSettings({fps:n.value.commonFrameRates,baseWidth:s[0],baseHeight:s[1],outputWidth:s[0],outputHeight:s[1]}),F(),k.success(C("common.updateSuccess"))}catch{}},u=m({basicResolution:!1,type:1,input:""}),U=async()=>{const s=await f.getVirtualCamConfig();u.value.type=s.type,u.value.input=s.input,u.value.basicResolution=await f.getVirtualCamStatus()},H=m([]),q=m([]),O=()=>{u.value.input=""},P=async()=>{try{u.value.basicResolution&&await f.setVirtualCamConfig(u.value),setTimeout(async()=>{await f.setVirtualCamStatus({enable:u.value.basicResolution}),U()},300),k.success(C("common.updateSuccess"))}catch{}};return Y(()=>{F(),U(),(async()=>H.value=await f.getVirtualCamInputList())(),(async()=>q.value=await f.getVirtualCamSceneList())()}),(s,l)=>{const i=ae,d=ue,x=te,L=le,p=ee,W=oe,D=Z,N=se,T=ie,b=re,h=ne;return r(),y(w,null,[t(N,{style:{width:"100%"},ref_key:"formRef",ref:g,model:e(n),"label-width":"170px",rules:e(E)},{default:o(()=>[t(D,{style:{width:"100%","margin-top":"15px"}},{default:o(()=>[l[8]||(l[8]=$("h3",null,"\u89C6\u9891\u914D\u7F6E",-1)),t(p,{prop:"basicResolution",label:"\u57FA\u7840\uFF08\u753B\u5E03\uFF09\u5206\u8FA8\u7387"},{default:o(()=>[t(L,{trigger:"click",ref:"elDropdownRef"},{dropdown:o(()=>[t(x,null,{default:o(()=>[(r(!0),y(w,null,R(e(A),a=>(r(),c(d,{onClick:M=>{return v=a.value,void(n.value.basicResolution=v);var v},style:{width:"200px","font-size":"18px",height:"40px"},key:a.value},{default:o(()=>[V(z(a.label),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),default:o(()=>[t(i,{modelValue:e(n).basicResolution,"onUpdate:modelValue":l[0]||(l[0]=a=>e(n).basicResolution=a),"suffix-icon":e(j)},null,8,["modelValue","suffix-icon"])]),_:1},512)]),_:1}),t(p,{prop:"commonFrameRates",label:"\u5E38\u7528\u5E27\u7387"},{default:o(()=>[t(L,{trigger:"click",ref:"elDropdownRef"},{dropdown:o(()=>[t(x,null,{default:o(()=>[(r(!0),y(w,null,R(e(G),a=>(r(),c(d,{onClick:M=>{return v=a.value,void(n.value.commonFrameRates=v);var v},style:{width:"200px","font-size":"18px",height:"40px"},key:a.value},{default:o(()=>[V(z(a.label),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),default:o(()=>[t(i,{modelValue:e(n).commonFrameRates,"onUpdate:modelValue":l[1]||(l[1]=a=>e(n).commonFrameRates=a),"suffix-icon":e(j)},null,8,["modelValue","suffix-icon"])]),_:1},512)]),_:1}),t(W,{type:"primary",onClick:I},{default:o(()=>l[7]||(l[7]=[V("\u4FDD\u5B58")])),_:1})]),_:1})]),_:1},8,["model","rules"]),t(N,{style:{width:"100%"},ref:"virtualCamform",model:e(n),"label-width":"170px",rules:e(E)},{default:o(()=>[t(D,{style:{width:"100%","margin-top":"15px"}},{default:o(()=>[l[10]||(l[10]=$("h3",null,"\u865A\u62DF\u6444\u50CF\u673A",-1)),t(p,{prop:"basicResolution",label:"\u5F00\u5173"},{default:o(()=>[t(T,{modelValue:e(u).basicResolution,"onUpdate:modelValue":l[2]||(l[2]=a=>e(u).basicResolution=a)},null,8,["modelValue"])]),_:1}),t(p,{label:"\u8F93\u51FA\u7C7B\u578B",prop:"type"},{default:o(()=>[t(h,{modelValue:e(u).type,"onUpdate:modelValue":l[3]||(l[3]=a=>e(u).type=a),class:"!w-240px",disabled:!e(u).basicResolution,placeholder:"\u8BF7\u9009\u62E9\u8F93\u51FA\u7C7B\u578B",onChange:O},{default:o(()=>[t(b,{label:"\u8F93\u51FA",value:3}),t(b,{label:"\u9884\u89C8",value:4}),t(b,{label:"\u573A\u666F",value:1}),t(b,{label:"\u8F93\u5165\u6E90",value:2})]),_:1},8,["modelValue","disabled"])]),_:1}),e(u).type==3||e(u).type==4?(r(),c(p,{key:0,label:"\u8F93\u51FA\u9009\u62E9",prop:"input"},{default:o(()=>[t(i,{modelValue:e(u).input,"onUpdate:modelValue":l[4]||(l[4]=a=>e(u).input=a),class:"!w-240px",disabled:""},null,8,["modelValue"])]),_:1})):_("",!0),e(u).type==2?(r(),c(p,{key:1,label:"\u8F93\u51FA\u9009\u62E9",prop:"input"},{default:o(()=>[t(h,{modelValue:e(u).input,"onUpdate:modelValue":l[5]||(l[5]=a=>e(u).input=a),placeholder:"\u8BF7\u9009\u62E9\u8F93\u5165\u6E90",class:"!w-240px",disabled:!e(u).basicResolution},{default:o(()=>[(r(!0),y(w,null,R(e(H),a=>(r(),c(b,{key:a.name,label:a.showName,value:a.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})):_("",!0),e(u).type==1?(r(),c(p,{key:2,label:"\u8F93\u51FA\u9009\u62E9",prop:"input"},{default:o(()=>[t(h,{modelValue:e(u).input,"onUpdate:modelValue":l[6]||(l[6]=a=>e(u).input=a),placeholder:"\u8BF7\u9009\u62E9\u573A\u666F",class:"!w-240px",disabled:!e(u).basicResolution},{default:o(()=>[(r(!0),y(w,null,R(e(q),a=>(r(),c(b,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})):_("",!0),t(W,{type:"primary",onClick:P},{default:o(()=>l[9]||(l[9]=[V("\u4FDD\u5B58")])),_:1})]),_:1})]),_:1},8,["model","rules"])],64)}}});export{de as _};

import{d as O,q as R,p as T,r as i,u as U,a3 as G,h as K,a as l,a4 as A,as as B,b as D,a5 as H,ae as J,C as v,o as F,s as o,j as a,a7 as Q,v as W,a8 as X,a9 as Y,aa as Z,ab as $,a6 as aa,af as ea,aj as ta,ak as la,al as oa,am as sa,ah as na,_ as ra}from"./index-DwcZmOlQ.js";import{_ as ia}from"./Verify-BpDrlxTH.js";import{_ as pa}from"./XButton-BmXPhnym.js";import{u as da,L as ma,_ as ua,a as ca}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang-CkqoI9Xw.js";import{u as f}from"./useIcon-DYJaHBnu.js";import{r as g}from"./formRules-RrpKDPWM.js";const fa=ra(O({name:"LoginForm",__name:"LoginForm",setup(ga){const{t:m}=R();T(),f({icon:"ep:house"});const k=f({icon:"ep:avatar"}),V=f({icon:"ep:lock"}),h=i(),{validForm:N}=ca(h),{getLoginState:L}=da(),{currentRoute:E,push:j}=U(),z=G(),p=i(""),u=i(!1),w=i(),M=i("blockPuzzle"),P=K(()=>l(L)===ma.LOGIN),S={tenantName:[g],username:[g],password:[g]},s=A({isShowPassword:!1,captchaEnable:"false",tenantEnable:"true",loginForm:{tenantName:"avswitch",username:"admin",password:"admin123",captchaVerification:"",rememberMe:!0}}),y=async()=>{s.captchaEnable==="false"?await _({}):w.value.show()},x=i(),_=async t=>{u.value=!0;try{if(!await N())return;const e={...s.loginForm};e.captchaVerification=t.captchaVerification;const n=await ta(e);if(!n)return;x.value=la.service({lock:!0,text:"\u6B63\u5728\u52A0\u8F7D\u7CFB\u7EDF\u4E2D...",background:"rgba(0, 0, 0, 0.7)"}),e.rememberMe?oa(e):sa(),na(n),p.value||(p.value="/"),p.value.indexOf("sso")!==-1?window.location.href=window.location.href.replace("/login?redirect=",""):await j({path:p.value||z.addRouters[0].path})}finally{u.value=!1,x.value.close()}};return B(()=>E.value,t=>{var e;p.value=(e=t==null?void 0:t.query)==null?void 0:e.redirect},{immediate:!0}),D(()=>{(()=>{const t=ea();t&&(s.loginForm={...s.loginForm,username:t.username?t.username:s.loginForm.username,password:t.password?t.password:s.loginForm.password,rememberMe:t.rememberMe,tenantName:t.tenantName?t.tenantName:s.loginForm.tenantName})})()}),(t,e)=>{const n=Y,r=X,b=Z,c=Q,C=pa,q=ia,I=aa;return H((F(),v(I,{ref_key:"formLogin",ref:h,model:l(s).loginForm,rules:S,class:"login-form","label-position":"top","label-width":"120px",size:"large"},{default:o(()=>[a(c,{style:{"margin-right":"-10px","margin-left":"-10px"}},{default:o(()=>[a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:o(()=>[a(n,null,{default:o(()=>[a(ua,{style:{width:"100%"}})]),_:1})]),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:o(()=>[a(n,{prop:"username"},{default:o(()=>[a(b,{modelValue:l(s).loginForm.username,"onUpdate:modelValue":e[0]||(e[0]=d=>l(s).loginForm.username=d),placeholder:l(m)("login.usernamePlaceholder"),"prefix-icon":l(k)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:o(()=>[a(n,{prop:"password"},{default:o(()=>[a(b,{modelValue:l(s).loginForm.password,"onUpdate:modelValue":e[1]||(e[1]=d=>l(s).loginForm.password=d),placeholder:l(m)("login.passwordPlaceholder"),"prefix-icon":l(V),"show-password":"",type:"password",onKeyup:e[2]||(e[2]=$(d=>y(),["enter"]))},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px","margin-top":"-20px","margin-bottom":"-20px"}},{default:o(()=>[a(n,null,{default:o(()=>[a(c,{justify:"space-between",style:{width:"100%"}})]),_:1})]),_:1}),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:o(()=>[a(n,null,{default:o(()=>[a(C,{loading:l(u),title:l(m)("login.login"),class:"w-[100%]",type:"primary",onClick:e[3]||(e[3]=d=>y())},null,8,["loading","title"])]),_:1})]),_:1}),l(s).captchaEnable==="true"?(F(),v(q,{key:0,ref_key:"verify",ref:w,captchaType:l(M),imgSize:{width:"400px",height:"200px"},mode:"pop",onSuccess:_},null,8,["captchaType"])):W("",!0),a(r,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:o(()=>[a(n,null,{default:o(()=>[a(c,{gutter:5,justify:"space-between",style:{width:"100%"}},{default:o(()=>[a(r,{span:8})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])),[[J,l(P)]])}}}),[["__scopeId","data-v-13ec24e1"]]);export{fa as default};

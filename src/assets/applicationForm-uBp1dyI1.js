import{d as T,q as G,p as J,r as p,a4 as L,C as h,o as f,s as t,a5 as O,a6 as Q,a,j as o,a9 as S,aa as W,aV as $,A as E,c as K,F as X,f as _,J as Y,Q as Z,ax as ee,aN as ae,D as le,G as oe,az as te,b6 as se,H as re,x as U,ap as de,_ as ue}from"./index-DwcZmOlQ.js";import{_ as ie}from"./Dialog.vue_vue_type_style_index_0_lang-BhpXB9km.js";import{A as x}from"./index-DX9ax4BH.js";const pe=["src"],ne={class:"image-actions"},me=ue(T({name:"DeviceTypeCatalogForm",__name:"applicationForm",emits:["success"],setup(ce,{expose:F,emit:N}){const{t:V}=G(),m=J(),i=p(!1),y=p(""),c=p(!1),v=p(""),g=p(),l=p({id:void 0,name:"",pidName:"",path:"",icon:"",workPath:"",type:void 0,sort:0}),q=L({name:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],type:[{required:!0,message:"\u8BF7\u9009\u62E9\u7C7B\u578B",trigger:"change"}],sort:[{required:!0,message:"\u8BF7\u8F93\u5165\u6392\u5E8F\u503C",trigger:"blur"}],icon:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u56FE\u7247",trigger:"change"}]});F({open:async(r,e)=>{i.value=!0,y.value=V("action."+r),v.value=r,B(),e&&(l.value=e)}});const A=N,C=async()=>{try{await g.value.validate(),c.value=!0,v.value==="create"?await x.addApp(l.value):await x.updateApp(l.value),m.success(V(`common.${v.value}Success`)),i.value=!1,A("success")}catch{}finally{c.value=!1}},b=r=>{const e=r.type.startsWith("image/"),d=r.size/1024/1024<2;return e?!!d||(m.error("\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 2MB!"),!1):(m.error("\u53EA\u80FD\u4E0A\u4F20\u56FE\u7247\u6587\u4EF6!"),!1)},P=r=>{const e=r.raw;if(!e||!b(e))return;const d=new FileReader;d.onload=u=>{var n;l.value.icon=(n=u.target)==null?void 0:n.result},d.onerror=()=>m.error("\u56FE\u7247\u8BFB\u53D6\u5931\u8D25!"),d.readAsDataURL(e)},z=()=>{l.value.icon=""},B=()=>{var r;l.value={id:void 0,name:"",pidName:"",path:"",icon:"",workPath:"",type:void 0,sort:0},(r=g.value)==null||r.resetFields()};return(r,e)=>{const d=W,u=S,n=Y,D=$,w=oe,I=le,R=te,j=Q,k=re,H=ie,M=se;return f(),h(H,{title:a(y),modelValue:a(i),"onUpdate:modelValue":e[7]||(e[7]=s=>de(i)?i.value=s:null)},{footer:t(()=>[o(k,{onClick:C,type:"primary",loading:a(c)},{default:t(()=>e[9]||(e[9]=[U("\u786E \u5B9A")])),_:1},8,["loading"]),o(k,{onClick:e[6]||(e[6]=s=>i.value=!1)},{default:t(()=>e[10]||(e[10]=[U("\u53D6 \u6D88")])),_:1})]),default:t(()=>[O((f(),h(j,{ref_key:"formRef",ref:g,model:a(l),rules:a(q),"label-width":"100px"},{default:t(()=>[o(u,{label:"\u540D\u79F0",prop:"name"},{default:t(()=>[o(d,{modelValue:a(l).name,"onUpdate:modelValue":e[0]||(e[0]=s=>a(l).name=s),placeholder:"\u8BF7\u8F93\u5165\u5206\u7C7B\u540D\u79F0"},null,8,["modelValue"])]),_:1}),o(u,{label:"\u56FE\u7247",prop:"icon",style:{"margin-bottom":"40px"}},{default:t(()=>[o(D,{action:"#","list-type":"picture-card","auto-upload":!1,style:{height:"183px"},"on-change":P,"before-upload":b,"show-file-list":!1,class:E({"has-image":a(l).icon})},{tip:t(()=>e[8]||(e[8]=[_("div",{class:"el-upload__tip"}," \u8BF7\u4E0A\u4F20\u56FE\u7247\u6587\u4EF6\uFF0C\u5927\u5C0F\u4E0D\u8D85\u8FC7 2MB ",-1)])),default:t(()=>[a(l).icon?(f(),K(X,{key:0},[_("img",{src:a(l).icon,class:"uploaded-image",alt:"Uploaded Image"},null,8,pe),_("div",ne,[o(n,{class:"delete-icon",onClick:Z(z,["stop"])},{default:t(()=>[o(a(ee))]),_:1})])],64)):(f(),h(n,{key:1},{default:t(()=>[o(a(ae))]),_:1}))]),_:1},8,["class"])]),_:1}),o(u,{label:"\u7A0B\u5E8F\u8DEF\u5F84",prop:"workPath"},{default:t(()=>[o(d,{modelValue:a(l).workPath,"onUpdate:modelValue":e[1]||(e[1]=s=>a(l).workPath=s),placeholder:"\u8BF7\u8F93\u5165\u7A0B\u5E8F\u8DEF\u5F84"},null,8,["modelValue"])]),_:1}),o(u,{label:"\u542F\u52A8\u7A0B\u5E8F",prop:"path"},{default:t(()=>[o(d,{modelValue:a(l).path,"onUpdate:modelValue":e[2]||(e[2]=s=>a(l).path=s),placeholder:"\u8BF7\u8F93\u5165\u542F\u52A8\u7A0B\u5E8F"},null,8,["modelValue"])]),_:1}),o(u,{label:"\u8FDB\u7A0B\u540D\u79F0",prop:"pidName"},{default:t(()=>[o(d,{modelValue:a(l).pidName,"onUpdate:modelValue":e[3]||(e[3]=s=>a(l).pidName=s),placeholder:"\u8BF7\u8F93\u5165\u8FDB\u7A0B\u540D\u79F0"},null,8,["modelValue"])]),_:1}),o(u,{label:"\u7C7B\u578B",prop:"type"},{default:t(()=>[o(I,{modelValue:a(l).type,"onUpdate:modelValue":e[4]||(e[4]=s=>a(l).type=s),placeholder:"\u8BF7\u9009\u62E9\u7C7B\u578B"},{default:t(()=>[o(w,{label:"\u4F1A\u8BAE\u5E73\u53F0",value:1}),o(w,{label:"\u5E94\u7528",value:2})]),_:1},8,["modelValue"])]),_:1}),o(u,{label:"\u6392\u5E8F",prop:"sort"},{default:t(()=>[o(R,{modelValue:a(l).sort,"onUpdate:modelValue":e[5]||(e[5]=s=>a(l).sort=s),min:0},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[M,a(c)]])]),_:1},8,["title","modelValue"])}}}),[["__scopeId","data-v-8b0e475e"]]);export{me as default};

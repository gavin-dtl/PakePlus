import{d as le,p as se,q as te,r as u,b as ie,e as ne,c as i,o as s,f as t,j as _,s as y,F as I,i as M,A as ue,t as c,z as re,C as f,x as R,H as oe,J as ce,a as ve,aA as de,v as J,n as N,aa as me,aG as pe,_ as ye}from"./index-Cv_H95TD.js";import{V as ge,a as k}from"./videoConversionForm-IkUN_sIi.js";import{T as fe}from"./index-BFNV9ymZ.js";import"./Dialog.vue_vue_type_style_index_0_lang-lK2Juh8I.js";const ke={class:"main"},he={class:"toVideo-list"},Ce=["onClick"],xe={style:{display:"flex","align-items":"center"}},Ee={style:{display:"flex","align-items":"center"}},Ae={class:"meeting-body"},_e={key:2,style:{color:"#888888","margin-left":"10px","margin-top":"10px"}},Ie={key:0,class:"loading-text"},Ve={key:1,class:"loading-text"},we={style:{display:"flex","align-items":"center"}},be={class:"time"},Me={class:"zh-message"},Re={key:0},qe={class:"en-message"},Te={key:0},Fe={class:"item-operate"},Se={class:"item"},ze={style:{display:"flex","align-items":"center"}},Ue={class:"time"},De={class:"zh-message"},He={class:"en-message"},Le=le({name:"VoiceToVideoConversion",__name:"index",setup(je){const Y=se(),{t:Z}=te(),m=u([]),z=async()=>{m.value=await k.getAsrList(),m.value.length>0&&D(m.value[0])},K=()=>{z()},U=u(),O=()=>{const e=m.value.find(a=>a.name==o.value);U.value.open("update",e)},o=u(""),D=e=>{o.value=e.name,V()},P=async()=>{await k.startAsr({name:o.value}),m.value.forEach(e=>{e.name==o.value&&(e.active=!0)}),V(),H()},H=()=>{X(1e3,()=>ee())},Q=async()=>{await k.stopAsr({name:o.value}),m.value.forEach(e=>{e.name==o.value&&(e.active=!1)}),q(),setTimeout(()=>{V(),v.value={},n.value=[]},100)},W=u(""),h=u([]),X=(e,a)=>{const r={timerId:null,interval:e,requestFn:a,isRequesting:!1};return r.timerId=window.setInterval(async()=>{if(!r.isRequesting){r.isRequesting=!0;try{await a()}catch{}finally{r.isRequesting=!1}}},e),h.value.push(r),()=>$(r.timerId)},$=e=>{const a=h.value.findIndex(r=>r.timerId===e);a!==-1&&(clearInterval(e),h.value.splice(a,1))},q=()=>{h.value.forEach(e=>{e.timerId&&clearInterval(e.timerId)}),h.value=[],W.value="\u6240\u6709\u8F6E\u8BE2\u5DF2\u505C\u6B62"},v=u([]),L=u(0),ee=async()=>{try{v.value=await k.getCntAsrResult({name:o.value}),L.value!=v.value.resultCount&&(j("bottom"),L.value=v.value.resultCount)}catch{V()}},n=u([]),C=u(!1),T=u(!1),B=u(null);u(1);const j=async e=>{if(e=="top"&&T.value||C.value)return;C.value=!0;const a=B.value,r=a.scrollTop,d=a.scrollHeight,S=n.value.length>0?e=="top"?n.value[0].id:n.value[n.value.length-1].id:-1,g=await k.getAsrResultById({name:o.value,pageSize:20,isAfter:e=="bottom",cntId:S,query:""});e=="top"?(n.value=[...g,...n.value],g.length<20&&(T.value=!0)):n.value=[...n.value,...g],C.value=!1,await pe();const w=a.scrollHeight-d;a.scrollTop=r+w,n.value.forEach(E=>E.isEdit=E.isEdit||!1)},ae=e=>{e.target.scrollTop!==0||C.value||j("top")},F=["#27A739","#FF8E1C","#D3BA34","#3AA3E0","#2CD7D7","#E37279","#8854FE"],x=u(!1),V=async()=>{x.value=await k.getStatusAsr({name:o.value}),x.value?H():(q(),n.value=[])};return ie(()=>{z()}),ne(()=>{q()}),(e,a)=>{var w,E;const r=re,d=oe,S=ce,g=me;return s(),i(I,null,[t("div",ke,[t("div",he,[a[0]||(a[0]=t("p",{class:"title"},"\u8F6C\u5199\u901A\u9053",-1)),_(r,{height:"calc(100vh - 190px)"},{default:y(()=>[(s(!0),i(I,null,M(m.value,l=>(s(),i("div",{onClick:A=>D(l),key:l,class:ue(["scrollbar-item",{activeItem:l.name==o.value}])},[t("p",xe,c(l.showName),1),t("p",Ee,c(l.active?"\u542F\u52A8":"\u672A\u542F\u52A8"),1)],10,Ce))),128))]),_:1})]),t("div",Ae,[x.value?(s(),f(d,{key:0,type:"danger",onClick:Q},{default:y(()=>a[1]||(a[1]=[R("\u505C\u6B62\u8F6C\u5199")])),_:1})):(s(),f(d,{key:1,type:"primary",onClick:P},{default:y(()=>a[2]||(a[2]=[R("\u5F00\u59CB\u8F6C\u5199")])),_:1})),_(d,{type:"primary",onClick:O,disabled:x.value},{default:y(()=>[_(S,null,{default:y(()=>[_(ve(de))]),_:1})]),_:1},8,["disabled"]),a[5]||(a[5]=t("h3",{style:{"margin-top":"20px"}},"\u8F6C\u5199\u8BB0\u5F55",-1)),x.value?(s(),i("div",{key:3,class:"scroll-container",ref_key:"scrollContainer",ref:B,onScroll:ae},[C.value?(s(),i("div",Ie,"\u52A0\u8F7D\u4E2D...")):J("",!0),T.value?(s(),i("div",Ve,"\u6CA1\u6709\u66F4\u591A\u5566")):J("",!0),(s(!0),i(I,null,M(n.value,(l,A)=>(s(),i("div",{key:A,class:"item"},[t("div",we,[t("p",be,c(l.createTime),1),t("p",null,[(s(!0),i(I,null,M(l.userList.split(","),(p,b)=>(s(),i("span",{key:b,style:N({backgroundColor:F[b%8]}),class:"user-name"},c(p),5))),128))])]),t("p",Me,[l.isEdit?(s(),f(g,{key:1,modelValue:l.asrMessage,"onUpdate:modelValue":p=>l.asrMessage=p,type:"textarea"},null,8,["modelValue","onUpdate:modelValue"])):(s(),i("span",Re,c(l.asrMessage),1))]),t("p",qe,[l.isEdit?(s(),f(g,{key:1,modelValue:l.transMessage,"onUpdate:modelValue":p=>l.transMessage=p,type:"textarea"},null,8,["modelValue","onUpdate:modelValue"])):(s(),i("span",Te,c(l.transMessage),1))]),t("p",Fe,[l.isEdit?(s(),f(d,{key:1,type:"primary",link:"",onClick:p=>(async b=>{try{await fe.updateAsrResulto(b),n.value.forEach(G=>G.isEdit=!1),Y.success(Z("common.updateSuccess"))}catch{}})(l)},{default:y(()=>a[4]||(a[4]=[R("\u4FDD\u5B58")])),_:2},1032,["onClick"])):(s(),f(d,{key:0,type:"primary",link:"",onClick:p=>l.isEdit=!0},{default:y(()=>a[3]||(a[3]=[R("\u7F16\u8F91")])),_:2},1032,["onClick"]))])]))),128)),t("div",Se,[t("div",ze,[t("p",Ue,c(v.value.time),1),t("p",null,[(s(!0),i(I,null,M((E=(w=v.value)==null?void 0:w.userList)==null?void 0:E.split(","),(l,A)=>(s(),i("span",{key:A,style:N({backgroundColor:F[A%F.length]}),class:"user-name"},c(l),5))),128))])]),t("p",De,c(v.value.asrMessage),1),t("p",He,c(v.value.transMessage),1)])],544)):(s(),i("p",_e,"\u6682\u672A\u5F00\u59CB\u8F6C\u5199"))])]),_(ge,{ref_key:"VideoConversionFormRef",ref:U,onSuccess:K},null,512)],64)}}}),Be=ye(Le,[["__scopeId","data-v-dd208fd6"]]);export{Be as default};

import{d as U,aq as s,k as w,r,ar as q,aW as n,c as z,p as k,o as L,m as p,aV as M,a as T,ao as $,w as f,C as j,q as R,t as A,_ as B}from"./index-h2IMwmcw.js";import{M as C}from"./index-B9iskDNg.js";const F={key:0,class:"upload-file"},N=B(U({name:"UploadFile",__name:"UploadVideo",props:{modelValue:s.oneOfType([String,Array]).isRequired,fileType:s.array.def([]),fileSize:s.number.def(1024),limit:s.number.def(5),autoUpload:s.bool.def(!0),drag:s.bool.def(!1),isShowTip:s.bool.def(!0),disabled:s.bool.def(!1),title:s.string.def("\u9009\u53D6\u6587\u4EF6"),activeListId:{type:Number,default:0}},emits:["update:modelValue","uploadSuccess"],setup(d,{emit:c}){const u=w(),m=c,i=d,v=r();r([]);const l=r([]),b=r(0),g=e=>{if(l.value.length>=i.limit)return u.error(`\u4E0A\u4F20\u6587\u4EF6\u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7${i.limit}\u4E2A!`),!1;if(e.name.lastIndexOf(".")>-1&&e.name.slice(e.name.lastIndexOf(".")+1),!(e.size<1024*i.fileSize*1024))return u.error(`\u4E0A\u4F20\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7${i.fileSize}MB!`),!1;u.success("\u6B63\u5728\u4E0A\u4F20\u6587\u4EF6\uFF0C\u8BF7\u7A0D\u5019..."),b.value++},h=e=>{u.success("\u4E0A\u4F20\u6210\u529F"),l.value=[],m("uploadSuccess")},y=()=>{u.error(`\u4E0A\u4F20\u6587\u4EF6\u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7${i.limit}\u4E2A!`)},V=()=>{},_=e=>{const a=l.value.map(o=>o.name).indexOf(e.name);a>-1&&(l.value.splice(a,1),S())},x=e=>{},I=e=>new Promise((a,o)=>{C.MeetingVideouUpload({file:e.file,id:i.activeListId}).then(t=>{t.code===0?a(t):o(t)}).catch(t=>{o(t)})});q(()=>i.modelValue,e=>{e?(l.value=[],n(e)?l.value.push(...e.split(",").map(a=>({name:a.substring(a.lastIndexOf("/")+1),url:a}))):l.value.push(...e.map(a=>({name:a.substring(a.lastIndexOf("/")+1),url:a})))):l.value=[]},{immediate:!0,deep:!0});const S=()=>{let e=l.value.map(a=>a.url);(i.limit===1||n(i.modelValue))&&(e=e.join(",")),m("update:modelValue",e)};return(e,a)=>{const o=j,t=M;return d.disabled?k("",!0):(L(),z("div",F,[p(t,{ref_key:"uploadRef",ref:v,"file-list":T(l),"onUpdate:fileList":a[0]||(a[0]=O=>$(l)?l.value=O:null),action:"/api/core/file/meeting/upload","auto-upload":d.autoUpload,"before-upload":g,disabled:d.disabled,drag:d.drag,"http-request":I,limit:i.limit,multiple:i.limit>1,"on-error":V,"on-exceed":y,"on-preview":x,"on-remove":_,"on-success":h,"show-file-list":!1,class:"upload-file-uploader",name:"file"},{default:f(()=>[p(o,{type:"primary"},{default:f(()=>[R(A(d.title),1)]),_:1})]),_:1},8,["file-list","auto-upload","disabled","drag","limit","multiple"])]))}}}),[["__scopeId","data-v-e6943a7d"]]);export{N as default};

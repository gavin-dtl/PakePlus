import{d as B,q as H,p as J,h as Q,r as u,b as Y,e as A,c as v,o,f as p,F as G,i as K,v as b,t as x,a as i,j as l,aR as M,s as t,aS as O,J as W,C as w,aT as X,aU as Z,H as $,Q as F,x as k,aE as aa,ap as ea,_ as la}from"./index-Cv_H95TD.js";import{U as ta,F as P}from"./UploadFile-BmfXmoQQ.js";const sa={class:"f1le-main"},oa={class:"filePath"},ia=["onClick"],na={style:{"background-color":"rgba(35,110,214,0.26)","border-radius":"4px",padding:"5px 10px","margin-left":"5px"}},ra={key:0},ca={style:{"margin-top":"15px"}},pa={style:{"margin-left":"5px"}},da={class:"footer"},ua=la(B({name:"DeviceTypeForm",__name:"globalFiles",props:{catalogSelection:{type:Boolean,default:!1}},emits:["success"],setup(z,{emit:V}){const{t:T}=H(),g=J(),q=V,D=z,E=Q(()=>D.catalogSelection),n=(u({}),u([])),S=u([]),c=async r=>{const e=await P.commonFileList({path:r});n.value=e.filePath,S.value=e.fileList,m.value=n.value[n.value.length-1].path},I=async r=>{r.directory&&c(r.path)},L=async()=>{const r=await g.validatePrompt("\u8BF7\u8F93\u5165\u6587\u4EF6\u5939\u540D\u79F0",T("\u521B\u5EFA\u6587\u4EF6\u5939"),{inputValue:"",validator:_=>!!_||"\u6587\u4EF6\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}),e=n.value[n.value.length-1].path;await P.createDirectory({dirName:r.value,basePath:e}),c(e),g.success("\u65B0\u589E\u6210\u529F")},C=u(),m=u(""),N={title:"\u6587\u4EF6\u4E0A\u4F20",isShowTip:!1},R=()=>{c(m.value)};return Y(()=>{c("")}),A(()=>{}),(r,e)=>{const _=W,y=O,f=$,j=M;return o(),v("div",sa,[p("div",oa,[(o(!0),v(G,null,K(i(n),(a,h)=>(o(),v("p",{onClick:s=>{c(a.path)},key:a.path},[p("span",na,x(a.name),1),i(n).length!=h+1?(o(),v("span",ra," > ")):b("",!0)],8,ia))),128))]),p("div",ca,[l(j,{data:i(S),height:"700px",style:{width:"100%"},onCellClick:I},{default:t(()=>[l(y,{prop:"name",label:"\u540D\u79F0"},{default:t(a=>[l(_,null,{default:t(()=>[a.row.directory?(o(),w(i(X),{key:0})):(o(),w(i(Z),{key:1}))]),_:2},1024),p("span",pa,x(a.row.name),1)]),_:1}),l(y,{prop:"size",label:"\u5927\u5C0F",width:"200px",align:"center"}),l(y,{prop:"format",label:"\u7C7B\u578B",width:"150px",align:"center"},{default:t(a=>[p("span",null,x(a.row.directory?"\u6587\u4EF6\u5939":a.row.format),1)]),_:1}),l(y,{label:"\u64CD\u4F5C",align:"center"},{default:t(a=>[l(f,{size:"small",type:"danger",onClick:F(h=>(async s=>{await g.delConfirm("\u786E\u8BA4\u5220\u9664\u6587\u4EF6?"),await P.deleteFile({filePath:s.path}),c(m.value)})(a.row),["stop"])},{default:t(()=>e[1]||(e[1]=[k(" \u5220\u9664 ")])),_:2},1032,["onClick"]),a.row.directory?b("",!0):(o(),w(f,{key:0,size:"small",onClick:F(h=>(async s=>{try{const U="/api/core/file/download?filePath="+encodeURIComponent(s.path),d=document.createElement("a");d.href=U,d.download=s.playName,document.body.appendChild(d),d.click(),document.body.removeChild(d)}catch{}})(a.row),["stop"])},{default:t(()=>e[2]||(e[2]=[k(" \u4E0B\u8F7D ")])),_:2},1032,["onClick"])),i(E)||!a.row.directory?(o(),w(f,{key:1,type:"primary",size:"small",onClick:F(h=>{return s=a.row,void q("success",s);var s},["stop"])},{default:t(()=>e[3]||(e[3]=[k(" \u9009\u62E9 ")])),_:2},1032,["onClick"])):b("",!0)]),_:1})]),_:1},8,["data"])]),p("div",da,[l(f,{type:"primary",onClick:L},{default:t(()=>e[4]||(e[4]=[k("\u521B\u5EFA\u6587\u4EF6\u5939")])),_:1}),l(ta,aa({style:{display:"inline-block","margin-left":"10px",transform:"translateY(4px)"},onUploadSuccess:R},N,{dir:i(m),modelValue:i(C),"onUpdate:modelValue":e[0]||(e[0]=a=>ea(C)?C.value=a:null),limit:1}),null,16,["dir","modelValue"])])])}}}),[["__scopeId","data-v-7214a5f4"]]);export{ua as default};

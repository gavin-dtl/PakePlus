import{av as ji,k as Bi,l as xe,d as cP,r as Lr,Z as lP,u as hP,b as fP,e as dP,c as pP,o as gP,f as $x,j as Wg,s as vP,y as mP,B as yP,F as bP,_ as xP}from"./index-Cv_H95TD.js";import{A as wP,D as EP}from"./deviceInfomationDialog-C3UC0Cug.js";import{m as Qx,u as MP}from"./useMatt-BtYd2sG4.js";import{e as SP}from"./mitt-CI7Qv1RY.js";function _P(e,n){for(var t=0;t<n.length;t++){const r=n[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}const Vg=Object.freeze(Object.defineProperty({__proto__:null,get Base(){return wi},get Circle(){return wj},get Ellipse(){return Ej},get Image(){return Mj},get Line(){return Sj},get Marker(){return kj},get Path(){return Qv},get Polygon(){return Ij},get Polyline(){return Tj},get Rect(){return Oj},get Text(){return Nj}},Symbol.toStringTag,{value:"Module"})),Hg=Object.freeze(Object.defineProperty({__proto__:null,get Base(){return ti},get Circle(){return Dj},get Dom(){return Pj},get Ellipse(){return Lj},get Image(){return Rj},get Line(){return jj},get Marker(){return Bj},get Path(){return zj},get Polygon(){return Fj},get Polyline(){return Gj},get Rect(){return Uj},get Text(){return Vj}},Symbol.toStringTag,{value:"Module"}));var qg=function(e,n){return qg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},qg(e,n)};function Nt(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function t(){this.constructor=e}qg(e,n),e.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}var F=function(){return F=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},F.apply(this,arguments)};function Yn(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function"){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(t[r[i]]=e[r[i]])}return t}function Jx(e,n,t,r){var i,o=arguments.length,a=o<3?n:r===null?r=Object.getOwnPropertyDescriptor(n,t):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(e,n,t,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(n,t,a):i(n,t))||a);return o>3&&a&&Object.defineProperty(n,t,a),a}function ew(e,n){return function(t,r){n(t,r,e)}}function tw(e,n,t,r,i,o){function a(m){if(m!==void 0&&typeof m!="function")throw new TypeError("Function expected");return m}for(var s,u=r.kind,c=u==="getter"?"get":u==="setter"?"set":"value",l=!n&&e?r.static?e:e.prototype:null,h=n||(l?Object.getOwnPropertyDescriptor(l,r.name):{}),f=!1,d=t.length-1;d>=0;d--){var p={};for(var g in r)p[g]=g==="access"?{}:r[g];for(var g in r.access)p.access[g]=r.access[g];p.addInitializer=function(m){if(f)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(m||null))};var v=(0,t[d])(u==="accessor"?{get:h.get,set:h.set}:h[c],p);if(u==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(s=a(v.get))&&(h.get=s),(s=a(v.set))&&(h.set=s),(s=a(v.init))&&i.unshift(s)}else(s=a(v))&&(u==="field"?i.unshift(s):h[c]=s)}l&&Object.defineProperty(l,r.name,h),f=!0}function nw(e,n,t){for(var r=arguments.length>2,i=0;i<n.length;i++)t=r?n[i].call(e,t):n[i].call(e);return r?t:void 0}function rw(e){return typeof e=="symbol"?e:"".concat(e)}function iw(e,n,t){return typeof n=="symbol"&&(n=n.description?"[".concat(n.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:t?"".concat(t," ",n):n})}function ow(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)}function Rr(e,n,t,r){return new(t||(t=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(l){o(l)}}function s(c){try{u(r.throw(c))}catch(l){o(l)}}function u(c){var l;c.done?i(c.value):(l=c.value,l instanceof t?l:new t(function(h){h(l)})).then(a,s)}u((r=r.apply(e,n||[])).next())})}function jr(e,n){var t,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(o=0)),o;)try{if(t=1,r&&(i=2&l[0]?r.return:l[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,l[1])).done)return i;switch(r=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(i=o.trys,!((i=i.length>0&&i[i.length-1])||l[0]!==6&&l[0]!==2)){o=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){o.label=l[1];break}if(l[0]===6&&o.label<i[1]){o.label=i[1],i=l;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(l);break}i[2]&&o.ops.pop(),o.trys.pop();continue}l=n.call(e,o)}catch(h){l=[6,h],r=0}finally{t=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([u,c])}}}var Dh=Object.create?function(e,n,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(n,t);i&&!("get"in i?!n.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(e,r,i)}:function(e,n,t,r){r===void 0&&(r=t),e[r]=n[t]};function aw(e,n){for(var t in e)t==="default"||Object.prototype.hasOwnProperty.call(n,t)||Dh(n,e,t)}function Zg(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function Kg(e,n){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var r,i,o=t.call(e),a=[];try{for(;(n===void 0||n-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return a}function sw(){for(var e=[],n=0;n<arguments.length;n++)e=e.concat(Kg(arguments[n]));return e}function Ph(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;var r=Array(e),i=0;for(n=0;n<t;n++)for(var o=arguments[n],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function Br(e,n,t){if(t||arguments.length===2)for(var r,i=0,o=n.length;i<o;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))}function Ys(e){return this instanceof Ys?(this.v=e,this):new Ys(e)}function uw(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(e,n||[]),o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function(h){return function(f){return Promise.resolve(f).then(h,c)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(h,f){i[h]&&(r[h]=function(d){return new Promise(function(p,g){o.push([h,d,p,g])>1||s(h,d)})},f&&(r[h]=f(r[h])))}function s(h,f){try{(function(d){d.value instanceof Ys?Promise.resolve(d.value.v).then(u,c):l(o[0][2],d)})(i[h](f))}catch(d){l(o[0][3],d)}}function u(h){s("next",h)}function c(h){s("throw",h)}function l(h,f){h(f),o.shift(),o.length&&s(o[0][0],o[0][1])}}function cw(e){var n,t;return n={},r("next"),r("throw",function(i){throw i}),r("return"),n[Symbol.iterator]=function(){return this},n;function r(i,o){n[i]=e[i]?function(a){return(t=!t)?{value:Ys(e[i](a)),done:!1}:o?o(a):a}:o}}function lw(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,t=e[Symbol.asyncIterator];return t?t.call(e):(e=Zg(e),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=e[i]&&function(o){return new Promise(function(a,s){(function(u,c,l,h){Promise.resolve(h).then(function(f){u({value:f,done:l})},c)})(a,s,(o=e[i](o)).done,o.value)})}}}function hw(e,n){return Object.defineProperty?Object.defineProperty(e,"raw",{value:n}):e.raw=n,e}var kP=Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n},$g=function(e){return $g=Object.getOwnPropertyNames||function(n){var t=[];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[t.length]=r);return t},$g(e)};function fw(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var t=$g(e),r=0;r<t.length;r++)t[r]!=="default"&&Dh(n,e,t[r]);return kP(n,e),n}function dw(e){return e&&e.__esModule?e:{default:e}}function pw(e,n,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?e!==n||!r:!n.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(e):r?r.value:n.get(e)}function gw(e,n,t,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof n=="function"?e!==n||!i:!n.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(e,t):i?i.value=t:n.set(e,t),t}function vw(e,n){if(n===null||typeof n!="object"&&typeof n!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?n===e:e.has(n)}function mw(e,n,t){if(n!=null){if(typeof n!="object"&&typeof n!="function")throw new TypeError("Object expected.");var r,i;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=n[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=n[Symbol.dispose],t&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(o){return Promise.reject(o)}}),e.stack.push({value:n,dispose:r,async:t})}else t&&e.stack.push({async:!0});return n}var CP=typeof SuppressedError=="function"?SuppressedError:function(e,n,t){var r=new Error(t);return r.name="SuppressedError",r.error=e,r.suppressed=n,r};function yw(e){function n(i){e.error=e.hasError?new CP(i,e.error,"An error was suppressed during disposal."):i,e.hasError=!0}var t,r=0;return function i(){for(;t=e.stack.pop();)try{if(!t.async&&r===1)return r=0,e.stack.push(t),Promise.resolve().then(i);if(t.dispose){var o=t.dispose.call(t.value);if(t.async)return r|=2,Promise.resolve(o).then(i,function(a){return n(a),i()})}else r|=1}catch(a){n(a)}if(r===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function bw(e,n){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,r,i,o,a){return r?n?".jsx":".js":!i||o&&a?i+o+"."+a.toLowerCase()+"js":t}):e}const AP={__extends:Nt,__assign:F,__rest:Yn,__decorate:Jx,__param:ew,__esDecorate:tw,__runInitializers:nw,__propKey:rw,__setFunctionName:iw,__metadata:ow,__awaiter:Rr,__generator:jr,__createBinding:Dh,__exportStar:aw,__values:Zg,__read:Kg,__spread:sw,__spreadArrays:Ph,__spreadArray:Br,__await:Ys,__asyncGenerator:uw,__asyncDelegator:cw,__asyncValues:lw,__makeTemplateObject:hw,__importStar:fw,__importDefault:dw,__classPrivateFieldGet:pw,__classPrivateFieldSet:gw,__classPrivateFieldIn:vw,__addDisposableResource:mw,__disposeResources:yw,__rewriteRelativeImportExtension:bw},IP=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:mw,get __assign(){return F},__asyncDelegator:cw,__asyncGenerator:uw,__asyncValues:lw,__await:Ys,__awaiter:Rr,__classPrivateFieldGet:pw,__classPrivateFieldIn:vw,__classPrivateFieldSet:gw,__createBinding:Dh,__decorate:Jx,__disposeResources:yw,__esDecorate:tw,__exportStar:aw,__extends:Nt,__generator:jr,__importDefault:dw,__importStar:fw,__makeTemplateObject:hw,__metadata:ow,__param:ew,__propKey:rw,__read:Kg,__rest:Yn,__rewriteRelativeImportExtension:bw,__runInitializers:nw,__setFunctionName:iw,__spread:sw,__spreadArray:Br,__spreadArrays:Ph,__values:Zg,default:AP},Symbol.toStringTag,{value:"Module"}));var _r=function(e){return e!==null&&typeof e!="function"&&isFinite(e.length)},Lh=function(e,n){return!!_r(e)&&e.indexOf(n)>-1},Rh=function(e,n){if(!_r(e))return e;for(var t=[],r=0;r<e.length;r++){var i=e[r];n(i,r)&&t.push(i)}return t},TP={}.toString,gi=function(e,n){return TP.call(e)==="[object "+n+"]"};const mn=function(e){return gi(e,"Function")};var yt=function(e){return e==null};const Mt=function(e){return Array.isArray?Array.isArray(e):gi(e,"Array")},tr=function(e){var n=typeof e;return e!==null&&n==="object"||n==="function"};function ye(e,n){if(e){if(Mt(e))for(var t=0,r=e.length;t<r&&n(e[t],t)!==!1;t++);else if(tr(e)){for(var i in e)if(e.hasOwnProperty(i)&&n(e[i],i)===!1)break}}}var xw=Object.keys?function(e){return Object.keys(e)}:function(e){var n=[];return ye(e,function(t,r){mn(e)&&r==="prototype"||n.push(r)}),n};function ww(e,n){var t=xw(n),r=t.length;if(yt(e))return!r;for(var i=0;i<r;i+=1){var o=t[i];if(n[o]!==e[o]||!(o in e))return!1}return!0}var jh=function(e){return typeof e=="object"&&e!==null},nr=function(e){if(!jh(e)||!gi(e,"Object"))return!1;if(Object.getPrototypeOf(e)===null)return!0;for(var n=e;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n},Ew=function(e,n){if(n===void 0&&(n=[]),Mt(e))for(var t=0;t<e.length;t+=1)Ew(e[t],n);else n.push(e);return n};const zi=function(e){if(Mt(e))return e.reduce(function(n,t){return Math.max(n,t)},e[0])},Fi=function(e){if(Mt(e))return e.reduce(function(n,t){return Math.min(n,t)},e[0])};var Mw=function(e){var n=e.filter(function(o){return!isNaN(o)});if(!n.length)return{min:0,max:0};if(Mt(e[0])){for(var t=[],r=0;r<e.length;r++)t=t.concat(e[r]);n=t}var i=zi(n);return{min:Fi(n),max:i}},Sw=Array.prototype,OP=Sw.splice,NP=Sw.indexOf,DP=Array.prototype.splice,_w=function(e,n){if(!_r(e))return[];for(var t=e?n.length:0,r=t-1;t--;){var i=void 0,o=n[t];t!==r&&o===i||(i=o,DP.call(e,o,1))}return e},kw=function(e,n,t){if(!Mt(e)&&!nr(e))return e;var r=t;return ye(e,function(i,o){r=n(r,i,o)}),r};const Re=function(e){return gi(e,"String")};function lc(e,n){n===void 0&&(n=new Map);var t=[];if(Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var o=e[r];n.has(o)||(t.push(o),n.set(o,!0))}return t}function Gi(e){if(_r(e))return e[0]}function $r(e){if(_r(e))return e[e.length-1]}var PP=Object.prototype.hasOwnProperty;function Bh(e,n){if(!n||!Mt(e))return{};for(var t,r={},i=mn(n)?n:function(s){return s[n]},o=0;o<e.length;o++){var a=e[o];t=i(a),PP.call(r,t)?r[t].push(a):r[t]=[a]}return r}function Cw(e,n){if(!n)return{0:e};if(!mn(n)){var t=Mt(n)?n:n.replace(/\s+/g,"").split("*");n=function(r){for(var i="_",o=0,a=t.length;o<a;o++)i+=r[t[o]]&&r[t[o]].toString();return i}}return Bh(e,n)}function Ya(e,n){if(e["_wrap_"+n])return e["_wrap_"+n];var t=function(r){e[n](r)};return e["_wrap_"+n]=t,t}var Aw={},zh=function(e,n){var t=n.toString(),r=t.indexOf(".");if(r===-1)return Math.round(e);var i=t.substr(r+1).length;return i>20&&(i=20),parseFloat(e.toFixed(i))},xt=function(e){return gi(e,"Number")},LP=Number.isInteger?Number.isInteger:function(e){return xt(e)&&e%1==0};function Iw(e,n,t){return t===void 0&&(t=1e-5),Math.abs(e-n)<t}var Fh=function(e,n){return(e%n+n)%n},RP=180/Math.PI;const jP=parseInt;var BP=Math.PI/180,Gh=function(e){return BP*e};const Tw=function(e,n){return e.hasOwnProperty(n)};var Qg=Object.values?function(e){return Object.values(e)}:function(e){var n=[];return ye(e,function(t,r){mn(e)&&r==="prototype"||n.push(t)}),n};const Ws=function(e){return yt(e)?"":e.toString()};var Vs=function(e){var n=Ws(e);return n.charAt(0).toUpperCase()+n.substring(1)},zP={}.toString,Ow=function(e){return zP.call(e).replace(/^\[object /,"").replace(/]$/,"")},hc=function(e){return gi(e,"Boolean")},Jg=function(e){return gi(e,"Date")},FP=Object.prototype,Nw=function(e){var n=e&&e.constructor;return e===(typeof n=="function"&&n.prototype||FP)};function Dw(e){var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,16)};return n(e)}function Pw(e){(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout)(e)}function e0(e,n){for(var t in n)n.hasOwnProperty(t)&&t!=="constructor"&&n[t]!==void 0&&(e[t]=n[t])}function St(e,n,t,r){return n&&e0(e,n),t&&e0(e,t),r&&e0(e,r),e}var Kt=function(e){if(typeof e!="object"||e===null)return e;var n;if(Mt(e)){n=[];for(var t=0,r=e.length;t<r;t++)typeof e[t]=="object"&&e[t]!=null?n[t]=Kt(e[t]):n[t]=e[t]}else for(var i in n={},e)typeof e[i]=="object"&&e[i]!=null?n[i]=Kt(e[i]):n[i]=e[i];return n};function fc(e,n,t){var r;return function(){var i=this,o=arguments,a=t&&!r;clearTimeout(r),r=setTimeout(function(){r=null,t||e.apply(i,o)},n),a&&e.apply(i,o)}}const Lw=function(e,n){if(!mn(e))throw new TypeError("Expected a function");var t=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=n?n.apply(this,r):r[0],a=t.cache;if(a.has(o))return a.get(o);var s=e.apply(this,r);return a.set(o,s),s};return t.cache=new Map,t};function Rw(e,n,t,r){for(var i in t=t||0,r=r||5,n)if(n.hasOwnProperty(i)){var o=n[i];o!==null&&nr(o)?(nr(e[i])||(e[i]={}),t<r?Rw(e[i],o,t+1,r):e[i]=n[i]):Mt(o)?(e[i]=[],e[i]=e[i].concat(o)):o!==void 0&&(e[i]=o)}}var fn=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];for(var r=0;r<n.length;r+=1)Rw(e,n[r]);return e},t0=function(e,n){if(!_r(e))return-1;var t=Array.prototype.indexOf;if(t)return t.call(e,n);for(var r=-1,i=0;i<e.length;i++)if(e[i]===n){r=i;break}return r},GP=Object.prototype.hasOwnProperty;function jw(e){if(yt(e))return!0;if(_r(e))return!e.length;var n=Ow(e);if(n==="Map"||n==="Set")return!e.size;if(Nw(e))return!Object.keys(e).length;for(var t in e)if(GP.call(e,t))return!1;return!0}var qo=function(e,n){if(e===n)return!0;if(!e||!n||Re(e)||Re(n))return!1;if(_r(e)||_r(n)){if(e.length!==n.length)return!1;for(var t=!0,r=0;r<e.length&&(t=qo(e[r],n[r]));r++);return t}if(jh(e)||jh(n)){var i=Object.keys(e),o=Object.keys(n);if(i.length!==o.length)return!1;for(t=!0,r=0;r<i.length&&(t=qo(e[i[r]],n[i[r]]));r++);return t}return!1},Wa=function(e,n){if(!_r(e))return e;for(var t=[],r=0;r<e.length;r++){var i=e[r];t.push(n(i,r))}return t},UP=function(e){return e};const fo=function(e,n,t){for(var r=0,i=Re(n)?n.split("."):n;e&&r<i.length;)e=e[i[r++]];return e===void 0||r<i.length?t:e};var XP=Object.prototype.hasOwnProperty;const dc=function(e,n,t){var r,i,o,a,s=0;t||(t={});var u=function(){s=t.leading===!1?0:Date.now(),r=null,a=e.apply(i,o),r||(i=o=null)},c=function(){var l=Date.now();s||t.leading!==!1||(s=l);var h=n-(l-s);return i=this,o=arguments,h<=0||h>n?(r&&(clearTimeout(r),r=null),s=l,a=e.apply(i,o),r||(i=o=null)):r||t.trailing===!1||(r=setTimeout(u,h)),a};return c.cancel=function(){clearTimeout(r),s=0,r=i=o=null},c},Bw=function(e){return _r(e)?Array.prototype.slice.call(e):[]};var Uh={};const Ui=function(e){return Uh[e=e||"g"]?Uh[e]+=1:Uh[e]=1,e+Uh[e]},pc=function(){};function Xh(e){return yt(e)?0:_r(e)?e.length:Object.keys(e).length}var Yh;const gc=Lw(function(e,n){n===void 0&&(n={});var t=n.fontSize,r=n.fontFamily,i=n.fontWeight,o=n.fontStyle,a=n.fontVariant;return Yh||(Yh=document.createElement("canvas").getContext("2d")),Yh.font=[o,a,i,t+"px",r].join(" "),Yh.measureText(Re(e)?e:"").width},function(e,n){return n===void 0&&(n={}),Ph([e],Qg(n)).join("")});var YP=function(){function e(){this.map={}}return e.prototype.has=function(n){return this.map[n]!==void 0},e.prototype.get=function(n,t){var r=this.map[n];return r===void 0?t:r},e.prototype.set=function(n,t){this.map[n]=t},e.prototype.clear=function(){this.map={}},e.prototype.delete=function(n){delete this.map[n]},e.prototype.size=function(){return Object.keys(this.map).length},e}();const WP=Object.freeze(Object.defineProperty({__proto__:null,Cache:YP,assign:St,augment:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var t=e[0],r=1;r<e.length;r++){var i=e[r];mn(i)&&(i=i.prototype),St(t.prototype,i)}},clamp:function(e,n,t){return e<n?n:e>t?t:e},clearAnimationFrame:Pw,clone:Kt,contains:Lh,debounce:fc,deepMix:fn,difference:function(e,n){return n===void 0&&(n=[]),Rh(e,function(t){return!Lh(n,t)})},each:ye,endsWith:function(e,n){return!(!Mt(e)&&!Re(e))&&e[e.length-1]===n},every:function(e,n){for(var t=0;t<e.length;t++)if(!n(e[t],t))return!1;return!0},extend:function(e,n,t,r){mn(n)||(t=n,n=e,e=function(){});var i=Object.create?function(a,s){return Object.create(a,{constructor:{value:s}})}:function(a,s){function u(){}u.prototype=a;var c=new u;return c.constructor=s,c},o=i(n.prototype,e);return e.prototype=St(o,e.prototype),e.superclass=i(n.prototype,n),St(o,t),St(e,r),e},filter:Rh,find:function(e,n){if(!Mt(e))return null;var t;if(mn(n)&&(t=n),nr(n)&&(t=function(i){return ww(i,n)}),t){for(var r=0;r<e.length;r+=1)if(t(e[r]))return e[r]}return null},findIndex:function(e,n,t){t===void 0&&(t=0);for(var r=t;r<e.length;r++)if(n(e[r],r))return r;return-1},firstValue:function(e,n){for(var t=null,r=0;r<e.length;r++){var i=e[r][n];if(!yt(i)){t=Mt(i)?i[0]:i;break}}return t},fixedBase:zh,flatten:function(e){if(!Mt(e))return[];for(var n=[],t=0;t<e.length;t++)n=n.concat(e[t]);return n},flattenDeep:Ew,forIn:ye,get:fo,getEllipsisText:function(e,n,t,r){r===void 0&&(r="...");var i,o,a=gc(r,t),s=Re(e)?e:Ws(e),u=n,c=[];if(gc(e,t)<=n)return e;for(;i=s.substr(0,16),!((o=gc(i,t))+a>u&&o>u);)if(c.push(i),u-=o,!(s=s.substr(16)))return c.join("");for(;i=s.substr(0,1),!((o=gc(i,t))+a>u);)if(c.push(i),u-=o,!(s=s.substr(1)))return c.join("");return""+c.join("")+r},getRange:Mw,getType:Ow,getWrapBehavior:function(e,n){return e["_wrap_"+n]},group:function(e,n){if(!n)return[e];var t=Cw(e,n),r=[];for(var i in t)r.push(t[i]);return r},groupBy:Bh,groupToMap:Cw,has:Tw,hasKey:Tw,hasValue:function(e,n){return Lh(Qg(e),n)},head:Gi,identity:function(e){return e},includes:Lh,indexOf:t0,isArguments:function(e){return gi(e,"Arguments")},isArray:Mt,isArrayLike:_r,isBoolean:hc,isDate:Jg,isDecimal:function(e){return xt(e)&&e%1!=0},isElement:function(e){return e instanceof Element||e instanceof HTMLDocument},isEmpty:jw,isEqual:qo,isEqualWith:function(e,n,t){return mn(t)?!!t(e,n):qo(e,n)},isError:function(e){return gi(e,"Error")},isEven:function(e){return xt(e)&&e%2==0},isFinite:function(e){return xt(e)&&isFinite(e)},isFunction:mn,isInteger:LP,isMatch:ww,isNegative:function(e){return xt(e)&&e<0},isNil:yt,isNull:function(e){return e===null},isNumber:xt,isNumberEqual:Iw,isObject:tr,isObjectLike:jh,isOdd:function(e){return xt(e)&&e%2!=0},isPlainObject:nr,isPositive:function(e){return xt(e)&&e>0},isPrototype:Nw,isRegExp:function(e){return gi(e,"RegExp")},isString:Re,isType:gi,isUndefined:function(e){return e===void 0},keys:xw,last:$r,lowerCase:function(e){return Ws(e).toLowerCase()},lowerFirst:function(e){var n=Ws(e);return n.charAt(0).toLowerCase()+n.substring(1)},map:Wa,mapValues:function(e,n){n===void 0&&(n=UP);var t={};return tr(e)&&!yt(e)&&Object.keys(e).forEach(function(r){t[r]=n(e[r],r)}),t},max:zi,maxBy:function(e,n){if(Mt(e)){for(var t,r=-1/0,i=0;i<e.length;i++){var o=e[i],a=mn(n)?n(o):o[n];a>r&&(t=o,r=a)}return t}},measureTextWidth:gc,memoize:Lw,min:Fi,minBy:function(e,n){if(Mt(e)){for(var t,r=1/0,i=0;i<e.length;i++){var o=e[i],a=mn(n)?n(o):o[n];a<r&&(t=o,r=a)}return t}},mix:St,mod:Fh,noop:pc,number2color:function(e){var n=Aw[e];if(!n){for(var t=e.toString(16),r=t.length;r<6;r++)t="0"+t;n="#"+t,Aw[e]=n}return n},omit:function(e,n){return kw(e,function(t,r,i){return n.includes(i)||(t[i]=r),t},{})},parseRadius:function(e){var n=0,t=0,r=0,i=0;return Mt(e)?e.length===1?n=t=r=i=e[0]:e.length===2?(n=r=e[0],t=i=e[1]):e.length===3?(n=e[0],t=i=e[1],r=e[2]):(n=e[0],t=e[1],r=e[2],i=e[3]):n=t=r=i=e,{r1:n,r2:t,r3:r,r4:i}},pick:function(e,n){if(e===null||!nr(e))return{};var t={};return ye(n,function(r){XP.call(e,r)&&(t[r]=e[r])}),t},pull:function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];for(var r=0;r<n.length;r++)for(var i=n[r],o=-1;(o=NP.call(e,i))>-1;)OP.call(e,o,1);return e},pullAt:_w,reduce:kw,remove:function(e,n){var t=[];if(!_r(e))return t;for(var r=-1,i=[],o=e.length;++r<o;){var a=e[r];n(a,r,e)&&(t.push(a),i.push(r))}return _w(e,i),t},requestAnimationFrame:Dw,set:function(e,n,t){var r=e,i=Re(n)?n.split("."):n;return i.forEach(function(o,a){a<i.length-1?(tr(r[o])||(r[o]=xt(i[a+1])?[]:{}),r=r[o]):r[o]=t}),e},size:Xh,some:function(e,n){for(var t=0;t<e.length;t++)if(n(e[t],t))return!0;return!1},sortBy:function(e,n){var t;if(mn(n))t=function(i,o){return n(i)-n(o)};else{var r=[];Re(n)?r.push(n):Mt(n)&&(r=n),t=function(i,o){for(var a=0;a<r.length;a+=1){var s=r[a];if(i[s]>o[s])return 1;if(i[s]<o[s])return-1}return 0}}return e.sort(t),e},startsWith:function(e,n){return!(!Mt(e)&&!Re(e))&&e[0]===n},substitute:function(e,n){return e&&n?e.replace(/\\?\{([^{}]+)\}/g,function(t,r){return t.charAt(0)==="\\"?t.slice(1):n[r]===void 0?"":n[r]}):e},throttle:dc,toArray:Bw,toDegree:function(e){return RP*e},toInteger:jP,toRadian:Gh,toString:Ws,union:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return lc([].concat.apply([],e))},uniq:lc,uniqueId:Ui,upperCase:function(e){return Ws(e).toUpperCase()},upperFirst:Vs,values:Qg,valuesOfKey:function(e,n){for(var t=[],r={},i=0;i<e.length;i++){var o=e[i][n];if(!yt(o)){Mt(o)||(o=[o]);for(var a=0;a<o.length;a++){var s=o[a];r[s]||(t.push(s),r[s]=!0)}}}return t},wrapBehavior:Ya},Symbol.toStringTag,{value:"Module"})),VP={getDefaultCfg:function(){return{}},getEvents:function(){return{}},updateCfg:function(e){return Object.assign(this,e),!0},shouldBegin:function(){return!0},shouldUpdate:function(){return!0},shouldEnd:function(){return!0},bind:function(e){var n=this,t=this.events;this.graph=e,this.type!=="drag-canvas"&&this.type!=="brush-select"&&this.type!=="lasso-select"||e.get("canvas").set("draggable",!0),ye(t,function(r,i){e.on(i,r)}),document.addEventListener("visibilitychange",function(){n.keydown=!1})},unbind:function(e){var n=this.events,t=e.get("canvas").get("draggable");this.type!=="drag-canvas"&&this.type!=="brush-select"&&this.type!=="lasso-select"||e.get("canvas").set("draggable",!1),ye(n,function(r,i){e.off(i,r)}),e.get("canvas").set("draggable",t)},get:function(e){return this[e]},set:function(e,n){return this[e]=n,this}};var n0=function(){function e(){}return e.registerBehavior=function(n,t){if(!t)throw new Error("please specify handler for this behavior: ".concat(n));var r=Kt(VP);Object.assign(r,t);var i=function(o){var a=this;Object.assign(this,this.getDefaultCfg(),o);var s=this.getEvents();this.events=null;var u={};s&&(ye(s,function(c,l){u[l]=Ya(a,c)}),this.events=u)};i.prototype=r,e.types[n]=i},e.hasBehavior=function(n){return!!e.types[n]},e.getBehavior=function(n){return e.types[n]},e.types={},e}(),zw=function(){function e(){this._events={}}return e.prototype.on=function(n,t,r){return this._events[n]||(this._events[n]=[]),this._events[n].push({callback:t,once:!!r}),this},e.prototype.once=function(n,t){return this.on(n,t,!0)},e.prototype.emit=function(n){for(var t=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=this._events[n]||[],a=this._events["*"]||[],s=function(u){for(var c=u.length,l=0;l<c;l++)if(u[l]){var h=u[l],f=h.callback;h.once&&(u.splice(l,1),u.length===0&&delete t._events[n],c--,l--),f.apply(t,r)}};s(o),s(a)},e.prototype.off=function(n,t){if(n)if(t){for(var r=this._events[n]||[],i=r.length,o=0;o<i;o++)r[o].callback===t&&(r.splice(o,1),i--,o--);r.length===0&&delete this._events[n]}else delete this._events[n];else this._events={};return this},e.prototype.getEvents=function(){return this._events},e}(),kt=1e-6,en=typeof Float32Array<"u"?Float32Array:Array,vi=Math.random,HP=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,n=arguments.length;n--;)e+=arguments[n]*arguments[n];return Math.sqrt(e)});const qP=Object.freeze(Object.defineProperty({__proto__:null,get ARRAY_TYPE(){return en},EPSILON:kt,RANDOM:vi,equals:function(e,n){return Math.abs(e-n)<=kt*Math.max(1,Math.abs(e),Math.abs(n))},setMatrixArrayType:function(e){en=e},toRadian:function(e){return e*HP}},Symbol.toStringTag,{value:"Module"}));function Fw(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3],s=t[0],u=t[1],c=t[2],l=t[3];return e[0]=r*s+o*u,e[1]=i*s+a*u,e[2]=r*c+o*l,e[3]=i*c+a*l,e}function Gw(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e[3]=n[3]-t[3],e}var ZP=Fw,KP=Gw;const $P=Object.freeze(Object.defineProperty({__proto__:null,LDU:function(e,n,t,r){return e[2]=r[2]/r[0],t[0]=r[0],t[1]=r[1],t[3]=r[3]-e[2]*t[1],[e,n,t]},add:function(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e[3]=n[3]+t[3],e},adjoint:function(e,n){var t=n[0];return e[0]=n[3],e[1]=-n[1],e[2]=-n[2],e[3]=t,e},clone:function(e){var n=new en(4);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n},copy:function(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e},create:function(){var e=new en(4);return en!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},determinant:function(e){return e[0]*e[3]-e[2]*e[1]},equals:function(e,n){var t=e[0],r=e[1],i=e[2],o=e[3],a=n[0],s=n[1],u=n[2],c=n[3];return Math.abs(t-a)<=kt*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(r-s)<=kt*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=kt*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=kt*Math.max(1,Math.abs(o),Math.abs(c))},exactEquals:function(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]},frob:function(e){return Math.hypot(e[0],e[1],e[2],e[3])},fromRotation:function(e,n){var t=Math.sin(n),r=Math.cos(n);return e[0]=r,e[1]=t,e[2]=-t,e[3]=r,e},fromScaling:function(e,n){return e[0]=n[0],e[1]=0,e[2]=0,e[3]=n[1],e},fromValues:function(e,n,t,r){var i=new en(4);return i[0]=e,i[1]=n,i[2]=t,i[3]=r,i},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},invert:function(e,n){var t=n[0],r=n[1],i=n[2],o=n[3],a=t*o-i*r;return a?(a=1/a,e[0]=o*a,e[1]=-r*a,e[2]=-i*a,e[3]=t*a,e):null},mul:ZP,multiply:Fw,multiplyScalar:function(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e[3]=n[3]*t,e},multiplyScalarAndAdd:function(e,n,t,r){return e[0]=n[0]+t[0]*r,e[1]=n[1]+t[1]*r,e[2]=n[2]+t[2]*r,e[3]=n[3]+t[3]*r,e},rotate:function(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3],s=Math.sin(t),u=Math.cos(t);return e[0]=r*u+o*s,e[1]=i*u+a*s,e[2]=r*-s+o*u,e[3]=i*-s+a*u,e},scale:function(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3],s=t[0],u=t[1];return e[0]=r*s,e[1]=i*s,e[2]=o*u,e[3]=a*u,e},set:function(e,n,t,r,i){return e[0]=n,e[1]=t,e[2]=r,e[3]=i,e},str:function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},sub:KP,subtract:Gw,transpose:function(e,n){if(e===n){var t=n[1];e[1]=n[2],e[2]=t}else e[0]=n[0],e[1]=n[2],e[2]=n[1],e[3]=n[3];return e}},Symbol.toStringTag,{value:"Module"}));function Uw(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=t[0],l=t[1],h=t[2],f=t[3],d=t[4],p=t[5];return e[0]=r*c+o*l,e[1]=i*c+a*l,e[2]=r*h+o*f,e[3]=i*h+a*f,e[4]=r*d+o*p+s,e[5]=i*d+a*p+u,e}function Xw(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e[3]=n[3]-t[3],e[4]=n[4]-t[4],e[5]=n[5]-t[5],e}var QP=Uw,JP=Xw;const eL=Object.freeze(Object.defineProperty({__proto__:null,add:function(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e[3]=n[3]+t[3],e[4]=n[4]+t[4],e[5]=n[5]+t[5],e},clone:function(e){var n=new en(6);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n},copy:function(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e},create:function(){var e=new en(6);return en!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e},determinant:function(e){return e[0]*e[3]-e[1]*e[2]},equals:function(e,n){var t=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=n[0],c=n[1],l=n[2],h=n[3],f=n[4],d=n[5];return Math.abs(t-u)<=kt*Math.max(1,Math.abs(t),Math.abs(u))&&Math.abs(r-c)<=kt*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-l)<=kt*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-h)<=kt*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(a-f)<=kt*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(s-d)<=kt*Math.max(1,Math.abs(s),Math.abs(d))},exactEquals:function(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]&&e[4]===n[4]&&e[5]===n[5]},frob:function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)},fromRotation:function(e,n){var t=Math.sin(n),r=Math.cos(n);return e[0]=r,e[1]=t,e[2]=-t,e[3]=r,e[4]=0,e[5]=0,e},fromScaling:function(e,n){return e[0]=n[0],e[1]=0,e[2]=0,e[3]=n[1],e[4]=0,e[5]=0,e},fromTranslation:function(e,n){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=n[0],e[5]=n[1],e},fromValues:function(e,n,t,r,i,o){var a=new en(6);return a[0]=e,a[1]=n,a[2]=t,a[3]=r,a[4]=i,a[5]=o,a},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},invert:function(e,n){var t=n[0],r=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=t*o-r*i;return u?(u=1/u,e[0]=o*u,e[1]=-r*u,e[2]=-i*u,e[3]=t*u,e[4]=(i*s-o*a)*u,e[5]=(r*a-t*s)*u,e):null},mul:QP,multiply:Uw,multiplyScalar:function(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e[3]=n[3]*t,e[4]=n[4]*t,e[5]=n[5]*t,e},multiplyScalarAndAdd:function(e,n,t,r){return e[0]=n[0]+t[0]*r,e[1]=n[1]+t[1]*r,e[2]=n[2]+t[2]*r,e[3]=n[3]+t[3]*r,e[4]=n[4]+t[4]*r,e[5]=n[5]+t[5]*r,e},rotate:function(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=Math.sin(t),l=Math.cos(t);return e[0]=r*l+o*c,e[1]=i*l+a*c,e[2]=r*-c+o*l,e[3]=i*-c+a*l,e[4]=s,e[5]=u,e},scale:function(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=t[0],l=t[1];return e[0]=r*c,e[1]=i*c,e[2]=o*l,e[3]=a*l,e[4]=s,e[5]=u,e},set:function(e,n,t,r,i,o,a){return e[0]=n,e[1]=t,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e},str:function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},sub:JP,subtract:Xw,translate:function(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=t[0],l=t[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=r*c+o*l+s,e[5]=i*c+a*l+u,e}},Symbol.toStringTag,{value:"Module"}));function Yw(){var e=new en(9);return en!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function r0(e,n){var t=n[0],r=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=n[6],c=n[7],l=n[8],h=l*a-s*c,f=-l*o+s*u,d=c*o-a*u,p=t*h+r*f+i*d;return p?(p=1/p,e[0]=h*p,e[1]=(-l*r+i*c)*p,e[2]=(s*r-i*a)*p,e[3]=f*p,e[4]=(l*t-i*u)*p,e[5]=(-s*t+i*o)*p,e[6]=d*p,e[7]=(-c*t+r*u)*p,e[8]=(a*t-r*o)*p,e):null}function Xi(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=n[8],f=t[0],d=t[1],p=t[2],g=t[3],v=t[4],m=t[5],y=t[6],b=t[7],x=t[8];return e[0]=f*r+d*a+p*c,e[1]=f*i+d*s+p*l,e[2]=f*o+d*u+p*h,e[3]=g*r+v*a+m*c,e[4]=g*i+v*s+m*l,e[5]=g*o+v*u+m*h,e[6]=y*r+b*a+x*c,e[7]=y*i+b*s+x*l,e[8]=y*o+b*u+x*h,e}function i0(e,n){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=n[0],e[7]=n[1],e[8]=1,e}function o0(e,n){var t=Math.sin(n),r=Math.cos(n);return e[0]=r,e[1]=t,e[2]=0,e[3]=-t,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function a0(e,n){return e[0]=n[0],e[1]=0,e[2]=0,e[3]=0,e[4]=n[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ww(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e[3]=n[3]-t[3],e[4]=n[4]-t[4],e[5]=n[5]-t[5],e[6]=n[6]-t[6],e[7]=n[7]-t[7],e[8]=n[8]-t[8],e}var tL=Xi,nL=Ww;const Vw=Object.freeze(Object.defineProperty({__proto__:null,add:function(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e[3]=n[3]+t[3],e[4]=n[4]+t[4],e[5]=n[5]+t[5],e[6]=n[6]+t[6],e[7]=n[7]+t[7],e[8]=n[8]+t[8],e},adjoint:function(e,n){var t=n[0],r=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=n[6],c=n[7],l=n[8];return e[0]=a*l-s*c,e[1]=i*c-r*l,e[2]=r*s-i*a,e[3]=s*u-o*l,e[4]=t*l-i*u,e[5]=i*o-t*s,e[6]=o*c-a*u,e[7]=r*u-t*c,e[8]=t*a-r*o,e},clone:function(e){var n=new en(9);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n},copy:function(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e},create:Yw,determinant:function(e){var n=e[0],t=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8];return n*(c*o-a*u)+t*(-c*i+a*s)+r*(u*i-o*s)},equals:function(e,n){var t=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=n[0],f=n[1],d=n[2],p=n[3],g=n[4],v=n[5],m=n[6],y=n[7],b=n[8];return Math.abs(t-h)<=kt*Math.max(1,Math.abs(t),Math.abs(h))&&Math.abs(r-f)<=kt*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-d)<=kt*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-p)<=kt*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-g)<=kt*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(s-v)<=kt*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-m)<=kt*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(c-y)<=kt*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(l-b)<=kt*Math.max(1,Math.abs(l),Math.abs(b))},exactEquals:function(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]&&e[4]===n[4]&&e[5]===n[5]&&e[6]===n[6]&&e[7]===n[7]&&e[8]===n[8]},frob:function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},fromMat2d:function(e,n){return e[0]=n[0],e[1]=n[1],e[2]=0,e[3]=n[2],e[4]=n[3],e[5]=0,e[6]=n[4],e[7]=n[5],e[8]=1,e},fromMat4:function(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[4],e[4]=n[5],e[5]=n[6],e[6]=n[8],e[7]=n[9],e[8]=n[10],e},fromQuat:function(e,n){var t=n[0],r=n[1],i=n[2],o=n[3],a=t+t,s=r+r,u=i+i,c=t*a,l=r*a,h=r*s,f=i*a,d=i*s,p=i*u,g=o*a,v=o*s,m=o*u;return e[0]=1-h-p,e[3]=l-m,e[6]=f+v,e[1]=l+m,e[4]=1-c-p,e[7]=d-g,e[2]=f-v,e[5]=d+g,e[8]=1-c-h,e},fromRotation:o0,fromScaling:a0,fromTranslation:i0,fromValues:function(e,n,t,r,i,o,a,s,u){var c=new en(9);return c[0]=e,c[1]=n,c[2]=t,c[3]=r,c[4]=i,c[5]=o,c[6]=a,c[7]=s,c[8]=u,c},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},invert:r0,mul:tL,multiply:Xi,multiplyScalar:function(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e[3]=n[3]*t,e[4]=n[4]*t,e[5]=n[5]*t,e[6]=n[6]*t,e[7]=n[7]*t,e[8]=n[8]*t,e},multiplyScalarAndAdd:function(e,n,t,r){return e[0]=n[0]+t[0]*r,e[1]=n[1]+t[1]*r,e[2]=n[2]+t[2]*r,e[3]=n[3]+t[3]*r,e[4]=n[4]+t[4]*r,e[5]=n[5]+t[5]*r,e[6]=n[6]+t[6]*r,e[7]=n[7]+t[7]*r,e[8]=n[8]+t[8]*r,e},normalFromMat4:function(e,n){var t=n[0],r=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=n[6],c=n[7],l=n[8],h=n[9],f=n[10],d=n[11],p=n[12],g=n[13],v=n[14],m=n[15],y=t*s-r*a,b=t*u-i*a,x=t*c-o*a,w=r*u-i*s,E=r*c-o*s,M=i*c-o*u,_=l*g-h*p,k=l*v-f*p,S=l*m-d*p,C=h*v-f*g,T=h*m-d*g,A=f*m-d*v,D=y*A-b*T+x*C+w*S-E*k+M*_;return D?(D=1/D,e[0]=(s*A-u*T+c*C)*D,e[1]=(u*S-a*A-c*k)*D,e[2]=(a*T-s*S+c*_)*D,e[3]=(i*T-r*A-o*C)*D,e[4]=(t*A-i*S+o*k)*D,e[5]=(r*S-t*T-o*_)*D,e[6]=(g*M-v*E+m*w)*D,e[7]=(v*x-p*M-m*b)*D,e[8]=(p*E-g*x+m*y)*D,e):null},projection:function(e,n,t){return e[0]=2/n,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/t,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},rotate:function(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=n[8],f=Math.sin(t),d=Math.cos(t);return e[0]=d*r+f*a,e[1]=d*i+f*s,e[2]=d*o+f*u,e[3]=d*a-f*r,e[4]=d*s-f*i,e[5]=d*u-f*o,e[6]=c,e[7]=l,e[8]=h,e},scale:function(e,n,t){var r=t[0],i=t[1];return e[0]=r*n[0],e[1]=r*n[1],e[2]=r*n[2],e[3]=i*n[3],e[4]=i*n[4],e[5]=i*n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e},set:function(e,n,t,r,i,o,a,s,u,c){return e[0]=n,e[1]=t,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e[8]=c,e},str:function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},sub:nL,subtract:Ww,translate:function(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=n[8],f=t[0],d=t[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=f*r+d*a+c,e[7]=f*i+d*s+l,e[8]=f*o+d*u+h,e},transpose:function(e,n){if(e===n){var t=n[1],r=n[2],i=n[5];e[1]=n[3],e[2]=n[6],e[3]=t,e[5]=n[7],e[6]=r,e[7]=i}else e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8];return e}},Symbol.toStringTag,{value:"Module"}));function Hw(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function qw(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=n[8],f=n[9],d=n[10],p=n[11],g=n[12],v=n[13],m=n[14],y=n[15],b=t[0],x=t[1],w=t[2],E=t[3];return e[0]=b*r+x*s+w*h+E*g,e[1]=b*i+x*u+w*f+E*v,e[2]=b*o+x*c+w*d+E*m,e[3]=b*a+x*l+w*p+E*y,b=t[4],x=t[5],w=t[6],E=t[7],e[4]=b*r+x*s+w*h+E*g,e[5]=b*i+x*u+w*f+E*v,e[6]=b*o+x*c+w*d+E*m,e[7]=b*a+x*l+w*p+E*y,b=t[8],x=t[9],w=t[10],E=t[11],e[8]=b*r+x*s+w*h+E*g,e[9]=b*i+x*u+w*f+E*v,e[10]=b*o+x*c+w*d+E*m,e[11]=b*a+x*l+w*p+E*y,b=t[12],x=t[13],w=t[14],E=t[15],e[12]=b*r+x*s+w*h+E*g,e[13]=b*i+x*u+w*f+E*v,e[14]=b*o+x*c+w*d+E*m,e[15]=b*a+x*l+w*p+E*y,e}function Zw(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3],s=r+r,u=i+i,c=o+o,l=r*s,h=r*u,f=r*c,d=i*u,p=i*c,g=o*c,v=a*s,m=a*u,y=a*c;return e[0]=1-(d+g),e[1]=h+y,e[2]=f-m,e[3]=0,e[4]=h-y,e[5]=1-(l+g),e[6]=p+v,e[7]=0,e[8]=f+m,e[9]=p-v,e[10]=1-(l+d),e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Kw(e,n){return e[0]=n[12],e[1]=n[13],e[2]=n[14],e}function $w(e,n){var t=n[0],r=n[1],i=n[2],o=n[4],a=n[5],s=n[6],u=n[8],c=n[9],l=n[10];return e[0]=Math.hypot(t,r,i),e[1]=Math.hypot(o,a,s),e[2]=Math.hypot(u,c,l),e}function Qw(e,n){var t=new en(3);$w(t,n);var r=1/t[0],i=1/t[1],o=1/t[2],a=n[0]*r,s=n[1]*i,u=n[2]*o,c=n[4]*r,l=n[5]*i,h=n[6]*o,f=n[8]*r,d=n[9]*i,p=n[10]*o,g=a+l+p,v=0;return g>0?(v=2*Math.sqrt(g+1),e[3]=.25*v,e[0]=(h-d)/v,e[1]=(f-u)/v,e[2]=(s-c)/v):a>l&&a>p?(v=2*Math.sqrt(1+a-l-p),e[3]=(h-d)/v,e[0]=.25*v,e[1]=(s+c)/v,e[2]=(f+u)/v):l>p?(v=2*Math.sqrt(1+l-a-p),e[3]=(f-u)/v,e[0]=(s+c)/v,e[1]=.25*v,e[2]=(h+d)/v):(v=2*Math.sqrt(1+p-a-l),e[3]=(s-c)/v,e[0]=(f+u)/v,e[1]=(h+d)/v,e[2]=.25*v),e}function Jw(e,n,t,r,i){var o,a=1/Math.tan(n/2);return e[0]=a/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0?(o=1/(r-i),e[10]=(i+r)*o,e[14]=2*i*r*o):(e[10]=-1,e[14]=-2*r),e}var rL=Jw;function e2(e,n,t,r,i,o,a){var s=1/(n-t),u=1/(r-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(n+t)*s,e[13]=(i+r)*u,e[14]=(a+o)*c,e[15]=1,e}var iL=e2;function t2(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e[3]=n[3]-t[3],e[4]=n[4]-t[4],e[5]=n[5]-t[5],e[6]=n[6]-t[6],e[7]=n[7]-t[7],e[8]=n[8]-t[8],e[9]=n[9]-t[9],e[10]=n[10]-t[10],e[11]=n[11]-t[11],e[12]=n[12]-t[12],e[13]=n[13]-t[13],e[14]=n[14]-t[14],e[15]=n[15]-t[15],e}var oL=qw,aL=t2;const sL=Object.freeze(Object.defineProperty({__proto__:null,add:function(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e[3]=n[3]+t[3],e[4]=n[4]+t[4],e[5]=n[5]+t[5],e[6]=n[6]+t[6],e[7]=n[7]+t[7],e[8]=n[8]+t[8],e[9]=n[9]+t[9],e[10]=n[10]+t[10],e[11]=n[11]+t[11],e[12]=n[12]+t[12],e[13]=n[13]+t[13],e[14]=n[14]+t[14],e[15]=n[15]+t[15],e},adjoint:function(e,n){var t=n[0],r=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=n[6],c=n[7],l=n[8],h=n[9],f=n[10],d=n[11],p=n[12],g=n[13],v=n[14],m=n[15];return e[0]=s*(f*m-d*v)-h*(u*m-c*v)+g*(u*d-c*f),e[1]=-(r*(f*m-d*v)-h*(i*m-o*v)+g*(i*d-o*f)),e[2]=r*(u*m-c*v)-s*(i*m-o*v)+g*(i*c-o*u),e[3]=-(r*(u*d-c*f)-s*(i*d-o*f)+h*(i*c-o*u)),e[4]=-(a*(f*m-d*v)-l*(u*m-c*v)+p*(u*d-c*f)),e[5]=t*(f*m-d*v)-l*(i*m-o*v)+p*(i*d-o*f),e[6]=-(t*(u*m-c*v)-a*(i*m-o*v)+p*(i*c-o*u)),e[7]=t*(u*d-c*f)-a*(i*d-o*f)+l*(i*c-o*u),e[8]=a*(h*m-d*g)-l*(s*m-c*g)+p*(s*d-c*h),e[9]=-(t*(h*m-d*g)-l*(r*m-o*g)+p*(r*d-o*h)),e[10]=t*(s*m-c*g)-a*(r*m-o*g)+p*(r*c-o*s),e[11]=-(t*(s*d-c*h)-a*(r*d-o*h)+l*(r*c-o*s)),e[12]=-(a*(h*v-f*g)-l*(s*v-u*g)+p*(s*f-u*h)),e[13]=t*(h*v-f*g)-l*(r*v-i*g)+p*(r*f-i*h),e[14]=-(t*(s*v-u*g)-a*(r*v-i*g)+p*(r*u-i*s)),e[15]=t*(s*f-u*h)-a*(r*f-i*h)+l*(r*u-i*s),e},clone:function(e){var n=new en(16);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},copy:function(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},create:function(){var e=new en(16);return en!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},determinant:function(e){var n=e[0],t=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],h=e[10],f=e[11],d=e[12],p=e[13],g=e[14],v=e[15];return(n*a-t*o)*(h*v-f*g)-(n*s-r*o)*(l*v-f*p)+(n*u-i*o)*(l*g-h*p)+(t*s-r*a)*(c*v-f*d)-(t*u-i*a)*(c*g-h*d)+(r*u-i*s)*(c*p-l*d)},equals:function(e,n){var t=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],p=e[12],g=e[13],v=e[14],m=e[15],y=n[0],b=n[1],x=n[2],w=n[3],E=n[4],M=n[5],_=n[6],k=n[7],S=n[8],C=n[9],T=n[10],A=n[11],D=n[12],j=n[13],L=n[14],B=n[15];return Math.abs(t-y)<=kt*Math.max(1,Math.abs(t),Math.abs(y))&&Math.abs(r-b)<=kt*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-x)<=kt*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-w)<=kt*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(a-E)<=kt*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(s-M)<=kt*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-_)<=kt*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(c-k)<=kt*Math.max(1,Math.abs(c),Math.abs(k))&&Math.abs(l-S)<=kt*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(h-C)<=kt*Math.max(1,Math.abs(h),Math.abs(C))&&Math.abs(f-T)<=kt*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(d-A)<=kt*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(p-D)<=kt*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(g-j)<=kt*Math.max(1,Math.abs(g),Math.abs(j))&&Math.abs(v-L)<=kt*Math.max(1,Math.abs(v),Math.abs(L))&&Math.abs(m-B)<=kt*Math.max(1,Math.abs(m),Math.abs(B))},exactEquals:function(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]&&e[4]===n[4]&&e[5]===n[5]&&e[6]===n[6]&&e[7]===n[7]&&e[8]===n[8]&&e[9]===n[9]&&e[10]===n[10]&&e[11]===n[11]&&e[12]===n[12]&&e[13]===n[13]&&e[14]===n[14]&&e[15]===n[15]},frob:function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},fromQuat:function(e,n){var t=n[0],r=n[1],i=n[2],o=n[3],a=t+t,s=r+r,u=i+i,c=t*a,l=r*a,h=r*s,f=i*a,d=i*s,p=i*u,g=o*a,v=o*s,m=o*u;return e[0]=1-h-p,e[1]=l+m,e[2]=f-v,e[3]=0,e[4]=l-m,e[5]=1-c-p,e[6]=d+g,e[7]=0,e[8]=f+v,e[9]=d-g,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromQuat2:function(e,n){var t=new en(3),r=-n[0],i=-n[1],o=-n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=r*r+i*i+o*o+a*a;return h>0?(t[0]=2*(s*a+l*r+u*o-c*i)/h,t[1]=2*(u*a+l*i+c*r-s*o)/h,t[2]=2*(c*a+l*o+s*i-u*r)/h):(t[0]=2*(s*a+l*r+u*o-c*i),t[1]=2*(u*a+l*i+c*r-s*o),t[2]=2*(c*a+l*o+s*i-u*r)),Zw(e,n,t),e},fromRotation:function(e,n,t){var r,i,o,a=t[0],s=t[1],u=t[2],c=Math.hypot(a,s,u);return c<kt?null:(a*=c=1/c,s*=c,u*=c,r=Math.sin(n),o=1-(i=Math.cos(n)),e[0]=a*a*o+i,e[1]=s*a*o+u*r,e[2]=u*a*o-s*r,e[3]=0,e[4]=a*s*o-u*r,e[5]=s*s*o+i,e[6]=u*s*o+a*r,e[7]=0,e[8]=a*u*o+s*r,e[9]=s*u*o-a*r,e[10]=u*u*o+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},fromRotationTranslation:Zw,fromRotationTranslationScale:function(e,n,t,r){var i=n[0],o=n[1],a=n[2],s=n[3],u=i+i,c=o+o,l=a+a,h=i*u,f=i*c,d=i*l,p=o*c,g=o*l,v=a*l,m=s*u,y=s*c,b=s*l,x=r[0],w=r[1],E=r[2];return e[0]=(1-(p+v))*x,e[1]=(f+b)*x,e[2]=(d-y)*x,e[3]=0,e[4]=(f-b)*w,e[5]=(1-(h+v))*w,e[6]=(g+m)*w,e[7]=0,e[8]=(d+y)*E,e[9]=(g-m)*E,e[10]=(1-(h+p))*E,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},fromRotationTranslationScaleOrigin:function(e,n,t,r,i){var o=n[0],a=n[1],s=n[2],u=n[3],c=o+o,l=a+a,h=s+s,f=o*c,d=o*l,p=o*h,g=a*l,v=a*h,m=s*h,y=u*c,b=u*l,x=u*h,w=r[0],E=r[1],M=r[2],_=i[0],k=i[1],S=i[2],C=(1-(g+m))*w,T=(d+x)*w,A=(p-b)*w,D=(d-x)*E,j=(1-(f+m))*E,L=(v+y)*E,B=(p+b)*M,N=(v-y)*M,R=(1-(f+g))*M;return e[0]=C,e[1]=T,e[2]=A,e[3]=0,e[4]=D,e[5]=j,e[6]=L,e[7]=0,e[8]=B,e[9]=N,e[10]=R,e[11]=0,e[12]=t[0]+_-(C*_+D*k+B*S),e[13]=t[1]+k-(T*_+j*k+N*S),e[14]=t[2]+S-(A*_+L*k+R*S),e[15]=1,e},fromScaling:function(e,n){return e[0]=n[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=n[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromTranslation:function(e,n){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},fromValues:function(e,n,t,r,i,o,a,s,u,c,l,h,f,d,p,g){var v=new en(16);return v[0]=e,v[1]=n,v[2]=t,v[3]=r,v[4]=i,v[5]=o,v[6]=a,v[7]=s,v[8]=u,v[9]=c,v[10]=l,v[11]=h,v[12]=f,v[13]=d,v[14]=p,v[15]=g,v},fromXRotation:function(e,n){var t=Math.sin(n),r=Math.cos(n);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=t,e[7]=0,e[8]=0,e[9]=-t,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromYRotation:function(e,n){var t=Math.sin(n),r=Math.cos(n);return e[0]=r,e[1]=0,e[2]=-t,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=t,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromZRotation:function(e,n){var t=Math.sin(n),r=Math.cos(n);return e[0]=r,e[1]=t,e[2]=0,e[3]=0,e[4]=-t,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},frustum:function(e,n,t,r,i,o,a){var s=1/(t-n),u=1/(i-r),c=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(t+n)*s,e[9]=(i+r)*u,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0,e},getRotation:Qw,getScaling:$w,getTranslation:Kw,identity:Hw,invert:function(e,n){var t=n[0],r=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=n[6],c=n[7],l=n[8],h=n[9],f=n[10],d=n[11],p=n[12],g=n[13],v=n[14],m=n[15],y=t*s-r*a,b=t*u-i*a,x=t*c-o*a,w=r*u-i*s,E=r*c-o*s,M=i*c-o*u,_=l*g-h*p,k=l*v-f*p,S=l*m-d*p,C=h*v-f*g,T=h*m-d*g,A=f*m-d*v,D=y*A-b*T+x*C+w*S-E*k+M*_;return D?(D=1/D,e[0]=(s*A-u*T+c*C)*D,e[1]=(i*T-r*A-o*C)*D,e[2]=(g*M-v*E+m*w)*D,e[3]=(f*E-h*M-d*w)*D,e[4]=(u*S-a*A-c*k)*D,e[5]=(t*A-i*S+o*k)*D,e[6]=(v*x-p*M-m*b)*D,e[7]=(l*M-f*x+d*b)*D,e[8]=(a*T-s*S+c*_)*D,e[9]=(r*S-t*T-o*_)*D,e[10]=(p*E-g*x+m*y)*D,e[11]=(h*x-l*E-d*y)*D,e[12]=(s*k-a*C-u*_)*D,e[13]=(t*C-r*k+i*_)*D,e[14]=(g*b-p*w-v*y)*D,e[15]=(l*w-h*b+f*y)*D,e):null},lookAt:function(e,n,t,r){var i,o,a,s,u,c,l,h,f,d,p=n[0],g=n[1],v=n[2],m=r[0],y=r[1],b=r[2],x=t[0],w=t[1],E=t[2];return Math.abs(p-x)<kt&&Math.abs(g-w)<kt&&Math.abs(v-E)<kt?Hw(e):(l=p-x,h=g-w,f=v-E,i=y*(f*=d=1/Math.hypot(l,h,f))-b*(h*=d),o=b*(l*=d)-m*f,a=m*h-y*l,(d=Math.hypot(i,o,a))?(i*=d=1/d,o*=d,a*=d):(i=0,o=0,a=0),s=h*a-f*o,u=f*i-l*a,c=l*o-h*i,(d=Math.hypot(s,u,c))?(s*=d=1/d,u*=d,c*=d):(s=0,u=0,c=0),e[0]=i,e[1]=s,e[2]=l,e[3]=0,e[4]=o,e[5]=u,e[6]=h,e[7]=0,e[8]=a,e[9]=c,e[10]=f,e[11]=0,e[12]=-(i*p+o*g+a*v),e[13]=-(s*p+u*g+c*v),e[14]=-(l*p+h*g+f*v),e[15]=1,e)},mul:oL,multiply:qw,multiplyScalar:function(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e[3]=n[3]*t,e[4]=n[4]*t,e[5]=n[5]*t,e[6]=n[6]*t,e[7]=n[7]*t,e[8]=n[8]*t,e[9]=n[9]*t,e[10]=n[10]*t,e[11]=n[11]*t,e[12]=n[12]*t,e[13]=n[13]*t,e[14]=n[14]*t,e[15]=n[15]*t,e},multiplyScalarAndAdd:function(e,n,t,r){return e[0]=n[0]+t[0]*r,e[1]=n[1]+t[1]*r,e[2]=n[2]+t[2]*r,e[3]=n[3]+t[3]*r,e[4]=n[4]+t[4]*r,e[5]=n[5]+t[5]*r,e[6]=n[6]+t[6]*r,e[7]=n[7]+t[7]*r,e[8]=n[8]+t[8]*r,e[9]=n[9]+t[9]*r,e[10]=n[10]+t[10]*r,e[11]=n[11]+t[11]*r,e[12]=n[12]+t[12]*r,e[13]=n[13]+t[13]*r,e[14]=n[14]+t[14]*r,e[15]=n[15]+t[15]*r,e},ortho:iL,orthoNO:e2,orthoZO:function(e,n,t,r,i,o,a){var s=1/(n-t),u=1/(r-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=c,e[11]=0,e[12]=(n+t)*s,e[13]=(i+r)*u,e[14]=o*c,e[15]=1,e},perspective:rL,perspectiveFromFieldOfView:function(e,n,t,r){var i=Math.tan(n.upDegrees*Math.PI/180),o=Math.tan(n.downDegrees*Math.PI/180),a=Math.tan(n.leftDegrees*Math.PI/180),s=Math.tan(n.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(a-s)*u*.5,e[9]=(i-o)*c*.5,e[10]=r/(t-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*t/(t-r),e[15]=0,e},perspectiveNO:Jw,perspectiveZO:function(e,n,t,r,i){var o,a=1/Math.tan(n/2);return e[0]=a/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0?(o=1/(r-i),e[10]=i*o,e[14]=i*r*o):(e[10]=-1,e[14]=-r),e},rotate:function(e,n,t,r){var i,o,a,s,u,c,l,h,f,d,p,g,v,m,y,b,x,w,E,M,_,k,S,C,T=r[0],A=r[1],D=r[2],j=Math.hypot(T,A,D);return j<kt?null:(T*=j=1/j,A*=j,D*=j,i=Math.sin(t),a=1-(o=Math.cos(t)),s=n[0],u=n[1],c=n[2],l=n[3],h=n[4],f=n[5],d=n[6],p=n[7],g=n[8],v=n[9],m=n[10],y=n[11],b=T*T*a+o,x=A*T*a+D*i,w=D*T*a-A*i,E=T*A*a-D*i,M=A*A*a+o,_=D*A*a+T*i,k=T*D*a+A*i,S=A*D*a-T*i,C=D*D*a+o,e[0]=s*b+h*x+g*w,e[1]=u*b+f*x+v*w,e[2]=c*b+d*x+m*w,e[3]=l*b+p*x+y*w,e[4]=s*E+h*M+g*_,e[5]=u*E+f*M+v*_,e[6]=c*E+d*M+m*_,e[7]=l*E+p*M+y*_,e[8]=s*k+h*S+g*C,e[9]=u*k+f*S+v*C,e[10]=c*k+d*S+m*C,e[11]=l*k+p*S+y*C,n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e)},rotateX:function(e,n,t){var r=Math.sin(t),i=Math.cos(t),o=n[4],a=n[5],s=n[6],u=n[7],c=n[8],l=n[9],h=n[10],f=n[11];return n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[4]=o*i+c*r,e[5]=a*i+l*r,e[6]=s*i+h*r,e[7]=u*i+f*r,e[8]=c*i-o*r,e[9]=l*i-a*r,e[10]=h*i-s*r,e[11]=f*i-u*r,e},rotateY:function(e,n,t){var r=Math.sin(t),i=Math.cos(t),o=n[0],a=n[1],s=n[2],u=n[3],c=n[8],l=n[9],h=n[10],f=n[11];return n!==e&&(e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=o*i-c*r,e[1]=a*i-l*r,e[2]=s*i-h*r,e[3]=u*i-f*r,e[8]=o*r+c*i,e[9]=a*r+l*i,e[10]=s*r+h*i,e[11]=u*r+f*i,e},rotateZ:function(e,n,t){var r=Math.sin(t),i=Math.cos(t),o=n[0],a=n[1],s=n[2],u=n[3],c=n[4],l=n[5],h=n[6],f=n[7];return n!==e&&(e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=o*i+c*r,e[1]=a*i+l*r,e[2]=s*i+h*r,e[3]=u*i+f*r,e[4]=c*i-o*r,e[5]=l*i-a*r,e[6]=h*i-s*r,e[7]=f*i-u*r,e},scale:function(e,n,t){var r=t[0],i=t[1],o=t[2];return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=n[3]*r,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=n[7]*i,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=n[11]*o,e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},set:function(e,n,t,r,i,o,a,s,u,c,l,h,f,d,p,g,v){return e[0]=n,e[1]=t,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e[8]=c,e[9]=l,e[10]=h,e[11]=f,e[12]=d,e[13]=p,e[14]=g,e[15]=v,e},str:function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},sub:aL,subtract:t2,targetTo:function(e,n,t,r){var i=n[0],o=n[1],a=n[2],s=r[0],u=r[1],c=r[2],l=i-t[0],h=o-t[1],f=a-t[2],d=l*l+h*h+f*f;d>0&&(l*=d=1/Math.sqrt(d),h*=d,f*=d);var p=u*f-c*h,g=c*l-s*f,v=s*h-u*l;return(d=p*p+g*g+v*v)>0&&(p*=d=1/Math.sqrt(d),g*=d,v*=d),e[0]=p,e[1]=g,e[2]=v,e[3]=0,e[4]=h*v-f*g,e[5]=f*p-l*v,e[6]=l*g-h*p,e[7]=0,e[8]=l,e[9]=h,e[10]=f,e[11]=0,e[12]=i,e[13]=o,e[14]=a,e[15]=1,e},translate:function(e,n,t){var r,i,o,a,s,u,c,l,h,f,d,p,g=t[0],v=t[1],m=t[2];return n===e?(e[12]=n[0]*g+n[4]*v+n[8]*m+n[12],e[13]=n[1]*g+n[5]*v+n[9]*m+n[13],e[14]=n[2]*g+n[6]*v+n[10]*m+n[14],e[15]=n[3]*g+n[7]*v+n[11]*m+n[15]):(r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=n[8],f=n[9],d=n[10],p=n[11],e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=c,e[7]=l,e[8]=h,e[9]=f,e[10]=d,e[11]=p,e[12]=r*g+s*v+h*m+n[12],e[13]=i*g+u*v+f*m+n[13],e[14]=o*g+c*v+d*m+n[14],e[15]=a*g+l*v+p*m+n[15]),e},transpose:function(e,n){if(e===n){var t=n[1],r=n[2],i=n[3],o=n[6],a=n[7],s=n[11];e[1]=n[4],e[2]=n[8],e[3]=n[12],e[4]=t,e[6]=n[9],e[7]=n[13],e[8]=r,e[9]=o,e[11]=n[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=n[0],e[1]=n[4],e[2]=n[8],e[3]=n[12],e[4]=n[1],e[5]=n[5],e[6]=n[9],e[7]=n[13],e[8]=n[2],e[9]=n[6],e[10]=n[10],e[11]=n[14],e[12]=n[3],e[13]=n[7],e[14]=n[11],e[15]=n[15];return e}},Symbol.toStringTag,{value:"Module"}));function s0(){var e=new en(3);return en!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function n2(e){var n=e[0],t=e[1],r=e[2];return Math.hypot(n,t,r)}function u0(e,n,t){var r=new en(3);return r[0]=e,r[1]=n,r[2]=t,r}function r2(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e}function i2(e,n,t){return e[0]=n[0]*t[0],e[1]=n[1]*t[1],e[2]=n[2]*t[2],e}function o2(e,n,t){return e[0]=n[0]/t[0],e[1]=n[1]/t[1],e[2]=n[2]/t[2],e}function a2(e,n){var t=n[0]-e[0],r=n[1]-e[1],i=n[2]-e[2];return Math.hypot(t,r,i)}function s2(e,n){var t=n[0]-e[0],r=n[1]-e[1],i=n[2]-e[2];return t*t+r*r+i*i}function u2(e){var n=e[0],t=e[1],r=e[2];return n*n+t*t+r*r}function c2(e,n){var t=n[0],r=n[1],i=n[2],o=t*t+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=n[0]*o,e[1]=n[1]*o,e[2]=n[2]*o,e}function c0(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}function Wh(e,n,t){var r=n[0],i=n[1],o=n[2],a=t[0],s=t[1],u=t[2];return e[0]=i*u-o*s,e[1]=o*a-r*u,e[2]=r*s-i*a,e}function Vh(e,n,t){var r=n[0],i=n[1],o=n[2];return e[0]=r*t[0]+i*t[3]+o*t[6],e[1]=r*t[1]+i*t[4]+o*t[7],e[2]=r*t[2]+i*t[5]+o*t[8],e}var po,uL=r2,cL=i2,lL=o2,hL=a2,fL=s2,l2=n2,dL=u2,pL=(po=s0(),function(e,n,t,r,i,o){var a,s;for(n||(n=3),t||(t=0),s=r?Math.min(r*n+t,e.length):e.length,a=t;a<s;a+=n)po[0]=e[a],po[1]=e[a+1],po[2]=e[a+2],i(po,po,o),e[a]=po[0],e[a+1]=po[1],e[a+2]=po[2];return e});const gL=Object.freeze(Object.defineProperty({__proto__:null,add:function(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e},angle:function(e,n){var t=e[0],r=e[1],i=e[2],o=n[0],a=n[1],s=n[2],u=Math.sqrt(t*t+r*r+i*i)*Math.sqrt(o*o+a*a+s*s),c=u&&c0(e,n)/u;return Math.acos(Math.min(Math.max(c,-1),1))},bezier:function(e,n,t,r,i,o){var a=1-o,s=a*a,u=o*o,c=s*a,l=3*o*s,h=3*u*a,f=u*o;return e[0]=n[0]*c+t[0]*l+r[0]*h+i[0]*f,e[1]=n[1]*c+t[1]*l+r[1]*h+i[1]*f,e[2]=n[2]*c+t[2]*l+r[2]*h+i[2]*f,e},ceil:function(e,n){return e[0]=Math.ceil(n[0]),e[1]=Math.ceil(n[1]),e[2]=Math.ceil(n[2]),e},clone:function(e){var n=new en(3);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n},copy:function(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e},create:s0,cross:Wh,dist:hL,distance:a2,div:lL,divide:o2,dot:c0,equals:function(e,n){var t=e[0],r=e[1],i=e[2],o=n[0],a=n[1],s=n[2];return Math.abs(t-o)<=kt*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(r-a)<=kt*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-s)<=kt*Math.max(1,Math.abs(i),Math.abs(s))},exactEquals:function(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]},floor:function(e,n){return e[0]=Math.floor(n[0]),e[1]=Math.floor(n[1]),e[2]=Math.floor(n[2]),e},forEach:pL,fromValues:u0,hermite:function(e,n,t,r,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),l=a*(3-2*o);return e[0]=n[0]*s+t[0]*u+r[0]*c+i[0]*l,e[1]=n[1]*s+t[1]*u+r[1]*c+i[1]*l,e[2]=n[2]*s+t[2]*u+r[2]*c+i[2]*l,e},inverse:function(e,n){return e[0]=1/n[0],e[1]=1/n[1],e[2]=1/n[2],e},len:l2,length:n2,lerp:function(e,n,t,r){var i=n[0],o=n[1],a=n[2];return e[0]=i+r*(t[0]-i),e[1]=o+r*(t[1]-o),e[2]=a+r*(t[2]-a),e},max:function(e,n,t){return e[0]=Math.max(n[0],t[0]),e[1]=Math.max(n[1],t[1]),e[2]=Math.max(n[2],t[2]),e},min:function(e,n,t){return e[0]=Math.min(n[0],t[0]),e[1]=Math.min(n[1],t[1]),e[2]=Math.min(n[2],t[2]),e},mul:cL,multiply:i2,negate:function(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e},normalize:c2,random:function(e,n){n=n||1;var t=2*vi()*Math.PI,r=2*vi()-1,i=Math.sqrt(1-r*r)*n;return e[0]=Math.cos(t)*i,e[1]=Math.sin(t)*i,e[2]=r*n,e},rotateX:function(e,n,t,r){var i=[],o=[];return i[0]=n[0]-t[0],i[1]=n[1]-t[1],i[2]=n[2]-t[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=o[0]+t[0],e[1]=o[1]+t[1],e[2]=o[2]+t[2],e},rotateY:function(e,n,t,r){var i=[],o=[];return i[0]=n[0]-t[0],i[1]=n[1]-t[1],i[2]=n[2]-t[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=o[0]+t[0],e[1]=o[1]+t[1],e[2]=o[2]+t[2],e},rotateZ:function(e,n,t,r){var i=[],o=[];return i[0]=n[0]-t[0],i[1]=n[1]-t[1],i[2]=n[2]-t[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+t[0],e[1]=o[1]+t[1],e[2]=o[2]+t[2],e},round:function(e,n){return e[0]=Math.round(n[0]),e[1]=Math.round(n[1]),e[2]=Math.round(n[2]),e},scale:function(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e},scaleAndAdd:function(e,n,t,r){return e[0]=n[0]+t[0]*r,e[1]=n[1]+t[1]*r,e[2]=n[2]+t[2]*r,e},set:function(e,n,t,r){return e[0]=n,e[1]=t,e[2]=r,e},sqrDist:fL,sqrLen:dL,squaredDistance:s2,squaredLength:u2,str:function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},sub:uL,subtract:r2,transformMat3:Vh,transformMat4:function(e,n,t){var r=n[0],i=n[1],o=n[2],a=t[3]*r+t[7]*i+t[11]*o+t[15];return a=a||1,e[0]=(t[0]*r+t[4]*i+t[8]*o+t[12])/a,e[1]=(t[1]*r+t[5]*i+t[9]*o+t[13])/a,e[2]=(t[2]*r+t[6]*i+t[10]*o+t[14])/a,e},transformQuat:function(e,n,t){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],u=n[1],c=n[2],l=i*c-o*u,h=o*s-r*c,f=r*u-i*s,d=i*f-o*h,p=o*l-r*f,g=r*h-i*l,v=2*a;return l*=v,h*=v,f*=v,d*=2,p*=2,g*=2,e[0]=s+l+d,e[1]=u+h+p,e[2]=c+f+g,e},zero:function(e){return e[0]=0,e[1]=0,e[2]=0,e}},Symbol.toStringTag,{value:"Module"}));function h2(){var e=new en(4);return en!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function f2(e){var n=new en(4);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n}function d2(e,n,t,r){var i=new en(4);return i[0]=e,i[1]=n,i[2]=t,i[3]=r,i}function p2(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}function g2(e,n,t,r,i){return e[0]=n,e[1]=t,e[2]=r,e[3]=i,e}function v2(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e[3]=n[3]+t[3],e}function m2(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e[2]=n[2]-t[2],e[3]=n[3]-t[3],e}function y2(e,n,t){return e[0]=n[0]*t[0],e[1]=n[1]*t[1],e[2]=n[2]*t[2],e[3]=n[3]*t[3],e}function b2(e,n,t){return e[0]=n[0]/t[0],e[1]=n[1]/t[1],e[2]=n[2]/t[2],e[3]=n[3]/t[3],e}function x2(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e[3]=n[3]*t,e}function w2(e,n){var t=n[0]-e[0],r=n[1]-e[1],i=n[2]-e[2],o=n[3]-e[3];return Math.hypot(t,r,i,o)}function E2(e,n){var t=n[0]-e[0],r=n[1]-e[1],i=n[2]-e[2],o=n[3]-e[3];return t*t+r*r+i*i+o*o}function l0(e){var n=e[0],t=e[1],r=e[2],i=e[3];return Math.hypot(n,t,r,i)}function h0(e){var n=e[0],t=e[1],r=e[2],i=e[3];return n*n+t*t+r*r+i*i}function M2(e,n){var t=n[0],r=n[1],i=n[2],o=n[3],a=t*t+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),e[0]=t*a,e[1]=r*a,e[2]=i*a,e[3]=o*a,e}function S2(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]+e[3]*n[3]}function _2(e,n,t,r){var i=n[0],o=n[1],a=n[2],s=n[3];return e[0]=i+r*(t[0]-i),e[1]=o+r*(t[1]-o),e[2]=a+r*(t[2]-a),e[3]=s+r*(t[3]-s),e}function k2(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]}function C2(e,n){var t=e[0],r=e[1],i=e[2],o=e[3],a=n[0],s=n[1],u=n[2],c=n[3];return Math.abs(t-a)<=kt*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(r-s)<=kt*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=kt*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=kt*Math.max(1,Math.abs(o),Math.abs(c))}var vL=m2,mL=y2,yL=b2,bL=w2,xL=E2,wL=l0,EL=h0,ML=function(){var e=h2();return function(n,t,r,i,o,a){var s,u;for(t||(t=4),r||(r=0),u=i?Math.min(i*t+r,n.length):n.length,s=r;s<u;s+=t)e[0]=n[s],e[1]=n[s+1],e[2]=n[s+2],e[3]=n[s+3],o(e,e,a),n[s]=e[0],n[s+1]=e[1],n[s+2]=e[2],n[s+3]=e[3];return n}}();const SL=Object.freeze(Object.defineProperty({__proto__:null,add:v2,ceil:function(e,n){return e[0]=Math.ceil(n[0]),e[1]=Math.ceil(n[1]),e[2]=Math.ceil(n[2]),e[3]=Math.ceil(n[3]),e},clone:f2,copy:p2,create:h2,cross:function(e,n,t,r){var i=t[0]*r[1]-t[1]*r[0],o=t[0]*r[2]-t[2]*r[0],a=t[0]*r[3]-t[3]*r[0],s=t[1]*r[2]-t[2]*r[1],u=t[1]*r[3]-t[3]*r[1],c=t[2]*r[3]-t[3]*r[2],l=n[0],h=n[1],f=n[2],d=n[3];return e[0]=h*c-f*u+d*s,e[1]=-l*c+f*a-d*o,e[2]=l*u-h*a+d*i,e[3]=-l*s+h*o-f*i,e},dist:bL,distance:w2,div:yL,divide:b2,dot:S2,equals:C2,exactEquals:k2,floor:function(e,n){return e[0]=Math.floor(n[0]),e[1]=Math.floor(n[1]),e[2]=Math.floor(n[2]),e[3]=Math.floor(n[3]),e},forEach:ML,fromValues:d2,inverse:function(e,n){return e[0]=1/n[0],e[1]=1/n[1],e[2]=1/n[2],e[3]=1/n[3],e},len:wL,length:l0,lerp:_2,max:function(e,n,t){return e[0]=Math.max(n[0],t[0]),e[1]=Math.max(n[1],t[1]),e[2]=Math.max(n[2],t[2]),e[3]=Math.max(n[3],t[3]),e},min:function(e,n,t){return e[0]=Math.min(n[0],t[0]),e[1]=Math.min(n[1],t[1]),e[2]=Math.min(n[2],t[2]),e[3]=Math.min(n[3],t[3]),e},mul:mL,multiply:y2,negate:function(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e[3]=-n[3],e},normalize:M2,random:function(e,n){var t,r,i,o,a,s;n=n||1;do a=(t=2*vi()-1)*t+(r=2*vi()-1)*r;while(a>=1);do s=(i=2*vi()-1)*i+(o=2*vi()-1)*o;while(s>=1);var u=Math.sqrt((1-a)/s);return e[0]=n*t,e[1]=n*r,e[2]=n*i*u,e[3]=n*o*u,e},round:function(e,n){return e[0]=Math.round(n[0]),e[1]=Math.round(n[1]),e[2]=Math.round(n[2]),e[3]=Math.round(n[3]),e},scale:x2,scaleAndAdd:function(e,n,t,r){return e[0]=n[0]+t[0]*r,e[1]=n[1]+t[1]*r,e[2]=n[2]+t[2]*r,e[3]=n[3]+t[3]*r,e},set:g2,sqrDist:xL,sqrLen:EL,squaredDistance:E2,squaredLength:h0,str:function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},sub:vL,subtract:m2,transformMat4:function(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3];return e[0]=t[0]*r+t[4]*i+t[8]*o+t[12]*a,e[1]=t[1]*r+t[5]*i+t[9]*o+t[13]*a,e[2]=t[2]*r+t[6]*i+t[10]*o+t[14]*a,e[3]=t[3]*r+t[7]*i+t[11]*o+t[15]*a,e},transformQuat:function(e,n,t){var r=n[0],i=n[1],o=n[2],a=t[0],s=t[1],u=t[2],c=t[3],l=c*r+s*o-u*i,h=c*i+u*r-a*o,f=c*o+a*i-s*r,d=-a*r-s*i-u*o;return e[0]=l*c+d*-a+h*-u-f*-s,e[1]=h*c+d*-s+f*-a-l*-u,e[2]=f*c+d*-u+l*-s-h*-a,e[3]=n[3],e},zero:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}},Symbol.toStringTag,{value:"Module"}));function Hh(){var e=new en(4);return en!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function A2(e,n,t){t*=.5;var r=Math.sin(t);return e[0]=r*n[0],e[1]=r*n[1],e[2]=r*n[2],e[3]=Math.cos(t),e}function I2(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3],s=t[0],u=t[1],c=t[2],l=t[3];return e[0]=r*l+a*s+i*c-o*u,e[1]=i*l+a*u+o*s-r*c,e[2]=o*l+a*c+r*u-i*s,e[3]=a*l-r*s-i*u-o*c,e}function T2(e,n,t){t*=.5;var r=n[0],i=n[1],o=n[2],a=n[3],s=Math.sin(t),u=Math.cos(t);return e[0]=r*u+a*s,e[1]=i*u+o*s,e[2]=o*u-i*s,e[3]=a*u-r*s,e}function O2(e,n,t){t*=.5;var r=n[0],i=n[1],o=n[2],a=n[3],s=Math.sin(t),u=Math.cos(t);return e[0]=r*u-o*s,e[1]=i*u+a*s,e[2]=o*u+r*s,e[3]=a*u-i*s,e}function N2(e,n,t){t*=.5;var r=n[0],i=n[1],o=n[2],a=n[3],s=Math.sin(t),u=Math.cos(t);return e[0]=r*u+i*s,e[1]=i*u-r*s,e[2]=o*u+a*s,e[3]=a*u-o*s,e}function D2(e,n){var t=n[0],r=n[1],i=n[2],o=n[3],a=Math.sqrt(t*t+r*r+i*i),s=Math.exp(o),u=a>0?s*Math.sin(a)/a:0;return e[0]=t*u,e[1]=r*u,e[2]=i*u,e[3]=s*Math.cos(a),e}function P2(e,n){var t=n[0],r=n[1],i=n[2],o=n[3],a=Math.sqrt(t*t+r*r+i*i),s=a>0?Math.atan2(a,o)/a:0;return e[0]=t*s,e[1]=r*s,e[2]=i*s,e[3]=.5*Math.log(t*t+r*r+i*i+o*o),e}function qh(e,n,t,r){var i,o,a,s,u,c=n[0],l=n[1],h=n[2],f=n[3],d=t[0],p=t[1],g=t[2],v=t[3];return(o=c*d+l*p+h*g+f*v)<0&&(o=-o,d=-d,p=-p,g=-g,v=-v),1-o>kt?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(s=1-r,u=r),e[0]=s*c+u*d,e[1]=s*l+u*p,e[2]=s*h+u*g,e[3]=s*f+u*v,e}function L2(e,n){var t,r=n[0]+n[4]+n[8];if(r>0)t=Math.sqrt(r+1),e[3]=.5*t,t=.5/t,e[0]=(n[5]-n[7])*t,e[1]=(n[6]-n[2])*t,e[2]=(n[1]-n[3])*t;else{var i=0;n[4]>n[0]&&(i=1),n[8]>n[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;t=Math.sqrt(n[3*i+i]-n[3*o+o]-n[3*a+a]+1),e[i]=.5*t,t=.5/t,e[3]=(n[3*o+a]-n[3*a+o])*t,e[o]=(n[3*o+i]+n[3*i+o])*t,e[a]=(n[3*a+i]+n[3*i+a])*t}return e}var mi,R2,j2,f0,d0,yi,_L=f2,kL=d2,p0=p2,CL=g2,AL=v2,IL=I2,B2=x2,g0=S2,TL=_2,v0=l0,OL=v0,m0=h0,NL=m0,y0=M2,DL=k2,PL=C2,LL=(mi=s0(),R2=u0(1,0,0),j2=u0(0,1,0),function(e,n,t){var r=c0(n,t);return r<-.999999?(Wh(mi,R2,n),l2(mi)<1e-6&&Wh(mi,j2,n),c2(mi,mi),A2(e,mi,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(Wh(mi,n,t),e[0]=mi[0],e[1]=mi[1],e[2]=mi[2],e[3]=1+r,y0(e,e))}),RL=(f0=Hh(),d0=Hh(),function(e,n,t,r,i,o){return qh(f0,n,i,o),qh(d0,t,r,o),qh(e,f0,d0,2*o*(1-o)),e}),jL=(yi=Yw(),function(e,n,t,r){return yi[0]=t[0],yi[3]=t[1],yi[6]=t[2],yi[1]=r[0],yi[4]=r[1],yi[7]=r[2],yi[2]=-n[0],yi[5]=-n[1],yi[8]=-n[2],y0(e,L2(e,yi))});const BL=Object.freeze(Object.defineProperty({__proto__:null,add:AL,calculateW:function(e,n){var t=n[0],r=n[1],i=n[2];return e[0]=t,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-t*t-r*r-i*i)),e},clone:_L,conjugate:function(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e[3]=n[3],e},copy:p0,create:Hh,dot:g0,equals:PL,exactEquals:DL,exp:D2,fromEuler:function(e,n,t,r){var i=.5*Math.PI/180;n*=i,t*=i,r*=i;var o=Math.sin(n),a=Math.cos(n),s=Math.sin(t),u=Math.cos(t),c=Math.sin(r),l=Math.cos(r);return e[0]=o*u*l-a*s*c,e[1]=a*s*l+o*u*c,e[2]=a*u*c-o*s*l,e[3]=a*u*l+o*s*c,e},fromMat3:L2,fromValues:kL,getAngle:function(e,n){var t=g0(e,n);return Math.acos(2*t*t-1)},getAxisAngle:function(e,n){var t=2*Math.acos(n[3]),r=Math.sin(t/2);return r>kt?(e[0]=n[0]/r,e[1]=n[1]/r,e[2]=n[2]/r):(e[0]=1,e[1]=0,e[2]=0),t},identity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},invert:function(e,n){var t=n[0],r=n[1],i=n[2],o=n[3],a=t*t+r*r+i*i+o*o,s=a?1/a:0;return e[0]=-t*s,e[1]=-r*s,e[2]=-i*s,e[3]=o*s,e},len:OL,length:v0,lerp:TL,ln:P2,mul:IL,multiply:I2,normalize:y0,pow:function(e,n,t){return P2(e,n),B2(e,e,t),D2(e,e),e},random:function(e){var n=vi(),t=vi(),r=vi(),i=Math.sqrt(1-n),o=Math.sqrt(n);return e[0]=i*Math.sin(2*Math.PI*t),e[1]=i*Math.cos(2*Math.PI*t),e[2]=o*Math.sin(2*Math.PI*r),e[3]=o*Math.cos(2*Math.PI*r),e},rotateX:T2,rotateY:O2,rotateZ:N2,rotationTo:LL,scale:B2,set:CL,setAxes:jL,setAxisAngle:A2,slerp:qh,sqlerp:RL,sqrLen:NL,squaredLength:m0,str:function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}},Symbol.toStringTag,{value:"Module"}));function z2(e,n,t){var r=.5*t[0],i=.5*t[1],o=.5*t[2],a=n[0],s=n[1],u=n[2],c=n[3];return e[0]=a,e[1]=s,e[2]=u,e[3]=c,e[4]=r*c+i*u-o*s,e[5]=i*c+o*a-r*u,e[6]=o*c+r*s-i*a,e[7]=-r*a-i*s-o*u,e}function F2(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e}var zL=p0,FL=p0;function G2(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3],s=t[4],u=t[5],c=t[6],l=t[7],h=n[4],f=n[5],d=n[6],p=n[7],g=t[0],v=t[1],m=t[2],y=t[3];return e[0]=r*y+a*g+i*m-o*v,e[1]=i*y+a*v+o*g-r*m,e[2]=o*y+a*m+r*v-i*g,e[3]=a*y-r*g-i*v-o*m,e[4]=r*l+a*s+i*c-o*u+h*y+p*g+f*m-d*v,e[5]=i*l+a*u+o*s-r*c+f*y+p*v+d*g-h*m,e[6]=o*l+a*c+r*u-i*s+d*y+p*m+h*v-f*g,e[7]=a*l-r*s-i*u-o*c+p*y-h*g-f*v-d*m,e}var GL=G2,U2=g0,X2=v0,UL=X2,Zh=m0,XL=Zh;const YL=Object.freeze(Object.defineProperty({__proto__:null,add:function(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e[2]=n[2]+t[2],e[3]=n[3]+t[3],e[4]=n[4]+t[4],e[5]=n[5]+t[5],e[6]=n[6]+t[6],e[7]=n[7]+t[7],e},clone:function(e){var n=new en(8);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n},conjugate:function(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e[3]=n[3],e[4]=-n[4],e[5]=-n[5],e[6]=-n[6],e[7]=n[7],e},copy:F2,create:function(){var e=new en(8);return en!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e},dot:U2,equals:function(e,n){var t=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=n[0],h=n[1],f=n[2],d=n[3],p=n[4],g=n[5],v=n[6],m=n[7];return Math.abs(t-l)<=kt*Math.max(1,Math.abs(t),Math.abs(l))&&Math.abs(r-h)<=kt*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-f)<=kt*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-d)<=kt*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-p)<=kt*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(s-g)<=kt*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(u-v)<=kt*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(c-m)<=kt*Math.max(1,Math.abs(c),Math.abs(m))},exactEquals:function(e,n){return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]&&e[3]===n[3]&&e[4]===n[4]&&e[5]===n[5]&&e[6]===n[6]&&e[7]===n[7]},fromMat4:function(e,n){var t=Hh();Qw(t,n);var r=new en(3);return Kw(r,n),z2(e,t,r),e},fromRotation:function(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},fromRotationTranslation:z2,fromRotationTranslationValues:function(e,n,t,r,i,o,a){var s=new en(8);s[0]=e,s[1]=n,s[2]=t,s[3]=r;var u=.5*i,c=.5*o,l=.5*a;return s[4]=u*r+c*t-l*n,s[5]=c*r+l*e-u*t,s[6]=l*r+u*n-c*e,s[7]=-u*e-c*n-l*t,s},fromTranslation:function(e,n){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*n[0],e[5]=.5*n[1],e[6]=.5*n[2],e[7]=0,e},fromValues:function(e,n,t,r,i,o,a,s){var u=new en(8);return u[0]=e,u[1]=n,u[2]=t,u[3]=r,u[4]=i,u[5]=o,u[6]=a,u[7]=s,u},getDual:function(e,n){return e[0]=n[4],e[1]=n[5],e[2]=n[6],e[3]=n[7],e},getReal:zL,getTranslation:function(e,n){var t=n[4],r=n[5],i=n[6],o=n[7],a=-n[0],s=-n[1],u=-n[2],c=n[3];return e[0]=2*(t*c+o*a+r*u-i*s),e[1]=2*(r*c+o*s+i*a-t*u),e[2]=2*(i*c+o*u+t*s-r*a),e},identity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},invert:function(e,n){var t=Zh(n);return e[0]=-n[0]/t,e[1]=-n[1]/t,e[2]=-n[2]/t,e[3]=n[3]/t,e[4]=-n[4]/t,e[5]=-n[5]/t,e[6]=-n[6]/t,e[7]=n[7]/t,e},len:UL,length:X2,lerp:function(e,n,t,r){var i=1-r;return U2(n,t)<0&&(r=-r),e[0]=n[0]*i+t[0]*r,e[1]=n[1]*i+t[1]*r,e[2]=n[2]*i+t[2]*r,e[3]=n[3]*i+t[3]*r,e[4]=n[4]*i+t[4]*r,e[5]=n[5]*i+t[5]*r,e[6]=n[6]*i+t[6]*r,e[7]=n[7]*i+t[7]*r,e},mul:GL,multiply:G2,normalize:function(e,n){var t=Zh(n);if(t>0){t=Math.sqrt(t);var r=n[0]/t,i=n[1]/t,o=n[2]/t,a=n[3]/t,s=n[4],u=n[5],c=n[6],l=n[7],h=r*s+i*u+o*c+a*l;e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=(s-r*h)/t,e[5]=(u-i*h)/t,e[6]=(c-o*h)/t,e[7]=(l-a*h)/t}return e},rotateAroundAxis:function(e,n,t,r){if(Math.abs(r)<kt)return F2(e,n);var i=Math.hypot(t[0],t[1],t[2]);r*=.5;var o=Math.sin(r),a=o*t[0]/i,s=o*t[1]/i,u=o*t[2]/i,c=Math.cos(r),l=n[0],h=n[1],f=n[2],d=n[3];e[0]=l*c+d*a+h*u-f*s,e[1]=h*c+d*s+f*a-l*u,e[2]=f*c+d*u+l*s-h*a,e[3]=d*c-l*a-h*s-f*u;var p=n[4],g=n[5],v=n[6],m=n[7];return e[4]=p*c+m*a+g*u-v*s,e[5]=g*c+m*s+v*a-p*u,e[6]=v*c+m*u+p*s-g*a,e[7]=m*c-p*a-g*s-v*u,e},rotateByQuatAppend:function(e,n,t){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],u=n[1],c=n[2],l=n[3];return e[0]=s*a+l*r+u*o-c*i,e[1]=u*a+l*i+c*r-s*o,e[2]=c*a+l*o+s*i-u*r,e[3]=l*a-s*r-u*i-c*o,s=n[4],u=n[5],c=n[6],l=n[7],e[4]=s*a+l*r+u*o-c*i,e[5]=u*a+l*i+c*r-s*o,e[6]=c*a+l*o+s*i-u*r,e[7]=l*a-s*r-u*i-c*o,e},rotateByQuatPrepend:function(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3],s=t[0],u=t[1],c=t[2],l=t[3];return e[0]=r*l+a*s+i*c-o*u,e[1]=i*l+a*u+o*s-r*c,e[2]=o*l+a*c+r*u-i*s,e[3]=a*l-r*s-i*u-o*c,s=t[4],u=t[5],c=t[6],l=t[7],e[4]=r*l+a*s+i*c-o*u,e[5]=i*l+a*u+o*s-r*c,e[6]=o*l+a*c+r*u-i*s,e[7]=a*l-r*s-i*u-o*c,e},rotateX:function(e,n,t){var r=-n[0],i=-n[1],o=-n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=s*a+l*r+u*o-c*i,f=u*a+l*i+c*r-s*o,d=c*a+l*o+s*i-u*r,p=l*a-s*r-u*i-c*o;return T2(e,n,t),r=e[0],i=e[1],o=e[2],a=e[3],e[4]=h*a+p*r+f*o-d*i,e[5]=f*a+p*i+d*r-h*o,e[6]=d*a+p*o+h*i-f*r,e[7]=p*a-h*r-f*i-d*o,e},rotateY:function(e,n,t){var r=-n[0],i=-n[1],o=-n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=s*a+l*r+u*o-c*i,f=u*a+l*i+c*r-s*o,d=c*a+l*o+s*i-u*r,p=l*a-s*r-u*i-c*o;return O2(e,n,t),r=e[0],i=e[1],o=e[2],a=e[3],e[4]=h*a+p*r+f*o-d*i,e[5]=f*a+p*i+d*r-h*o,e[6]=d*a+p*o+h*i-f*r,e[7]=p*a-h*r-f*i-d*o,e},rotateZ:function(e,n,t){var r=-n[0],i=-n[1],o=-n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=s*a+l*r+u*o-c*i,f=u*a+l*i+c*r-s*o,d=c*a+l*o+s*i-u*r,p=l*a-s*r-u*i-c*o;return N2(e,n,t),r=e[0],i=e[1],o=e[2],a=e[3],e[4]=h*a+p*r+f*o-d*i,e[5]=f*a+p*i+d*r-h*o,e[6]=d*a+p*o+h*i-f*r,e[7]=p*a-h*r-f*i-d*o,e},scale:function(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e[2]=n[2]*t,e[3]=n[3]*t,e[4]=n[4]*t,e[5]=n[5]*t,e[6]=n[6]*t,e[7]=n[7]*t,e},set:function(e,n,t,r,i,o,a,s,u){return e[0]=n,e[1]=t,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e},setDual:function(e,n){return e[4]=n[0],e[5]=n[1],e[6]=n[2],e[7]=n[3],e},setReal:FL,sqrLen:XL,squaredLength:Zh,str:function(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"},translate:function(e,n,t){var r=n[0],i=n[1],o=n[2],a=n[3],s=.5*t[0],u=.5*t[1],c=.5*t[2],l=n[4],h=n[5],f=n[6],d=n[7];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=a*s+i*c-o*u+l,e[5]=a*u+o*s-r*c+h,e[6]=a*c+r*u-i*s+f,e[7]=-r*s-i*u-o*c+d,e}},Symbol.toStringTag,{value:"Module"}));function Y2(){var e=new en(2);return en!=Float32Array&&(e[0]=0,e[1]=0),e}function rr(e,n,t){return e[0]=n[0]+t[0],e[1]=n[1]+t[1],e}function W2(e,n,t){return e[0]=n[0]-t[0],e[1]=n[1]-t[1],e}function V2(e,n,t){return e[0]=n[0]*t[0],e[1]=n[1]*t[1],e}function H2(e,n,t){return e[0]=n[0]/t[0],e[1]=n[1]/t[1],e}function Zo(e,n,t){return e[0]=Math.min(n[0],t[0]),e[1]=Math.min(n[1],t[1]),e}function Ko(e,n,t){return e[0]=Math.max(n[0],t[0]),e[1]=Math.max(n[1],t[1]),e}function fr(e,n,t){return e[0]=n[0]*t,e[1]=n[1]*t,e}function Kh(e,n){var t=n[0]-e[0],r=n[1]-e[1];return Math.hypot(t,r)}function q2(e,n){var t=n[0]-e[0],r=n[1]-e[1];return t*t+r*r}function Z2(e){var n=e[0],t=e[1];return Math.hypot(n,t)}function K2(e){var n=e[0],t=e[1];return n*n+t*t}function $o(e,n){var t=n[0],r=n[1],i=t*t+r*r;return i>0&&(i=1/Math.sqrt(i)),e[0]=n[0]*i,e[1]=n[1]*i,e}function b0(e,n){return e[0]*n[0]+e[1]*n[1]}function $2(e,n){var t=e[0],r=e[1],i=n[0],o=n[1],a=Math.sqrt(t*t+r*r)*Math.sqrt(i*i+o*o),s=a&&(t*i+r*o)/a;return Math.acos(Math.min(Math.max(s,-1),1))}function x0(e,n){return e[0]===n[0]&&e[1]===n[1]}var WL=Z2,$h=W2,VL=V2,HL=H2,qL=Kh,ZL=q2,KL=K2,$L=function(){var e=Y2();return function(n,t,r,i,o,a){var s,u;for(t||(t=2),r||(r=0),u=i?Math.min(i*t+r,n.length):n.length,s=r;s<u;s+=t)e[0]=n[s],e[1]=n[s+1],o(e,e,a),n[s]=e[0],n[s+1]=e[1];return n}}();const QL=Object.freeze(Object.defineProperty({__proto__:null,add:rr,angle:$2,ceil:function(e,n){return e[0]=Math.ceil(n[0]),e[1]=Math.ceil(n[1]),e},clone:function(e){var n=new en(2);return n[0]=e[0],n[1]=e[1],n},copy:function(e,n){return e[0]=n[0],e[1]=n[1],e},create:Y2,cross:function(e,n,t){var r=n[0]*t[1]-n[1]*t[0];return e[0]=e[1]=0,e[2]=r,e},dist:qL,distance:Kh,div:HL,divide:H2,dot:b0,equals:function(e,n){var t=e[0],r=e[1],i=n[0],o=n[1];return Math.abs(t-i)<=kt*Math.max(1,Math.abs(t),Math.abs(i))&&Math.abs(r-o)<=kt*Math.max(1,Math.abs(r),Math.abs(o))},exactEquals:x0,floor:function(e,n){return e[0]=Math.floor(n[0]),e[1]=Math.floor(n[1]),e},forEach:$L,fromValues:function(e,n){var t=new en(2);return t[0]=e,t[1]=n,t},inverse:function(e,n){return e[0]=1/n[0],e[1]=1/n[1],e},len:WL,length:Z2,lerp:function(e,n,t,r){var i=n[0],o=n[1];return e[0]=i+r*(t[0]-i),e[1]=o+r*(t[1]-o),e},max:Ko,min:Zo,mul:VL,multiply:V2,negate:function(e,n){return e[0]=-n[0],e[1]=-n[1],e},normalize:$o,random:function(e,n){n=n||1;var t=2*vi()*Math.PI;return e[0]=Math.cos(t)*n,e[1]=Math.sin(t)*n,e},rotate:function(e,n,t,r){var i=n[0]-t[0],o=n[1]-t[1],a=Math.sin(r),s=Math.cos(r);return e[0]=i*s-o*a+t[0],e[1]=i*a+o*s+t[1],e},round:function(e,n){return e[0]=Math.round(n[0]),e[1]=Math.round(n[1]),e},scale:fr,scaleAndAdd:function(e,n,t,r){return e[0]=n[0]+t[0]*r,e[1]=n[1]+t[1]*r,e},set:function(e,n,t){return e[0]=n,e[1]=t,e},sqrDist:ZL,sqrLen:KL,squaredDistance:q2,squaredLength:K2,str:function(e){return"vec2("+e[0]+", "+e[1]+")"},sub:$h,subtract:W2,transformMat2:function(e,n,t){var r=n[0],i=n[1];return e[0]=t[0]*r+t[2]*i,e[1]=t[1]*r+t[3]*i,e},transformMat2d:function(e,n,t){var r=n[0],i=n[1];return e[0]=t[0]*r+t[2]*i+t[4],e[1]=t[1]*r+t[3]*i+t[5],e},transformMat3:function(e,n,t){var r=n[0],i=n[1];return e[0]=t[0]*r+t[3]*i+t[6],e[1]=t[1]*r+t[4]*i+t[7],e},transformMat4:function(e,n,t){var r=n[0],i=n[1];return e[0]=t[0]*r+t[4]*i+t[12],e[1]=t[1]*r+t[5]*i+t[13],e},zero:function(e){return e[0]=0,e[1]=0,e}},Symbol.toStringTag,{value:"Module"})),JL=Object.freeze(Object.defineProperty({__proto__:null,glMatrix:qP,mat2:$P,mat2d:eL,mat3:Vw,mat4:sL,quat:BL,quat2:YL,vec2:QL,vec3:gL,vec4:SL},Symbol.toStringTag,{value:"Module"}));function e4(e,n,t){var r=[0,0,0,0,0,0,0,0,0];return i0(r,t),Xi(e,r,n)}function t4(e,n,t){var r=[0,0,0,0,0,0,0,0,0];return o0(r,t),Xi(e,r,n)}function n4(e,n,t){var r=[0,0,0,0,0,0,0,0,0];return a0(r,t),Xi(e,r,n)}function r4(e,n,t){return Xi(e,t,n)}function Qr(e,n){for(var t=e?[].concat(e):[1,0,0,0,1,0,0,0,1],r=0,i=n.length;r<i;r++){var o=n[r];switch(o[0]){case"t":e4(t,t,[o[1],o[2]]);break;case"s":n4(t,t,[o[1],o[2]]);break;case"r":t4(t,t,o[1]);break;case"m":r4(t,t,o[1])}}return t}var Va=function(e,n){var t=e.nodes,r=e.edges,i=[],o={};if(!t)throw new Error("invalid nodes data!");return t&&t.forEach(function(a,s){o[a.id]=s,i.push([])}),r&&r.forEach(function(a){var s=a.source,u=a.target,c=o[s],l=o[u];!c&&c!==0||!l&&l!==0||(i[c][l]=1,n||(i[l][c]=1))}),i},i4=function(e,n){return e===n},Q2=function(){function e(n,t){t===void 0&&(t=null),this.value=n,this.next=t}return e.prototype.toString=function(n){return n?n(this.value):"".concat(this.value)},e}(),J2=function(){function e(n){n===void 0&&(n=i4),this.head=null,this.tail=null,this.compare=n}return e.prototype.prepend=function(n){var t=new Q2(n,this.head);return this.head=t,this.tail||(this.tail=t),this},e.prototype.append=function(n){var t=new Q2(n);return this.head?(this.tail.next=t,this.tail=t,this):(this.head=t,this.tail=t,this)},e.prototype.delete=function(n){if(!this.head)return null;for(var t=null;this.head&&this.compare(this.head.value,n);)t=this.head,this.head=this.head.next;var r=this.head;if(r!==null)for(;r.next;)this.compare(r.next.value,n)?(t=r.next,r.next=r.next.next):r=r.next;return this.compare(this.tail.value,n)&&(this.tail=r),t},e.prototype.find=function(n){var t=n.value,r=t===void 0?void 0:t,i=n.callback,o=i===void 0?void 0:i;if(!this.head)return null;for(var a=this.head;a;){if(o&&o(a.value)||r!==void 0&&this.compare(a.value,r))return a;a=a.next}return null},e.prototype.deleteTail=function(){var n=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,n;for(var t=this.head;t.next;)t.next.next?t=t.next:t.next=null;return this.tail=t,n},e.prototype.deleteHead=function(){if(!this.head)return null;var n=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),n},e.prototype.fromArray=function(n){var t=this;return n.forEach(function(r){return t.append(r)}),this},e.prototype.toArray=function(){for(var n=[],t=this.head;t;)n.push(t),t=t.next;return n},e.prototype.reverse=function(){for(var n=this.head,t=null,r=null;n;)r=n.next,n.next=t,t=n,n=r;this.tail=this.head,this.head=t},e.prototype.toString=function(n){return n===void 0&&(n=void 0),this.toArray().map(function(t){return t.toString(n)}).toString()},e}(),o4=function(){function e(){this.linkedList=new J2}return e.prototype.isEmpty=function(){return!this.linkedList.head},e.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},e.prototype.enqueue=function(n){this.linkedList.append(n)},e.prototype.dequeue=function(){var n=this.linkedList.deleteHead();return n?n.value:null},e.prototype.toString=function(n){return this.linkedList.toString(n)},e}(),zr=function(e,n,t){n===void 0&&(n=[]);var r=n.filter(function(i){return i.source===e||i.target===e});return t==="target"?r.filter(function(i){return i.source===e}).map(function(i){return i.target}):t==="source"?r.filter(function(i){return i.target===e}).map(function(i){return i.source}):r.map(function(i){return i.source===e?i.target:i.source})},Qh=function(e,n){return n.filter(function(t){return t.source===e||t.target===e})},eE=function(e){e===void 0&&(e=0);var n="".concat(Math.random()).split(".")[1].substr(0,5),t="".concat(Math.random()).split(".")[1].substr(0,5);return"".concat(e,"-").concat(n).concat(t)},tE=function(e,n,t,r){r===void 0&&(r=!0);var i=function(l){l===void 0&&(l={});var h,f=l,d=function(){},p=(h={},function(g){var v=g.next;return!h[v]&&(h[v]=!0,!0)});return f.allowTraversal=l.allowTraversal||p,f.enter=l.enter||d,f.leave=l.leave||d,f}(t),o=new o4,a=e.edges,s=a===void 0?[]:a;o.enqueue(n);for(var u="",c=function(){var l=o.dequeue();i.enter({current:l,previous:u}),zr(l,s,r?"target":void 0).forEach(function(h){i.allowTraversal({previous:u,current:l,next:h})&&o.enqueue(h)}),i.leave({current:l,previous:u}),u=l};!o.isEmpty();)c()},nE=function(e){for(var n=e.nodes,t=n===void 0?[]:n,r=e.edges,i=r===void 0?[]:r,o=[],a={},s={},u={},c=[],l=0,h=function g(v){s[v.id]=l,u[v.id]=l,l+=1,o.push(v),a[v.id]=!0;for(var m=zr(v.id,i,"target").filter(function(E){return t.map(function(M){return M.id}).indexOf(E)>-1}),y=function(E){var M=m[E];if(s[M]||s[M]===0)a[M]&&(u[v.id]=Math.min(u[v.id],s[M]));else{var _=t.filter(function(k){return k.id===M});_.length>0&&g(_[0]),u[v.id]=Math.min(u[v.id],u[M])}},b=0;b<m.length;b++)y(b);if(u[v.id]===s[v.id]){for(var x=[];o.length>0;){var w=o.pop();if(a[w.id]=!1,x.push(w),w===v)break}x.length>0&&c.push(x)}},f=0,d=t;f<d.length;f++){var p=d[f];s[p.id]||s[p.id]===0||h(p)}return c};function w0(e,n){return n?nE(e):function(t){for(var r=t.nodes,i=r===void 0?[]:r,o=t.edges,a=o===void 0?[]:o,s=[],u={},c=[],l=function p(g){c.push(g),u[g.id]=!0;for(var v=zr(g.id,a),m=function(b){var x=v[b];if(!u[x]){var w=i.filter(function(E){return E.id===x});w.length>0&&p(w[0])}},y=0;y<v.length;++y)m(y)},h=0;h<i.length;h++){var f=i[h];if(!u[f.id]){l(f);for(var d=[];c.length>0;)d.push(c.pop());s.push(d)}}return s}(e)}var go=function(e){var n={},t=e.nodes,r=t===void 0?[]:t,i=e.edges,o=i===void 0?[]:i;return r.forEach(function(a){n[a.id]={degree:0,inDegree:0,outDegree:0}}),o.forEach(function(a){n[a.source].degree++,n[a.source].outDegree++,n[a.target].degree++,n[a.target].inDegree++}),n},rE=function(e,n){return go(e)[n]?go(e)[n].inDegree:0},iE=function(e,n){return go(e)[n]?go(e)[n].outDegree:0};function oE(e,n,t,r,i){i===void 0&&(i=!0),r.enter({current:n,previous:t});var o=e.edges;zr(n,o===void 0?[]:o,i?"target":void 0).forEach(function(a){r.allowTraversal({previous:t,current:n,next:a})&&oE(e,a,n,r,i)}),r.leave({current:n,previous:t})}function E0(e,n,t,r){r===void 0&&(r=!0),oE(e,n,"",function(i){i===void 0&&(i={});var o,a=i,s=function(){},u=(o={},function(c){var l=c.next;return!o[l]&&(o[l]=!0,!0)});return a.allowTraversal=i.allowTraversal||u,a.enter=i.enter||s,a.leave=i.leave||s,a}(t),r)}var M0=function(e){var n=null,t=e.nodes,r={},i={},o={},a={};(t===void 0?[]:t).forEach(function(u){i[u.id]=u});for(var s={enter:function(u){var c=u.current,l=u.previous;if(o[c]){n={};for(var h=c,f=l;f!==c;)n[h]=f,h=f,f=r[f];n[h]=f}else o[c]=c,delete i[c],r[c]=l},leave:function(u){var c=u.current;a[c]=c,delete o[c]},allowTraversal:function(u){var c=u.next;return!n&&!a[c]}};Object.keys(i).length;)E0(e,Object.keys(i)[0],s);return n},S0=function(e,n,t){var r,i;t===void 0&&(t=!0);for(var o=[],a=0,s=w0(e,!1);a<s.length;a++){var u=s[a];if(u.length)for(var c=u[0],l=c.id,h=[c],f=((r={})[l]=c,r),d=((i={})[l]=new Set,i);h.length>0;)for(var p=h.pop(),g=p.id,v=zr(g,e.edges),m=function(b){var x,w=v[b],E=e.nodes.find(function(T){return T.id===w});if(w===g)o.push(((x={})[w]=p,x));else if(w in d){if(!d[g].has(E)){for(var M=!0,_=[E,p],k=f[g];d[w].size&&!d[w].has(k)&&(_.push(k),k!==f[k.id]);)k=f[k.id];if(_.push(k),n&&t?(M=!1,_.findIndex(function(T){return n.indexOf(T.id)>-1})>-1&&(M=!0)):n&&!t&&_.findIndex(function(T){return n.indexOf(T.id)>-1})>-1&&(M=!1),M){for(var S={},C=1;C<_.length;C+=1)S[_[C-1].id]=_[C];_.length&&(S[_[_.length-1].id]=_[0]),o.push(S)}d[w].add(p)}}else f[w]=p,h.push(E),d[w]=new Set([p])},y=0;y<v.length;y+=1)m(y)}return o},_0=function(e,n,t){t===void 0&&(t=!0);for(var r=[],i=new Set,o=[],a=[],s={},u={},c=function k(S,C,T){var A=!1;if(n&&t===!1&&n.indexOf(S.id)>-1)return A;r.push(S),i.add(S);for(var D=T[S.id],j=0;j<D.length;j+=1)if((N=s[D[j]])===C){for(var L={},B=1;B<r.length;B+=1)L[r[B-1].id]=r[B];r.length&&(L[r[r.length-1].id]=r[0]),a.push(L),A=!0}else i.has(N)||k(N,C,T)&&(A=!0);if(A)(function(R){for(var P=[R];P.length>0;){var H=P.pop();i.has(H)&&(i.delete(H),o[H.id].forEach(function(ne){P.push(ne)}),o[H.id].clear())}})(S);else for(j=0;j<D.length;j+=1){var N=s[D[j]];o[N.id].has(S)||o[N.id].add(S)}return r.pop(),A},l=e.nodes,h=l===void 0?[]:l,f=0;f<h.length;f+=1){var d=h[f],p=d.id;u[p]=f,s[f]=d}if(n&&t){var g=function(k){var S=n[k];u[h[k].id]=u[S],u[S]=0,s[0]=h.find(function(C){return C.id===S}),s[u[h[k].id]]=h[k]};for(f=0;f<n.length;f++)g(f)}for(var v=function(k){for(var S,C,T=1/0,A=0;A<k.length;A+=1)for(var D=k[A],j=0;j<D.length;j++){var L=u[D[j].id];L<T&&(T=L,C=A)}var B=k[C],N=[];for(A=0;A<B.length;A+=1){var R=B[A];N[R.id]=[];for(var P=0,H=zr(R.id,e.edges,"target").filter(function(Z){return B.map(function(q){return q.id}).indexOf(Z)>-1});P<H.length;P++){var ne=H[P];ne!==R.id||t===!1&&n.indexOf(R.id)>-1?N[R.id].push(u[ne]):a.push(((S={})[R.id]=R,S))}}return{component:B,adjList:N,minIdx:T}},m=0;m<h.length;){var y=h.filter(function(k){return u[k.id]>=m}),b=nE({nodes:y,edges:e.edges}).filter(function(k){return k.length>1});if(b.length===0)break;var x=v(b),w=x.minIdx,E=x.adjList,M=x.component;if(!(M.length>1))break;M.forEach(function(k){o[k.id]=new Set});var _=s[w];if(n&&t&&n.indexOf(_.id)===-1)return a;c(_,_,E),m=w+1}return a},aE=function(e,n,t,r){return r===void 0&&(r=!0),n?_0(e,t,r):S0(e,t,r)},vc=function(e,n,t,r){var i=e.nodes,o=i===void 0?[]:i,a=e.edges,s=a===void 0?[]:a,u={},c={},l={};o.forEach(function(m,y){var b=m.id;c[b]=1/0,b===n&&(c[b]=0)});for(var h=o.length,f=function(m){var y=function(w,E,M){for(var _,k=1/0,S=0;S<E.length;S++){var C=E[S].id;!M[C]&&w[C]<=k&&(k=w[C],_=E[S])}return _}(c,o,u),b=y.id;if(u[b]=!0,c[b]===1/0)return"continue";var x=[];x=t?function(w,E){return E.filter(function(M){return M.source===w})}(b,s):Qh(b,s),x.forEach(function(w){var E=w.target,M=w.source,_=E===b?M:E,k=r&&w[r]?w[r]:1;c[_]>c[y.id]+k?(c[_]=c[y.id]+k,l[_]=[y.id]):c[_]===c[y.id]+k&&l[_].push(y.id)})},d=0;d<h;d++)f();l[n]=[n];var p={};for(var g in c)c[g]!==1/0&&sE(n,g,l,p);var v={};for(var g in p)v[g]=p[g][0];return{length:c,path:v,allPath:p}};function sE(e,n,t,r){if(e===n)return[e];if(r[n])return r[n];for(var i=[],o=0,a=t[n];o<a.length;o++){var s=sE(e,a[o],t,r);if(!s)return;for(var u=0,c=s;u<c.length;u++){var l=c[u];Mt(l)?i.push(Br(Br([],l,!0),[n],!1)):i.push([l,n])}}return r[n]=i,r[n]}var bi,uE=function(e,n,t,r,i){var o=vc(e,n,r,i),a=o.length,s=o.path,u=o.allPath;return{length:a[t],path:s[t],allPath:u[t]}},cE=function(e,n,t,r){var i;if(n===t)return[[n]];var o=e.edges,a=o===void 0?[]:o,s=[n],u=((i={})[n]=!0,i),c=[],l=[],h=r?zr(n,a,"target"):zr(n,a);for(c.push(h);s.length>0&&c.length>0;){var f=c[c.length-1];if(f.length){var d=f.shift();if(d&&(s.push(d),u[d]=!0,h=r?zr(d,a,"target"):zr(d,a),c.push(h.filter(function(v){return!u[v]}))),s[s.length-1]===t){var p=s.map(function(v){return v});l.push(p),g=s.pop(),u[g]=!1,c.pop()}}else{var g=s.pop();u[g]=!1,c.pop()}}return l},mc=function(e,n){for(var t=Va(e,n),r=[],i=t.length,o=0;o<i;o+=1){r[o]=[];for(var a=0;a<i;a+=1)o===a?r[o][a]=0:t[o][a]!==0&&t[o][a]?r[o][a]=t[o][a]:r[o][a]=1/0}for(var s=0;s<i;s+=1)for(o=0;o<i;o+=1)for(a=0;a<i;a+=1)r[o][a]>r[o][s]+r[s][a]&&(r[o][a]=r[o][s]+r[s][a]);return r},lE=function(e,n,t,r){n===void 0&&(n=!1),t===void 0&&(t="weight"),r===void 0&&(r=1e3);var i=e.nodes,o=i===void 0?[]:i,a=e.edges,s=a===void 0?[]:a,u={},c={};o.forEach(function(m,y){var b=eE();m.clusterId=b,u[b]={id:b,nodes:[m]},c[m.id]={node:m,idx:y}});var l=Va(e,n),h={};l.forEach(function(m,y){var b=o[y].id;h[b]={},m.forEach(function(x,w){if(x){var E=o[w].id;h[b][E]=x}})});for(var f=0,d=function(){var m=!1;if(o.forEach(function(y){var b={};Object.keys(h[y.id]).forEach(function(C){var T=h[y.id][C],A=c[C].node.clusterId;b[A]||(b[A]=0),b[A]+=T});var x=-1/0,w=[];if(Object.keys(b).forEach(function(C){x<b[C]?(x=b[C],w=[C]):x===b[C]&&w.push(C)}),w.length!==1||w[0]!==y.clusterId){var E=w.indexOf(y.clusterId);if(E>=0&&w.splice(E,1),w&&w.length){m=!0;var M=u[y.clusterId],_=M.nodes.indexOf(y);M.nodes.splice(_,1);var k=Math.floor(Math.random()*w.length),S=u[w[k]];S.nodes.push(y),y.clusterId=S.id}}}),!m)return"break";f++};f<r&&d()!=="break";);Object.keys(u).forEach(function(m){var y=u[m];y.nodes&&y.nodes.length||delete u[m]});var p=[],g={};s.forEach(function(m){var y=m.source,b=m.target,x=m[t]||1,w=c[y].node.clusterId,E=c[b].node.clusterId,M="".concat(w,"---").concat(E);if(g[M])g[M].weight+=x,g[M].count++;else{var _={source:w,target:E,weight:x,count:1};g[M]=_,p.push(_)}});var v=[];return Object.keys(u).forEach(function(m){v.push(u[m])}),{clusters:v,clusterEdges:p}},Jr=function(){function e(n){this.arr=n}return e.prototype.getArr=function(){return this.arr||[]},e.prototype.add=function(n){var t,r=n.arr;if(!(!((t=this.arr)===null||t===void 0)&&t.length))return new e(r);if(!(r!=null&&r.length))return new e(this.arr);if(this.arr.length===r.length){var i=[];for(var o in this.arr)i[o]=this.arr[o]+r[o];return new e(i)}},e.prototype.subtract=function(n){var t,r=n.arr;if(!(!((t=this.arr)===null||t===void 0)&&t.length))return new e(r);if(!(r!=null&&r.length))return new e(this.arr);if(this.arr.length===r.length){var i=[];for(var o in this.arr)i[o]=this.arr[o]-r[o];return new e(i)}},e.prototype.avg=function(n){var t=[];if(n!==0)for(var r in this.arr)t[r]=this.arr[r]/n;return new e(t)},e.prototype.negate=function(){var n=[];for(var t in this.arr)n[t]=-this.arr[t];return new e(n)},e.prototype.squareEuclideanDistance=function(n){var t,r=n.arr;if(!(!((t=this.arr)===null||t===void 0)&&t.length)||!(r!=null&&r.length))return 0;if(this.arr.length===r.length){var i=0;for(var o in this.arr)i+=Math.pow(this.arr[o]-n.arr[o],2);return i}},e.prototype.euclideanDistance=function(n){var t,r=n.arr;if(!(!((t=this.arr)===null||t===void 0)&&t.length)||!(r!=null&&r.length))return 0;if(this.arr.length===r.length){var i=0;for(var o in this.arr)i+=Math.pow(this.arr[o]-n.arr[o],2);return Math.sqrt(i)}},e.prototype.normalize=function(){var n=[],t=Kt(this.arr);t.sort(function(a,s){return a-s});var r=t[t.length-1],i=t[0];for(var o in this.arr)n[o]=(this.arr[o]-i)/(r-i);return new e(n)},e.prototype.norm2=function(){var n;if(!(!((n=this.arr)===null||n===void 0)&&n.length))return 0;var t=0;for(var r in this.arr)t+=Math.pow(this.arr[r],2);return Math.sqrt(t)},e.prototype.dot=function(n){var t,r=n.arr;if(!(!((t=this.arr)===null||t===void 0)&&t.length)||!(r!=null&&r.length))return 0;if(this.arr.length===r.length){var i=0;for(var o in this.arr)i+=this.arr[o]*n.arr[o];return i}},e.prototype.equal=function(n){var t,r=n.arr;if(((t=this.arr)===null||t===void 0?void 0:t.length)!==(r==null?void 0:r.length))return!1;for(var i in this.arr)if(this.arr[i]!==r[i])return!1;return!0},e}(),k0=function(e,n){n===void 0&&(n=void 0);var t=[];return e.forEach(function(r){n===void 0&&t.push(r),r[n]!==void 0&&t.push(r[n])}),t};(bi||(bi={})).EuclideanDistance="euclideanDistance";var C0=function(e,n,t){var r=function(a,s,u){var c=[];s!=null&&s.length?c=s:(a.forEach(function(h){c=c.concat(Object.keys(h))}),c=lc(c));var l={};return c.forEach(function(h){var f=[];a.forEach(function(d){d[h]!==void 0&&d[h]!==""&&f.push(d[h])}),f.length&&!(u!=null&&u.includes(h))&&(l[h]=lc(f))}),l}(e,n,t),i=[];if(!Object.keys(r).length)return i;var o=Object.values(r).every(function(a){return a.every(function(s){return typeof s=="number"})});return e.forEach(function(a,s){var u=[];Object.keys(r).forEach(function(c){var l=a[c],h=r[c],f=h.findIndex(function(g){return l===g}),d=[];if(o)d.push(l);else for(var p=0;p<h.length;p++)p===f?d.push(1):d.push(0);u=u.concat(d)}),i[s]=u}),i},hE=function(e,n,t,r){t===void 0&&(t=bi.EuclideanDistance);var i=0;return t===bi.EuclideanDistance&&(i=new Jr(e).euclideanDistance(new Jr(n))),i},fE=function(e,n,t,r){for(var i=n.length,o=2*r,a=0,s=0;s<i;s++)for(var u=e[s].clusterId,c=0;c<i;c++)u===e[c].clusterId&&(a+=(n[s][c]||0)-(t[s]||0)*(t[c]||0)/o);return a*=1/o},A0=function(e,n){e===void 0&&(e=[]);for(var t=e.length,r=new Jr([]),i=0;i<t;i++)r=r.add(new Jr(n[i]));var o=r.avg(t);o.normalize();var a=0;for(i=0;i<t;i++)a+=(u=new Jr(n[i])).squareEuclideanDistance(o);var s=[];for(e.forEach(function(){s.push([])}),i=0;i<t;i++){var u=new Jr(n[i]);e[i].clusterInertial=0;for(var c=0;c<t;c++)if(i!==c){var l=new Jr(n[c]);s[i][c]=u.squareEuclideanDistance(l),e[i].clusterInertial+=s[i][c]}else s[i][c]=0}var h=0,f=2*t*a;for(i=0;i<t;i++){var d=e[i].clusterId;for(c=0;c<t;c++){var p=e[c].clusterId;i!==c&&d===p&&(h+=e[i].clusterInertial*e[c].clusterInertial/Math.pow(f,2)-s[i][c]/f)}}return Number(h.toFixed(4))},I0=function(e,n,t,r,i,o,a,s,u){n===void 0&&(n=!1),t===void 0&&(t="weight"),r===void 0&&(r=1e-4),i===void 0&&(i=!1),o===void 0&&(o=void 0),a===void 0&&(a=[]),s===void 0&&(s=["id"]),u===void 0&&(u=1);var c=e.nodes,l=c===void 0?[]:c,h=e.edges,f=h===void 0?[]:h,d=[];if(i){l.forEach(function(N,R){N.properties=N.properties||{},N.originIndex=R});var p=[];l.every(function(N){return N.hasOwnProperty("nodeType")})&&(p=Array.from(new Set(l.map(function(N){return N.nodeType}))),l.forEach(function(N){N.properties.nodeType=p.findIndex(function(R){return R===N.nodeType})}));var g=k0(l,o);d=C0(g,a,s)}var v=1,m={},y={};l.forEach(function(N,R){var P=String(v++);N.clusterId=P,m[P]={id:P,nodes:[N]},y[N.id]={node:N,idx:R}});var b=Va(e,n),x=[],w={},E=0;b.forEach(function(N,R){var P=0,H=l[R].id;w[H]={},N.forEach(function(ne,Z){if(ne){P+=ne;var q=l[Z].id;w[H][q]=ne,E+=ne}}),x.push(P)}),E/=2;for(var M=1/0,_=1/0,k=0,S=[],C={};;){M=i&&l.every(function(N){return N.hasOwnProperty("properties")})?fE(l,b,x,E)+A0(l,d)*u:fE(l,b,x,E),k===0&&(_=M,S=l,C=m);var T=M>0&&M>_&&M-_<r;if(M>_&&(S=l.map(function(N){return{node:N,clusterId:N.clusterId}}),C=Kt(m),_=M),T||k>100)break;k++,Object.keys(m).forEach(function(N){var R=0;f.forEach(function(P){var H=P.source,ne=P.target,Z=y[H].node.clusterId,q=y[ne].node.clusterId;(Z===N&&q!==N||q===N&&Z!==N)&&(R+=P[t]||1)}),m[N].sumTot=R}),l.forEach(function(N,R){var P,H=m[N.clusterId],ne=0,Z=x[R]/(2*E),q=0,te=H.nodes;te.forEach(function(Te){var Xe=y[Te.id].idx;q+=b[R][Xe]||0});var we=q-H.sumTot*Z,pe=te.filter(function(Te){return Te.id!==N.id});pe.forEach(function(Te,Xe){d[Te.originIndex]});var Me=A0(pe,d)*u,Be=w[N.id];if(Object.keys(Be).forEach(function(Te){var Xe=y[Te].node.clusterId;if(Xe!==N.clusterId){var Oe=m[Xe],Se=Oe.nodes;if(Se&&Se.length){var We=0;Se.forEach(function(Ze){var Je=y[Ze.id].idx;We+=b[R][Je]||0});var Ve=We-Oe.sumTot*Z,O=Se.concat([N]);O.forEach(function(Ze,Je){d[Ze.originIndex]});var he=A0(O,d)*u,_e=Ve-we;i&&(_e=Ve+he-(we+Me)),_e>ne&&(ne=_e,P=Oe)}}}),ne>0){P.nodes.push(N);var dt=N.clusterId;N.clusterId=P.id;var It=H.nodes.indexOf(N);H.nodes.splice(It,1);var at=0,Ue=0;f.forEach(function(Te){var Xe=Te.source,Oe=Te.target,Se=y[Xe].node.clusterId,We=y[Oe].node.clusterId;(Se===P.id&&We!==P.id||We===P.id&&Se!==P.id)&&(at+=Te[t]||1),(Se===dt&&We!==dt||We===dt&&Se!==dt)&&(Ue+=Te[t]||1)}),P.sumTot=at,H.sumTot=Ue}})}var A={},D=0;Object.keys(C).forEach(function(N){var R=C[N];if(R.nodes&&R.nodes.length){var P=String(D+1);P!==N&&(R.id=P,R.nodes=R.nodes.map(function(H){return{id:H.id,clusterId:P}}),C[P]=R,A[N]=P,delete C[N],D++)}else delete C[N]}),S.forEach(function(N){var R=N.node,P=N.clusterId;R&&(R.clusterId=P,R.clusterId&&A[R.clusterId]&&(R.clusterId=A[R.clusterId]))});var j=[],L={};f.forEach(function(N){var R=N.source,P=N.target,H=N[t]||1,ne=y[R].node.clusterId,Z=y[P].node.clusterId;if(ne&&Z){var q="".concat(ne,"---").concat(Z);if(L[q])L[q].weight+=H,L[q].count++;else{var te={source:ne,target:Z,weight:H,count:1};L[q]=te,j.push(te)}}});var B=[];return Object.keys(C).forEach(function(N){B.push(C[N])}),{clusters:B,clusterEdges:j}},dE=function(e,n,t,r,i,o,a,s){return n===void 0&&(n=!1),t===void 0&&(t="weight"),r===void 0&&(r=1e-4),i===void 0&&(i=void 0),o===void 0&&(o=[]),a===void 0&&(a=["id"]),s===void 0&&(s=1),I0(e,n,t,r,!0,i,o,a,s)},pE=function(e,n){var t;n===void 0&&(n=1);for(var r=Kt(e),i=r.nodes,o=i===void 0?[]:i,a=r.edges,s=a===void 0?[]:a,u=function(){var c=go({nodes:o,edges:s}),l=Object.keys(c);l.sort(function(d,p){var g,v;return((g=c[d])===null||g===void 0?void 0:g.degree)-((v=c[p])===null||v===void 0?void 0:v.degree)});var h=l[0];if(!o.length||((t=c[h])===null||t===void 0?void 0:t.degree)>=n)return"break";var f=o.findIndex(function(d){return d.id===h});o.splice(f,1),s=s.filter(function(d){return!(d.source===h||d.target===h)})};u()!=="break";);return{nodes:o,edges:s}},gE=function(e,n,t){var r=[];return e===bi.EuclideanDistance?r=n[t]:r=[],r},vE=function(e,n,t,r,i,o){n===void 0&&(n=3),t===void 0&&(t=void 0),r===void 0&&(r=[]),i===void 0&&(i=["id"]),o===void 0&&(o=bi.EuclideanDistance);var a=e.nodes,s=a===void 0?[]:a,u=e.edges,c=u===void 0?[]:u,l={clusters:[{id:"0",nodes:s}],clusterEdges:[]};if(o===bi.EuclideanDistance&&!s.every(function(P){return P.hasOwnProperty(t)}))return l;var h=[],f=[];if(o===bi.EuclideanDistance&&(h=k0(s,t),f=C0(h,r,i)),!f.length)return l;for(var d=lc(f.map(function(P){return P.join("")})),p=Math.min(n,s.length,d.length),g=0;g<s.length;g++)s[g].originIndex=g;var v=[],m=[],y=[];for(g=0;g<p;g++)if(g===0){var b=Math.floor(Math.random()*s.length);o===bi.EuclideanDistance?v[g]=f[b]:v[g]=[],m.push(b),y[g]=[s[b]],s[b].clusterId=String(g)}else{for(var x=-1/0,w=0,E=function(P){if(!m.includes(P)){for(var H=0,ne=0;ne<v.length;ne++){var Z=0;o===bi.EuclideanDistance&&(Z=hE(f[s[P].originIndex],v[ne],o)),H+=Z}var q=H/v.length;q>x&&!v.find(function(te){return qo(te,gE(o,f,s[P].originIndex))})&&(x=q,w=P)}},M=0;M<s.length;M++)E(M);v[g]=gE(o,f,w),m.push(w),y[g]=[s[w]],s[w].clusterId=String(g)}for(var _=0;;){for(g=0;g<s.length;g++){var k=0,S=1/0;if(_!==0||!m.includes(g)){for(var C=0;C<v.length;C++){var T=0;o===bi.EuclideanDistance&&(T=hE(f[g],v[C],o)),T<S&&(S=T,k=C)}if(s[g].clusterId!==void 0)for(var A=y[Number(s[g].clusterId)].length-1;A>=0;A--)y[Number(s[g].clusterId)][A].id===s[g].id&&y[Number(s[g].clusterId)].splice(A,1);s[g].clusterId=String(k),y[k].push(s[g])}}var D=!1;for(g=0;g<y.length;g++){var j=y[g],L=new Jr([]);for(C=0;C<j.length;C++)L=L.add(new Jr(f[j[C].originIndex]));var B=L.avg(j.length);B.equal(new Jr(v[g]))||(D=!0,v[g]=B.getArr())}if(_++,s.every(function(P){return P.clusterId!==void 0})&&D||_>=1e3)break}var N=[],R={};return c.forEach(function(P){var H,ne,Z=P.source,q=P.target,te=(H=s.find(function(Be){return Be.id===Z}))===null||H===void 0?void 0:H.clusterId,we=(ne=s.find(function(Be){return Be.id===q}))===null||ne===void 0?void 0:ne.clusterId,pe="".concat(te,"---").concat(we);if(R[pe])R[pe].count++;else{var Me={source:te,target:we,count:1};R[pe]=Me,N.push(Me)}}),{clusters:y,clusterEdges:N}},T0=function(e,n){var t=new Jr(n),r=t.norm2(),i=new Jr(e),o=i.norm2(),a=t.dot(i),s=r*o,u=s?a/s:0;return u},mE=function(e,n,t,r,i){e===void 0&&(e=[]),t===void 0&&(t=void 0),r===void 0&&(r=[]),i===void 0&&(i=[]);var o=Kt(e.filter(function(h){return h.id!==n.id})),a=e.findIndex(function(h){return h.id===n.id}),s=k0(e,t),u=C0(s,r,i),c=u[a],l=[];return o.forEach(function(h,f){if(h.id!==n.id){var d=u[f],p=T0(d,c);l.push(p),h.cosineSimilarity=p}}),o.sort(function(h,f){return f.cosineSimilarity-h.cosineSimilarity}),{allCosineSimilarity:l,similarNodes:o}},a4=function(){function e(n){this.count=n.length,this.parent={};for(var t=0,r=n;t<r.length;t++){var i=r[t];this.parent[i]=i}}return e.prototype.find=function(n){for(;this.parent[n]!==n;)n=this.parent[n];return n},e.prototype.union=function(n,t){var r=this.find(n),i=this.find(t);r!==i&&(r<i?(this.parent[t]!==t&&this.union(this.parent[t],n),this.parent[t]=this.parent[n]):(this.parent[n]!==n&&this.union(this.parent[n],t),this.parent[n]=this.parent[t]))},e.prototype.connected=function(n,t){return this.find(n)===this.find(t)},e}(),s4=function(e,n){return e-n},u4=function(){function e(n){n===void 0&&(n=s4),this.compareFn=n,this.list=[]}return e.prototype.getLeft=function(n){return 2*n+1},e.prototype.getRight=function(n){return 2*n+2},e.prototype.getParent=function(n){return n===0?null:Math.floor((n-1)/2)},e.prototype.isEmpty=function(){return this.list.length<=0},e.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},e.prototype.delMin=function(){var n=this.top(),t=this.list.pop();return this.list.length>0&&(this.list[0]=t,this.moveDown(0)),n},e.prototype.insert=function(n){if(n!==null){this.list.push(n);var t=this.list.length-1;return this.moveUp(t),!0}return!1},e.prototype.moveUp=function(n){for(var t=this.getParent(n);n&&n>0&&this.compareFn(this.list[t],this.list[n])>0;){var r=this.list[t];this.list[t]=this.list[n],this.list[n]=r,n=t,t=this.getParent(n)}},e.prototype.moveDown=function(n){var t,r=n,i=this.getLeft(n),o=this.getRight(n),a=this.list.length;i!==null&&i<a&&this.compareFn(this.list[r],this.list[i])>0?r=i:o!==null&&o<a&&this.compareFn(this.list[r],this.list[o])>0&&(r=o),n!==r&&(t=[this.list[r],this.list[n]],this.list[n]=t[0],this.list[r]=t[1],this.moveDown(r))},e}(),c4=function(e,n){var t=[],r=e.nodes,i=r===void 0?[]:r,o=e.edges,a=o===void 0?[]:o;if(i.length===0)return t;var s=i[0],u=new Set;u.add(s);var c=new u4(function(d,p){return n?d.weight-p.weight:0});for(Qh(s.id,a).forEach(function(d){c.insert(d)});!c.isEmpty();){var l=c.delMin(),h=l.source,f=l.target;u.has(h)&&u.has(f)||(t.push(l),u.has(h)||(u.add(h),Qh(h,a).forEach(function(d){c.insert(d)})),u.has(f)||(u.add(f),Qh(f,a).forEach(function(d){c.insert(d)})))}return t},yE=function(e,n){var t=[],r=e.nodes,i=r===void 0?[]:r,o=e.edges,a=o===void 0?[]:o;if(i.length===0)return t;var s=a.map(function(f){return f});n&&s.sort(function(f,d){return f.weight-d.weight});for(var u=new a4(i.map(function(f){return f.id}));s.length>0;){var c=s.shift(),l=c.source,h=c.target;u.connected(l,h)||(t.push(c),u.union(l,h))}return t},bE=function(e,n,t){return t?{prim:c4,kruskal:yE}[t](e,n):yE(e,n)},xE=function(e,n,t){typeof n!="number"&&(n=1e-6),typeof t!="number"&&(t=.85);for(var r,i=1,o=0,a=1e3,s=e.nodes,u=s===void 0?[]:s,c=e.edges,l=c===void 0?[]:c,h=u.length,f={},d={},p=0;p<h;++p)f[v=(w=u[p]).id]=1/h,d[v]=1/h;for(var g=go(e);a>0&&i>n;){for(o=0,p=0;p<h;++p){var v=(w=u[p]).id;if(r=0,g[w.id].inDegree===0)f[v]=0;else{for(var m=zr(v,l,"source"),y=0;y<m.length;++y){var b=m[y],x=g[b].outDegree;x>0&&(r+=d[b]/x)}f[v]=t*r,o+=f[v]}}for(o=(1-o)/h,i=0,p=0;p<h;++p){var w;r=f[v=(w=u[p]).id]+o,i+=Math.abs(r-d[v]),d[v]=r}a-=1}return d},Yi="-1",wE=function(e,n,t,r){e===void 0&&(e=-1),n===void 0&&(n=-1),t===void 0&&(t=-1),r===void 0&&(r="-1"),this.id=e,this.from=n,this.to=t,this.label=r},l4=function(){function e(n,t){n===void 0&&(n=-1),t===void 0&&(t=Yi),this.id=n,this.label=t,this.edges=[],this.edgeMap={}}return e.prototype.addEdge=function(n){this.edges.push(n),this.edgeMap[n.id]=n},e}(),EE=function(){function e(n,t,r){n===void 0&&(n=-1),t===void 0&&(t=!0),r===void 0&&(r=!1),this.id=n,this.edgeIdAutoIncrease=t,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=r}return e.prototype.getNodeNum=function(){return this.nodes.length},e.prototype.addNode=function(n,t){if(!this.nodeMap[n]){var r=new l4(n,t);this.nodes.push(r),this.nodeMap[n]=r,this.nodeLabelMap[t]||(this.nodeLabelMap[t]=[]),this.nodeLabelMap[t].push(n)}},e.prototype.addEdge=function(n,t,r,i){if((this.edgeIdAutoIncrease||n===void 0)&&(n=this.counter++),!(this.nodeMap[t]&&this.nodeMap[r]&&this.nodeMap[r].edgeMap[n])){var o=new wE(n,t,r,i);if(this.edges.push(o),this.edgeMap[n]=o,this.nodeMap[t].addEdge(o),this.edgeLabelMap[i]||(this.edgeLabelMap[i]=[]),this.edgeLabelMap[i].push(o),!this.directed){var a=new wE(n,r,t,i);this.nodeMap[r].addEdge(a),this.edgeLabelMap[i].push(a)}}},e}(),Ha=function(){function e(n,t,r,i,o){this.fromNode=n,this.toNode=t,this.nodeEdgeNodeLabel={nodeLabel1:r||Yi,edgeLabel:i||"-1",nodeLabel2:o||Yi}}return e.prototype.equalTo=function(n){return this.fromNode===n.formNode&&this.toNode===n.toNode&&this.nodeEdgeNodeLabel===n.nodeEdgeNodeLabel},e.prototype.notEqualTo=function(n){return!this.equalTo(n)},e}(),ME=function(){function e(){this.rmpath=[],this.dfsEdgeList=[]}return e.prototype.equalTo=function(n){var t=this.dfsEdgeList.length;if(t!==n.length)return!1;for(var r=0;r<t;r++)if(this.dfsEdgeList[r]!==n[r])return!1;return!0},e.prototype.notEqualTo=function(n){return!this.equalTo(n)},e.prototype.pushBack=function(n,t,r,i,o){return this.dfsEdgeList.push(new Ha(n,t,r,i,o)),this.dfsEdgeList},e.prototype.toGraph=function(n,t){n===void 0&&(n=-1),t===void 0&&(t=!1);var r=new EE(n,!0,t);return this.dfsEdgeList.forEach(function(i){var o=i.fromNode,a=i.toNode,s=i.nodeEdgeNodeLabel,u=s.nodeLabel1,c=s.edgeLabel,l=s.nodeLabel2;u!==Yi&&r.addNode(o,u),l!==Yi&&r.addNode(a,l),u!==Yi&&l!==u&&r.addEdge(void 0,o,a,c)}),r},e.prototype.buildRmpath=function(){this.rmpath=[];for(var n=void 0,t=this.dfsEdgeList.length-1;t>=0;t--){var r=this.dfsEdgeList[t],i=r.fromNode,o=r.toNode;i<o&&(n===void 0||o===n)&&(this.rmpath.push(t),n=i)}return this.rmpath},e.prototype.getNodeNum=function(){var n={};return this.dfsEdgeList.forEach(function(t){n[t.fromNode]||(n[t.fromNode]=!0),n[t.toNode]||(n[t.toNode]=!0)}),Object.keys(n).length},e}(),Jh=function(){function e(n){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],n){for(;n;){var t=n.edge;this.edges.push(t),this.nodesUsed[t.from]=1,this.nodesUsed[t.to]=1,this.edgesUsed[t.id]=1,n=n.preNode}this.edges=this.edges.reverse()}}return e.prototype.hasNode=function(n){return this.nodesUsed[n.id]===1},e.prototype.hasEdge=function(n){return this.edgesUsed[n.id]===1},e}(),h4=function(){function e(n){var t=n.graphs,r=n.minSupport,i=r===void 0?2:r,o=n.minNodeNum,a=o===void 0?1:o,s=n.maxNodeNum,u=s===void 0?4:s,c=n.top,l=c===void 0?10:c,h=n.directed,f=h!==void 0&&h,d=n.verbose,p=d!==void 0&&d;this.graphs=t,this.dfsCode=new ME,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=i,this.top=l,this.directed=f,this.counter=0,this.maxNodeNum=u,this.minNodeNum=a,this.verbose=p,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}return e.prototype.findForwardRootEdges=function(n,t){var r=this,i=[],o=n.nodeMap;return t.edges.forEach(function(a){(r.directed||t.label<=o[a.to].label)&&i.push(a)}),i},e.prototype.findBackwardEdge=function(n,t,r,i){if(!this.directed&&t===r)return null;for(var o=n.nodeMap,a=o[r.to].edges,s=a.length,u=0;u<s;u++){var c=a[u];if(!i.hasEdge(c)&&c.to===t.from){if(this.directed){if(o[t.from].label<o[r.to].label||o[t.from].label===o[r.to].label&&t.label<=c.label)return c}else if(t.label<c.label||t.label===c.label&&o[t.to].label<=o[r.to].label)return c}}return null},e.prototype.findForwardPureEdges=function(n,t,r,i){for(var o=[],a=t.to,s=n.nodeMap[a].edges,u=s.length,c=0;c<u;c++){var l=s[c],h=n.nodeMap[l.to];r<=h.label&&!i.hasNode(h)&&o.push(l)}return o},e.prototype.findForwardRmpathEdges=function(n,t,r,i){for(var o=[],a=n.nodeMap,s=a[t.to].label,u=a[t.from].edges,c=u.length,l=0;l<c;l++){var h=u[l],f=a[h.to].label;t.to===h.to||r>f||i.hasNode(a[h.to])||(t.label<h.label||t.label===h.label&&s<=f)&&o.push(h)}return o},e.prototype.getSupport=function(n){var t={};return n.forEach(function(r){t[r.graphId]||(t[r.graphId]=!0)}),Object.keys(t).length},e.prototype.findMinLabel=function(n){var t=void 0;return Object.keys(n).forEach(function(r){var i=n[r],o=i.nodeLabel1,a=i.edgeLabel,s=i.nodeLabel2;t?(o<t.nodeLabel1||o===t.nodeLabel1&&a<t.edgeLabel||o===t.nodeLabel1&&a===t.edgeLabel&&s<t.nodeLabel2)&&(t={nodeLabel1:o,edgeLabel:a,nodeLabel2:s}):t={nodeLabel1:o,edgeLabel:a,nodeLabel2:s}}),t},e.prototype.isMin=function(){var n=this,t=this.dfsCode;if(this.verbose,t.dfsEdgeList.length===1)return!0;var r=this.directed,i=t.toGraph(-1,r),o=i.nodeMap,a=new ME,s={};i.nodes.forEach(function(l){n.findForwardRootEdges(i,l).forEach(function(h){var f=o[h.to],d="".concat(l.label,"-").concat(h.label,"-").concat(f.label);s[d]||(s[d]={projected:[],nodeLabel1:l.label,edgeLabel:h.label,nodeLabel2:f.label});var p={graphId:i.id,edge:h,preNode:null};s[d].projected.push(p)})});var u=this.findMinLabel(s);if(u){a.dfsEdgeList.push(new Ha(0,1,u.nodeLabel1,u.edgeLabel,u.nodeLabel2));var c="".concat(u.nodeLabel1,"-").concat(u.edgeLabel,"-").concat(u.nodeLabel2);return function l(h){for(var f=a.buildRmpath(),d=a.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,p=a.dfsEdgeList[f[0]].toNode,g={},v=!1,m=0,y=r?-1:0,b=function(A){if(v)return"break";h.forEach(function(D){var j=new Jh(D),L=n.findBackwardEdge(i,j.edges[f[A]],j.edges[f[0]],j);L&&(g[L.label]||(g[L.label]={projected:[],edgeLabel:L.label}),g[L.label].projected.push({graphId:i.id,edge:g,preNode:D}),m=a.dfsEdgeList[f[A]].fromNode,v=!0)})},x=f.length-1;x>y&&b(x)!=="break";x--);if(v){var w=n.findMinLabel(g);a.dfsEdgeList.push(new Ha(p,m,Yi,w.edgeLabel,Yi));var E=a.dfsEdgeList.length-1;return n.dfsCode.dfsEdgeList[E]===a.dfsEdgeList[E]&&l(g[w.edgeLabel].projected)}var M={};v=!1;var _=0;h.forEach(function(A){var D=new Jh(A),j=n.findForwardPureEdges(i,D.edges[f[0]],d,D);j.length>0&&(v=!0,_=p,j.forEach(function(L){var B="".concat(L.label,"-").concat(o[L.to].label);M[B]||(M[B]={projected:[],edgeLabel:L.label,nodeLabel2:o[L.to].label}),M[B].projected.push({graphId:i.id,edge:L,preNode:A})}))});var k=f.length,S=function(A){if(v)return"break";var D=f[A];h.forEach(function(j){var L=new Jh(j),B=n.findForwardRmpathEdges(i,L.edges[D],d,L);B.length>0&&(v=!0,_=a.dfsEdgeList[D].fromNode,B.forEach(function(N){var R="".concat(N.label,"-").concat(o[N.to].label);M[R]||(M[R]={projected:[],edgeLabel:N.label,nodeLabel2:o[N.to].label}),M[R].projected.push({graphId:i.id,edge:N,preNode:j})}))})};for(x=0;x<k&&S(x)!=="break";x++);if(!v)return!0;var C=n.findMinLabel(M);a.dfsEdgeList.push(new Ha(_,p+1,Yi,C.edgeLabel,C.nodeLabel2));var T=a.dfsEdgeList.length-1;return t.dfsEdgeList[T]===a.dfsEdgeList[T]&&l(M["".concat(C.edgeLabel,"-").concat(C.nodeLabel2)].projected)}(s[c].projected)}},e.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var n=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push(Kt(n))}},e.prototype.subGraphMining=function(n){var t=this;if(!(this.getSupport(n)<this.minSupport)&&this.isMin()){this.report();var r=this.dfsCode.getNodeNum(),i=this.dfsCode.buildRmpath(),o=this.dfsCode.dfsEdgeList[i[0]].toNode,a=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,s={},u={};n.forEach(function(c){for(var l=t.graphs[c.graphId],h=l.nodeMap,f=new Jh(c),d=i.length-1;d>=0;d--){var p=t.findBackwardEdge(l,f.edges[i[d]],f.edges[i[0]],f);if(p){var g="".concat(t.dfsCode.dfsEdgeList[i[d]].fromNode,"-").concat(p.label);u[g]||(u[g]={projected:[],toNodeId:t.dfsCode.dfsEdgeList[i[d]].fromNode,edgeLabel:p.label}),u[g].projected.push({graphId:c.graphId,edge:p,preNode:c})}}if(!(r>=t.maxNodeNum)){t.findForwardPureEdges(l,f.edges[i[0]],a,f).forEach(function(m){var y="".concat(o,"-").concat(m.label,"-").concat(h[m.to].label);s[y]||(s[y]={projected:[],fromNodeId:o,edgeLabel:m.label,nodeLabel2:h[m.to].label}),s[y].projected.push({graphId:c.graphId,edge:m,preNode:c})});var v=function(m){t.findForwardRmpathEdges(l,f.edges[i[m]],a,f).forEach(function(y){var b="".concat(t.dfsCode.dfsEdgeList[i[m]].fromNode,"-").concat(y.label,"-").concat(h[y.to].label);s[b]||(s[b]={projected:[],fromNodeId:t.dfsCode.dfsEdgeList[i[m]].fromNode,edgeLabel:y.label,nodeLabel2:h[y.to].label}),s[b].projected.push({graphId:c.graphId,edge:y,preNode:c})})};for(d=0;d<i.length;d++)v(d)}}),Object.keys(u).forEach(function(c){var l=u[c],h=l.toNodeId,f=l.edgeLabel;t.dfsCode.dfsEdgeList.push(new Ha(o,h,"-1",f,"-1")),t.subGraphMining(u[c].projected),t.dfsCode.dfsEdgeList.pop()}),Object.keys(s).forEach(function(c){var l=s[c],h=l.fromNodeId,f=l.edgeLabel,d=l.nodeLabel2;t.dfsCode.dfsEdgeList.push(new Ha(h,o+1,Yi,f,d)),t.subGraphMining(s[c].projected),t.dfsCode.dfsEdgeList.pop()})}},e.prototype.generate1EdgeFrequentSubGraphs=function(){var n=this.graphs,t=this.directed,r=this.minSupport,i=this.frequentSize1Subgraphs,o={},a={},s={};return Object.keys(n).forEach(function(u){var c=n[u],l=c.nodeMap;c.nodes.forEach(function(h,f){var d=h.label,p="".concat(u,"-").concat(d);if(!s[p]){var g=o[d]||0;g++,o[d]=g}s[p]={graphKey:u,label:d},h.edges.forEach(function(v){var m=d,y=l[v.to].label;if(!t&&m>y){var b=y;y=m,m=b}var x=v.label,w="".concat(m,"-").concat(x,"-").concat(y);if(!a[w]){var E=a[w]||0;E++,a[w]=E}})})}),Object.keys(o).forEach(function(u){if(!(o[u]<r)){var c={nodes:[],edges:[]};c.nodes.push({id:"0",label:u}),i.push(c)}}),i},e.prototype.run=function(){var n=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var t=this.graphs;this.directed;var r={};Object.keys(t).forEach(function(i){var o=t[i],a=o.nodeMap;o.nodes.forEach(function(s){n.findForwardRootEdges(o,s).forEach(function(u){var c=a[u.to],l="".concat(s.label,"-").concat(u.label,"-").concat(c.label);r[l]||(r[l]={projected:[],nodeLabel1:s.label,edgeLabel:u.label,nodeLabel2:c.label});var h={graphId:i,edge:u,preNode:null};r[l].projected.push(h)})})}),Object.keys(r).forEach(function(i){var o=r[i],a=o.projected,s=o.nodeLabel1,u=o.edgeLabel,c=o.nodeLabel2;n.dfsCode.dfsEdgeList.push(new Ha(0,1,s,u,c)),n.subGraphMining(a),n.dfsCode.dfsEdgeList.pop()})}},e}(),SE="cluster",f4=function(e){var n=e.graphs,t=e.directed,r=t!==void 0&&t,i=e.nodeLabelProp,o=i===void 0?SE:i,a=e.edgeLabelProp,s=a===void 0?SE:a,u=function(v,m,y,b){var x={};return Object.keys(v).forEach(function(w,E){var M=v[w],_=new EE(E,!0,m),k={};M.nodes.forEach(function(S,C){_.addNode(C,S[y]),k[S.id]=C}),M.edges.forEach(function(S,C){var T=k[S.source],A=k[S.target];_.addEdge(-1,T,A,S[b])}),_&&_.getNodeNum()&&(x[_.id]=_)}),x}(n,r,o,s),c=e.minSupport,l=e.maxNodeNum,h=e.minNodeNum,f=e.verbose,d=e.top,p=new h4({graphs:u,minSupport:c,maxNodeNum:l,minNodeNum:h,top:d,verbose:f,directed:r});p.run();var g=function(v,m,y){var b=[];return v.forEach(function(x){var w={nodes:[],edges:[]};x.nodes.forEach(function(E){var M;w.nodes.push(((M={id:"".concat(E.id)})[m]=E.label,M))}),x.edges.forEach(function(E){var M;w.edges.push(((M={source:"".concat(E.from),target:"".concat(E.to)})[y]=E.label,M))}),b.push(w)}),b}(p.frequentSubgraphs,o,s);return g},_E=function(e,n,t,r){t===void 0&&(t="cluster"),r===void 0&&(r=2);var i=[],o=e.nodes;return n.forEach(function(a,s){i.push(kE(o,a,s,t,r))}),i},kE=function(e,n,t,r,i){var o=[t],a=[],s={};return n.forEach(function(u,c){if(u<=i&&t!==c){o.push(c),a.push(e[c]);var l=e[c][r];s[l]?(s[l].count++,s[l].dists.push(u)):s[l]={count:1,dists:[u]}}}),Object.keys(s).forEach(function(u){s[u].dists=s[u].dists.sort(function(c,l){return c-l})}),{nodeIdx:t,nodeId:e[t].id,nodeIdxs:o,neighbors:a,neighborNum:o.length-1,nodeLabelCountMap:s}},ef=function(e,n,t,r){var i=t.nodes;return r||(r={}),Object.keys(e).forEach(function(o){var a,s;if(!r||!r[o]){r[o]={nodes:[],edges:[]};var u=e[o],c=(a=n[u.start])===null||a===void 0?void 0:a.nodeIdxs,l=(s=n[u.end])===null||s===void 0?void 0:s.nodeIdxs;if(c&&l){var h=new Set(l),f=c.filter(function(m){return h.has(m)});if(f&&f.length){for(var d={},p=f.length,g=0;g<p;g++){var v=i[f[g]];r[o].nodes.push(v),d[v.id]=!0}t.edges.forEach(function(m){d[m.source]&&d[m.target]&&r[o].edges.push(m)})}}}}),r},tf=function(e,n,t,r){var i,o,a={};e.nodes.forEach(function(u){a[u.id]=u});var s=0;return!(!((i=n==null?void 0:n.edges)===null||i===void 0)&&i.length)||((o=n==null?void 0:n.nodes)===null||o===void 0?void 0:o.length)<2?0:(e.edges.forEach(function(u){var c=a[u.source][t],l=a[u.target][t],h=n==null?void 0:n.nodes[0][t],f=n==null?void 0:n.nodes[1][t],d=n==null?void 0:n.edges[0][r];u[r]===d&&(c===h&&l===f||c===f&&l===h)&&s++}),s)},CE=function(e,n){var t={},r={};return e.forEach(function(i,o){t[i.id]={idx:o,node:i,degree:0,inDegree:0,outDegree:0};var a=i[n];r[a]||(r[a]=[]),r[a].push(i)}),{nodeMap:t,nodeLabelMap:r}},AE=function(e,n,t){var r={},i={};return e.forEach(function(o,a){r["".concat(eE)]={idx:a,edge:o};var s=o[n];i[s]||(i[s]=[]),i[s].push(o);var u=t[o.source];u&&(u.degree++,u.outDegree++);var c=t[o.target];c&&(c.degree++,c.inDegree++)}),{edgeMap:r,edgeLabelMap:i}},IE=function(e,n,t){var r=n.length,i={};return n.forEach(function(o,a){for(var s=t?0:a+1,u=e[a].id,c=s;c<r;c++)if(a!==c){var l=e[c].id,h=o[c];i["".concat(u,"-").concat(l)]=h,t||(i["".concat(l,"-").concat(u)]=h)}}),i},d4=function(e,n,t,r,i,o,a,s,u,c,l){var h,f="".concat(n.id,"-").concat(t.id);if(c&&c[f])return c[f];var d=l?l[f]:void 0;if(!d){var p=((h={})[f]={start:r[n.id].idx,end:r[t.id].idx,distance:i},h);d=(l=ef(p,o,e,l))[f]}return tf(d,a,s,u)},TE=function(e,n,t,r){var i,o,a,s=(i=e[n])===null||i===void 0?void 0:i.degree,u=(o=e[n])===null||o===void 0?void 0:o.inDegree,c=(a=e[n])===null||a===void 0?void 0:a.outDegree;return e[n]===void 0&&(s=1/0,u=1/0,c=1/0,r[n].forEach(function(l){var h=t[l.id].degree;s>h&&(s=h);var f=t[l.id].inDegree;u>f&&(u=f);var d=t[l.id].outDegree;c>d&&(c=d)}),e[n]={degree:s,inDegree:u,outDegree:c}),{minPatternNodeLabelDegree:s,minPatternNodeLabelInDegree:u,minPatternNodeLabelOutDegree:c}},OE=function(e,n,t,r,i,o,a){var s;if(t===void 0&&(t=!1),o===void 0&&(o="cluster"),a===void 0&&(a="cluster"),e&&e.nodes){var u=e.nodes.length;if(u){var c=mc(e,t),l=mc(n,t),h=IE(e.nodes,c,t),f=IE(n.nodes,l,t),d=CE(e.nodes,o),p=d.nodeMap,g=d.nodeLabelMap,v=CE(n.nodes,o),m=v.nodeMap,y=v.nodeLabelMap;AE(e.edges,a,p);var b=AE(n.edges,a,m).edgeLabelMap,x=[];l==null||l.forEach(function(at){x=x.concat(at)}),i||(i=Math.max.apply(Math,Br(Br([],x,!1),[2],!1))),r||(r=i);var w=_E(e,c,o,r),E=_E(n,l,o,r),M=function(at,Ue,Te,Xe,Oe){var Se=Math.ceil(Te/Ue),We={},Ve=0;return Xe.forEach(function(O,he){for(var _e=0,Ze=0,Je=O.nodeIdxs,qe=O.neighborNum-1;_e<Se;){for(var vt=Je[1+Math.floor(Math.random()*qe)],pt=0;(We["".concat(he,"-").concat(vt)]||We["".concat(vt,"-").concat(he)])&&(vt=Math.floor(Math.random()*Ue),!(++pt>2*Ue)););if(pt<2*Ue&&(We["".concat(he,"-").concat(vt)]={start:he,end:vt,distance:Oe[he][vt]},_e++,++Ve>=Te))return We;if(++Ze>2*Ue)break}_e<Se&&(Se=(Se+(Se-_e))/(Ue-he-1))}),We}(0,u,Math.min(100,u*(u-1)/2),w,c),_=ef(M,w,e),k=f4({graphs:_,nodeLabelProp:o,edgeLabelProp:a,minSupport:1,minNodeNum:1,maxNodeNum:4,directed:t}).slice(0,10),S=k.length,C=[];k.forEach(function(at,Ue){C[Ue]={},Object.keys(_).forEach(function(Te){var Xe=_[Te],Oe=tf(Xe,at,o,a);C[Ue][Te]=Oe})});var T=function(at,Ue,Te){for(var Xe=1/0,Oe=0,Se=function(Ve){var O=at[Ve],he=Object.keys(O).sort(function(pt,Et){return O[pt]-O[Et]}),_e=[];he.forEach(function(pt,Et){_e[Et%10]||(_e[Et%10]={graphs:[],totalCount:0,aveCount:0}),_e[Et%10].graphs.push(pt),_e[Et%10].totalCount+=O[pt]});var Ze=0,Je=[];_e.forEach(function(pt){var Et=pt.totalCount/pt.graphs.length;pt.aveCount=Et,Je.push(Et);var Tt=0,Rt=pt.length;pt.graphs.forEach(function(ln,xn){var ar=O[ln];pt.graphs.forEach(function(Mr,hr){xn!==hr&&(Tt+=Math.abs(ar-O[Mr]))})}),Ze+=Tt/=Rt*(Rt-1)/2}),Ze/=_e.length;var qe=0;Je.forEach(function(pt,Et){Je.forEach(function(Tt,Rt){Et!==Rt&&(qe+=Math.abs(pt-Tt))}),qe/=Je.length*(Je.length-1)/2});var vt=qe-Ze;Xe<vt&&(Xe=vt,Oe=Ve)},We=0;We<Ue;We++)Se(We);return{structure:Te[Oe],structureCountMap:at[Oe]}}(C,S,k),A=T.structure,D=T.structureCountMap,j=n.nodes[0],L=[],B=(s=n.nodes[0])===null||s===void 0?void 0:s[o],N=-1/0;n.nodes.forEach(function(at){var Ue=at[o],Te=g[Ue];(Te==null?void 0:Te.length)>N&&(N=Te.length,L=Te,B=Ue,j=at)});var R={},P={},H={},ne={},Z={},q={};Object.keys(y).forEach(function(at,Ue){Z[at]=[],t&&(q[at]=[]);var Te=y[at],Xe={};Te.forEach(function(Ve){var O=f["".concat(j.id,"-").concat(Ve.id)];if(O&&Z[at].push(O),Xe["".concat(j.id,"-").concat(Ve.id)]={start:0,end:m[Ve.id].idx,distance:O},t){var he=f["".concat(Ve.id,"-").concat(j.id)];he&&q[at].push(he)}}),Z[at]=Z[at].sort(function(Ve,O){return Ve-O}),t&&(q[at]=q[at].sort(function(Ve,O){return Ve-O})),P=ef(Xe,E,n,P);var Oe=[];if(Object.keys(Xe).forEach(function(Ve){if(H[Ve])Oe.push(H[Ve]);else{var O=P[Ve];H[Ve]=tf(O,A,o,a),Oe.push(H[Ve])}}),Oe=Oe.sort(function(Ve,O){return O-Ve}),ne["".concat(j.id,"-").concat(at)]=Oe,at!==B)for(var Se=function(Ve){var O=L[Ve],he=w[p[O.id].idx],_e=he.nodeLabelCountMap[at],Ze=y[at].length;if(!_e||_e.count<Ze)return L.splice(Ve,1),"continue";for(var Je=!1,qe=0;qe<Ze;qe++)if(_e.dists[qe]>Z[at][qe]){Je=!0;break}if(Je)return L.splice(Ve,1),"continue";var vt={};he.neighbors.forEach(function(Tt){var Rt=h["".concat(O.id,"-").concat(Tt.id)];vt["".concat(O.id,"-").concat(Tt.id)]={start:p[O.id].idx,end:p[Tt.id].idx,distance:Rt}}),_=ef(vt,w,e,_);var pt=[];Object.keys(vt).forEach(function(Tt){if(D[Tt])pt.push(D[Tt]);else{var Rt=_[Tt];D[Tt]=tf(Rt,A,o,a),pt.push(D[Tt])}}),pt=pt.sort(function(Tt,Rt){return Rt-Tt});var Et=!1;for(qe=0;qe<Ze;qe++)if(pt[qe]<Oe[qe]){Et=!0;break}return Et?(L.splice(Ve,1),"continue"):void 0},We=((L==null?void 0:L.length)||0)-1;We>=0;We--)Se(We)});var te=[];L==null||L.forEach(function(at){for(var Ue=p[at.id].idx,Te=kE(e.nodes,c[Ue],Ue,o,i).neighbors,Xe=!1,Oe=Te.length-1;Oe>=0;Oe--){if(Te.length+1<n.nodes.length)return void(Xe=!0);var Se=Te[Oe],We=Se[o];if(y[We]&&y[We].length)if(Z[We]&&Z[We].length){var Ve="".concat(at.id,"-").concat(Se.id),O=h[Ve],he=Z[We].length-1;if(O>Z[We][he])Te.splice(Oe,1);else{if(t){var _e="".concat(Se.id,"-").concat(at.id),Ze=h[_e];if(he=q[We].length-1,Ze>q[We][he]){Te.splice(Oe,1);continue}}var Je=D[Ve]?D[Ve]:d4(e,at,Se,p,O,w,A,o,a,D,_),qe="".concat(j.id,"-").concat(We);if(Je<ne[qe][ne[qe].length-1])Te.splice(Oe,1);else{var vt=TE(R,We,m,y),pt=vt.minPatternNodeLabelDegree;vt.minPatternNodeLabelInDegree,vt.minPatternNodeLabelOutDegree,p[Se.id].degree<pt&&Te.splice(Oe,1)}}}else Te.splice(Oe,1);else Te.splice(Oe,1)}Xe||te.push({nodes:[at].concat(Te)})});var we=vc(n,j.id,!1).length,pe={};t?(Object.keys(we).forEach(function(at){var Ue=m[at].node[o];pe[Ue]?pe[Ue].push(we[at]):pe[Ue]=[we[at]]}),Object.keys(pe).forEach(function(at){pe[at].sort(function(Ue,Te){return Ue-Te})})):pe=Z;for(var Me=function(at){var Ue=te[at],Te=Ue.nodes[0],Xe={},Oe={};Ue.nodes.forEach(function(sn,Dt){Oe[sn.id]={idx:Dt,node:sn,degree:0,inDegree:0,outDegree:0};var zt=sn[o];Xe[zt]?Xe[zt]++:Xe[zt]=1});var Se=[],We={};e.edges.forEach(function(sn){Oe[sn.source]&&Oe[sn.target]&&(Se.push(sn),We[sn[a]]?We[sn[a]]++:We[sn[a]]=1,Oe[sn.source].degree++,Oe[sn.target].degree++,Oe[sn.source].outDegree++,Oe[sn.target].inDegree++)});for(var Ve=Object.keys(b).length,O=!1,he=0;he<Ve;he++){var _e=Object.keys(b)[he];if(!We[_e]||We[_e]<b[_e].length){O=!0;break}}if(O)return te.splice(at,1),"continue";var Ze=Se.length;if(Ze<n.edges.length)return te.splice(at,1),"break";var Je=!1,qe=function(sn){var Dt=Se[sn],zt=Dt[a],hn=b[zt];if(!hn||!hn.length)return We[zt]--,hn&&We[zt]<hn.length?(Je=!0,"break"):(Se.splice(sn,1),Oe[Dt.source].degree--,Oe[Dt.target].degree--,Oe[Dt.source].outDegree--,Oe[Dt.target].inDegree--,"continue");var cr=Oe[Dt.source].node[o],Ta=Oe[Dt.target].node[o],Go=!1;return hn.forEach(function(Uo){var Oa=m[Uo.source].node,Na=m[Uo.target].node;Oa[o]===cr&&Na[o]===Ta&&(Go=!0),t||Oa[o]!==Ta||Na[o]!==cr||(Go=!0)}),Go?void 0:(We[zt]--,hn&&We[zt]<hn.length?(Je=!0,"break"):(Se.splice(sn,1),Oe[Dt.source].degree--,Oe[Dt.target].degree--,Oe[Dt.source].outDegree--,Oe[Dt.target].inDegree--,"continue"))};for(he=Ze-1;he>=0&&qe(he)!=="break";he--);if(Je)return te.splice(at,1),"continue";Ue.edges=Se;var vt=vc(Ue,Ue.nodes[0].id,!1).length;if(Object.keys(vt).reverse().forEach(function(sn){if(sn!==Ue.nodes[0].id&&!Je){if(vt[sn]===1/0){var Dt=Oe[sn].node[o];if(Xe[Dt]--,Xe[Dt]<y[Dt].length)return void(Je=!0);var zt=Ue.nodes.indexOf(Oe[sn].node);return Ue.nodes.splice(zt,1),void(Oe[sn]=void 0)}var hn=p[sn].node[o];if(!pe[hn]||!pe[hn].length||vt[sn]>pe[hn][pe[hn].length-1]){if(Dt=Oe[sn].node[o],Xe[Dt]--,Xe[Dt]<y[Dt].length)return void(Je=!0);zt=Ue.nodes.indexOf(Oe[sn].node),Ue.nodes.splice(zt,1),Oe[sn]=void 0}}}),Je)return te.splice(at,1),"continue";for(var pt=!0,Et=0;pt&&!Je;){if(pt=!1,t?Oe[Te.id].degree<m[j.id].degree||Oe[Te.id].inDegree<m[j.id].inDegree||Oe[Te.id].outDegree<m[j.id].outDegree:Oe[Te.id].degree<m[j.id].degree){Je=!0;break}if(Xe[Te[o]]<y[Te[o]].length){Je=!0;break}for(var Tt=Ue.nodes.length-1;Tt>=0;Tt--){var Rt=Ue.nodes[Tt],ln=Oe[Rt.id].degree,xn=Oe[Rt.id].inDegree,ar=Oe[Rt.id].outDegree,Mr=Rt[o],hr=TE(R,Mr,m,y),Di=hr.minPatternNodeLabelDegree,ks=hr.minPatternNodeLabelInDegree,Vu=hr.minPatternNodeLabelOutDegree;if(t?ln<Di||xn<ks||ar<Vu:ln<Di){if(Xe[Rt[o]]--,Xe[Rt[o]]<y[Rt[o]].length){Je=!0;break}Ue.nodes.splice(Tt,1),Oe[Rt.id]=void 0,pt=!0}}if(Je||!pt&&Et!==0)break;for(var Fo=(Ze=Se.length)-1;Fo>=0;Fo--){var sr=Se[Fo];if(!Oe[sr.source]||!Oe[sr.target]){Se.splice(Fo,1);var ur=sr[a];if(We[ur]--,Oe[sr.source]&&(Oe[sr.source].degree--,Oe[sr.source].outDegree--),Oe[sr.target]&&(Oe[sr.target].degree--,Oe[sr.target].inDegree--),b[ur]&&We[ur]<b[ur].length){Je=!0;break}pt=!0}}Et++}return Je||Je||Ue.nodes.length<n.nodes.length||Se.length<n.edges.length?(te.splice(at,1),"continue"):void 0},Be=te.length-1;Be>=0&&Me(Be)!=="break";Be--);var dt=te.length,It=function(at){var Ue=te[at],Te={};Ue.edges.forEach(function(Se){var We="".concat(Se.source,"-").concat(Se.target,"-").concat(Se.label);Te[We]?Te[We]++:Te[We]=1});for(var Xe=function(Se){var We=te[Se],Ve={};We.edges.forEach(function(he){var _e="".concat(he.source,"-").concat(he.target,"-").concat(he.label);Ve[_e]?Ve[_e]++:Ve[_e]=1});var O=!0;Object.keys(Ve).length!==Object.keys(Te).length?O=!1:Object.keys(Te).forEach(function(he){Ve[he]!==Te[he]&&(O=!1)}),O&&te.splice(Se,1)},Oe=dt-1;Oe>at;Oe--)Xe(Oe);dt=te.length};for(Be=0;Be<=dt-1;Be++)It(Be);return te}}},Hs=function(){function e(n){n===void 0&&(n=10),this.linkedList=new J2,this.maxStep=n}return Object.defineProperty(e.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return!this.linkedList.head},e.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},e.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},e.prototype.push=function(n){this.linkedList.prepend(n),this.length>this.maxStep&&this.linkedList.deleteTail()},e.prototype.pop=function(){var n=this.linkedList.deleteHead();return n?n.value:null},e.prototype.toArray=function(){return this.linkedList.toArray().map(function(n){return n.value})},e.prototype.clear=function(){for(;!this.isEmpty();)this.pop()},e}(),NE=M0;const p4={getAdjMatrix:Va,breadthFirstSearch:tE,connectedComponent:w0,getDegree:go,getInDegree:rE,getOutDegree:iE,detectCycle:M0,detectDirectedCycle:NE,detectAllCycles:aE,detectAllDirectedCycle:_0,detectAllUndirectedCycle:S0,depthFirstSearch:E0,dijkstra:vc,findAllPath:cE,findShortestPath:uE,floydWarshall:mc,labelPropagation:lE,louvain:I0,iLouvain:dE,kCore:pE,kMeans:vE,cosineSimilarity:T0,nodesCosineSimilarity:mE,minimumSpanningTree:bE,pageRank:xE,getNeighbors:zr,Stack:Hs,GADDI:OE},g4=Object.freeze(Object.defineProperty({__proto__:null,GADDI:OE,Stack:Hs,breadthFirstSearch:tE,connectedComponent:w0,cosineSimilarity:T0,default:p4,depthFirstSearch:E0,detectAllCycles:aE,detectAllDirectedCycle:_0,detectAllUndirectedCycle:S0,detectCycle:M0,detectDirectedCycle:NE,dijkstra:vc,findAllPath:cE,findShortestPath:uE,floydWarshall:mc,getAdjMatrix:Va,getDegree:go,getInDegree:rE,getNeighbors:zr,getOutDegree:iE,iLouvain:dE,kCore:pE,kMeans:vE,labelPropagation:lE,louvain:I0,minimumSpanningTree:bE,nodesCosineSimilarity:mE,pageRank:xE},Symbol.toStringTag,{value:"Module"}));var nf=Qr,DE=function(e,n,t){return e>=n&&e<=t},rf=function(e,n,t,r){var i=t.x-e.x,o=t.y-e.y,a=n.x-e.x,s=n.y-e.y,u=r.x-t.x,c=r.y-t.y,l=a*c-s*u,h=1/l;if(l*l>1e-4*(a*a+s*s)*(u*u+c*c)){var f=(i*c-o*u)*h,d=(i*s-o*a)*h;return DE(f,0,1)&&DE(d,0,1)?{x:e.x+f*a,y:e.y+f*s}:null}return null},PE=function(e,n){var t=e.x,r=e.y,i=e.width,o=e.height,a=[],s={x:t+i/2,y:r+o/2};a.push({x:t,y:r}),a.push({x:t+i,y:r}),a.push({x:t+i,y:r+o}),a.push({x:t,y:r+o}),a.push({x:t,y:r});for(var u=null,c=1;c<a.length&&!(u=rf(a[c-1],a[c],s,n));c++);return u},LE=function(e,n){var t=e.x,r=e.y,i=e.r,o=n.x-t,a=n.y-r;if(o*o+a*a<i*i)return null;var s=Math.atan(a/o);return{x:t+Math.abs(i*Math.cos(s))*Math.sign(o),y:r+Math.abs(i*Math.sin(s))*Math.sign(a)}},RE=function(e,n){var t=e.rx,r=e.ry,i=e.x,o=e.y,a=n.x-i,s=n.y-o,u=Math.atan2(s/r,a/t);return u<0&&(u+=2*Math.PI),{x:i+t*Math.cos(u),y:o+r*Math.sin(u)}},qs=function(e,n,t){t===void 0&&(t=1);var r=[e.x,e.y,t];return n&&!isNaN(n[0])||(n=[1,0,0,0,1,0,0,0,1]),Vh(r,r,n),{x:r[0],y:r[1]}},jE=function(e,n,t){t===void 0&&(t=1),n&&!isNaN(n[0])||(n=[1,0,0,0,1,0,0,0,1]);var r=r0([1,0,0,0,1,0,0,0,1],n);r||(r=[1,0,0,0,1,0,0,0,1]);var i=[e.x,e.y,t];return Vh(i,i,r),{x:i[0],y:i[1]}},O0=function(e,n,t){var r=e.x-n.x,i=e.y-n.y,o=e.x-t.x,a=e.y-t.y,s=(e.x*e.x-n.x*n.x-n.y*n.y+e.y*e.y)/2,u=(e.x*e.x-t.x*t.x-t.y*t.y+e.y*e.y)/2,c=i*o-r*a;return{x:-(a*s-i*u)/c,y:-(r*u-o*s)/c}},of=function(e,n){var t=e.x-n.x,r=e.y-n.y;return Math.sqrt(t*t+r*r)},BE=function(e,n){e.translate(n.x,n.y)},N0=function(e,n,t,r){r===void 0&&(r={duration:500});var i=e.getMatrix();i||(i=[1,0,0,0,1,0,0,0,1]);var o=e.getCanvasBBox(),a=n.x-o.minX,s=n.y-o.minY;if(t){var u=a*i[0],c=s*i[4],l=0,h=0,f=0,d=0;e.animate(function(g){return i=nf(i,[["t",(f=u*g)-l,(d=c*g)-h]]),l=f,h=d,{matrix:i}},r)}else{var p=nf(i,[["t",a,s]]);e.setMatrix(p)}};function v4(e,n,t){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])&&Math.min(e[0],n[0])<=t[0]&&t[0]<=Math.max(e[0],n[0])&&Math.min(e[1],n[1])<=t[1]&&t[1]<=Math.max(e[1],n[1])}var yc=function(e,n,t){var r=!1,i=e.length;function o(c){return Math.abs(c)<1e-6?0:c<0?-1:1}if(i<=2)return!1;for(var a=0;a<i;a++){var s=e[a],u=e[(a+1)%i];if(v4(s,u,[n,t]))return!0;o(s[1]-t)>0!=o(u[1]-t)>0&&o(n-(t-s[1])*(s[0]-u[0])/(s[1]-u[1])-s[0])<0&&(r=!r)}return r},zE=function(e,n){return!(n.minX>e.maxX||n.maxX<e.minX||n.minY>e.maxY||n.maxY<e.minY)},FE=function(e,n){var t=function(l){var h=l.map(function(d){return d[0]}),f=l.map(function(d){return d[1]});return{minX:Math.min.apply(null,h),maxX:Math.max.apply(null,h),minY:Math.min.apply(null,f),maxY:Math.max.apply(null,f)}},r=function(l){for(var h=[],f=l.length,d=0;d<f-1;d++){var p=l[d],g=l[d+1];h.push({from:{x:p[0],y:p[1]},to:{x:g[0],y:g[1]}})}if(h.length>1){var v=l[0],m=l[f-1];h.push({from:{x:m[0],y:m[1]},to:{x:v[0],y:v[1]}})}return h};if(e.length<2||n.length<2)return!1;var i=t(e),o=t(n);if(!zE(i,o))return!1;var a=!1;if(ye(n,function(l){if(yc(e,l[0],l[1]))return a=!0,!1}),a||(ye(e,function(l){if(yc(n,l[0],l[1]))return a=!0,!1}),a))return!0;var s=r(e),u=r(n),c=!1;return ye(u,function(l){if(function(h,f){var d=!1;return ye(h,function(p){if(rf(p.from,p.to,f.from,f.to))return d=!0,!1}),d}(s,l))return c=!0,!1}),c},qa=function(){function e(n,t,r,i){this.x1=n,this.y1=t,this.x2=r,this.y2=i}return e.prototype.getBBox=function(){var n=Math.min(this.x1,this.x2),t=Math.min(this.y1,this.y2),r=Math.max(this.x1,this.x2),i=Math.max(this.y1,this.y2);return{x:n,y:t,minX:n,minY:t,maxX:r,maxY:i,width:r-n,height:i-t}},e}(),D0=function(e,n){return{top:[e.minX,e.minY,e.maxX,e.minY],left:[e.minX,e.minY,e.minX,e.maxY],bottom:[e.minX,e.maxY,e.maxX,e.maxY],right:[e.maxX,e.minY,e.maxX,e.maxY]}[n]},m4=function(e,n){var t=(n.x2-n.x1)*(e.y1-n.y1)-(n.y2-n.y1)*(e.x1-n.x1),r=(e.x2-e.x1)*(e.y1-n.y1)-(e.y2-e.y1)*(e.x1-n.x1),i=(n.y2-n.y1)*(e.x2-e.x1)-(n.x2-n.x1)*(e.y2-e.y1);if(i){var o=t/i,a=r/i;if(o>=0&&o<=1&&a>=0&&a<=1)return o}return Number.POSITIVE_INFINITY},GE=function(e,n){for(var t=["top","left","bottom","right"],r=e.getBBox(),i=0,o=[],a=0;a<4;a++){var s=D0(r,t[a]),u=s[0],c=s[1],l=s[2],h=s[3];o[a]=rf({x:n.x1,y:n.y1},{x:n.x2,y:n.y2},{x:u,y:c},{x:l,y:h}),o[a]&&(i+=1)}return[o,i]},P0=function(e,n){for(var t=["top","left","bottom","right"],r=e.getBBox(),i=Number.POSITIVE_INFINITY,o=0,a=0;a<4;a++){var s=D0(r,t[a]),u=s[0],c=s[1],l=s[2],h=s[3],f=m4(n,new qa(u,c,l,h));(f=Math.abs(f-.5))>=0&&f<=1&&(o+=1,i=f<i?f:i)}return o===0?-1:i},UE=function(e){var n=0,t=0;if(e.length>0){for(var r=0,i=e;r<i.length;r++){var o=i[r];n+=o.x,t+=o.y}n/=e.length,t/=e.length}return{x:n,y:t}},af=function(e,n){return Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)},XE=function(e,n){var t,r=n.x1,i=n.y1,o=n.x2-r,a=n.y2-i,s=e.x-r,u=e.y-i,c=s*o+u*a;t=c<=0||(c=(s=o-s)*o+(u=a-u)*a)<=0?0:c*c/(o*o+a*a);var l=s*s+u*u-t;return l<0&&(l=0),l},L0=function(e,n,t){return t===void 0&&(t=.001),Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)<Math.pow(t,2)},YE=function(e,n){var t=e.x<n.x,r=e.x>n.x+n.width,i=e.y>n.y+n.height,o=e.y<n.y;if(!(t||r||i||o))return 0;if(i&&!t&&!r)return Math.pow(n.y+n.height-e.y,2);if(o&&!t&&!r)return Math.pow(e.y-n.y,2);if(t&&!i&&!o)return Math.pow(n.x-e.x,2);if(r&&!i&&!o)return Math.pow(n.x+n.width-e.x,2);var a=Math.min(Math.abs(n.x-e.x),Math.abs(n.x+n.width-e.x)),s=Math.min(Math.abs(n.y-e.y),Math.abs(n.y+n.height-e.y));return a*a+s*s},R0=function(e,n,t){return e+(n-e)*t},j0=function(e,n,t){for(var r=Math.min(e.length,n.length),i=new Array(r),o=0;o<r;o++)i[o]=R0(e[o],n[o],t);return i};const y4=Object.freeze(Object.defineProperty({__proto__:null,Line:qa,applyMatrix:qs,compare:function(e){return function(n,t){return n[e]-t[e]}},distance:of,floydWarshall:function(e){for(var n=[],t=e.length,r=0;r<t;r+=1){n[r]=[];for(var i=0;i<t;i+=1)r===i?n[r][i]=0:e[r][i]!==0&&e[r][i]?n[r][i]=e[r][i]:n[r][i]=1/0}for(var o=0;o<t;o+=1)for(r=0;r<t;r+=1)for(i=0;i<t;i+=1)n[r][i]>n[r][o]+n[o][i]&&(n[r][i]=n[r][o]+n[o][i]);return n},fractionToLine:P0,getAdjMatrix:function(e,n){var t=e.nodes,r=e.edges,i=[],o={};if(!t)throw new Error("invalid nodes data!");return t&&t.forEach(function(a,s){o[a.id]=s,i.push([])}),r&&r.forEach(function(a){var s=a.source,u=a.target,c=o[s],l=o[u];i[c][l]=1,n||(i[l][c]=1)}),i},getBBoxBoundLine:D0,getCircleCenterByPoints:O0,getCircleIntersectByPoint:LE,getDegree:function(e,n,t){for(var r=[],i=0;i<e;i++)r[i]=0;return t.forEach(function(o){o.source&&(r[n[o.source]]+=1),o.target&&(r[n[o.target]]+=1)}),r},getEllipseIntersectByPoint:RE,getLineIntersect:rf,getPointsCenter:UE,getRectIntersectByPoint:PE,intersectBBox:zE,invertMatrix:jE,isPointInPolygon:yc,isPointsOverlap:L0,isPolygonsIntersect:FE,itemIntersectByLine:GE,lerp:R0,lerpArray:j0,move:N0,pointLineDistance:function(e,n){var t=e[0],r=e[1],i=e[2],o=e[3],a=n.x,s=n.y,u=[i-t,o-r];if(x0(u,[0,0]))return NaN;var c=[-u[1],u[0]];$o(c,c);var l=[a-t,s-r];return Math.abs(b0(l,c))},pointLineSquareDist:XE,pointRectSquareDist:YE,rotate:function(e,n){var t=e.getMatrix();t||(t=[1,0,0,0,1,0,0,0,1]),t=nf(t,[["r",n]]),e.setMatrix(t)},scale:function(e,n){var t=e.getMatrix();t||(t=[1,0,0,0,1,0,0,0,1]);var r=n;Mt(n)||(r=[n,n]),Mt(n)&&n.length===1&&(r=[n[0],n[0]]),t=nf(t,[["s",r[0],r[1]]]),e.setMatrix(t)},scaleMatrix:function(e,n){var t=[];return e.forEach(function(r){var i=[];r.forEach(function(o){i.push(o*n)}),t.push(i)}),t},squareDist:af,translate:BE},Symbol.toStringTag,{value:"Module"}));var kr="rgb(95, 149, 255)",WE="rgb(0, 0, 0)",sf="rgb(247, 250, 255)",uf="rgb(253, 253, 253)",VE="rgb(250, 250, 250)",Zs="rgb(224, 224, 224)",HE="rgb(234, 234, 234)",qE="#4572d9";const bt={version:"0.8.23",rootContainerClassName:"root-container",nodeContainerClassName:"node-container",edgeContainerClassName:"edge-container",comboContainerClassName:"combo-container",delegateContainerClassName:"delegate-container",defaultLoopPosition:"top",nodeLabel:{style:{fill:"#000",fontSize:12,textAlign:"center",textBaseline:"middle"},offset:4},defaultNode:{type:"circle",style:{lineWidth:1,stroke:kr,fill:"rgb(239, 244, 255)"},size:20,color:kr,linkPoints:{size:8,lineWidth:1,fill:sf,stroke:kr}},nodeStateStyles:{active:{fill:sf,stroke:kr,lineWidth:2,shadowColor:kr,shadowBlur:10},selected:{fill:"rgb(255, 255, 255)",stroke:kr,lineWidth:4,shadowColor:kr,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{fill:"rgb(223, 234, 255)",stroke:qE,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{fill:sf,stroke:"rgb(191, 213, 255)",lineWidth:1},disable:{fill:VE,stroke:Zs,lineWidth:1}},edgeLabel:{style:{fill:WE,textAlign:"center",textBaseline:"middle",fontSize:12}},defaultEdge:{type:"line",size:1,style:{stroke:Zs,lineAppendWidth:2},color:Zs},edgeStateStyles:{active:{stroke:kr,lineWidth:1},selected:{stroke:kr,lineWidth:2,shadowColor:kr,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:kr,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{stroke:HE,lineWidth:1},disable:{stroke:"rgb(245, 245, 245)",lineWidth:1}},comboLabel:{style:{fill:WE,textBaseline:"middle",fontSize:12},refY:10,refX:10},defaultCombo:{type:"circle",style:{fill:uf,lineWidth:1,stroke:Zs,r:5,width:20,height:10},size:[20,5],color:Zs,padding:[25,20,15,20]},comboStateStyles:{active:{stroke:kr,lineWidth:1,fill:sf},selected:{stroke:kr,lineWidth:2,fill:uf,shadowColor:kr,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:qE,lineWidth:2,fill:uf,"text-shape":{fontWeight:500}},inactive:{stroke:Zs,fill:uf,lineWidth:1},disable:{stroke:HE,fill:VE,lineWidth:1}},delegateStyle:{fill:"#F3F9FF",fillOpacity:.5,stroke:"#1890FF",strokeOpacity:.9,lineDash:[5,5]},windowFontFamily:typeof window<"u"&&window.getComputedStyle&&document.body&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif"},b4={" ":.3329986572265625,a:.5589996337890625,A:.6569992065429687,b:.58599853515625,B:.6769989013671875,c:.5469985961914062,C:.7279998779296875,d:.58599853515625,D:.705999755859375,e:.554998779296875,E:.63699951171875,f:.37299957275390627,F:.5769989013671875,g:.5909988403320312,G:.7479995727539063,h:.555999755859375,H:.7199996948242188,i:.255999755859375,I:.23699951171875,j:.26699981689453123,J:.5169998168945312,k:.5289993286132812,K:.6899993896484375,l:.23499908447265624,L:.5879989624023437,m:.854998779296875,M:.8819992065429687,n:.5589996337890625,N:.7189987182617188,o:.58599853515625,O:.7669998168945312,p:.58599853515625,P:.6419998168945312,q:.58599853515625,Q:.7669998168945312,r:.3649993896484375,R:.6759994506835938,s:.504998779296875,S:.6319992065429687,t:.354998779296875,T:.6189987182617187,u:.5599990844726562,U:.7139999389648437,v:.48199920654296874,V:.6389999389648438,w:.754998779296875,W:.929998779296875,x:.5089996337890625,X:.63699951171875,y:.4959991455078125,Y:.66199951171875,z:.48699951171875,Z:.6239990234375,0:.6,1:.40099945068359377,2:.6,3:.6,4:.6,5:.6,6:.6,7:.5469985961914062,8:.6,9:.6,"[":.3329986572265625,"]":.3329986572265625,",":.26399993896484375,".":.26399993896484375,";":.26399993896484375,":":.26399993896484375,"{":.3329986572265625,"}":.3329986572265625,"\\":.5,"|":.19499969482421875,"=":.604998779296875,"+":.604998779296875,"-":.604998779296875,_:.5,"`":.3329986572265625," ~":.8329986572265625,"!":.3329986572265625,"@":.8579986572265625,"#":.6,$:.6,"%":.9699996948242188,"^":.517999267578125,"&":.7259994506835937,"*":.505999755859375,"(":.3329986572265625,")":.3329986572265625,"<":.604998779296875,">":.604998779296875,"/":.5,"?":.53699951171875};var Wi=Math.PI,B0=Math.sin,z0=Math.cos,ir=B0(Wi/8),or=z0(Wi/8),cf=function(e,n){var t=e.getBBox(),r={x:t.minX,y:t.minY},i={x:t.maxX,y:t.maxY};if(n){var o=n.getMatrix();o||(o=[1,0,0,0,1,0,0,0,1]),r=qs(r,o),i=qs(i,o)}var a=r.x,s=r.y,u=i.x,c=i.y;return{x:a,y:s,minX:a,minY:s,maxX:u,maxY:c,width:u-a,height:c-s}},ZE=function(e){var n=e.sourceNode||e.targetNode,t=n.get("group").getMatrix();t||(t=[1,0,0,0,1,0,0,0,1]);var r=n.getKeyShape(),i=r.getBBox(),o=e.loopCfg||{},a=o.dist||2*Math.max(i.width,i.height),s=o.position||bt.defaultLoopPosition,u=[(i.minX+i.maxX)/2+t[6],(i.minY+i.maxY)/2+t[7]],c=[e.startPoint.x,e.startPoint.y],l=[e.endPoint.x,e.endPoint.y],h=i.height/2,f=i.width/2,d=h,p=h,g=d*ir,v=d*or,m=p*ir,y=p*or,b=r.get("type"),x=Math.min(h/2,f/2),w=Math.min(h,f),E=o!=null&&o.pointPadding?Math.min(w,o==null?void 0:o.pointPadding):x;if(c[0]===l[0]&&c[1]===l[1]){switch(s){case"top":b==="circle"?(c=[u[0]-g,u[1]-v],l=[u[0]+m,u[1]-y]):(c=[u[0]-E,u[1]-h],l=[u[0]+E,u[1]-h]);break;case"top-right":d=h,p=f,b==="circle"?(c=[u[0]+(g=d*ir),u[1]-(v=d*or)],l=[u[0]+(y=p*or),u[1]-(m=p*ir)]):(c=[u[0]+f-E,u[1]-h],l=[u[0]+f,u[1]-h+E]);break;case"right":d=f,p=f,b==="circle"?(c=[u[0]+(v=d*or),u[1]-(g=d*ir)],l=[u[0]+(y=p*or),u[1]+(m=p*ir)]):(c=[u[0]+f,u[1]-E],l=[u[0]+f,u[1]+E]);break;case"bottom-right":d=f,p=h,b==="circle"?(c=[u[0]+(v=d*or),u[1]+(g=d*ir)],l=[u[0]+(m=p*ir),u[1]+(y=p*or)]):(c=[u[0]+f,u[1]+h-E],l=[u[0]+f-E,u[1]+h]);break;case"bottom":d=h,p=h,b==="circle"?(c=[u[0]+(g=d*ir),u[1]+(v=d*or)],l=[u[0]-(m=p*ir),u[1]+(y=p*or)]):(c=[u[0]-E,u[1]+h],l=[u[0]+E,u[1]+h]);break;case"bottom-left":d=h,p=f,b==="circle"?(c=[u[0]-(g=d*ir),u[1]+(v=d*or)],l=[u[0]-(y=p*or),u[1]+(m=p*ir)]):(c=[u[0]-f,u[1]+h-E],l=[u[0]-f+E,u[1]+h]);break;case"left":d=f,p=f,b==="circle"?(c=[u[0]-(v=d*or),u[1]+(g=d*ir)],l=[u[0]-(y=p*or),u[1]-(m=p*ir)]):(c=[u[0]-f,u[1]-E],l=[u[0]-f,u[1]+E]);break;case"top-left":d=f,p=h,b==="circle"?(c=[u[0]-(v=d*or),u[1]-(g=d*ir)],l=[u[0]-(m=p*ir),u[1]-(y=p*or)]):(c=[u[0]-f+E,u[1]-h],l=[u[0]-f,u[1]-h+E]);break;default:c=[u[0]-(g=(d=f)*ir),u[1]-(v=d*or)],l=[u[0]+(m=(p=f)*ir),u[1]-(y=p*or)]}if(o.clockwise===!1){var M=[c[0],c[1]];c=[l[0],l[1]],l=[M[0],M[1]]}}var _=[c[0]-u[0],c[1]-u[1]],k=(d+a)/d,S=(p+a)/p;o.clockwise===!1&&(k=(p+a)/p,S=(d+a)/d);var C=fr([0,0],_,k),T=[u[0]+C[0],u[1]+C[1]],A=fr([0,0],[l[0]-u[0],l[1]-u[1]],S),D=[u[0]+A[0],u[1]+A[1]];return e.startPoint={x:c[0],y:c[1]},e.endPoint={x:l[0],y:l[1]},e.controlPoints=[{x:T[0],y:T[1]},{x:D[0],y:D[1]}],e},KE=function(e,n,t,r,i){var o=1e-4,a=[],s=e==null?void 0:e.getPoint(n);if(!s)return{x:0,y:0,angle:0};if(n<o)a=e.getStartTangent().reverse();else if(n>.9999)a=e.getEndTangent();else{var u=e==null?void 0:e.getPoint(n+o);a.push([s.x,s.y]),a.push([u.x,u.y])}var c=Math.atan2(a[1][1]-a[0][1],a[1][0]-a[0][0]);if(c<0&&(c+=2*Wi),t&&(s.x+=z0(c)*t,s.y+=B0(c)*t),r){var l=c-Wi/2;c>.5*Wi&&c<1.5*Wi&&(l-=Wi),s.x+=z0(l)*r,s.y+=B0(l)*r}var h={x:s.x,y:s.y,angle:c};return i?(c>.5*Wi&&c<1.5*Wi&&(c-=Wi),F({rotate:c},h)):h},x4=function e(n,t,r,i){if(i(n,t,r)===!1)return!1;if(n&&n.children){for(var o=n.children.length-1;o>=0;o--)if(!e(n.children[o],n,o,i))return!1}return!0},w4=function e(n,t,r,i){if(n&&n.children){for(var o=n.children.length-1;o>=0;o--)if(!e(n.children[o],n,o,i))return}return i(n,t,r)!==!1},dr=function(e,n){typeof n=="function"&&x4(e,null,-1,n)},Vi=function(e,n){typeof n=="function"&&w4(e,null,-1,n)},$E=function(e,n){return n*(b4[e]||1)},QE=function(e,n){var t=0,r=new RegExp("[\u4E00-\u9FA5]+");return e.split("").forEach(function(i){r.test(i)?t+=n:t+=$E(i,n)}),[t,n]},JE=function(e,n){return typeof n!="number"||n<=0||n>=e.length?e:e.substring(0,n)+"..."},F0=function(e,n){var t=[],r={},i={};e.forEach(function(s){i[s.id]=s}),e.forEach(function(s,u){var c=Kt(s);c.itemType="combo",c.children=void 0,(c.parentId===c.id||c.parentId&&!i[c.parentId])&&delete c.parentId;var l=r[c.id];if(l){if(c.children=l.children,r[c.id]=c,!(l=c).parentId)return void t.push(l);var h=r[l.parentId];if(h)h.children?h.children.push(c):h.children=[c];else{var f={id:l.parentId,children:[l]};r[l.parentId]=f,r[c.id]=c}}else if(Re(s.parentId)){var d=r[s.parentId];if(d)d.children?d.children.push(c):d.children=[c],r[c.id]=c;else{var p={id:s.parentId,children:[c]};r[p.id]=p,r[c.id]=c}}else t.push(c),r[c.id]=c});var o={};(n||[]).forEach(function(s){o[s.id]=s;var u=r[s.comboId];if(u){var c={id:s.id,comboId:s.comboId};u.children?u.children.push(c):u.children=[c],c.itemType="node",r[s.id]=c}});var a=0;return t.forEach(function(s){s.depth=a+10,dr(s,function(u){var c,l=r[u.id].itemType;c=l==="node"?r[u.comboId]:r[u.parentId],u.depth=c&&l==="node"?a+1:a+10,a<u.depth&&(a=u.depth);var h=o[u.id];return h&&(h.depth=u.depth),!0})}),t},G0=function(e,n,t){var r,i,o=e,a={root:{children:e}},s=!1,u="root";(e||[]).forEach(function(d){if(!s)return d.id===n?(i=d,d.itemType==="combo"?i.parentId=t:i.comboId=t,void(s=!0)):void dr(d,function(p){var g;return a[p.id]={children:(p==null?void 0:p.children)||[]},o=(g=a[p.parentId||p.comboId||"root"])===null||g===void 0?void 0:g.children,!p||!p.removed&&n!==p.id||!o||(u=p.parentId||p.comboId||"root",i=p,p.itemType==="combo"?i.parentId=t:i.comboId=t,s=!0,!1)})});var c=(o=(r=a[u])===null||r===void 0?void 0:r.children)?o.indexOf(i):-1;if(c>-1&&o.splice(c,1),s||(i={id:n,itemType:"node",comboId:t},a[n]={children:void 0}),n){var l=!1;if(t){var h=0;(e||[]).forEach(function(d){l||dr(d,function(p){return t!==p.id||(l=!0,p.children?p.children.push(i):p.children=[i],h=p.depth,i.itemType==="node"?i.depth=h+2:i.depth=h+1,!1)})})}else t&&l||i.itemType==="node"||e.push(i);var f=i.depth;dr(i,function(d){return d.itemType==="node"?f+=2:f+=1,d.depth=f,!0})}return e},lf=function(e,n,t){var r={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,x:void 0,y:void 0,width:void 0,height:void 0,centerX:void 0,centerY:void 0};if(!e||e.length===0){var i=(t==null?void 0:t.getModel())||{},o=i.x,a=i.y,s=i.fixSize,u=i.collapsed,c=i.fixCollapseSize,l=u?c:s,h=Mt(l)?l:[l,l],f=h[0],d=h[1],p=[f/2,d/2];return{minX:o-p[0],minY:a-p[1],maxX:o+p[0],maxY:a+p[1],x:o,y:a,width:f,height:d}}return e.forEach(function(g){var v=n.findById(g.id);if(v&&v.isVisible()){v.set("bboxCanvasCache",void 0);var m=v.getCanvasBBox();m.x&&r.minX>m.minX&&(r.minX=m.minX),m.y&&r.minY>m.minY&&(r.minY=m.minY),m.x&&r.maxX<m.maxX&&(r.maxX=m.maxX),m.y&&r.maxY<m.maxY&&(r.maxY=m.maxY)}}),r.x=(r.minX+r.maxX)/2,r.y=(r.minY+r.maxY)/2,r.width=r.maxX-r.minX,r.height=r.maxY-r.minY,r.centerX=(r.minX+r.maxX)/2,r.centerY=(r.minY+r.maxY)/2,(t==null?void 0:t.getKeyShape().get("type"))==="circle"&&(r.width=Math.hypot(r.height,r.width),r.height=r.width),Object.keys(r).forEach(function(g){r[g]!==1/0&&r[g]!==-1/0||(r[g]=void 0)}),r},hf=function(e){var n={};return Object.keys(e).forEach(function(t){var r=e[t];if(t!=="img"||Re(r))if(tr(r)&&!Mt(r)){var i={};Object.keys(r).forEach(function(o){var a=r[o];(o!=="img"||Re(a))&&(i[o]=Kt(a))}),n[t]=i}else n[t]=Kt(r)}),n},bc=function(e){var n,t=e.animateCfg,r=e.callback;if(t)if(n=Kt(t),t.callback){var i=t.callback;n.callback=function(){r(),i()}}else n.callback=r;else n={duration:500,callback:r};return n};const E4=Object.freeze(Object.defineProperty({__proto__:null,cloneBesidesImg:hf,getAnimateCfgWithCallback:bc,getBBox:cf,getComboBBox:lf,getLabelPosition:KE,getLetterWidth:$E,getLoopCfgs:ZE,getTextSize:QE,plainCombosToTrees:F0,reconstructTree:G0,shouldRefreshEdge:function(e){var n=xt(e.x)||xt(e.y)||e.type||e.anchorPoints||e.size;return e.style&&(n=n||xt(e.style.r)||xt(e.style.width)||xt(e.style.height)||xt(e.style.rx)||xt(e.style.ry)),n},traverseTree:dr,traverseTreeUp:Vi,truncateLabelByLength:JE},Symbol.toStringTag,{value:"Module"}));var eM=function(e){if(!e)return!1;var n=e.nodes,t=e.edges,r=e.combos,i=r===void 0?[]:r;if(!n&&!t){var o=!0;return dr(e,function(c){return!!Re(c.id)||(o=!1,!1)}),o}if((n||[]).find(function(c){return!Re(c.id)}))return!1;var a=(n||[]).map(function(c){return c.id}),s=i==null?void 0:i.map(function(c){return c.id}),u=Br(Br([],a,!0),s,!0);return!(t||[]).find(function(c){return!u.includes(c.source)||!u.includes(c.target)})},M4=function(){function e(n){this.graph=n,this.destroyed=!1,this.modes=n.get("modes")||{default:[]},this.formatModes(),this.mode=n.get("defaultMode")||"default",this.currentBehaves=[],this.setMode(this.mode)}return e.prototype.formatModes=function(){ye(this.modes,function(n){ye(n,function(t,r){Re(t)&&(n[r]={type:t})})})},e.prototype.setBehaviors=function(n){var t,r=this.graph,i=this.modes[n],o=[];ye(i||[],function(a){var s=n0.getBehavior(a.type||a);s&&(t=new s(a))&&(t.bind(r),o.push(t))}),this.currentBehaves=o},e.mergeBehaviors=function(n,t){return ye(t,function(r){n.indexOf(r)<0&&(Re(r)&&(r={type:r}),n.push(r))}),n},e.filterBehaviors=function(n,t){var r=[];return n.forEach(function(i){var o="";o=Re(i)?i:i.type,t.indexOf(o)<0&&r.push(i)}),r},e.prototype.setMode=function(n){var t=this.modes,r=this.graph,i=n;t[i]&&(r.emit("beforemodechange",{mode:n}),ye(this.currentBehaves,function(o){o.delegate&&o.delegate.remove(),o.unbind(r)}),this.setBehaviors(i),r.emit("aftermodechange",{mode:n}),this.mode=n)},e.prototype.getMode=function(){return this.mode},e.prototype.manipulateBehaviors=function(n,t,r){var i,o=this;if(i=Mt(n)?n:[n],Mt(t))return ye(t,function(s){o.modes[s]?o.modes[s]=r?e.mergeBehaviors(o.modes[s]||[],i):e.filterBehaviors(o.modes[s]||[],i):r&&(o.modes[s]=i)}),this;var a=t;return t||(a=this.mode),this.modes[a]||r&&(this.modes[a]=i),this.modes[a]=r?e.mergeBehaviors(this.modes[a]||[],i):e.filterBehaviors(this.modes[a]||[],i),this.formatModes(),this.setMode(this.mode),this},e.prototype.updateBehavior=function(n,t,r){Re(n)&&(n={type:n});var i=[];if(r&&r!==this.mode&&r!=="default"){if(!(i=this.modes[r])||!i.length)return this;var o=i.length;for(s=0;s<o;s++)if((u=i[s]).type===n.type||u===n.type)return u===n.type&&(u={type:u}),Object.assign(u,t),i[s]=u,this}else{if(!(i=this.currentBehaves)||!i.length)return this;for(var a=i.length,s=0;s<a;s++){var u;if((u=i[s]).type===n.type)return u.updateCfg(t),this}}return this},e.prototype.destroy=function(){this.graph=null,this.modes=null,this.currentBehaves=null,this.destroyed=!0},e}(),xc=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,S4=new RegExp("([a-z])["+xc+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+xc+"]*,?["+xc+"]*)+)","ig"),_4=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+xc+"]*,?["+xc+"]*","ig"),Ks=function(e){if(!e)return null;if(Mt(e))return e;var n={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},t=[];return String(e).replace(S4,function(r,i,o){var a=[],s=i.toLowerCase();if(o.replace(_4,function(u,c){c&&a.push(+c)}),s==="m"&&a.length>2&&(t.push([i].concat(a.splice(0,2))),s="l",i=i==="m"?"l":"L"),s==="o"&&a.length===1&&t.push([i,a[0]]),s==="r")t.push([i].concat(a));else for(;a.length>=n[s]&&(t.push([i].concat(a.splice(0,n[s]))),n[s]););return e}),t},U0=function(e,n){for(var t=[],r=0,i=e.length;i-2*!n>r;r+=2){var o=[{x:+e[r-2],y:+e[r-1]},{x:+e[r],y:+e[r+1]},{x:+e[r+2],y:+e[r+3]},{x:+e[r+4],y:+e[r+5]}];n?r?i-4===r?o[3]={x:+e[0],y:+e[1]}:i-2===r&&(o[2]={x:+e[0],y:+e[1]},o[3]={x:+e[2],y:+e[3]}):o[0]={x:+e[i-2],y:+e[i-1]}:i-4===r?o[3]=o[2]:r||(o[0]={x:+e[r],y:+e[r+1]}),t.push(["C",(-o[0].x+6*o[1].x+o[2].x)/6,(-o[0].y+6*o[1].y+o[2].y)/6,(o[1].x+6*o[2].x-o[3].x)/6,(o[1].y+6*o[2].y-o[3].y)/6,o[2].x,o[2].y])}return t},ff=function(e,n,t,r,i){var o=[];if(i===null&&r===null&&(r=t),e=+e,n=+n,t=+t,r=+r,i!==null){var a=Math.PI/180,s=e+t*Math.cos(-r*a),u=e+t*Math.cos(-i*a);o=[["M",s,n+t*Math.sin(-r*a)],["A",t,t,0,+(i-r>180),0,u,n+t*Math.sin(-i*a)]]}else o=[["M",e,n],["m",0,-r],["a",t,r,0,1,1,0,2*r],["a",t,r,0,1,1,0,-2*r],["z"]];return o},X0=function(e){if(!(e=Ks(e))||!e.length)return[["M",0,0]];var n,t,r=[],i=0,o=0,a=0,s=0,u=0;e[0][0]==="M"&&(a=i=+e[0][1],s=o=+e[0][2],u++,r[0]=["M",i,o]);for(var c=e.length===3&&e[0][0]==="M"&&e[1][0].toUpperCase()==="R"&&e[2][0].toUpperCase()==="Z",l=void 0,h=void 0,f=u,d=e.length;f<d;f++){if(r.push(l=[]),(n=(h=e[f])[0])!==n.toUpperCase())switch(l[0]=n.toUpperCase(),l[0]){case"A":l[1]=h[1],l[2]=h[2],l[3]=h[3],l[4]=h[4],l[5]=h[5],l[6]=+h[6]+i,l[7]=+h[7]+o;break;case"V":l[1]=+h[1]+o;break;case"H":l[1]=+h[1]+i;break;case"R":for(var p=2,g=(t=[i,o].concat(h.slice(1))).length;p<g;p++)t[p]=+t[p]+i,t[++p]=+t[p]+o;r.pop(),r=r.concat(U0(t,c));break;case"O":r.pop(),(t=ff(i,o,h[1],h[2])).push(t[0]),r=r.concat(t);break;case"U":r.pop(),r=r.concat(ff(i,o,h[1],h[2],h[3])),l=["U"].concat(r[r.length-1].slice(-2));break;case"M":a=+h[1]+i,s=+h[2]+o;break;default:for(p=1,g=h.length;p<g;p++)l[p]=+h[p]+(p%2?i:o)}else if(n==="R")t=[i,o].concat(h.slice(1)),r.pop(),r=r.concat(U0(t,c)),l=["R"].concat(h.slice(-2));else if(n==="O")r.pop(),(t=ff(i,o,h[1],h[2])).push(t[0]),r=r.concat(t);else if(n==="U")r.pop(),r=r.concat(ff(i,o,h[1],h[2],h[3])),l=["U"].concat(r[r.length-1].slice(-2));else for(var v=0,m=h.length;v<m;v++)l[v]=h[v];if((n=n.toUpperCase())!=="O")switch(l[0]){case"Z":i=+a,o=+s;break;case"H":i=l[1];break;case"V":o=l[1];break;case"M":a=l[l.length-2],s=l[l.length-1];break;default:i=l[l.length-2],o=l[l.length-1]}}return r},df=function(e,n,t,r){return[e,n,t,r,t,r]},tM=function(e,n,t,r,i,o){var a=.3333333333333333,s=2/3;return[a*e+s*t,a*n+s*r,a*i+s*t,a*o+s*r,i,o]},nM=function(e,n,t,r,i,o,a,s,u,c){t===r&&(t+=1);var l,h,f,d,p,g=120*Math.PI/180,v=Math.PI/180*(+i||0),m=[],y=function(pe,Me,Be){return{x:pe*Math.cos(Be)-Me*Math.sin(Be),y:pe*Math.sin(Be)+Me*Math.cos(Be)}};if(c)h=c[0],f=c[1],d=c[2],p=c[3];else{e=(l=y(e,n,-v)).x,n=l.y,s=(l=y(s,u,-v)).x,u=l.y,e===s&&n===u&&(s+=1,u+=1);var b=(e-s)/2,x=(n-u)/2,w=b*b/(t*t)+x*x/(r*r);w>1&&(t*=w=Math.sqrt(w),r*=w);var E=t*t,M=r*r,_=(o===a?-1:1)*Math.sqrt(Math.abs((E*M-E*x*x-M*b*b)/(E*x*x+M*b*b)));d=_*t*x/r+(e+s)/2,p=_*-r*b/t+(n+u)/2,h=Math.asin(((n-p)/r).toFixed(9)),f=Math.asin(((u-p)/r).toFixed(9)),h=e<d?Math.PI-h:h,f=s<d?Math.PI-f:f,h<0&&(h=2*Math.PI+h),f<0&&(f=2*Math.PI+f),a&&h>f&&(h-=2*Math.PI),!a&&f>h&&(f-=2*Math.PI)}var k=f-h;if(Math.abs(k)>g){var S=f,C=s,T=u;f=h+g*(a&&f>h?1:-1),s=d+t*Math.cos(f),u=p+r*Math.sin(f),m=nM(s,u,t,r,i,0,a,C,T,[f,S,d,p])}k=f-h;var A=Math.cos(h),D=Math.sin(h),j=Math.cos(f),L=Math.sin(f),B=Math.tan(k/4),N=4/3*t*B,R=4/3*r*B,P=[e,n],H=[e+N*D,n-R*A],ne=[s+N*L,u-R*j],Z=[s,u];if(H[0]=2*P[0]-H[0],H[1]=2*P[1]-H[1],c)return[H,ne,Z].concat(m);for(var q=[],te=0,we=(m=[H,ne,Z].concat(m).join().split(",")).length;te<we;te++)q[te]=te%2?y(m[te-1],m[te],v).y:y(m[te],m[te+1],v).x;return q},Y0=function(e,n){var t,r=X0(e),i=n&&X0(n),o={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s=[],u=[],c="",l="",h=function(b,x,w){var E,M;if(!b)return["C",x.x,x.y,x.x,x.y,x.x,x.y];switch(!(b[0]in{T:1,Q:1})&&(x.qx=x.qy=null),b[0]){case"M":x.X=b[1],x.Y=b[2];break;case"A":b=["C"].concat(nM.apply(0,[x.x,x.y].concat(b.slice(1))));break;case"S":w==="C"||w==="S"?(E=2*x.x-x.bx,M=2*x.y-x.by):(E=x.x,M=x.y),b=["C",E,M].concat(b.slice(1));break;case"T":w==="Q"||w==="T"?(x.qx=2*x.x-x.qx,x.qy=2*x.y-x.qy):(x.qx=x.x,x.qy=x.y),b=["C"].concat(tM(x.x,x.y,x.qx,x.qy,b[1],b[2]));break;case"Q":x.qx=b[1],x.qy=b[2],b=["C"].concat(tM(x.x,x.y,b[1],b[2],b[3],b[4]));break;case"L":b=["C"].concat(df(x.x,x.y,b[1],b[2]));break;case"H":b=["C"].concat(df(x.x,x.y,b[1],x.y));break;case"V":b=["C"].concat(df(x.x,x.y,x.x,b[1]));break;case"Z":b=["C"].concat(df(x.x,x.y,x.X,x.Y))}return b},f=function(b,x){if(b[x].length>7){b[x].shift();for(var w=b[x];w.length;)s[x]="A",i&&(u[x]="A"),b.splice(x++,0,["C"].concat(w.splice(0,6)));b.splice(x,1),t=Math.max(r.length,i&&i.length||0)}},d=function(b,x,w,E,M){b&&x&&b[M][0]==="M"&&x[M][0]!=="M"&&(x.splice(M,0,["M",E.x,E.y]),w.bx=0,w.by=0,w.x=b[M][1],w.y=b[M][2],t=Math.max(r.length,i&&i.length||0))};t=Math.max(r.length,i&&i.length||0);for(var p=0;p<t;p++){r[p]&&(c=r[p][0]),c!=="C"&&(s[p]=c,p&&(l=s[p-1])),r[p]=h(r[p],o,l),s[p]!=="A"&&c==="C"&&(s[p]="C"),f(r,p),i&&(i[p]&&(c=i[p][0]),c!=="C"&&(u[p]=c,p&&(l=u[p-1])),i[p]=h(i[p],a,l),u[p]!=="A"&&c==="C"&&(u[p]="C"),f(i,p)),d(r,i,o,a,p),d(i,r,a,o,p);var g=r[p],v=i&&i[p],m=g.length,y=i&&v.length;o.x=g[m-2],o.y=g[m-1],o.bx=parseFloat(g[m-4])||o.x,o.by=parseFloat(g[m-3])||o.y,a.bx=i&&(parseFloat(v[y-4])||a.x),a.by=i&&(parseFloat(v[y-3])||a.y),a.x=i&&v[y-2],a.y=i&&v[y-1]}return i?[r,i]:r},k4=/,?([a-z]),?/gi,rM=function(e){return e.join(",").replace(k4,"$1")},iM=function(e,n,t,r,i){return e*(e*(-3*n+9*t-9*r+3*i)+6*n-12*t+6*r)-3*n+3*t},oM=function(e,n,t,r,i,o,a,s,u){u===null&&(u=1);for(var c=(u=u>1?1:u<0?0:u)/2,l=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],h=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],f=0,d=0;d<12;d++){var p=c*l[d]+c,g=iM(p,e,t,i,a),v=iM(p,n,r,o,s),m=g*g+v*v;f+=h[d]*Math.sqrt(m)}return c*f},C4=function(e,n,t,r,i,o,a,s){for(var u,c,l,h,f=[],d=[[],[]],p=0;p<2;++p)if(p===0?(c=6*e-12*t+6*i,u=-3*e+9*t-9*i+3*a,l=3*t-3*e):(c=6*n-12*r+6*o,u=-3*n+9*r-9*o+3*s,l=3*r-3*n),Math.abs(u)<1e-12){if(Math.abs(c)<1e-12)continue;(h=-l/c)>0&&h<1&&f.push(h)}else{var g=c*c-4*l*u,v=Math.sqrt(g);if(!(g<0)){var m=(-c+v)/(2*u);m>0&&m<1&&f.push(m);var y=(-c-v)/(2*u);y>0&&y<1&&f.push(y)}}for(var b,x=f.length,w=x;x--;)b=1-(h=f[x]),d[0][x]=b*b*b*e+3*b*b*h*t+3*b*h*h*i+h*h*h*a,d[1][x]=b*b*b*n+3*b*b*h*r+3*b*h*h*o+h*h*h*s;return d[0][w]=e,d[1][w]=n,d[0][w+1]=a,d[1][w+1]=s,d[0].length=d[1].length=w+2,{min:{x:Math.min.apply(0,d[0]),y:Math.min.apply(0,d[1])},max:{x:Math.max.apply(0,d[0]),y:Math.max.apply(0,d[1])}}},A4=function(e,n,t,r,i,o,a,s){if(!(Math.max(e,t)<Math.min(i,a)||Math.min(e,t)>Math.max(i,a)||Math.max(n,r)<Math.min(o,s)||Math.min(n,r)>Math.max(o,s))){var u=(e-t)*(o-s)-(n-r)*(i-a);if(u){var c=((e*r-n*t)*(i-a)-(e-t)*(i*s-o*a))/u,l=((e*r-n*t)*(o-s)-(n-r)*(i*s-o*a))/u,h=+c.toFixed(2),f=+l.toFixed(2);if(!(h<+Math.min(e,t).toFixed(2)||h>+Math.max(e,t).toFixed(2)||h<+Math.min(i,a).toFixed(2)||h>+Math.max(i,a).toFixed(2)||f<+Math.min(n,r).toFixed(2)||f>+Math.max(n,r).toFixed(2)||f<+Math.min(o,s).toFixed(2)||f>+Math.max(o,s).toFixed(2)))return{x:c,y:l}}}},Qo=function(e,n,t){return n>=e.x&&n<=e.x+e.width&&t>=e.y&&t<=e.y+e.height},aM=function(e,n,t,r,i){if(i)return[["M",+e+ +i,n],["l",t-2*i,0],["a",i,i,0,0,1,i,i],["l",0,r-2*i],["a",i,i,0,0,1,-i,i],["l",2*i-t,0],["a",i,i,0,0,1,-i,-i],["l",0,2*i-r],["a",i,i,0,0,1,i,-i],["z"]];var o=[["M",e,n],["l",t,0],["l",0,r],["l",-t,0],["z"]];return o.parsePathArray=rM,o},W0=function(e,n,t,r){return e===null&&(e=n=t=r=0),n===null&&(n=e.y,t=e.width,r=e.height,e=e.x),{x:e,y:n,width:t,w:t,height:r,h:r,x2:e+t,y2:n+r,cx:e+t/2,cy:n+r/2,r1:Math.min(t,r)/2,r2:Math.max(t,r)/2,r0:Math.sqrt(t*t+r*r)/2,path:aM(e,n,t,r),vb:[e,n,t,r].join(" ")}},sM=function(e,n,t,r,i,o,a,s){Mt(e)||(e=[e,n,t,r,i,o,a,s]);var u=C4.apply(null,e);return W0(u.min.x,u.min.y,u.max.x-u.min.x,u.max.y-u.min.y)},uM=function(e,n,t,r,i,o,a,s,u){var c=1-u,l=Math.pow(c,3),h=Math.pow(c,2),f=u*u,d=f*u,p=e+2*u*(t-e)+f*(i-2*t+e),g=n+2*u*(r-n)+f*(o-2*r+n),v=t+2*u*(i-t)+f*(a-2*i+t),m=r+2*u*(o-r)+f*(s-2*o+r);return{x:l*e+3*h*u*t+3*c*u*u*i+d*a,y:l*n+3*h*u*r+3*c*u*u*o+d*s,m:{x:p,y:g},n:{x:v,y:m},start:{x:c*e+u*t,y:c*n+u*r},end:{x:c*i+u*a,y:c*o+u*s},alpha:90-180*Math.atan2(p-v,g-m)/Math.PI}},I4=function(e,n,t){if(!function(w,E){return w=W0(w),E=W0(E),Qo(E,w.x,w.y)||Qo(E,w.x2,w.y)||Qo(E,w.x,w.y2)||Qo(E,w.x2,w.y2)||Qo(w,E.x,E.y)||Qo(w,E.x2,E.y)||Qo(w,E.x,E.y2)||Qo(w,E.x2,E.y2)||(w.x<E.x2&&w.x>E.x||E.x<w.x2&&E.x>w.x)&&(w.y<E.y2&&w.y>E.y||E.y<w.y2&&E.y>w.y)}(sM(e),sM(n)))return[];for(var r=~~(oM.apply(0,e)/8),i=~~(oM.apply(0,n)/8),o=[],a=[],s={},u=[],c=0;c<r+1;c++){var l=uM.apply(0,e.concat(c/r));o.push({x:l.x,y:l.y,t:c/r})}for(c=0;c<i+1;c++)l=uM.apply(0,n.concat(c/i)),a.push({x:l.x,y:l.y,t:c/i});for(c=0;c<r;c++)for(var h=0;h<i;h++){var f=o[c],d=o[c+1],p=a[h],g=a[h+1],v=Math.abs(d.x-f.x)<.001?"y":"x",m=Math.abs(g.x-p.x)<.001?"y":"x",y=A4(f.x,f.y,d.x,d.y,p.x,p.y,g.x,g.y);if(y){if(s[y.x.toFixed(4)]===y.y.toFixed(4))continue;s[y.x.toFixed(4)]=y.y.toFixed(4);var b=f.t+Math.abs((y[v]-f[v])/(d[v]-f[v]))*(d.t-f.t),x=p.t+Math.abs((y[m]-p[m])/(g[m]-p[m]))*(g.t-p.t);b>=0&&b<=1&&x>=0&&x<=1&&u.push({x:y.x,y:y.y,t1:b,t2:x})}}return u};function T4(e,n){var t=[],r=[];return e.length&&function i(o,a){if(o.length===1)t.push(o[0]),r.push(o[0]);else{for(var s=[],u=0;u<o.length-1;u++)u===0&&t.push(o[0]),u===o.length-2&&r.push(o[u+1]),s[u]=[(1-a)*o[u][0]+a*o[u+1][0],(1-a)*o[u][1]+a*o[u+1][1]];i(s,a)}}(e,n),{left:t,right:r.reverse()}}var O4=function(e,n,t){if(t===1)return[[].concat(e)];var r=[];if(n[0]==="L"||n[0]==="C"||n[0]==="Q")r=r.concat(function(a,s,u){var c=[[a[1],a[2]]];u=u||2;var l=[];s[0]==="A"?(c.push(s[6]),c.push(s[7])):s[0]==="C"?(c.push([s[1],s[2]]),c.push([s[3],s[4]]),c.push([s[5],s[6]])):s[0]==="S"||s[0]==="Q"?(c.push([s[1],s[2]]),c.push([s[3],s[4]])):c.push([s[1],s[2]]);for(var h=c,f=1/u,d=0;d<u-1;d++){var p=T4(h,f/(1-f*d));l.push(p.left),h=p.right}return l.push(h),l.map(function(g){var v=[];return g.length===4&&(v.push("C"),v=v.concat(g[2])),g.length>=3&&(g.length===3&&v.push("Q"),v=v.concat(g[1])),g.length===2&&v.push("L"),v.concat(g[g.length-1])})}(e,n,t));else{var i=[].concat(e);i[0]==="M"&&(i[0]="L");for(var o=0;o<=t-1;o++)r.push(i)}return r},N4=function(e,n){if(e.length!==n.length)return!1;var t=!0;return ye(e,function(r,i){if(r!==n[i])return t=!1,!1}),t};function D4(e,n,t){var r=null,i=t;return n<i&&(i=n,r="add"),e<i&&(i=e,r="del"),{type:r,min:i}}var cM=function(e,n){var t=function(f,d){var p,g,v=f.length,m=d.length,y=0;if(v===0||m===0)return null;for(var b=[],x=0;x<=v;x++)b[x]=[],b[x][0]={min:x};for(var w=0;w<=m;w++)b[0][w]={min:w};for(x=1;x<=v;x++)for(p=f[x-1],w=1;w<=m;w++){g=d[w-1],y=N4(p,g)?0:1;var E=b[x-1][w].min+1,M=b[x][w-1].min+1,_=b[x-1][w-1].min+y;b[x][w]=D4(E,M,_)}return b}(e,n),r=e.length,i=n.length,o=[],a=1,s=1;if(t[r][i].min!==r){for(var u=1;u<=r;u++){var c=t[u][u].min;s=u;for(var l=a;l<=i;l++)t[u][l].min<c&&(c=t[u][l].min,s=l);a=s,t[u][a].type&&o.push({index:u-1,type:t[u][a].type})}for(u=o.length-1;u>=0;u--)a=o[u].index,o[u].type==="add"?e.splice(a,0,[].concat(e[a])):e.splice(a,1)}var h=i-(r=e.length);if(r<i)for(u=0;u<h;u++)e[r-1][0]==="z"||e[r-1][0]==="Z"?e.splice(r-2,0,e[r-2]):e.push(e[r-1]),r+=1;return e};function V0(e,n,t){for(var r,i=[].concat(e),o=1/(t+1),a=lM(n)[0],s=1;s<=t;s++)o*=s,(r=Math.floor(e.length*o))===0?i.unshift([a[0]*o+e[r][0]*(1-o),a[1]*o+e[r][1]*(1-o)]):i.splice(r,0,[a[0]*o+e[r][0]*(1-o),a[1]*o+e[r][1]*(1-o)]);return i}function lM(e){var n=[];switch(e[0]){case"M":case"L":case"T":n.push([e[1],e[2]]);break;case"A":n.push([e[6],e[7]]);break;case"Q":case"S":n.push([e[3],e[4]]),n.push([e[1],e[2]]);break;case"C":n.push([e[5],e[6]]),n.push([e[1],e[2]]),n.push([e[3],e[4]]);break;case"H":case"V":n.push([e[1],e[1]])}return n}var H0=function(e,n){if(e.length<=1)return e;for(var t,r=0;r<n.length;r++)if(e[r][0]!==n[r][0])switch(t=lM(e[r]),n[r][0]){case"M":e[r]=["M"].concat(t[0]);break;case"L":e[r]=["L"].concat(t[0]);break;case"A":e[r]=[].concat(n[r]),e[r][6]=t[0][0],e[r][7]=t[0][1];break;case"Q":if(t.length<2){if(!(r>0)){e[r]=n[r];break}t=V0(t,e[r-1],1)}e[r]=["Q"].concat(t.reduce(function(i,o){return i.concat(o)},[]));break;case"T":e[r]=["T"].concat(t[0]);break;case"C":if(t.length<3){if(!(r>0)){e[r]=n[r];break}t=V0(t,e[r-1],2)}e[r]=["C"].concat(t.reduce(function(i,o){return i.concat(o)},[]));break;case"S":if(t.length<2){if(!(r>0)){e[r]=n[r];break}t=V0(t,e[r-1],1)}e[r]=["S"].concat(t.reduce(function(i,o){return i.concat(o)},[]));break;default:e[r]=n[r]}return e};const P4=Object.freeze(Object.defineProperty({__proto__:null,catmullRomToBezier:U0,fillPath:function(e,n){if(e.length===1)return e;var t=e.length-1,r=n.length-1,i=t/r,o=[];if(e.length===1&&e[0][0]==="M"){for(var a=0;a<r-t;a++)e.push(e[0]);return e}for(a=0;a<r;a++){var s=Math.floor(i*a);o[s]=(o[s]||0)+1}var u=o.reduce(function(c,l,h){return h===t?c.concat(e[t]):c.concat(O4(e[h],e[h+1],l))},[]);return u.unshift(e[0]),n[r]!=="Z"&&n[r]!=="z"||u.push("Z"),u},fillPathByDiff:cM,formatPath:H0,intersection:function(e,n){return function(t,r,i){var o,a,s,u,c,l,h,f,d,p;t=Y0(t),r=Y0(r);for(var g=i?0:[],v=0,m=t.length;v<m;v++){var y=t[v];if(y[0]==="M")o=c=y[1],a=l=y[2];else{y[0]==="C"?(d=[o,a].concat(y.slice(1)),o=d[6],a=d[7]):(d=[o,a,o,a,c,l,c,l],o=c,a=l);for(var b=0,x=r.length;b<x;b++){var w=r[b];if(w[0]==="M")s=h=w[1],u=f=w[2];else{w[0]==="C"?(p=[s,u].concat(w.slice(1)),s=p[6],u=p[7]):(p=[s,u,s,u,h,f,h,f],s=h,u=f);for(var E=I4(d,p),M=0,_=E.length;M<_;M++)E[M].segment1=v,E[M].segment2=b,E[M].bez1=d,E[M].bez2=p;g=g.concat(E)}}}}return g}(e,n)},parsePathArray:rM,parsePathString:Ks,pathToAbsolute:X0,pathToCurve:Y0,rectPath:aM},Symbol.toStringTag,{value:"Module"}));var hM=function(){function e(n,t){this.bubbles=!0,this.target=null,this.currentTarget=null,this.delegateTarget=null,this.delegateObject=null,this.defaultPrevented=!1,this.propagationStopped=!1,this.shape=null,this.fromShape=null,this.toShape=null,this.propagationPath=[],this.type=n,this.name=n,this.originalEvent=t,this.timeStamp=t.timeStamp}return e.prototype.preventDefault=function(){this.defaultPrevented=!0,this.originalEvent.preventDefault&&this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){this.propagationStopped=!0},e.prototype.toString=function(){return"[Event (type="+this.type+")]"},e.prototype.save=function(){},e.prototype.restore=function(){},e}();function fM(e,n){var t=e.indexOf(n);t!==-1&&e.splice(t,1)}var dM=typeof window<"u"&&window.document!==void 0;function pM(e,n){if(e.isCanvas())return!0;for(var t=n.getParent(),r=!1;t;){if(t===e){r=!0;break}t=t.getParent()}return r}function q0(e){return e.cfg.visible&&e.cfg.capture}var L4=function(e){function n(t){var r=e.call(this)||this;r.destroyed=!1;var i=r.getDefaultCfg();return r.cfg=St(i,t),r}return Nt(n,e),n.prototype.getDefaultCfg=function(){return{}},n.prototype.get=function(t){return this.cfg[t]},n.prototype.set=function(t,r){this.cfg[t]=r},n.prototype.destroy=function(){this.cfg={destroyed:!0},this.off(),this.destroyed=!0},n}(zw),gM=function(e,n,t){if(t||arguments.length===2)for(var r,i=0,o=n.length;i<o;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))},R4=function(e,n,t){this.name=e,this.version=n,this.os=t,this.type="browser"},j4=function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform},B4=function(e,n,t,r){this.name=e,this.version=n,this.os=t,this.bot=r,this.type="bot-device"},z4=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},F4=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},G4=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,U4=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],vM=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function mM(e){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new F4:typeof navigator<"u"?function(n){var t=function(c){return c!==""&&U4.reduce(function(l,h){var f=h[0],d=h[1];if(l)return l;var p=d.exec(c);return!!p&&[f,p]},!1)}(n);if(!t)return null;var r=t[0],i=t[1];if(r==="searchbot")return new z4;var o=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);o?o.length<3&&(o=gM(gM([],o,!0),function(c){for(var l=[],h=0;h<c;h++)l.push("0");return l}(3-o.length),!0)):o=[];var a=o.join("."),s=function(c){for(var l=0,h=vM.length;l<h;l++){var f=vM[l],d=f[0];if(f[1].exec(c))return d}return null}(n),u=G4.exec(n);return u&&u[1]?new B4(r,a,s,u[1]):new R4(r,a,s)}(navigator.userAgent):typeof process<"u"&&process.version?new j4(process.version.slice(1)):null}function yM(e,n){var t=[],r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=n[0],d=n[1],p=n[2],g=n[3],v=n[4],m=n[5],y=n[6],b=n[7],x=n[8];return t[0]=f*r+d*a+p*c,t[1]=f*i+d*s+p*l,t[2]=f*o+d*u+p*h,t[3]=g*r+v*a+m*c,t[4]=g*i+v*s+m*l,t[5]=g*o+v*u+m*h,t[6]=y*r+b*a+x*c,t[7]=y*i+b*s+x*l,t[8]=y*o+b*u+x*h,t}function Za(e,n){var t=[],r=n[0],i=n[1];return t[0]=e[0]*r+e[3]*i+e[6],t[1]=e[1]*r+e[4]*i+e[7],t}function bM(e){var n=[],t=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=l*a-s*c,f=-l*o+s*u,d=c*o-a*u,p=t*h+r*f+i*d;return p?(p=1/p,n[0]=h*p,n[1]=(-l*r+i*c)*p,n[2]=(s*r-i*a)*p,n[3]=f*p,n[4]=(l*t-i*u)*p,n[5]=(-s*t+i*o)*p,n[6]=d*p,n[7]=(-c*t+r*u)*p,n[8]=(a*t-r*o)*p,n):null}var wc=Qr,Z0="matrix",X4=["zIndex","capture","visible","type"],Y4=["repeat"];function W4(e,n){var t={},r=n.attrs;for(var i in e)t[i]=r[i];return t}var xM=function(e){function n(t){var r=e.call(this,t)||this;r.attrs={};var i=r.getDefaultAttrs();return St(i,t.attrs),r.attrs=i,r.initAttrs(i),r.initAnimate(),r}return Nt(n,e),n.prototype.getDefaultCfg=function(){return{visible:!0,capture:!0,zIndex:0}},n.prototype.getDefaultAttrs=function(){return{matrix:this.getDefaultMatrix(),opacity:1}},n.prototype.onCanvasChange=function(t){},n.prototype.initAttrs=function(t){},n.prototype.initAnimate=function(){this.set("animable",!0),this.set("animating",!1)},n.prototype.isGroup=function(){return!1},n.prototype.getParent=function(){return this.get("parent")},n.prototype.getCanvas=function(){return this.get("canvas")},n.prototype.attr=function(){for(var t,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=r[0],a=r[1];if(!o)return this.attrs;if(tr(o)){for(var s in o)this.setAttr(s,o[s]);return this.afterAttrsChange(o),this}return r.length===2?(this.setAttr(o,a),this.afterAttrsChange(((t={})[o]=a,t)),this):this.attrs[o]},n.prototype.isClipped=function(t,r){var i=this.getClip();return i&&!i.isHit(t,r)},n.prototype.setAttr=function(t,r){var i=this.attrs[t];i!==r&&(this.attrs[t]=r,this.onAttrChange(t,r,i))},n.prototype.onAttrChange=function(t,r,i){t==="matrix"&&this.set("totalMatrix",null)},n.prototype.afterAttrsChange=function(t){if(this.cfg.isClipShape){var r=this.cfg.applyTo;r&&r.onCanvasChange("clip")}else this.onCanvasChange("attr")},n.prototype.show=function(){return this.set("visible",!0),this.onCanvasChange("show"),this},n.prototype.hide=function(){return this.set("visible",!1),this.onCanvasChange("hide"),this},n.prototype.setZIndex=function(t){this.set("zIndex",t);var r=this.getParent();return r&&r.sort(),this},n.prototype.toFront=function(){var t=this.getParent();if(t){var r=t.getChildren();this.get("el");var i=r.indexOf(this);r.splice(i,1),r.push(this),this.onCanvasChange("zIndex")}},n.prototype.toBack=function(){var t=this.getParent();if(t){var r=t.getChildren();this.get("el");var i=r.indexOf(this);r.splice(i,1),r.unshift(this),this.onCanvasChange("zIndex")}},n.prototype.remove=function(t){t===void 0&&(t=!0);var r=this.getParent();r?(fM(r.getChildren(),this),r.get("clearing")||this.onCanvasChange("remove")):this.onCanvasChange("remove"),t&&this.destroy()},n.prototype.resetMatrix=function(){this.attr(Z0,this.getDefaultMatrix()),this.onCanvasChange("matrix")},n.prototype.getMatrix=function(){return this.attr(Z0)},n.prototype.setMatrix=function(t){this.attr(Z0,t),this.onCanvasChange("matrix")},n.prototype.getTotalMatrix=function(){var t=this.cfg.totalMatrix;if(!t){var r=this.attr("matrix"),i=this.cfg.parentMatrix;t=i&&r?yM(i,r):r||i,this.set("totalMatrix",t)}return t},n.prototype.applyMatrix=function(t){var r=this.attr("matrix"),i=null;i=t&&r?yM(t,r):r||t,this.set("totalMatrix",i),this.set("parentMatrix",t)},n.prototype.getDefaultMatrix=function(){return null},n.prototype.applyToMatrix=function(t){var r=this.attr("matrix");return r?Za(r,t):t},n.prototype.invertFromMatrix=function(t){var r=this.attr("matrix");if(r){var i=bM(r);if(i)return Za(i,t)}return t},n.prototype.setClip=function(t){var r=this.getCanvas(),i=null;if(t){var o=this.getShapeBase()[Vs(t.type)];o&&(i=new o({type:t.type,isClipShape:!0,applyTo:this,attrs:t.attrs,canvas:r}))}return this.set("clipShape",i),this.onCanvasChange("clip"),i},n.prototype.getClip=function(){var t=this.cfg.clipShape;return t||null},n.prototype.clone=function(){var t=this,r=this.attrs,i={};ye(r,function(a,s){Mt(r[s])?i[s]=function(u){for(var c=[],l=0;l<u.length;l++)Mt(u[l])?c.push([].concat(u[l])):c.push(u[l]);return c}(r[s]):i[s]=r[s]});var o=new this.constructor({attrs:i});return ye(X4,function(a){o.set(a,t.get(a))}),o},n.prototype.destroy=function(){this.destroyed||(this.attrs={},e.prototype.destroy.call(this))},n.prototype.isAnimatePaused=function(){return this.get("_pause").isPaused},n.prototype.animate=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(this.get("timeline")||this.get("canvas")){this.set("animating",!0);var i=this.get("timeline");i||(i=this.get("canvas").get("timeline"),this.set("timeline",i));var o=this.get("animations")||[];i.timer||i.initTimer();var a,s,u,c,l,h=t[0],f=t[1],d=t[2],p=d===void 0?"easeLinear":d,g=t[3],v=g===void 0?pc:g,m=t[4],y=m===void 0?0:m;mn(h)?(a=h,h={}):tr(h)&&h.onFrame&&(a=h.onFrame,s=h.repeat),tr(f)?(f=(l=f).duration,p=l.easing||"easeLinear",y=l.delay||0,s=l.repeat||s||!1,v=l.callback||pc,u=l.pauseCallback||pc,c=l.resumeCallback||pc):(xt(v)&&(y=v,v=null),mn(p)?(v=p,p="easeLinear"):p=p||"easeLinear");var b=function(w,E){var M={},_=E.attr();return ye(w,function(k,S){Y4.indexOf(S)!==-1||qo(_[S],k)||(M[S]=k)}),M}(h,this),x={fromAttrs:W4(b,this),toAttrs:b,duration:f,easing:p,repeat:s,callback:v,pauseCallback:u,resumeCallback:c,delay:y,startTime:i.getTime(),id:Ui(),onFrame:a,pathFormatted:!1};o.length>0?o=function(w,E){if(E.onFrame)return w;var M=E.startTime,_=E.delay,k=E.duration,S=Object.prototype.hasOwnProperty;return ye(w,function(C){M+_<C.startTime+C.delay+C.duration&&k>C.delay&&ye(E.toAttrs,function(T,A){S.call(C.toAttrs,A)&&(delete C.toAttrs[A],delete C.fromAttrs[A])})}),w}(o,x):i.addAnimator(this),o.push(x),this.set("animations",o),this.set("_pause",{isPaused:!1})}},n.prototype.stopAnimate=function(t){var r=this;t===void 0&&(t=!0),ye(this.get("animations"),function(i){t&&(i.onFrame?r.attr(i.onFrame(1)):r.attr(i.toAttrs)),i.callback&&i.callback()}),this.set("animating",!1),this.set("animations",[])},n.prototype.pauseAnimate=function(){var t=this.get("timeline"),r=this.get("animations"),i=t.getTime();return ye(r,function(o){o._paused=!0,o._pauseTime=i,o.pauseCallback&&o.pauseCallback()}),this.set("_pause",{isPaused:!0,pauseTime:i}),this},n.prototype.resumeAnimate=function(){var t=this.get("timeline").getTime(),r=this.get("animations"),i=this.get("_pause").pauseTime;return ye(r,function(o){o.startTime=o.startTime+(t-i),o._paused=!1,o._pauseTime=null,o.resumeCallback&&o.resumeCallback()}),this.set("_pause",{isPaused:!1}),this.set("animations",r),this},n.prototype.emitDelegation=function(t,r){var i,o=this,a=r.propagationPath;this.getEvents(),t==="mouseenter"?i=r.fromShape:t==="mouseleave"&&(i=r.toShape);for(var s=function(l){var h=a[l],f=h.get("name");if(f){if((h.isGroup()||h.isCanvas&&h.isCanvas())&&i&&pM(h,i))return"break";Mt(f)?ye(f,function(d){o.emitDelegateEvent(h,d,r)}):u.emitDelegateEvent(h,f,r)}},u=this,c=0;c<a.length&&s(c)!=="break";c++);},n.prototype.emitDelegateEvent=function(t,r,i){var o=this.getEvents(),a=r+":"+i.type;(o[a]||o["*"])&&(i.name=a,i.currentTarget=t,i.delegateTarget=this,i.delegateObject=t.get("delegateObject"),this.emit(a,i))},n.prototype.translate=function(t,r){t===void 0&&(t=0),r===void 0&&(r=0);var i=this.getMatrix(),o=wc(i,[["t",t,r]]);return this.setMatrix(o),this},n.prototype.move=function(t,r){var i=this.attr("x")||0,o=this.attr("y")||0;return this.translate(t-i,r-o),this},n.prototype.moveTo=function(t,r){return this.move(t,r)},n.prototype.scale=function(t,r){var i=this.getMatrix(),o=wc(i,[["s",t,r||t]]);return this.setMatrix(o),this},n.prototype.rotate=function(t){var r=this.getMatrix(),i=wc(r,[["r",t]]);return this.setMatrix(i),this},n.prototype.rotateAtStart=function(t){var r=this.attr(),i=r.x,o=r.y,a=this.getMatrix(),s=wc(a,[["t",-i,-o],["r",t],["t",i,o]]);return this.setMatrix(s),this},n.prototype.rotateAtPoint=function(t,r,i){var o=this.getMatrix(),a=wc(o,[["t",-t,-r],["r",i],["t",t,r]]);return this.setMatrix(a),this},n}(L4),wM={},K0="_INDEX";function EM(e,n){if(e.set("canvas",n),e.isGroup()){var t=e.get("children");t.length&&t.forEach(function(r){EM(r,n)})}}function MM(e,n){if(e.set("timeline",n),e.isGroup()){var t=e.get("children");t.length&&t.forEach(function(r){MM(r,n)})}}var pf,Ec,SM=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.isCanvas=function(){return!1},n.prototype.getBBox=function(){var t=1/0,r=-1/0,i=1/0,o=-1/0,a=this.getChildren().filter(function(s){return s.get("visible")&&(!s.isGroup()||s.isGroup()&&s.getChildren().length>0)});return a.length>0?ye(a,function(s){var u=s.getBBox(),c=u.minX,l=u.maxX,h=u.minY,f=u.maxY;c<t&&(t=c),l>r&&(r=l),h<i&&(i=h),f>o&&(o=f)}):(t=0,r=0,i=0,o=0),{x:t,y:i,minX:t,minY:i,maxX:r,maxY:o,width:r-t,height:o-i}},n.prototype.getCanvasBBox=function(){var t=1/0,r=-1/0,i=1/0,o=-1/0,a=this.getChildren().filter(function(s){return s.get("visible")&&(!s.isGroup()||s.isGroup()&&s.getChildren().length>0)});return a.length>0?ye(a,function(s){var u=s.getCanvasBBox(),c=u.minX,l=u.maxX,h=u.minY,f=u.maxY;c<t&&(t=c),l>r&&(r=l),h<i&&(i=h),f>o&&(o=f)}):(t=0,r=0,i=0,o=0),{x:t,y:i,minX:t,minY:i,maxX:r,maxY:o,width:r-t,height:o-i}},n.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return t.children=[],t},n.prototype.onAttrChange=function(t,r,i){if(e.prototype.onAttrChange.call(this,t,r,i),t==="matrix"){var o=this.getTotalMatrix();this._applyChildrenMarix(o)}},n.prototype.applyMatrix=function(t){var r=this.getTotalMatrix();e.prototype.applyMatrix.call(this,t);var i=this.getTotalMatrix();i!==r&&this._applyChildrenMarix(i)},n.prototype._applyChildrenMarix=function(t){ye(this.getChildren(),function(r){r.applyMatrix(t)})},n.prototype.addShape=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=t[0],o=t[1];tr(i)?o=i:o.type=i;var a=wM[o.type];a||(a=Vs(o.type),wM[o.type]=a);var s=new(this.getShapeBase())[a](o);return this.add(s),s},n.prototype.addGroup=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i,o=t[0],a=t[1];if(mn(o))i=new o(a||{parent:this});else{var s=o||{};i=new(this.getGroupBase())(s)}return this.add(i),i},n.prototype.getCanvas=function(){return this.isCanvas()?this:this.get("canvas")},n.prototype.getShape=function(t,r,i){if(!q0(this))return null;var o,a=this.getChildren();if(this.isCanvas())o=this._findShape(a,t,r,i);else{var s=[t,r,1];s=this.invertFromMatrix(s),this.isClipped(s[0],s[1])||(o=this._findShape(a,s[0],s[1],i))}return o},n.prototype._findShape=function(t,r,i,o){for(var a=null,s=t.length-1;s>=0;s--){var u=t[s];if(q0(u)&&(u.isGroup()?a=u.getShape(r,i,o):u.isHit(r,i)&&(a=u)),a)break}return a},n.prototype.add=function(t){var r=this.getCanvas(),i=this.getChildren(),o=this.get("timeline"),a=t.getParent();a&&function(s,u){u.set("parent",null),u.set("canvas",null),fM(s.getChildren(),u)}(a,t),t.set("parent",this),r&&EM(t,r),o&&MM(t,o),i.push(t),t.onCanvasChange("add"),this._applyElementMatrix(t)},n.prototype._applyElementMatrix=function(t){var r=this.getTotalMatrix();r&&t.applyMatrix(r)},n.prototype.getChildren=function(){return this.get("children")||[]},n.prototype.sort=function(){var t=this.getChildren();ye(t,function(r,i){return r[K0]=i,r}),t.sort(function(r){return function(i,o){var a=r(i,o);return a===0?i[K0]-o[K0]:a}}(function(r,i){return r.get("zIndex")-i.get("zIndex")})),this.onCanvasChange("sort")},n.prototype.clear=function(){if(this.set("clearing",!0),!this.destroyed){for(var t=this.getChildren(),r=t.length-1;r>=0;r--)t[r].destroy();this.set("children",[]),this.onCanvasChange("clear"),this.set("clearing",!1)}},n.prototype.destroy=function(){this.get("destroyed")||(this.clear(),e.prototype.destroy.call(this))},n.prototype.getFirst=function(){return this.getChildByIndex(0)},n.prototype.getLast=function(){var t=this.getChildren();return this.getChildByIndex(t.length-1)},n.prototype.getChildByIndex=function(t){return this.getChildren()[t]},n.prototype.getCount=function(){return this.getChildren().length},n.prototype.contain=function(t){return this.getChildren().indexOf(t)>-1},n.prototype.removeChild=function(t,r){r===void 0&&(r=!0),this.contain(t)&&t.remove(r)},n.prototype.findAll=function(t){var r=[];return ye(this.getChildren(),function(i){t(i)&&r.push(i),i.isGroup()&&(r=r.concat(i.findAll(t)))}),r},n.prototype.find=function(t){var r=null;return ye(this.getChildren(),function(i){if(t(i)?r=i:i.isGroup()&&(r=i.find(t)),r)return!1}),r},n.prototype.findById=function(t){return this.find(function(r){return r.get("id")===t})},n.prototype.findByClassName=function(t){return this.find(function(r){return r.get("className")===t})},n.prototype.findAllByName=function(t){return this.findAll(function(r){return r.get("name")===t})},n}(xM),$s=0,Mc=0,Sc=0,gf=0,Ka=0,vf=0,_c=typeof performance=="object"&&performance.now?performance:Date,_M=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function kM(){return Ka||(_M(V4),Ka=_c.now()+vf)}function V4(){Ka=0}function $0(){this._call=this._time=this._next=null}function CM(e,n,t){var r=new $0;return r.restart(e,n,t),r}function AM(){Ka=(gf=_c.now())+vf,$s=Mc=0;try{(function(){kM(),++$s;for(var e,n=pf;n;)(e=Ka-n._time)>=0&&n._call.call(null,e),n=n._next;--$s})()}finally{$s=0,function(){for(var e,n,t=pf,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:pf=n);Ec=e,Q0(r)}(),Ka=0}}function H4(){var e=_c.now(),n=e-gf;n>1e3&&(vf-=n,gf=e)}function Q0(e){$s||(Mc&&(Mc=clearTimeout(Mc)),e-Ka>24?(e<1/0&&(Mc=setTimeout(AM,e-_c.now()-vf)),Sc&&(Sc=clearInterval(Sc))):(Sc||(gf=_c.now(),Sc=setInterval(H4,1e3)),$s=1,_M(AM)))}function J0(e,n,t){e.prototype=n.prototype=t,t.constructor=e}function IM(e,n){var t=Object.create(e.prototype);for(var r in n)t[r]=n[r];return t}function kc(){}$0.prototype=CM.prototype={constructor:$0,restart:function(e,n,t){if(typeof e!="function")throw new TypeError("callback is not a function");t=(t==null?kM():+t)+(n==null?0:+n),this._next||Ec===this||(Ec?Ec._next=this:pf=this,Ec=this),this._call=e,this._time=t,Q0()},stop:function(){this._call&&(this._call=null,this._time=1/0,Q0())}};var Cc=.7,mf=1/Cc,Qs="\\s*([+-]?\\d+)\\s*",Ac="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Hi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",q4=/^#([0-9a-f]{3,8})$/,Z4=new RegExp(`^rgb\\(${Qs},${Qs},${Qs}\\)$`),K4=new RegExp(`^rgb\\(${Hi},${Hi},${Hi}\\)$`),$4=new RegExp(`^rgba\\(${Qs},${Qs},${Qs},${Ac}\\)$`),Q4=new RegExp(`^rgba\\(${Hi},${Hi},${Hi},${Ac}\\)$`),J4=new RegExp(`^hsl\\(${Ac},${Hi},${Hi}\\)$`),e6=new RegExp(`^hsla\\(${Ac},${Hi},${Hi},${Ac}\\)$`),TM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function OM(){return this.rgb().formatHex()}function NM(){return this.rgb().formatRgb()}function Ic(e){var n,t;return e=(e+"").trim().toLowerCase(),(n=q4.exec(e))?(t=n[1].length,n=parseInt(n[1],16),t===6?DM(n):t===3?new Cr(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):t===8?yf(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):t===4?yf(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=Z4.exec(e))?new Cr(n[1],n[2],n[3],1):(n=K4.exec(e))?new Cr(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=$4.exec(e))?yf(n[1],n[2],n[3],n[4]):(n=Q4.exec(e))?yf(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=J4.exec(e))?RM(n[1],n[2]/100,n[3]/100,1):(n=e6.exec(e))?RM(n[1],n[2]/100,n[3]/100,n[4]):TM.hasOwnProperty(e)?DM(TM[e]):e==="transparent"?new Cr(NaN,NaN,NaN,0):null}function DM(e){return new Cr(e>>16&255,e>>8&255,255&e,1)}function yf(e,n,t,r){return r<=0&&(e=n=t=NaN),new Cr(e,n,t,r)}function ev(e,n,t,r){return arguments.length===1?function(i){return i instanceof kc||(i=Ic(i)),i?new Cr((i=i.rgb()).r,i.g,i.b,i.opacity):new Cr}(e):new Cr(e,n,t,r??1)}function Cr(e,n,t,r){this.r=+e,this.g=+n,this.b=+t,this.opacity=+r}function PM(){return`#${Qa(this.r)}${Qa(this.g)}${Qa(this.b)}`}function LM(){const e=bf(this.opacity);return`${e===1?"rgb(":"rgba("}${$a(this.r)}, ${$a(this.g)}, ${$a(this.b)}${e===1?")":`, ${e})`}`}function bf(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function $a(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Qa(e){return((e=$a(e))<16?"0":"")+e.toString(16)}function RM(e,n,t,r){return r<=0?e=n=t=NaN:t<=0||t>=1?e=n=NaN:n<=0&&(e=NaN),new xi(e,n,t,r)}function jM(e){if(e instanceof xi)return new xi(e.h,e.s,e.l,e.opacity);if(e instanceof kc||(e=Ic(e)),!e)return new xi;if(e instanceof xi)return e;var n=(e=e.rgb()).r/255,t=e.g/255,r=e.b/255,i=Math.min(n,t,r),o=Math.max(n,t,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=n===o?(t-r)/s+6*(t<r):t===o?(r-n)/s+2:(n-t)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new xi(a,s,u,e.opacity)}function xi(e,n,t,r){this.h=+e,this.s=+n,this.l=+t,this.opacity=+r}function BM(e){return(e=(e||0)%360)<0?e+360:e}function xf(e){return Math.max(0,Math.min(1,e||0))}function tv(e,n,t){return 255*(e<60?n+(t-n)*e/60:e<180?t:e<240?n+(t-n)*(240-e)/60:n)}J0(kc,Ic,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:OM,formatHex:OM,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return jM(this).formatHsl()},formatRgb:NM,toString:NM}),J0(Cr,ev,IM(kc,{brighter(e){return e=e==null?mf:Math.pow(mf,e),new Cr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Cc:Math.pow(Cc,e),new Cr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Cr($a(this.r),$a(this.g),$a(this.b),bf(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:PM,formatHex:PM,formatHex8:function(){return`#${Qa(this.r)}${Qa(this.g)}${Qa(this.b)}${Qa(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:LM,toString:LM})),J0(xi,function(e,n,t,r){return arguments.length===1?jM(e):new xi(e,n,t,r??1)},IM(kc,{brighter(e){return e=e==null?mf:Math.pow(mf,e),new xi(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Cc:Math.pow(Cc,e),new xi(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),n=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,r=t+(t<.5?t:1-t)*n,i=2*t-r;return new Cr(tv(e>=240?e-240:e+120,i,r),tv(e,i,r),tv(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new xi(BM(this.h),xf(this.s),xf(this.l),bf(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=bf(this.opacity);return`${e===1?"hsl(":"hsla("}${BM(this.h)}, ${100*xf(this.s)}%, ${100*xf(this.l)}%${e===1?")":`, ${e})`}`}}));const nv=e=>()=>e;function t6(e){return(e=+e)==1?zM:function(n,t){return t-n?function(r,i,o){return r=Math.pow(r,o),i=Math.pow(i,o)-r,o=1/o,function(a){return Math.pow(r+a*i,o)}}(n,t,e):nv(isNaN(n)?t:n)}}function zM(e,n){var t=n-e;return t?function(r,i){return function(o){return r+o*i}}(e,t):nv(isNaN(e)?n:e)}const FM=function e(n){var t=t6(n);function r(i,o){var a=t((i=ev(i)).r,(o=ev(o)).r),s=t(i.g,o.g),u=t(i.b,o.b),c=zM(i.opacity,o.opacity);return function(l){return i.r=a(l),i.g=s(l),i.b=u(l),i.opacity=c(l),i+""}}return r.gamma=e,r}(1);function GM(e,n){n||(n=[]);var t,r=e?Math.min(n.length,e.length):0,i=n.slice();return function(o){for(t=0;t<r;++t)i[t]=e[t]*(1-o)+n[t]*o;return i}}function UM(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function n6(e,n){return(UM(n)?GM:XM)(e,n)}function XM(e,n){var t,r=n?n.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(t=0;t<i;++t)o[t]=wf(e[t],n[t]);for(;t<r;++t)a[t]=n[t];return function(s){for(t=0;t<i;++t)a[t]=o[t](s);return a}}function r6(e,n){var t=new Date;return e=+e,n=+n,function(r){return t.setTime(e*(1-r)+n*r),t}}function rv(e,n){return e=+e,n=+n,function(t){return e*(1-t)+n*t}}function i6(e,n){var t,r={},i={};for(t in e!==null&&typeof e=="object"||(e={}),n!==null&&typeof n=="object"||(n={}),n)t in e?r[t]=wf(e[t],n[t]):i[t]=n[t];return function(o){for(t in r)i[t]=r[t](o);return i}}var iv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ov=new RegExp(iv.source,"g");function o6(e,n){var t,r,i,o=iv.lastIndex=ov.lastIndex=0,a=-1,s=[],u=[];for(e+="",n+="";(t=iv.exec(e))&&(r=ov.exec(n));)(i=r.index)>o&&(i=n.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(t=t[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:rv(t,r)})),o=ov.lastIndex;return o<n.length&&(i=n.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(c){return function(l){return c(l)+""}}(u[0].x):function(c){return function(){return c}}(n):(n=u.length,function(c){for(var l,h=0;h<n;++h)s[(l=u[h]).i]=l.x(c);return s.join("")})}function wf(e,n){var t,r=typeof n;return n==null||r==="boolean"?nv(n):(r==="number"?rv:r==="string"?(t=Ic(n))?(n=t,FM):o6:n instanceof Ic?FM:n instanceof Date?r6:UM(n)?GM:Array.isArray(n)?XM:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?i6:rv)(e,n)}function YM(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}function WM(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var a6=function e(n){function t(r){return Math.pow(r,n)}return n=+n,t.exponent=e,t}(3),s6=function e(n){function t(r){return 1-Math.pow(1-r,n)}return n=+n,t.exponent=e,t}(3),VM=function e(n){function t(r){return((r*=2)<=1?Math.pow(r,n):2-Math.pow(2-r,n))/2}return n=+n,t.exponent=e,t}(3),HM=Math.PI,qM=HM/2;function ZM(e){return(1-Math.cos(HM*e))/2}function Jo(e){return 1.0009775171065494*(Math.pow(2,-10*e)-.0009765625)}function KM(e){return((e*=2)<=1?Jo(1-e):2-Jo(e-1))/2}function $M(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2}var u6=4/11,c6=6/11,l6=8/11,h6=9/11,f6=10/11,d6=21/22,Ef=7.5625;function Tc(e){return(e=+e)<u6?Ef*e*e:e<l6?Ef*(e-=c6)*e+.75:e<f6?Ef*(e-=h6)*e+.9375:Ef*(e-=d6)*e+.984375}var av=1.70158,p6=function e(n){function t(r){return(r=+r)*r*(n*(r-1)+r)}return n=+n,t.overshoot=e,t}(av),g6=function e(n){function t(r){return--r*r*((r+1)*n+r)+1}return n=+n,t.overshoot=e,t}(av),QM=function e(n){function t(r){return((r*=2)<1?r*r*((n+1)*r-n):(r-=2)*r*((n+1)*r+n)+2)/2}return n=+n,t.overshoot=e,t}(av),Js=2*Math.PI,v6=function e(n,t){var r=Math.asin(1/(n=Math.max(1,n)))*(t/=Js);function i(o){return n*Jo(- --o)*Math.sin((r-o)/t)}return i.amplitude=function(o){return e(o,t*Js)},i.period=function(o){return e(n,o)},i}(1,.3),JM=function e(n,t){var r=Math.asin(1/(n=Math.max(1,n)))*(t/=Js);function i(o){return 1-n*Jo(o=+o)*Math.sin((o+r)/t)}return i.amplitude=function(o){return e(o,t*Js)},i.period=function(o){return e(n,o)},i}(1,.3),m6=function e(n,t){var r=Math.asin(1/(n=Math.max(1,n)))*(t/=Js);function i(o){return((o=2*o-1)<0?n*Jo(-o)*Math.sin((r-o)/t):2-n*Jo(o)*Math.sin((r+o)/t))/2}return i.amplitude=function(o){return e(o,t*Js)},i.period=function(o){return e(n,o)},i}(1,.3);const y6=Object.freeze(Object.defineProperty({__proto__:null,easeBack:QM,easeBackIn:p6,easeBackInOut:QM,easeBackOut:g6,easeBounce:Tc,easeBounceIn:function(e){return 1-Tc(1-e)},easeBounceInOut:function(e){return((e*=2)<=1?1-Tc(1-e):Tc(e-1)+1)/2},easeBounceOut:Tc,easeCircle:$M,easeCircleIn:function(e){return 1-Math.sqrt(1-e*e)},easeCircleInOut:$M,easeCircleOut:function(e){return Math.sqrt(1- --e*e)},easeCubic:WM,easeCubicIn:function(e){return e*e*e},easeCubicInOut:WM,easeCubicOut:function(e){return--e*e*e+1},easeElastic:JM,easeElasticIn:v6,easeElasticInOut:m6,easeElasticOut:JM,easeExp:KM,easeExpIn:function(e){return Jo(1-+e)},easeExpInOut:KM,easeExpOut:function(e){return 1-Jo(e)},easeLinear:function(e){return+e},easePoly:VM,easePolyIn:a6,easePolyInOut:VM,easePolyOut:s6,easeQuad:YM,easeQuadIn:function(e){return e*e},easeQuadInOut:YM,easeQuadOut:function(e){return e*(2-e)},easeSin:ZM,easeSinIn:function(e){return+e==1?1:1-Math.cos(e*qM)},easeSinInOut:ZM,easeSinOut:function(e){return Math.sin(e*qM)}},Symbol.toStringTag,{value:"Module"}));var b6={},eS=[1,0,0,0,1,0,0,0,1];function x6(e,n,t){var r,i=n.startTime;if(t<i+n.delay||n._paused)return!1;var o,a=n.duration,s=n.easing,u=b6[(o=s).toLowerCase()]||y6[o];if(t=t-i-n.delay,n.repeat)r=u(r=t%a/a);else{if(!((r=t/a)<1))return n.onFrame?e.attr(n.onFrame(1)):e.attr(n.toAttrs),!0;r=u(r)}if(n.onFrame){var c=n.onFrame(r);e.attr(c)}else(function(l,h,f){var d={},p=h.fromAttrs,g=h.toAttrs;if(!l.destroyed){var v,m;for(var y in g)if(!qo(p[y],g[y]))if(y==="path"){var b=g[y],x=p[y];b.length>x.length?(b=Ks(g[y]),x=Ks(p[y]),x=cM(x,b),x=H0(x,b),h.fromAttrs.path=x,h.toAttrs.path=b):h.pathFormatted||(b=Ks(g[y]),x=Ks(p[y]),x=H0(x,b),h.fromAttrs.path=x,h.toAttrs.path=b,h.pathFormatted=!0),d[y]=[];for(var w=0;w<b.length;w++){for(var E=b[w],M=x[w],_=[],k=0;k<E.length;k++)xt(E[k])&&M&&xt(M[k])?(v=wf(M[k],E[k]),_.push(v(f))):_.push(E[k]);d[y].push(_)}}else if(y==="matrix"){var S=n6(p[y]||eS,g[y]||eS)(f);d[y]=S}else["fill","stroke","fillStyle","strokeStyle"].includes(y)&&(m=g[y],/^[r,R,L,l]{1}[\s]*\(/.test(m))?d[y]=g[y]:mn(g[y])||(v=wf(p[y],g[y]),d[y]=v(f));l.attr(d)}})(e,n,r);return!1}var w6=function(){function e(n){this.animators=[],this.current=0,this.timer=null,this.canvas=n}return e.prototype.initTimer=function(){var n,t,r,i=this;this.timer=CM(function(o){if(i.current=o,i.animators.length>0){for(var a=i.animators.length-1;a>=0;a--)if((n=i.animators[a]).destroyed)i.removeAnimator(a);else{if(!n.isAnimatePaused())for(var s=(t=n.get("animations")).length-1;s>=0;s--)r=t[s],x6(n,r,o)&&(t.splice(s,1),r.callback&&r.callback());t.length===0&&i.removeAnimator(a)}i.canvas.get("autoDraw")||i.canvas.draw()}})},e.prototype.addAnimator=function(n){this.animators.push(n)},e.prototype.removeAnimator=function(n){this.animators.splice(n,1)},e.prototype.isAnimating=function(){return!!this.animators.length},e.prototype.stop=function(){this.timer&&this.timer.stop()},e.prototype.stopAllAnimations=function(n){n===void 0&&(n=!0),this.animators.forEach(function(t){t.stopAnimate(n)}),this.animators=[],this.canvas.draw()},e.prototype.getTime=function(){return this.current},e}(),tS=["mousedown","mouseup","dblclick","mouseout","mouseover","mousemove","mouseleave","mouseenter","touchstart","touchmove","touchend","dragenter","dragover","dragleave","drop","contextmenu","mousewheel"];function nS(e,n,t){t.name=n,t.target=e,t.currentTarget=e,t.delegateTarget=e,e.emit(n,t)}function E6(e,n,t){if(t.bubbles){var r=void 0,i=!1;if(n==="mouseenter"?(r=t.fromShape,i=!0):n==="mouseleave"&&(i=!0,r=t.toShape),e.isCanvas()&&i)return;if(r&&pM(e,r))return void(t.bubbles=!1);t.name=n,t.currentTarget=e,t.delegateTarget=e,e.emit(n,t)}}var M6=function(){function e(n){var t=this;this.draggingShape=null,this.dragging=!1,this.currentShape=null,this.mousedownShape=null,this.mousedownPoint=null,this._eventCallback=function(r){var i=r.type;t._triggerEvent(i,r)},this._onDocumentMove=function(r){if(t.canvas.get("el")!==r.target&&(t.dragging||t.currentShape)){var i=t._getPointInfo(r);t.dragging&&t._emitEvent("drag",r,i,t.draggingShape)}},this._onDocumentMouseUp=function(r){if(t.canvas.get("el")!==r.target&&t.dragging){var i=t._getPointInfo(r);t.draggingShape&&t._emitEvent("drop",r,i,null),t._emitEvent("dragend",r,i,t.draggingShape),t._afterDrag(t.draggingShape,i,r)}},this.canvas=n.canvas}return e.prototype.init=function(){this._bindEvents()},e.prototype._bindEvents=function(){var n=this,t=this.canvas.get("el");ye(tS,function(r){t.addEventListener(r,n._eventCallback)}),document&&(document.addEventListener("mousemove",this._onDocumentMove),document.addEventListener("mouseup",this._onDocumentMouseUp))},e.prototype._clearEvents=function(){var n=this,t=this.canvas.get("el");ye(tS,function(r){t.removeEventListener(r,n._eventCallback)}),document&&(document.removeEventListener("mousemove",this._onDocumentMove),document.removeEventListener("mouseup",this._onDocumentMouseUp))},e.prototype._getEventObj=function(n,t,r,i,o,a){var s=new hM(n,t);return s.fromShape=o,s.toShape=a,s.x=r.x,s.y=r.y,s.clientX=r.clientX,s.clientY=r.clientY,s.propagationPath.push(i),s},e.prototype._getShape=function(n,t){return this.canvas.getShape(n.x,n.y,t)},e.prototype._getPointInfo=function(n){var t=this.canvas,r=t.getClientByEvent(n),i=t.getPointByEvent(n);return{x:i.x,y:i.y,clientX:r.x,clientY:r.y}},e.prototype._triggerEvent=function(n,t){var r=this._getPointInfo(t),i=this._getShape(r,t),o=this["_on"+n],a=!1;if(o)o.call(this,r,i,t);else{var s=this.currentShape;n==="mouseenter"||n==="dragenter"||n==="mouseover"?(this._emitEvent(n,t,r,null,null,i),i&&this._emitEvent(n,t,r,i,null,i),n==="mouseenter"&&this.draggingShape&&this._emitEvent("dragenter",t,r,null)):n==="mouseleave"||n==="dragleave"||n==="mouseout"?(a=!0,s&&this._emitEvent(n,t,r,s,s,null),this._emitEvent(n,t,r,null,s,null),n==="mouseleave"&&this.draggingShape&&this._emitEvent("dragleave",t,r,null)):this._emitEvent(n,t,r,i,null,null)}if(a||(this.currentShape=i),i&&!i.get("destroyed")){var u=this.canvas;u.get("el").style.cursor=i.attr("cursor")||u.get("cursor")}},e.prototype._onmousedown=function(n,t,r){r.button===0&&(this.mousedownShape=t,this.mousedownPoint=n,this.mousedownTimeStamp=r.timeStamp),this._emitEvent("mousedown",r,n,t,null,null)},e.prototype._emitMouseoverEvents=function(n,t,r,i){var o=this.canvas.get("el");r!==i&&(r&&(this._emitEvent("mouseout",n,t,r,r,i),this._emitEvent("mouseleave",n,t,r,r,i),i&&!i.get("destroyed")||(o.style.cursor=this.canvas.get("cursor"))),i&&(this._emitEvent("mouseover",n,t,i,r,i),this._emitEvent("mouseenter",n,t,i,r,i)))},e.prototype._emitDragoverEvents=function(n,t,r,i,o){i?(i!==r&&(r&&this._emitEvent("dragleave",n,t,r,r,i),this._emitEvent("dragenter",n,t,i,r,i)),o||this._emitEvent("dragover",n,t,i)):r&&this._emitEvent("dragleave",n,t,r,r,i),o&&this._emitEvent("dragover",n,t,i)},e.prototype._afterDrag=function(n,t,r){n&&(n.set("capture",!0),this.draggingShape=null),this.dragging=!1;var i=this._getShape(t,r);i!==n&&this._emitMouseoverEvents(r,t,n,i),this.currentShape=i},e.prototype._onmouseup=function(n,t,r){if(r.button===0){var i=this.draggingShape;this.dragging?(i&&this._emitEvent("drop",r,n,t),this._emitEvent("dragend",r,n,i),this._afterDrag(i,n,r)):(this._emitEvent("mouseup",r,n,t),t===this.mousedownShape&&this._emitEvent("click",r,n,t),this.mousedownShape=null,this.mousedownPoint=null)}},e.prototype._ondragover=function(n,t,r){r.preventDefault();var i=this.currentShape;this._emitDragoverEvents(r,n,i,t,!0)},e.prototype._onmousemove=function(n,t,r){var i=this.canvas,o=this.currentShape,a=this.draggingShape;if(this.dragging)a&&this._emitDragoverEvents(r,n,o,t,!1),this._emitEvent("drag",r,n,a);else{var s=this.mousedownPoint;if(s){var u=this.mousedownShape,c=r.timeStamp-this.mousedownTimeStamp,l=s.clientX-n.clientX,h=s.clientY-n.clientY;c>120||l*l+h*h>40?u&&u.get("draggable")?((a=this.mousedownShape).set("capture",!1),this.draggingShape=a,this.dragging=!0,this._emitEvent("dragstart",r,n,a),this.mousedownShape=null,this.mousedownPoint=null):!u&&i.get("draggable")?(this.dragging=!0,this._emitEvent("dragstart",r,n,null),this.mousedownShape=null,this.mousedownPoint=null):(this._emitMouseoverEvents(r,n,o,t),this._emitEvent("mousemove",r,n,t)):(this._emitMouseoverEvents(r,n,o,t),this._emitEvent("mousemove",r,n,t))}else this._emitMouseoverEvents(r,n,o,t),this._emitEvent("mousemove",r,n,t)}},e.prototype._emitEvent=function(n,t,r,i,o,a){var s=this._getEventObj(n,t,r,i,o,a);if(i){s.shape=i,nS(i,n,s);for(var u=i.getParent();u;)u.emitDelegation(n,s),s.propagationStopped||E6(u,n,s),s.propagationPath.push(u),u=u.getParent()}else nS(this.canvas,n,s)},e.prototype.destroy=function(){this._clearEvents(),this.canvas=null,this.currentShape=null,this.draggingShape=null,this.mousedownPoint=null,this.mousedownShape=null,this.mousedownTimeStamp=null},e}(),rS=mM(),S6=rS&&rS.name==="firefox",iS=function(e){function n(t){var r=e.call(this,t)||this;return r.initContainer(),r.initDom(),r.initEvents(),r.initTimeline(),r}return Nt(n,e),n.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return t.cursor="default",t.supportCSSTransform=!1,t},n.prototype.initContainer=function(){var t=this.get("container");Re(t)&&(t=document.getElementById(t),this.set("container",t))},n.prototype.initDom=function(){var t=this.createDom();this.set("el",t),this.get("container").appendChild(t),this.setDOMSize(this.get("width"),this.get("height"))},n.prototype.initEvents=function(){var t=new M6({canvas:this});t.init(),this.set("eventController",t)},n.prototype.initTimeline=function(){var t=new w6(this);this.set("timeline",t)},n.prototype.setDOMSize=function(t,r){var i=this.get("el");dM&&(i.style.width=t+"px",i.style.height=r+"px")},n.prototype.changeSize=function(t,r){this.setDOMSize(t,r),this.set("width",t),this.set("height",r),this.onCanvasChange("changeSize")},n.prototype.getRenderer=function(){return this.get("renderer")},n.prototype.getCursor=function(){return this.get("cursor")},n.prototype.setCursor=function(t){this.set("cursor",t);var r=this.get("el");dM&&r&&(r.style.cursor=t)},n.prototype.getPointByEvent=function(t){if(this.get("supportCSSTransform")){if(S6&&!yt(t.layerX)&&t.layerX!==t.offsetX)return{x:t.layerX,y:t.layerY};if(!yt(t.offsetX))return{x:t.offsetX,y:t.offsetY}}var r=this.getClientByEvent(t),i=r.x,o=r.y;return this.getPointByClient(i,o)},n.prototype.getClientByEvent=function(t){var r=t;return t.touches&&(r=t.type==="touchend"?t.changedTouches[0]:t.touches[0]),{x:r.clientX,y:r.clientY}},n.prototype.getPointByClient=function(t,r){var i=this.get("el").getBoundingClientRect();return{x:t-i.left,y:r-i.top}},n.prototype.getClientByPoint=function(t,r){var i=this.get("el").getBoundingClientRect();return{x:t+i.left,y:r+i.top}},n.prototype.draw=function(){},n.prototype.removeDom=function(){var t=this.get("el");t.parentNode.removeChild(t)},n.prototype.clearEvents=function(){this.get("eventController").destroy()},n.prototype.isCanvas=function(){return!0},n.prototype.getParent=function(){return null},n.prototype.destroy=function(){var t=this.get("timeline");this.get("destroyed")||(this.clear(),t&&t.stop(),this.clearEvents(),this.removeDom(),e.prototype.destroy.call(this))},n}(SM),oS=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.isGroup=function(){return!0},n.prototype.isEntityGroup=function(){return!1},n.prototype.clone=function(){for(var t=e.prototype.clone.call(this),r=this.getChildren(),i=0;i<r.length;i++){var o=r[i];t.add(o.clone())}return t},n}(SM),aS=function(e){function n(t){return e.call(this,t)||this}return Nt(n,e),n.prototype._isInBBox=function(t,r){var i=this.getBBox();return i.minX<=t&&i.maxX>=t&&i.minY<=r&&i.maxY>=r},n.prototype.afterAttrsChange=function(t){e.prototype.afterAttrsChange.call(this,t),this.clearCacheBBox()},n.prototype.getBBox=function(){var t=this.cfg.bbox;return t||(t=this.calculateBBox(),this.set("bbox",t)),t},n.prototype.getCanvasBBox=function(){var t=this.cfg.canvasBBox;return t||(t=this.calculateCanvasBBox(),this.set("canvasBBox",t)),t},n.prototype.applyMatrix=function(t){e.prototype.applyMatrix.call(this,t),this.set("canvasBBox",null)},n.prototype.calculateCanvasBBox=function(){var t=this.getBBox(),r=this.getTotalMatrix(),i=t.minX,o=t.minY,a=t.maxX,s=t.maxY;if(r){var u=Za(r,[t.minX,t.minY]),c=Za(r,[t.maxX,t.minY]),l=Za(r,[t.minX,t.maxY]),h=Za(r,[t.maxX,t.maxY]);i=Math.min(u[0],c[0],l[0],h[0]),a=Math.max(u[0],c[0],l[0],h[0]),o=Math.min(u[1],c[1],l[1],h[1]),s=Math.max(u[1],c[1],l[1],h[1])}var f=this.attrs;if(f.shadowColor){var d=f.shadowBlur,p=d===void 0?0:d,g=f.shadowOffsetX,v=g===void 0?0:g,m=f.shadowOffsetY,y=m===void 0?0:m,b=i-p+v,x=a+p+v,w=o-p+y,E=s+p+y;i=Math.min(i,b),a=Math.max(a,x),o=Math.min(o,w),s=Math.max(s,E)}return{x:i,y:o,minX:i,minY:o,maxX:a,maxY:s,width:a-i,height:s-o}},n.prototype.clearCacheBBox=function(){this.set("bbox",null),this.set("canvasBBox",null)},n.prototype.isClipShape=function(){return this.get("isClipShape")},n.prototype.isInShape=function(t,r){return!1},n.prototype.isOnlyHitBox=function(){return!1},n.prototype.isHit=function(t,r){var i=this.get("startArrowShape"),o=this.get("endArrowShape"),a=[t,r,1],s=(a=this.invertFromMatrix(a))[0],u=a[1],c=this._isInBBox(s,u);return this.isOnlyHitBox()?c:!!(c&&!this.isClipped(s,u)&&(this.isInShape(s,u)||i&&i.isHit(s,u)||o&&o.isHit(s,u)))},n}(xM),sS=new Map;function qi(e,n){sS.set(e,n)}function uS(e){return sS.get(e)}function cS(e){var n=e.attr();return{x:n.x,y:n.y,width:n.width,height:n.height}}function lS(e){var n=e.attr(),t=n.x,r=n.y,i=n.r;return{x:t-i,y:r-i,width:2*i,height:2*i}}function Fr(e,n,t,r){var i=e-t,o=n-r;return Math.sqrt(i*i+o*o)}function Mf(e,n){return Math.abs(e-n)<.001}function Oc(e,n){var t=Fi(e),r=Fi(n);return{x:t,y:r,width:zi(e)-t,height:zi(n)-r}}function hS(e){return(e+2*Math.PI)%(2*Math.PI)}const pr={box:function(e,n,t,r){return Oc([e,t],[n,r])},length:function(e,n,t,r){return Fr(e,n,t,r)},pointAt:function(e,n,t,r,i){return{x:(1-i)*e+i*t,y:(1-i)*n+i*r}},pointDistance:function(e,n,t,r,i,o){var a=(t-e)*(i-e)+(r-n)*(o-n);return a<0?Fr(e,n,i,o):a>(t-e)*(t-e)+(r-n)*(r-n)?Fr(t,r,i,o):this.pointToLine(e,n,t,r,i,o)},pointToLine:function(e,n,t,r,i,o){var a=[t-e,r-n];if(x0(a,[0,0]))return Math.sqrt((i-e)*(i-e)+(o-n)*(o-n));var s=[-a[1],a[0]];$o(s,s);var u=[i-e,o-n];return Math.abs(b0(u,s))},tangentAngle:function(e,n,t,r){return Math.atan2(r-n,t-e)}};function fS(e,n,t,r,i,o){var a,s=1/0,u=[t,r],c=20;o&&o>200&&(c=o/10);for(var l=1/c,h=l/10,f=0;f<=c;f++){var d=f*l,p=[i.apply(null,e.concat([d])),i.apply(null,n.concat([d]))];(y=Fr(u[0],u[1],p[0],p[1]))<s&&(a=d,s=y)}if(a===0)return{x:e[0],y:n[0]};if(a===1){var g=e.length;return{x:e[g-1],y:n[g-1]}}for(s=1/0,f=0;f<32&&!(h<1e-4);f++){var v=a-h,m=a+h,y=(p=[i.apply(null,e.concat([v])),i.apply(null,n.concat([v]))],Fr(u[0],u[1],p[0],p[1]));if(v>=0&&y<s)a=v,s=y;else{var b=[i.apply(null,e.concat([m])),i.apply(null,n.concat([m]))],x=Fr(u[0],u[1],b[0],b[1]);m<=1&&x<s?(a=m,s=x):h*=.5}}return{x:i.apply(null,e.concat([a])),y:i.apply(null,n.concat([a]))}}function ea(e,n,t,r){var i=1-r;return i*i*e+2*r*i*n+r*r*t}function dS(e,n,t){var r=e+t-2*n;if(Mf(r,0))return[.5];var i=(e-n)/r;return i<=1&&i>=0?[i]:[]}function pS(e,n,t,r){return 2*(1-r)*(n-e)+2*r*(t-n)}function gS(e,n,t,r,i,o,a){var s=ea(e,t,i,a),u=ea(n,r,o,a),c=pr.pointAt(e,n,t,r,a),l=pr.pointAt(t,r,i,o,a);return[[e,n,c.x,c.y,s,u],[s,u,l.x,l.y,i,o]]}function sv(e,n,t,r,i,o,a){if(a===0)return(Fr(e,n,t,r)+Fr(t,r,i,o)+Fr(e,n,i,o))/2;var s=gS(e,n,t,r,i,o,.5),u=s[0],c=s[1];return u.push(a-1),c.push(a-1),sv.apply(null,u)+sv.apply(null,c)}const vS={box:function(e,n,t,r,i,o){var a=dS(e,t,i)[0],s=dS(n,r,o)[0],u=[e,i],c=[n,o];return a!==void 0&&u.push(ea(e,t,i,a)),s!==void 0&&c.push(ea(n,r,o,s)),Oc(u,c)},length:function(e,n,t,r,i,o){return sv(e,n,t,r,i,o,3)},nearestPoint:function(e,n,t,r,i,o,a,s){return fS([e,t,i],[n,r,o],a,s,ea)},pointDistance:function(e,n,t,r,i,o,a,s){var u=this.nearestPoint(e,n,t,r,i,o,a,s);return Fr(u.x,u.y,a,s)},interpolationAt:ea,pointAt:function(e,n,t,r,i,o,a){return{x:ea(e,t,i,a),y:ea(n,r,o,a)}},divide:function(e,n,t,r,i,o,a){return gS(e,n,t,r,i,o,a)},tangentAngle:function(e,n,t,r,i,o,a){var s=pS(e,t,i,a),u=pS(n,r,o,a);return hS(Math.atan2(u,s))}};function ta(e,n,t,r,i){var o=1-i;return o*o*o*e+3*n*i*o*o+3*t*i*i*o+r*i*i*i}function mS(e,n,t,r,i){var o=1-i;return 3*(o*o*(n-e)+2*o*i*(t-n)+i*i*(r-t))}function uv(e,n,t,r){var i,o,a,s=-3*e+9*n-9*t+3*r,u=6*e-12*n+6*t,c=3*n-3*e,l=[];if(Mf(s,0))Mf(u,0)||(i=-c/u)>=0&&i<=1&&l.push(i);else{var h=u*u-4*s*c;Mf(h,0)?l.push(-u/(2*s)):h>0&&(o=(-u-(a=Math.sqrt(h)))/(2*s),(i=(-u+a)/(2*s))>=0&&i<=1&&l.push(i),o>=0&&o<=1&&l.push(o))}return l}function yS(e,n,t,r,i,o,a,s,u){var c=ta(e,t,i,a,u),l=ta(n,r,o,s,u),h=pr.pointAt(e,n,t,r,u),f=pr.pointAt(t,r,i,o,u),d=pr.pointAt(i,o,a,s,u),p=pr.pointAt(h.x,h.y,f.x,f.y,u),g=pr.pointAt(f.x,f.y,d.x,d.y,u);return[[e,n,h.x,h.y,p.x,p.y,c,l],[c,l,g.x,g.y,d.x,d.y,a,s]]}function cv(e,n,t,r,i,o,a,s,u){if(u===0)return function(f,d){for(var p=0,g=f.length,v=0;v<g;v++)p+=Fr(f[v],d[v],f[(v+1)%g],d[(v+1)%g]);return p/2}([e,t,i,a],[n,r,o,s]);var c=yS(e,n,t,r,i,o,a,s,.5),l=c[0],h=c[1];return l.push(u-1),h.push(u-1),cv.apply(null,l)+cv.apply(null,h)}const Nc={extrema:uv,box:function(e,n,t,r,i,o,a,s){for(var u=[e,a],c=[n,s],l=uv(e,t,i,a),h=uv(n,r,o,s),f=0;f<l.length;f++)u.push(ta(e,t,i,a,l[f]));for(f=0;f<h.length;f++)c.push(ta(n,r,o,s,h[f]));return Oc(u,c)},length:function(e,n,t,r,i,o,a,s){return cv(e,n,t,r,i,o,a,s,3)},nearestPoint:function(e,n,t,r,i,o,a,s,u,c,l){return fS([e,t,i,a],[n,r,o,s],u,c,ta,l)},pointDistance:function(e,n,t,r,i,o,a,s,u,c,l){var h=this.nearestPoint(e,n,t,r,i,o,a,s,u,c,l);return Fr(h.x,h.y,u,c)},interpolationAt:ta,pointAt:function(e,n,t,r,i,o,a,s,u){return{x:ta(e,t,i,a,u),y:ta(n,r,o,s,u)}},divide:function(e,n,t,r,i,o,a,s,u){return yS(e,n,t,r,i,o,a,s,u)},tangentAngle:function(e,n,t,r,i,o,a,s,u){var c=mS(e,t,i,a,u),l=mS(n,r,o,s,u);return hS(Math.atan2(l,c))}};function _6(e,n,t,r,i,o){return t*Math.cos(i)*Math.cos(o)-r*Math.sin(i)*Math.sin(o)+e}function k6(e,n,t,r,i,o){return t*Math.sin(i)*Math.cos(o)+r*Math.cos(i)*Math.sin(o)+n}const C6=function(e,n,t,r,i,o,a){for(var s=function(x,w,E){return Math.atan(-w/x*Math.tan(E))}(t,r,i),u=1/0,c=-1/0,l=[o,a],h=2*-Math.PI;h<=2*Math.PI;h+=Math.PI){var f=s+h;o<a?o<f&&f<a&&l.push(f):a<f&&f<o&&l.push(f)}for(h=0;h<l.length;h++){var d=_6(e,0,t,r,i,l[h]);d<u&&(u=d),d>c&&(c=d)}var p=function(x,w,E){return Math.atan(w/(x*Math.tan(E)))}(t,r,i),g=1/0,v=-1/0,m=[o,a];for(h=2*-Math.PI;h<=2*Math.PI;h+=Math.PI){var y=p+h;o<a?o<y&&y<a&&m.push(y):a<y&&y<o&&m.push(y)}for(h=0;h<m.length;h++){var b=k6(0,n,t,r,i,m[h]);b<g&&(g=b),b>v&&(v=b)}return{x:u,y:g,width:c-u,height:v-g}},bS=function(e){return function(n){if(n.length<2)return 0;for(var t=0,r=0;r<n.length-1;r++){var i=n[r],o=n[r+1];t+=Fr(i[0],i[1],o[0],o[1])}return t}(e)};function xS(e,n){return e&&n?{minX:Math.min(e.minX,n.minX),minY:Math.min(e.minY,n.minY),maxX:Math.max(e.maxX,n.maxX),maxY:Math.max(e.maxY,n.maxY)}:e||n}function lv(e,n){var t=e.get("startArrowShape"),r=e.get("endArrowShape");return t&&(n=xS(n,t.getCanvasBBox())),r&&(n=xS(n,r.getCanvasBBox())),n}var hv=null;function wS(){if(!hv){var e=document.createElement("canvas");e.width=1,e.height=1,hv=e.getContext("2d")}return hv}function ES(e,n,t){var r=1;if(Re(e)&&(r=e.split(`
`).length),r>1){var i=function(o,a){return a?a-o:.14*o}(n,t);return n*r+i*(r-1)}return n}function MS(e){var n=e.fontSize,t=e.fontFamily,r=e.fontWeight;return[e.fontStyle,e.fontVariant,r,n+"px",t].join(" ").trim()}var A6=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/gi,I6=/[^\s\,]+/gi;function SS(e,n,t){n===void 0&&(n=!1),t===void 0&&(t=[[0,0],[1,1]]);for(var r=!!n,i=[],o=0,a=e.length;o<a;o+=2)i.push([e[o],e[o+1]]);var s,u,c,l=function(d,p,g,v){var m,y,b,x,w,E,M,_=[],k=!!v;if(k){b=v[0],x=v[1];for(var S=0,C=d.length;S<C;S+=1)b=Zo([0,0],b,A=d[S]),x=Ko([0,0],x,A)}S=0;for(var T=d.length;S<T;S+=1){var A=d[S];if(S!==0||g)if(S!==T-1||g){m=d[[S?S-1:T-1,S-1][g?0:1]],y=d[g?(S+1)%T:S+1];var D=[0,0];D=fr(D=$h(D,y,m),D,p);var j=Kh(A,m),L=Kh(A,y),B=j+L;B!==0&&(j/=B,L/=B);var N=fr([0,0],D,-j),R=fr([0,0],D,L);E=rr([0,0],A,N),w=Zo([0,0],w=rr([0,0],A,R),Ko([0,0],y,A)),w=Ko([0,0],w,Zo([0,0],y,A)),E=Zo([0,0],E=rr([0,0],A,N=fr([0,0],N=$h([0,0],w,A),-j/L)),Ko([0,0],m,A)),E=Ko([0,0],E,Zo([0,0],m,A)),w=rr([0,0],A,R=fr([0,0],R=$h([0,0],A,E),L/j)),k&&(E=Zo([0,0],E=Ko([0,0],E,b),x),w=Zo([0,0],w=Ko([0,0],w,b),x)),_.push(M),_.push(E),M=w}else E=A,_.push(M),_.push(E);else M=A}return g&&_.push(_.shift()),_}(i,.4,r,t),h=i.length,f=[];for(o=0;o<h-1;o+=1)s=l[2*o],u=l[2*o+1],c=i[o+1],f.push(["C",s[0],s[1],u[0],u[1],c[0],c[1]]);return r&&(s=l[h],u=l[h+1],c=i[0],f.push(["C",s[0],s[1],u[0],u[1],c[0],c[1]])),f}var Dc=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,T6=new RegExp("([a-z])["+Dc+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+Dc+"]*,?["+Dc+"]*)+)","ig"),O6=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+Dc+"]*,?["+Dc+"]*","ig");function fv(e){if(!e)return null;if(Mt(e))return e;var n={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},t=[];return String(e).replace(T6,function(r,i,o){var a=[],s=i.toLowerCase();if(o.replace(O6,function(u,c){c&&a.push(+c)}),s==="m"&&a.length>2&&(t.push([i].concat(a.splice(0,2))),s="l",i=i==="m"?"l":"L"),s==="o"&&a.length===1&&t.push([i,a[0]]),s==="r")t.push([i].concat(a));else for(;a.length>=n[s]&&(t.push([i].concat(a.splice(0,n[s]))),n[s]););return""}),t}var N6=/[a-z]/;function _S(e,n){return[n[0]+(n[0]-e[0]),n[1]+(n[1]-e[1])]}function kS(e){var n=fv(e);if(!n||!n.length)return[["M",0,0]];for(var t=!1,r=0;r<n.length;r++){var i=n[r][0];if(N6.test(i)||["V","H","T","S"].indexOf(i)>=0){t=!0;break}}if(!t)return n;var o=[],a=0,s=0,u=0,c=0,l=0,h=n[0];h[0]!=="M"&&h[0]!=="m"||(u=a=+h[1],c=s=+h[2],l++,o[0]=["M",a,s]),r=l;for(var f=n.length;r<f;r++){var d=n[r],p=o[r-1],g=[],v=(i=d[0]).toUpperCase();if(i!==v)switch(g[0]=v,v){case"A":g[1]=d[1],g[2]=d[2],g[3]=d[3],g[4]=d[4],g[5]=d[5],g[6]=+d[6]+a,g[7]=+d[7]+s;break;case"V":g[1]=+d[1]+s;break;case"H":g[1]=+d[1]+a;break;case"M":u=+d[1]+a,c=+d[2]+s,g[1]=u,g[2]=c;break;default:for(var m=1,y=d.length;m<y;m++)g[m]=+d[m]+(m%2?a:s)}else g=n[r];switch(v){case"Z":a=+u,s=+c;break;case"H":g=["L",a=g[1],s];break;case"V":g=["L",a,s=g[1]];break;case"T":a=g[1],s=g[2];var b=_S([p[1],p[2]],[p[3],p[4]]);g=["Q",b[0],b[1],a,s];break;case"S":a=g[g.length-2],s=g[g.length-1];var x=p.length,w=_S([p[x-4],p[x-3]],[p[x-2],p[x-1]]);g=["C",w[0],w[1],g[1],g[2],a,s];break;case"M":u=g[g.length-2],c=g[g.length-1];break;default:a=g[g.length-2],s=g[g.length-1]}o.push(g)}return o}function Sf(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function dv(e,n){return Sf(e)*Sf(n)?(e[0]*n[0]+e[1]*n[1])/(Sf(e)*Sf(n)):1}function CS(e,n){return(e[0]*n[1]<e[1]*n[0]?-1:1)*Math.acos(dv(e,n))}function pv(e,n){return e[0]===n[0]&&e[1]===n[1]}function D6(e,n){var t=n[1],r=n[2],i=Fh(Gh(n[3]),2*Math.PI),o=n[4],a=n[5],s=e[0],u=e[1],c=n[6],l=n[7],h=Math.cos(i)*(s-c)/2+Math.sin(i)*(u-l)/2,f=-1*Math.sin(i)*(s-c)/2+Math.cos(i)*(u-l)/2,d=h*h/(t*t)+f*f/(r*r);d>1&&(t*=Math.sqrt(d),r*=Math.sqrt(d));var p=t*t*(f*f)+r*r*(h*h),g=p?Math.sqrt((t*t*(r*r)-p)/p):1;o===a&&(g*=-1),isNaN(g)&&(g=0);var v=r?g*t*f/r:0,m=t?g*-r*h/t:0,y=(s+c)/2+Math.cos(i)*v-Math.sin(i)*m,b=(u+l)/2+Math.sin(i)*v+Math.cos(i)*m,x=[(h-v)/t,(f-m)/r],w=[(-1*h-v)/t,(-1*f-m)/r],E=CS([1,0],x),M=CS(x,w);return dv(x,w)<=-1&&(M=Math.PI),dv(x,w)>=1&&(M=0),a===0&&M>0&&(M-=2*Math.PI),a===1&&M<0&&(M+=2*Math.PI),{cx:y,cy:b,rx:pv(e,[c,l])?0:t,ry:pv(e,[c,l])?0:r,startAngle:E,endAngle:E+M,xRotation:i,arcFlag:o,sweepFlag:a}}function AS(e,n){return[n[0]+(n[0]-e[0]),n[1]+(n[1]-e[1])]}function IS(e){e=function(Z){var q=Z||[];return Mt(q)?q:Re(q)?(ye(q=q.match(A6),function(te,we){if((te=te.match(I6))[0].length>1){var pe=te[0].charAt(0);te.splice(1,0,te[0].substr(1)),te[0]=pe}ye(te,function(Me,Be){isNaN(Me)||(te[Be]=+Me)}),q[we]=te}),q):void 0}(e);for(var n=[],t=null,r=null,i=null,o=0,a=e.length,s=0;s<a;s++){var u=e[s];r=e[s+1];var c=u[0],l={command:c,prePoint:t,params:u,startTangent:null,endTangent:null};switch(c){case"M":i=[u[1],u[2]],o=s;break;case"A":var h=D6(t,u);l.arcParams=h}if(c==="Z")t=i,r=e[o+1];else{var f=u.length;t=[u[f-2],u[f-1]]}r&&r[0]==="Z"&&(r=e[o],n[o]&&(n[o].prePoint=t)),l.currentPoint=t,n[o]&&pv(t,n[o].currentPoint)&&(n[o].prePoint=l.prePoint);var d=r?[r[r.length-2],r[r.length-1]]:null;l.nextPoint=d;var p=l.prePoint;if(["L","H","V"].includes(c))l.startTangent=[p[0]-t[0],p[1]-t[1]],l.endTangent=[t[0]-p[0],t[1]-p[1]];else if(c==="Q"){var g=[u[1],u[2]];l.startTangent=[p[0]-g[0],p[1]-g[1]],l.endTangent=[t[0]-g[0],t[1]-g[1]]}else if(c==="T")g=AS((y=n[s-1]).currentPoint,p),y.command==="Q"?(l.command="Q",l.startTangent=[p[0]-g[0],p[1]-g[1]],l.endTangent=[t[0]-g[0],t[1]-g[1]]):(l.command="TL",l.startTangent=[p[0]-t[0],p[1]-t[1]],l.endTangent=[t[0]-p[0],t[1]-p[1]]);else if(c==="C"){var v=[u[1],u[2]],m=[u[3],u[4]];l.startTangent=[p[0]-v[0],p[1]-v[1]],l.endTangent=[t[0]-m[0],t[1]-m[1]],l.startTangent[0]===0&&l.startTangent[1]===0&&(l.startTangent=[v[0]-m[0],v[1]-m[1]]),l.endTangent[0]===0&&l.endTangent[1]===0&&(l.endTangent=[m[0]-v[0],m[1]-v[1]])}else if(c==="S"){var y;v=AS((y=n[s-1]).currentPoint,p),m=[u[1],u[2]],y.command==="C"?(l.command="C",l.startTangent=[p[0]-v[0],p[1]-v[1]],l.endTangent=[t[0]-m[0],t[1]-m[1]]):(l.command="SQ",l.startTangent=[p[0]-m[0],p[1]-m[1]],l.endTangent=[t[0]-m[0],t[1]-m[1]])}else if(c==="A"){var b=.001,x=l.arcParams||{},w=x.cx,E=w===void 0?0:w,M=x.cy,_=M===void 0?0:M,k=x.rx,S=k===void 0?0:k,C=x.ry,T=C===void 0?0:C,A=x.sweepFlag,D=A===void 0?0:A,j=x.startAngle,L=j===void 0?0:j,B=x.endAngle,N=B===void 0?0:B;D===0&&(b*=-1);var R=S*Math.cos(L-b)+E,P=T*Math.sin(L-b)+_;l.startTangent=[R-i[0],P-i[1]];var H=S*Math.cos(L+N+b)+E,ne=T*Math.sin(L+N-b)+_;l.endTangent=[p[0]-H,p[1]-ne]}n.push(l)}return n}function _f(e,n){var t=e.prePoint,r=e.currentPoint,i=e.nextPoint,o=Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2),a=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2),u=Math.acos((o+a-s)/(2*Math.sqrt(o)*Math.sqrt(a)));if(!u||Math.sin(u)===0||Iw(u,0))return{xExtra:0,yExtra:0};var c=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),l=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return c=c>Math.PI/2?Math.PI-c:c,l=l>Math.PI/2?Math.PI-l:l,{xExtra:Math.cos(u/2-c)*(n/2*(1/Math.sin(u/2)))-n/2||0,yExtra:Math.cos(l-u/2)*(n/2*(1/Math.sin(u/2)))-n/2||0}}qi("rect",cS),qi("image",cS),qi("circle",lS),qi("marker",lS),qi("polyline",function(e){for(var n=e.attr().points,t=[],r=[],i=0;i<n.length;i++){var o=n[i];t.push(o[0]),r.push(o[1])}var a=Oc(t,r),s=a.x,u=a.y,c={minX:s,minY:u,maxX:s+a.width,maxY:u+a.height};return{x:(c=lv(e,c)).minX,y:c.minY,width:c.maxX-c.minX,height:c.maxY-c.minY}}),qi("polygon",function(e){for(var n=e.attr().points,t=[],r=[],i=0;i<n.length;i++){var o=n[i];t.push(o[0]),r.push(o[1])}return Oc(t,r)}),qi("text",function(e){var n=e.attr(),t=n.x,r=n.y,i=n.text,o=n.fontSize,a=n.lineHeight,s=n.font;s||(s=MS(n));var u,c=function(p,g){var v=wS(),m=0;return yt(p)||p===""||(v.save(),v.font=g,Re(p)&&p.includes(`
`)?ye(p.split(`
`),function(y){var b=v.measureText(y).width;m<b&&(m=b)}):m=v.measureText(p).width,v.restore()),m}(i,s);if(c){var l=n.textAlign,h=n.textBaseline,f=ES(i,o,a),d={x:t,y:r-f};l&&(l==="end"||l==="right"?d.x-=c:l==="center"&&(d.x-=c/2)),h&&(h==="top"?d.y+=f:h==="middle"&&(d.y+=f/2)),u={x:d.x,y:d.y,width:c,height:f}}else u={x:t,y:r,width:0,height:0};return u}),qi("path",function(e){var n=e.attr(),t=n.path,r=n.stroke?n.lineWidth:0,i=function(u,c){for(var l=[],h=[],f=[],d=0;d<u.length;d++){var p=(M=u[d]).currentPoint,g=M.params,v=M.prePoint,m=void 0;switch(M.command){case"Q":m=vS.box(v[0],v[1],g[1],g[2],g[3],g[4]);break;case"C":m=Nc.box(v[0],v[1],g[1],g[2],g[3],g[4],g[5],g[6]);break;case"A":var y=M.arcParams;m=C6(y.cx,y.cy,y.rx,y.ry,y.xRotation,y.startAngle,y.endAngle);break;default:l.push(p[0]),h.push(p[1])}m&&(M.box=m,l.push(m.x,m.x+m.width),h.push(m.y,m.y+m.height)),c&&(M.command==="L"||M.command==="M")&&M.prePoint&&M.nextPoint&&f.push(M)}l=l.filter(function(_){return!Number.isNaN(_)&&_!==1/0&&_!==-1/0}),h=h.filter(function(_){return!Number.isNaN(_)&&_!==1/0&&_!==-1/0});var b=Fi(l),x=Fi(h),w=zi(l),E=zi(h);if(f.length===0)return{x:b,y:x,width:w-b,height:E-x};for(d=0;d<f.length;d++){var M;(p=(M=f[d]).currentPoint)[0]===b?b-=_f(M,c).xExtra:p[0]===w&&(w+=_f(M,c).xExtra),p[1]===x?x-=_f(M,c).yExtra:p[1]===E&&(E+=_f(M,c).yExtra)}return{x:b,y:x,width:w-b,height:E-x}}(e.get("segments")||IS(t),r),o=i.x,a=i.y,s={minX:o,minY:a,maxX:o+i.width,maxY:a+i.height};return{x:(s=lv(e,s)).minX,y:s.minY,width:s.maxX-s.minX,height:s.maxY-s.minY}}),qi("line",function(e){var n=e.attr(),t=n.x1,r=n.y1,i=n.x2,o=n.y2,a={minX:Math.min(t,i),maxX:Math.max(t,i),minY:Math.min(r,o),maxY:Math.max(r,o)};return{x:(a=lv(e,a)).minX,y:a.minY,width:a.maxX-a.minX,height:a.maxY-a.minY}}),qi("ellipse",function(e){var n=e.attr(),t=n.x,r=n.y,i=n.rx,o=n.ry;return{x:t-i,y:r-o,width:2*i,height:2*o}});var P6=function(e){function n(t,r){var i=e.call(this,t,r)||this;return i.item=r.item,i.canvasX=r.canvasX,i.canvasY=r.canvasY,i.wheelDelta=r.wheelDelta,i.detail=r.detail,i}return Nt(n,e),n}(hM),gv=function(e){return"".concat(e,"-").concat(Math.random()).concat(Date.now())},vv=function(e){if(Mt(e))switch(e.length){case 4:return e;case 3:return e.push(e[1]),e;case 2:return e.concat(e);case 1:return[e[0],e[0],e[0],e[0]];default:return[0,0,0,0]}if(xt(e))return[e,e,e,e];if(Re(e)){var n=parseInt(e,10);return[n,n,n,n]}return[0,0,0,0]},Zi=function(e){return Number.isNaN(Number(e))},TS=function(e){for(var n=1/0,t=-1/0,r=1/0,i=-1/0,o=0;o<e.length;o++){var a=e[o].getBBox(),s=a.minX,u=a.minY,c=a.maxX,l=a.maxY;s<n&&(n=s),u<r&&(r=u),c>t&&(t=c),l>i&&(i=l)}return{x:Math.floor(n),y:Math.floor(r),width:Math.ceil(t)-Math.floor(n),height:Math.ceil(i)-Math.floor(r),minX:n,minY:r,maxX:t,maxY:i}};const L6=Object.freeze(Object.defineProperty({__proto__:null,calculationItemsBBox:TS,cloneEvent:function(e){var n=new P6(e.type,e);return n.clientX=e.clientX,n.clientY=e.clientY,n.x=e.x,n.y=e.y,n.target=e.target,n.currentTarget=e.currentTarget,n.bubbles=!0,n.item=e.item,n},formatPadding:vv,isNaN:Zi,isViewportChanged:function(e){if(!e)return!1;for(var n=[1,0,0,0,1,0,0,0,1],t=0;t<9;t++)if(e[t]!==n[t])return!0;return!1},processParallelEdges:function(e,n,t,r,i){n===void 0&&(n=15),t===void 0&&(t="quadratic"),r===void 0&&(r=void 0),i===void 0&&(i=void 0);for(var o=e.length,a=2*n,s=["top","top-right","right","bottom-right","bottom","bottom-left","left","top-left"],u={},c=[],l={},h=0;h<o;h++){var f=e[h],d=f.source,p=f.target,g="".concat(d,"-").concat(p);if(!c[h]){u[g]||(u[g]=[]),c[h]=!0,u[g].push(f);for(var v=0;v<o;v++)if(h!==v){var m=e[v],y=m.source,b=m.target;c[v]||(d===b&&p===y?(u[g].push(m),c[v]=!0,l["".concat(y,"|").concat(b,"|").concat(u[g].length-1)]=!0):d===y&&p===b&&(u[g].push(m),c[v]=!0))}}}for(var x in u)for(var w=u[x],E=w.length,M=0;M<E;M++){var _=w[M];if(_.source!==_.target)if(E===1&&r&&_.source!==_.target)_.type=r;else{_.type=t;var k=(M%2==0?1:-1)*(l["".concat(_.source,"|").concat(_.target,"|").concat(M)]?-1:1);_.curveOffset=E%2==1?k*Math.ceil(M/2)*a:k*(Math.floor(M/2)*a+n)}else i&&(_.type=i),_.loopCfg={position:s[M%8],dist:20*Math.floor(M/8)+50}}return e},uniqueId:gv},Symbol.toStringTag,{value:"Module"}));var na={};const R6=ji(JL);Object.defineProperty(na,"__esModule",{value:!0});var ra=R6;function OS(e,n,t){var r=[0,0,0,0,0,0,0,0,0];return ra.mat3.fromTranslation(r,t),ra.mat3.multiply(e,r,n)}function NS(e,n,t){var r=[0,0,0,0,0,0,0,0,0];return ra.mat3.fromRotation(r,t),ra.mat3.multiply(e,r,n)}function DS(e,n,t){var r=[0,0,0,0,0,0,0,0,0];return ra.mat3.fromScaling(r,t),ra.mat3.multiply(e,r,n)}function j6(e,n,t){return ra.mat3.multiply(e,t,n)}na.leftTranslate=OS,na.leftRotate=NS,na.leftScale=DS;var PS=na.transform=function(e,n){for(var t=e?[].concat(e):[1,0,0,0,1,0,0,0,1],r=0,i=n.length;r<i;r++){var o=n[r];switch(o[0]){case"t":OS(t,t,[o[1],o[2]]);break;case"s":DS(t,t,[o[1],o[2]]);break;case"r":NS(t,t,o[1]);break;case"m":j6(t,t,o[1])}}return t};function LS(e,n){return e[0]*n[1]-n[0]*e[1]}na.direction=LS,na.angleTo=function(e,n,t){var r=ra.vec2.angle(e,n),i=LS(e,n)>=0;return t?i?2*Math.PI-r:r:i?r:2*Math.PI-r},na.vertical=function(e,n,t){return t?(e[0]=n[1],e[1]=-1*n[0]):(e[0]=-1*n[1],e[1]=n[0]),e};var B6=function(){function e(n){this.destroyed=!1,this.graph=n,this.destroyed=!1}return e.prototype.getViewCenter=function(){var n=this.getFormatPadding(),t=this.graph,r=this.graph.get("width"),i=t.get("height");return{x:(r-n[1]-n[3])/2+n[3],y:(i-n[0]-n[2])/2+n[0]}},e.prototype.fitCenter=function(n,t){var r,i=this.graph,o=i.get("group"),a=i.getNodes();if(a.length>i.get("optimizeThreshold")){var s=1/0,u=1/0,c=-1/0,l=-1/0;a.forEach(function(w){var E=w.getModel(),M=E.x,_=E.y;s>M&&(s=M),u>_&&(u=_),c<M&&(c=M),l<_&&(l=_)});var h=o.getMatrix()||[1,0,0,0,1,0,0,0,1],f=qs({x:s,y:u},h),d=f.x,p=f.y,g=qs({x:c,y:l},h),v=g.x,m=g.y;r={minX:d,maxX:v,minY:p,maxY:m,width:v-d,height:m-p,x:d,y:p}}else r=o.getCanvasBBox();if(r.width!==0&&r.height!==0){var y=this.getViewCenter(),b=r.x+r.width/2,x=r.y+r.height/2;i.translate(y.x-b,y.y-x,n,t)}},e.prototype.animatedFitView=function(n,t,r,i,o,a,s,u){var c=this.graph;r=r||{duration:500,easing:"easeCubic"};var l=i.x+o.x-a.x-i.minX,h=i.y+o.y-a.y-i.minY;if(!Zi(l)&&!Zi(h)){var f=PS([1,0,0,0,1,0,0,0,1],[["t",l,h]]);if(u){var d=c.get("minZoom"),p=c.get("maxZoom"),g=s;d&&s<d?g=d:p&&s>p&&(g=p);var v=PS(f,[["t",-o.x,-o.y],["s",g,g],["t",o.x,o.y]]),m=bc({animateCfg:r,callback:function(){n.setMatrix(v),c.emit("viewportchange",{action:"translate",matrix:f}),c.emit("viewportchange",{action:"zoom",matrix:v})}});n.stopAnimate(),n.setMatrix(t),n.animate(function(b){return{matrix:j0(t,v,b)}},m)}else{var y=bc({animateCfg:r,callback:function(){c.emit("viewportchange",{action:"translate",matrix:f})}});n.animate(function(b){return{matrix:j0(t,f,b)}},y)}}},e.prototype.fitView=function(n,t){var r,i=this.graph,o=this.getFormatPadding(),a=i.get("width"),s=i.get("height"),u=i.get("group"),c=u.getMatrix()||[1,0,0,0,1,0,0,0,1];u.resetMatrix();var l=i.getNodes();if(l.length>i.get("optimizeThreshold")){var h=1/0,f=1/0,d=-1/0,p=-1/0;l.forEach(function(E){var M=E.getModel(),_=M.x,k=M.y;h>_&&(h=_),f>k&&(f=k),d<_&&(d=_),p<k&&(p=k)}),r={minX:h,maxX:d,minY:f,maxY:p,width:d-h,height:p-f,x:h,y:f}}else r=u.getCanvasBBox();if(r.width!==0&&r.height!==0){var g=this.getViewCenter(),v={x:r.x+r.width/2,y:r.y+r.height/2},m=(a-o[1]-o[3])/r.width,y=(s-o[0]-o[2])/r.height,b=m;if(m>y&&(b=y),n)this.animatedFitView(u,c,t,r,g,v,b,!0);else{var x=g.x-v.x,w=g.y-v.y;if(Zi(x)||Zi(w))return;i.translate(x,w),i.zoom(b,g)}}},e.prototype.fitViewByRules=function(n,t,r){var i,o=n.onlyOutOfViewPort,a=o!==void 0&&o,s=n.direction,u=s===void 0?"both":s,c=n.ratioRule,l=c===void 0?"min":c,h=this.graph,f=this.getFormatPadding(),d=h.get("width"),p=h.get("height"),g=h.get("group"),v=g.getMatrix()||[1,0,0,0,1,0,0,0,1];g.resetMatrix();var m=h.getNodes();if(m.length>h.get("optimizeThreshold")){var y=1/0,b=1/0,x=-1/0,w=-1/0;m.forEach(function(A){var D=A.getModel(),j=D.x,L=D.y;y>j&&(y=j),b>L&&(b=L),x<j&&(x=j),w<L&&(w=L)}),i={minX:y,maxX:x,minY:b,maxY:w,width:x-y,height:w-b,x:y,y:b}}else i=g.getCanvasBBox();if(i.width!==0&&i.height!==0){var E,M=this.getViewCenter(),_={x:i.x+i.width/2,y:i.y+i.height/2},k=(d-f[1]-f[3])/i.width,S=(p-f[0]-f[2])/i.height;if(E=u==="x"?k:u==="y"?S:l==="max"?Math.max(k,S):Math.min(k,S),a&&(E=E<1?E:1),t)this.animatedFitView(g,v,r,i,M,_,E,!0);else{var C=h.getZoom()*E,T=h.get("minZoom");C<T&&(C=T),h.translate(M.x-_.x,M.y-_.y),h.zoomTo(C,M)}}},e.prototype.getFormatPadding=function(){var n=this.graph.get("fitViewPadding");return vv(n)},e.prototype.focusPoint=function(n,t,r){var i=this,o=this.getViewCenter(),a=this.getPointByCanvas(o.x,o.y),s=this.graph.get("group").getMatrix();if(s||(s=[1,0,0,0,1,0,0,0,1]),t){var u=(a.x-n.x)*s[0],c=(a.y-n.y)*s[4],l=0,h=0,f=0,d=0;this.graph.get("canvas").animate(function(p){f=u*p,d=c*p,i.graph.translate(f-l,d-h),l=f,h=d},F({},r))}else this.graph.translate((a.x-n.x)*s[0],(a.y-n.y)*s[4])},e.prototype.getPointByCanvas=function(n,t){var r=this.graph.get("group").getMatrix();return r||(r=[1,0,0,0,1,0,0,0,1]),jE({x:n,y:t},r)},e.prototype.getPointByClient=function(n,t){var r=this.graph.get("canvas").getPointByClient(n,t);return this.getPointByCanvas(r.x,r.y)},e.prototype.getClientByPoint=function(n,t){var r=this.graph.get("canvas"),i=this.getCanvasByPoint(n,t),o=r.getClientByPoint(i.x,i.y);return{x:o.x,y:o.y}},e.prototype.getCanvasByPoint=function(n,t){var r=this.graph.get("group").getMatrix();return r||(r=[1,0,0,0,1,0,0,0,1]),qs({x:n,y:t},r)},e.prototype.focus=function(n,t,r){if(Re(n)&&(n=this.graph.findById(n)),n){var i=0,o=0;if(n.getType&&n.getType()==="edge"){var a=n.getSource().get("group").getMatrix(),s=n.getTarget().get("group").getMatrix();a&&s?(i=(a[6]+s[6])/2,o=(a[7]+s[7])/2):(a||s)&&(i=a?a[6]:s[6],o=a?a[7]:s[7])}else{var u=n.get("group").getMatrix();u||(u=[1,0,0,0,1,0,0,0,1]),i=u[6],o=u[7]}this.focusPoint({x:i,y:o},t,r)}},e.prototype.focusItems=function(n,t,r,i){if(n.length){var o=this.graph,a=this.getFormatPadding(),s=o.get("width"),u=o.get("height"),c=o.get("group"),l=c.getMatrix()||[1,0,0,0,1,0,0,0,1];c.resetMatrix();for(var h={x:0,y:0,minX:Number.MAX_SAFE_INTEGER,minY:Number.MAX_SAFE_INTEGER,maxX:Number.MIN_SAFE_INTEGER,maxY:Number.MIN_SAFE_INTEGER,width:0,height:0},f=0,d=n;f<d.length;f++){var p=d[f].getBBox();p.minX<h.minX&&(h.minX=p.minX),p.minY<h.minY&&(h.minY=p.minY),p.maxX>h.maxX&&(h.maxX=p.maxX),p.maxY>h.maxY&&(h.maxY=p.maxY)}if(h.x=h.minX,h.y=h.minY,h.width=h.maxX-h.minX,h.height=h.maxY-h.minY,h.width!==0&&h.height!==0){var g=this.getViewCenter(),v={x:h.x+h.width/2,y:h.y+h.height/2},m=(s-a[1]-a[3])/h.width,y=(u-a[0]-a[2])/h.height,b=m;m>y&&(b=y),r?this.animatedFitView(c,l,i,h,g,v,b,t):(o.translate(g.x-v.x,g.y-v.y),t&&o.zoom(b,g))}}},e.prototype.changeSize=function(n,t){var r=this.graph;if(!xt(n)||!xt(t))throw Error("invalid canvas width & height, please make sure width & height type is number");r.set({width:n,height:t}),r.get("canvas").changeSize(n,t),r.get("plugins").forEach(function(i){i.get("gridContainer")&&i.positionInit()})},e.prototype.destroy=function(){this.graph=null,this.destroyed=!1},e}();function mv(e){return mv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},mv(e)}function RS(e){if(typeof e!="string")return e;var n=function(w){if(typeof w!="string")return w;try{return JSON.parse(w.trim())}catch{return w.trim()}},t=n(e);if(typeof t!="string")return t;for(var r=function(w){return w[w.length-1]},i=e.trim(),o=[],a=[],s=function(){for(var w=[],E=0;E<arguments.length;E++)w[E]=arguments[E];return w.some(function(M){return r(a)===M})},u=null,c=0,l="";c<i.length;){var h=i[c],f=s('"',"'");if(f||h.trim()){var d=i[c-1]==="\\",p=s("}"),g=s("]"),v=s(","),m=r(o);if(f)if(r(a)!==h||d)l+=h;else{a.pop();var y=n(l);m.push(y),u=y,l=""}else if(g&&h===",")l&&(m.push(n(l)),l="");else if(p&&h===":")a.push(","),l&&(m.push(l),l="");else if(v&&h===",")l&&(m.push(n(l)),l=""),a.pop();else if(h==="}"&&(p||v)){l&&(m.push(n(l)),l=""),v&&a.pop();for(var b={},x=1;x<m.length;x+=2)b[m[x-1]]=m[x];o.pop(),o.length&&r(o).push(b),a.pop(),u=b}else h==="]"&&g?(l&&(m.push(n(l)),l=""),o.pop(),o.length&&r(o).push(m),a.pop(),u=m):h==="{"?(o.push([]),a.push("}")):h==="["?(o.push([]),a.push("]")):h==='"'?a.push('"'):h==="'"?a.push("'"):l+=h;c+=1}else c+=1}return u||l}function jS(e,n){var t={},r=e.getAttributeNames&&e.getAttributeNames()||[],i=e.children&&Array.from(e.children).map(function(s){return jS(s,n)}),o={},a=e.tagName?e.tagName.toLowerCase():"group";return a==="text"&&(t.text=e.innerText),o.type=a,a==="img"&&(o.type="image"),Array.from(r).forEach(function(s){var u=function(h){return h.split("-").reduce(function(f,d){return f+d.charAt(0).toUpperCase()+d.slice(1)})}(s),c=e.getAttribute(s);try{if(u==="style"||u==="attrs"){var l=RS(c);t=F(F({},t),l)}else o[u]=RS(c)}catch(h){if(u==="style")throw h;o[u]=c}}),o.attrs=t,n&&n.style&&o.name&&mv(n.style[o.name])==="object"&&(o.attrs=F(F({},o.attrs),n.style[o.name])),n&&n.style&&o.keyshape&&(o.attrs=F(F({},o.attrs),n.style)),i.length&&(o.children=i),o}function BS(e,n){var t;n===void 0&&(n={x:0,y:0});var r=F({x:0,y:0,width:0,height:0},n);if(!((t=e.children)===null||t===void 0)&&t.length){var i=e.attrs,o=i===void 0?{}:i,a=o.marginTop,s=F({},n);a&&(s.y+=a);for(var u=0;u<e.children.length;u++){e.children[u].attrs.key="".concat(o.key||"root"," -").concat(u," ");var c=BS(e.children[u],s);if(c.bbox){var l=c.bbox;c.attrs.next==="inline"?s.x+=c.bbox.width:s.y+=c.bbox.height,l.width+l.x>r.width&&(r.width=l.width+l.x),l.height+l.y>r.height&&(r.height=l.height+l.y)}}}return e.bbox=function(h,f,d){var p,g,v=h.attrs,m=v===void 0?{}:v,y={x:f.x||0,y:f.y||0,width:d.width||0,height:d.height||0};switch(h.type){case"maker":case"circle":m.r&&(g=2*m.r,p=2*m.r);break;case"text":m.text&&(g=QE(m.text,m.fontSize||12)[0],p=16,y.y+=p,y.height=p,y.width=g,h.attrs=F({fontSize:12,fill:"#000"},m));break;default:m.width&&(g=m.width),m.height&&(p=m.height)}return p>=0&&(y.height=p),g>=0&&(y.width=g),m.marginTop&&(y.y+=m.marginTop),m.marginLeft&&(y.x+=m.marginLeft),y}(e,n,r),e.attrs=F(F({},e.attrs),e.bbox),e}function zS(e,n){var t,r,i,o,a=(e||{}).type,s=((n==null?void 0:n.attrs)||{}).key;if(s&&e&&(e.attrs.key=s),!e&&n)return{action:"delete",val:n,type:a,key:s};if(e&&!n)return{action:"add",val:e,type:a};if(!e&&!n)return{action:"same",type:a};var u=[];if(((t=e.children)===null||t===void 0?void 0:t.length)>0||((r=n.children)===null||r===void 0?void 0:r.length)>0)for(var c=Math.max((i=e.children)===null||i===void 0?void 0:i.length,(o=n.children)===null||o===void 0?void 0:o.length),l=n.children||[],h=e.children||[],f=0;f<c;f+=1)u.push(zS(h[f],l[f]));var d=Object.keys(n.attrs),p=Object.keys(e.attrs);return n.type!==e.type?{action:"restructure",nowTarget:e,formerTarget:n,key:s,children:u}:d.filter(function(g){return g!=="children"}).some(function(g){return e.attrs[g]!==n.attrs[g]||!p.includes(g)})?{action:"change",val:e,children:u,type:a,key:s}:{action:"same",children:u,type:a,key:s}}function FS(e){var n={},t=function(r){var i=function(s){return function(u){for(var c=s.length,l=[],h=0,f="";h<c;)if(s[h]==="{"&&s[h+1]==="{")l.push(f),f="",h+=2;else if(s[h]==="}"&&s[h+1]==="}"){if(l.length){var d=l.pop();f=fo(u,f,d.endsWith("=")?'"{'.concat(f,'}"'):f),l.push(d+f)}h+=2,f=""}else f+=s[h],h+=1;return l.push(f),l.map(function(p,g){return l[g-1]&&l[g-1].endsWith("=")?'"{'.concat(p,'}"'):p}).join("")}}(typeof e=="function"?e(r):e)(r),o=document.createElement("div");o.innerHTML=i;var a=BS(jS(o.children[0],r));return o.remove(),a};return{draw:function(r,i){var o=t(r),a=i;return function s(u){var c=u.attrs,l=c===void 0?{}:c,h=u.bbox,f=u.type,d=u.children,p=Yn(u,["attrs","bbox","type","children"]);if(u.type!=="group"){var g=i.addShape(u.type,F({attrs:l,origin:{bbox:h,type:f,children:d}},p));u.keyshape&&(a=g)}u.children&&u.children.forEach(function(v){return s(v)})}(o),n[r.id]=[o],a},update:function(r,i){n[r.id]||(n[r.id]=[]);var o=i.getContainer(),a=o.get("children"),s=t(r),u=zS(s,n[r.id].pop()),c=function h(f){var d;f.type!=="group"&&o.addShape(f.type,{attrs:f.attrs}),!((d=f.children)===null||d===void 0)&&d.length&&f.children.map(function(p){return h(p)})},l=function h(f){var d,p=a.find(function(g){return g.attrs.key===f.attrs.key});p&&o.removeChild(p),!((d=f.children)===null||d===void 0)&&d.length&&f.children.map(function(g){return h(g)})};(function h(f){var d=f.key;if(f.type!=="group"){var p=a.find(function(v){return v.attrs.key===d});switch(f.action){case"change":if(p){var g=f.val.keyshape?i.getOriginStyle():{};p.attr(F(F({},g),f.val.attrs))}break;case"add":c(f.val);break;case"delete":l(f.val);break;case"restructure":l(f.formerTarget),c(f.nowTarget)}}f.children&&f.children.forEach(function(v){return h(v)})})(u),n[r.id].push(s)},getAnchorPoints:function(){return[[0,.5],[1,.5],[.5,1],[.5,0]]}}}var yv={};function GS(e){return yv[e]||(yv[e]=Vs(e)),yv[e]}var z6={defaultShapeType:"defaultType",className:null,getShape:function(e){var n=this;return n[e]||n[n.defaultShapeType]||n["simple-circle"]},draw:function(e,n,t){var r=this.getShape(e);t.shapeMap={};var i=r.draw(n,t);return r.afterDraw&&r.afterDraw(n,t,i),i},baseUpdate:function(e,n,t,r){var i,o,a=this.getShape(e);a.update&&(a.mergeStyle=(i=a.getOptions)===null||i===void 0?void 0:i.call(a,n,r),(o=a.update)===null||o===void 0||o.call(a,n,t,r)),a.afterUpdate&&a.afterUpdate(n,t)},setState:function(e,n,t,r){this.getShape(e).setState(n,t,r)},shouldUpdate:function(e){return!!this.getShape(e).update},getControlPoints:function(e,n){return this.getShape(e).getControlPoints(n)},getAnchorPoints:function(e,n){return this.getShape(e).getAnchorPoints(n)}},bv={options:{},draw:function(e,n){return this.drawShape(e,n)},drawShape:function(){},afterDraw:function(){},afterUpdate:function(){},setState:function(){},getControlPoints:function(e){return e.controlPoints},getAnchorPoints:function(e){var n=this.options.anchorPoints;return e.anchorPoints||n}},dn=function(){function e(){}return e.registerFactory=function(n,t){var r=GS(n),i=F(F({},z6),t);return e[r]=i,i.className=r,i},e.getFactory=function(n){return e[GS(n)]},e.registerNode=function(n,t,r){var i,o=e.Node;if(typeof t=="string"||typeof t=="function"){var a=FS(t);i=F(F({},o.getShape("single-node")),a)}else if(t.jsx)a=FS(t.jsx),i=F(F(F({},o.getShape("single-node")),a),t);else{o.getShape(r);var s=r?o.getShape(r):bv;i=F(F({},s),t)}return i.type=n,i.itemType="node",o[n]=i,i},e.registerEdge=function(n,t,r){var i=e.Edge,o=r?i.getShape(r):bv,a=F(F({},o),t);return a.type=n,a.itemType="edge",i[n]=a,a},e.registerCombo=function(n,t,r){var i=e.Combo,o=r?i.getShape(r):bv,a=F(F({},o),t);return a.type=n,a.itemType="combo",i[n]=a,a},e}();dn.registerFactory("node",{defaultShapeType:"circle"}),dn.registerFactory("edge",{defaultShapeType:"line"}),dn.registerFactory("combo",{defaultShapeType:"circle"});var xv="bboxCache",wv="bboxCanvasCache",US=function(){function e(n){this._cfg={},this.destroyed=!1,this.optimize=!1;var t={id:void 0,type:"item",model:{},group:void 0,animate:!1,visible:!0,locked:!1,event:!0,keyShape:void 0,states:[]};this._cfg=Object.assign(t,this.getDefaultCfg(),n);var r=this.get("model"),i=r.id,o=this.get("type");i===void 0?i=gv(o):typeof i!="string"&&(i=String(i)),this.get("model").id=i,this.set("id",i);var a=n.group;a&&(a.set("item",this),a.set("id",i)),this.init(),this.draw();var s=r.shape||r.type||(o==="edge"?"line":"circle"),u=this.get("shapeFactory");if(u&&u[s]){var c=u[s].options;if(c&&c.stateStyles){var l=this.get("styles")||r.stateStyles;l=fn({},c.stateStyles,l),this.set("styles",l)}}}return e.prototype.calculateBBox=function(){var n=this.get("keyShape"),t=this.get("group"),r=cf(n,t);return r.x=r.minX,r.y=r.minY,r.width=r.maxX-r.minX,r.height=r.maxY-r.minY,r.centerX=(r.minX+r.maxX)/2,r.centerY=(r.minY+r.maxY)/2,r},e.prototype.calculateCanvasBBox=function(){var n=this.get("keyShape"),t=this.get("group"),r=cf(n,t);return r.x=r.minX,r.y=r.minY,r.width=r.maxX-r.minX,r.height=r.maxY-r.minY,r.centerX=(r.minX+r.maxX)/2,r.centerY=(r.minY+r.maxY)/2,r},e.prototype.drawInner=function(){var n=this,t=n.get("shapeFactory"),r=n.get("group"),i=n.get("model");r.clear();var o=i.visible;if(o===void 0||o||n.changeVisibility(o),t){n.updatePosition(i);var a=n.getShapeCfg(i),s=a.type,u=t.draw(s,a,r);u&&(n.set("keyShape",u),u.set("isKeyShape",!0),u.set("draggable",!0)),this.setOriginStyle(),this.set("currentShape",s),this.restoreStates(t,s)}},e.prototype.setOriginStyle=function(){var n=this.get("group"),t=n.get("children"),r=this.getKeyShape(),i=this,o=r.get("name");if(this.get("originStyle")){var a=this.get("originStyle");o&&!a[o]&&(a[o]={});var s=this.getCurrentStatesStyle(),u=function(v){var m=t[v],y=m.get("name"),b=m.attr();if(y&&y!==o){var x=s[y];a[y]||(a[y]={}),x?Object.keys(b).forEach(function(M){var _=b[M];_!==x[M]&&(a[y][M]=_)}):a[y]=m.get("type")!=="image"?Kt(b):i.getShapeStyleByName(y)}else{var w=m.attr(),E={};Object.keys(s).forEach(function(M){var _=s[M];M!==o&&nr(_)||(E[M]=_)}),Object.keys(w).forEach(function(M){var _=w[M];E[M]!==_&&(o?a[o][M]=_:a[M]=_)})}};for(l=0;l<t.length;l++)u(l);delete a.path,delete a.matrix,delete a.x,delete a.y,a[o]&&(delete a[o].x,delete a[o].y,delete a[o].matrix,delete a[o].path),i.set("originStyle",a)}else{for(var c={},l=0;l<t.length;l++){var h=t[l],f=h.get("type"),d=h.get("name");if(d&&d!==o)c[d]=f!=="image"?Kt(h.attr()):i.getShapeStyleByName(d),f==="text"&&c[d]&&(delete c[d].x,delete c[d].y,delete c[d].matrix);else{var p=i.getShapeStyleByName();if(delete p.path,delete p.matrix,o)if(d)c[o]=p;else{var g=gv("shape");h.set("name",g),n.shapeMap[g]=h,c[g]=f!=="image"?Kt(h.attr()):i.getShapeStyleByName(d)}else Object.assign(c,p)}}i.set("originStyle",c)}},e.prototype.restoreStates=function(n,t){var r=this;ye(r.get("states"),function(i){n.setState(t,i,!0,r)})},e.prototype.init=function(){var n=dn.getFactory(this.get("type"));this.set("shapeFactory",n)},e.prototype.get=function(n){return this._cfg[n]},e.prototype.set=function(n,t){nr(n)?this._cfg=F(F({},this._cfg),n):this._cfg[n]=t},e.prototype.getDefaultCfg=function(){return{}},e.prototype.clearCache=function(){this.set(xv,null),this.set(wv,null)},e.prototype.beforeDraw=function(){},e.prototype.afterDraw=function(){},e.prototype.afterUpdate=function(){},e.prototype.draw=function(){this.beforeDraw(),this.drawInner(),this.afterDraw()},e.prototype.getShapeStyleByName=function(n){var t,r=this.get("group");if(t=n?r.shapeMap[n]||r.find(function(o){return o.get("name")===n}):this.getKeyShape()){var i={};return ye(t.attr(),function(o,a){(a!=="img"||Re(o))&&(i[a]=o)}),i}return{}},e.prototype.getShapeCfg=function(n,t){var r=this.get("styles");if(r){var i=n;return i.style=F(F({},r),n.style),i}return n},e.prototype.getStateStyle=function(n){var t=this.get("styles");return t&&t[n]},e.prototype.getOriginStyle=function(){return this.get("originStyle")},e.prototype.getCurrentStatesStyle=function(){var n=this,t={},r=n.getStates();return r&&r.length?(ye(n.getStates(),function(i){t=Object.assign(t,n.getStateStyle(i))}),t):this.get("originStyle")},e.prototype.setState=function(n,t){var r=this.get("states"),i=this.get("shapeFactory"),o=n,a=n;Re(t)&&(o="".concat(n,":").concat(t),a="".concat(n,":"));var s=r;if(hc(t)){var u=r.indexOf(a);if(t){if(u>-1)return;r.push(o)}else u>-1&&r.splice(u,1)}else if(Re(t)){var c=r.filter(function(h){return h.includes(a)});c.length>0&&this.clearStates(c),s=s.filter(function(h){return!h.includes(a)}),s.push(o),this.set("states",s)}if(i){var l=this.get("model").type;i.setState(l,n,t,this)}},e.prototype.clearStates=function(n){var t=this,r=t.getStates(),i=t.get("shapeFactory"),o=t.get("model").type;n||(n=r),Re(n)&&(n=[n]);var a=r.filter(function(s){return n.indexOf(s)===-1});t.set("states",a),n.forEach(function(s){i.setState(o,s,!1,t)})},e.prototype.setOptimize=function(n){this.optimize=n},e.prototype.getContainer=function(){return this.get("group")},e.prototype.getKeyShape=function(){return this.get("keyShape")},e.prototype.getModel=function(){return this.get("model")},e.prototype.getType=function(){return this.get("type")},e.prototype.getID=function(){return this.get("id")},e.prototype.isItem=function(){return!0},e.prototype.getStates=function(){return this.get("states")},e.prototype.hasState=function(n){return this.getStates().indexOf(n)>=0},e.prototype.refresh=function(n){var t=this.get("model");this.updatePosition(t),this.updateShape(n),this.afterUpdate(),this.clearCache()},e.prototype.getUpdateType=function(n){},e.prototype.update=function(n,t){t===void 0&&(t=void 0);var r=this.get("model");if(t==="move")this.updatePosition(n);else{var i=r.visible,o=n.visible;i!==o&&o!==void 0&&this.changeVisibility(o);var a={x:r.x,y:r.y};n.x=isNaN(+n.x)?r.x:+n.x,n.y=isNaN(+n.y)?r.y:+n.y;var s=this.get("styles");n.stateStyles&&(St(s,n.stateStyles),delete n.stateStyles),Object.assign(r,n),a.x===n.x&&a.y===n.y||this.updatePosition(n),this.updateShape(t)}this.afterUpdate(),this.clearCache()},e.prototype.updateShape=function(n){var t=this.get("shapeFactory"),r=this.get("model"),i=r.type;if(t.shouldUpdate(i)&&i===this.get("currentShape")){var o=this.getShapeCfg(r,n);t.baseUpdate(i,o,this,n),n!=="move"&&this.setOriginStyle()}else this.draw();this.restoreStates(t,i)},e.prototype.updatePosition=function(n){var t=this.get("model"),r=isNaN(+n.x)?+t.x:+n.x,i=isNaN(+n.y)?+t.y:+n.y,o=this.get("group");if(isNaN(r)||isNaN(i))return!1;t.x=r,t.y=i;var a=o.getMatrix();return(!a||a[6]!==r||a[7]!==i)&&(o.resetMatrix(),BE(o,{x:r,y:i}),this.clearCache(),!0)},e.prototype.getBBox=function(){var n=this.get(xv);return n||(n=this.calculateBBox(),this.set(xv,n)),n},e.prototype.getCanvasBBox=function(){var n=this.get(wv);return n||(n=this.calculateCanvasBBox(),this.set(wv,n)),n},e.prototype.toFront=function(){this.get("group").toFront()},e.prototype.toBack=function(){this.get("group").toBack()},e.prototype.show=function(){this.changeVisibility(!0)},e.prototype.hide=function(){this.changeVisibility(!1)},e.prototype.changeVisibility=function(n){var t=this.get("group");n?t.show():t.hide(),this.set("visible",n)},e.prototype.isVisible=function(){return this.get("visible")},e.prototype.enableCapture=function(n){var t=this.get("group");t&&t.set("capture",n)},e.prototype.destroy=function(){if(!this.destroyed){var n=this.get("animate"),t=this.get("group");n&&t.stopAnimate(),t.shapeMap={},this.clearCache(),t.remove(),this._cfg=null,this.destroyed=!0}},e}(),kf={source:"start",target:"end"},Ki="Node",eu="Point",F6=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.getDefaultCfg=function(){return{type:"edge",sourceNode:null,targetNode:null,startPoint:null,endPoint:null,linkCenter:!1}},n.prototype.setEnd=function(t,r){var i=kf[t]+eu,o=t+Ki,a=this.get(o);a&&!a.destroyed&&a.removeEdge(this),nr(r)?(this.set(i,r),this.set(o,null)):r&&(r.addEdge(this),this.set(o,r),this.set(i,null))},n.prototype.getLinkPoint=function(t,r,i){var o=kf[t]+eu,a=t+Ki,s=this.get(o);if(!s){var u=this.get(a),c=t+"Anchor",l=this.getPrePoint(t,i),h=r[c];yt(h)||(s=u.getLinkPointByAnchor(h)),s=s||u.getLinkPoint(l),yt(s.index)||this.set("".concat(t,"AnchorIndex"),s.index)}return s},n.prototype.getPrePoint=function(t,r){if(r&&r.length)return r[t==="source"?0:r.length-1];var i=t==="source"?"target":"source";return this.getEndPoint(i)},n.prototype.getEndPoint=function(t){var r=t+Ki,i=kf[t]+eu,o=this.get(r);return o&&!o.destroyed?o.get("model"):this.get(i)},n.prototype.getControlPointsByCenter=function(t){var r=this.getEndPoint("source"),i=this.getEndPoint("target"),o=this.get("shapeFactory"),a=t.type;return o.getControlPoints(a,{startPoint:r,endPoint:i})},n.prototype.getEndCenter=function(t){var r=t+Ki,i=kf[t]+eu,o=this.get(r);if(o){var a=o.getBBox();return{x:a.centerX,y:a.centerY}}return this.get(i)},n.prototype.init=function(){e.prototype.init.call(this),this.setSource(this.get("source")),this.setTarget(this.get("target"))},n.prototype.getShapeCfg=function(t,r){var i=this,o=i.get("linkCenter"),a=r!=null&&r.includes("move")?t:e.prototype.getShapeCfg.call(this,t);if(o)a.startPoint=i.getEndCenter("source"),a.endPoint=i.getEndCenter("target");else{var s=a.controlPoints||i.getControlPointsByCenter(a);a.startPoint=i.getLinkPoint("source",t,s),a.endPoint=i.getLinkPoint("target",t,s)}return a.sourceNode=i.get("sourceNode"),a.targetNode=i.get("targetNode"),a},n.prototype.getModel=function(){var t=this.get("model"),r=this.get("source".concat(Ki)),i=this.get("target".concat(Ki));return r?delete t["source".concat(Ki)]:t.source=this.get("start".concat(eu)),i?delete t["target".concat(Ki)]:t.target=this.get("end".concat(eu)),Re(t.source)||nr(t.source)||(t.source=t.source.getID()),Re(t.target)||nr(t.target)||(t.target=t.target.getID()),t},n.prototype.setSource=function(t){this.setEnd("source",t),this.set("source",t)},n.prototype.setTarget=function(t){this.setEnd("target",t),this.set("target",t)},n.prototype.getSource=function(){return this.get("source")},n.prototype.getTarget=function(){return this.get("target")},n.prototype.updatePosition=function(){return!1},n.prototype.update=function(t,r){r===void 0&&(r=void 0);var i=this.get("model"),o=i.visible,a=t.visible;o!==a&&a!==void 0&&this.changeVisibility(a);var s=this.get("source"),u=this.get("target");if(s&&!s.destroyed&&u&&!u.destroyed){var c=this.get("styles");t.stateStyles&&(St(c,t.stateStyles),delete t.stateStyles),Object.assign(i,t),this.updateShape(r),this.afterUpdate(),this.clearCache()}},n.prototype.destroy=function(){var t=this.get("source".concat(Ki)),r=this.get("target".concat(Ki));t&&!t.destroyed&&t.removeEdge(this),r&&!r.destroyed&&r.removeEdge(this),e.prototype.destroy.call(this)},n}(US),Ev="anchorPointsCache",XS=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.getNearestPoint=function(t,r){for(var i=0,o=t[0],a=of(t[0],r),s=0;s<t.length;s++){var u=t[s],c=of(u,r);c<a&&(o=u,a=c,i=s)}return o.anchorIndex=i,o},n.prototype.getDefaultCfg=function(){return{type:"node",edges:[]}},n.prototype.getEdges=function(){return this.get("edges")},n.prototype.getInEdges=function(){var t=this;return this.get("edges").filter(function(r){return r.get("target")===t})},n.prototype.getOutEdges=function(){var t=this;return this.get("edges").filter(function(r){return r.get("source")===t})},n.prototype.getNeighbors=function(t){var r=this,i=this.get("edges");return t==="target"?i.filter(function(o){return o.getSource()===r}).map(function(o){return o.getTarget()}):t==="source"?i.filter(function(o){return o.getTarget()===r}).map(function(o){return o.getSource()}):i.map(function(o){return o.getSource()===r?o.getTarget():o.getSource()})},n.prototype.getLinkPointByAnchor=function(t){return this.getAnchorPoints()[t]},n.prototype.getLinkPoint=function(t){var r,i,o=this.get("keyShape").get("type"),a=this.get("type"),s=this.getBBox();a==="combo"?(r=s.centerX||(s.maxX+s.minX)/2,i=s.centerY||(s.maxY+s.minY)/2):(r=s.centerX,i=s.centerY);var u,c=this.getAnchorPoints();switch(o){case"circle":u=LE({x:r,y:i,r:s.width/2},t);break;case"ellipse":u=RE({x:r,y:i,rx:s.width/2,ry:s.height/2},t);break;default:u=PE(s,t)}var l=u;return c.length&&(l||(l=t),l=this.getNearestPoint(c,l)),l||(l={x:r,y:i}),l},n.prototype.getAnchorPoints=function(){var t=this.get(Ev);if(!t){t=[];var r=this.get("shapeFactory"),i=this.getBBox(),o=this.get("model"),a=this.getShapeCfg(o),s=o.type;ye(r.getAnchorPoints(s,a)||[],function(u,c){var l={x:i.minX+u[0]*i.width,y:i.minY+u[1]*i.height,anchorIndex:c};t.push(l)}),this.set(Ev,t)}return t},n.prototype.addEdge=function(t){this.get("edges").push(t)},n.prototype.lock=function(){this.set("locked",!0)},n.prototype.unlock=function(){this.set("locked",!1)},n.prototype.hasLocked=function(){return this.get("locked")},n.prototype.removeEdge=function(t){var r=this.getEdges(),i=r.indexOf(t);i>-1&&r.splice(i,1)},n.prototype.clearCache=function(){this.set("bboxCache",null),this.set(Ev,null)},n.prototype.getUpdateType=function(t){var r,i,o,a,s;if(t){var u=!yt(t.x),c=!yt(t.y),l=Object.keys(t);return l.length===1&&(u||c)||l.length===2&&u&&c?"move":xt(t.x)||xt(t.y)||t.type||t.anchorPoints||t.size||t!=null&&t.style&&(!((r=t==null?void 0:t.style)===null||r===void 0)&&r.r||!((i=t==null?void 0:t.style)===null||i===void 0)&&i.width||!((o=t==null?void 0:t.style)===null||o===void 0)&&o.height||!((a=t==null?void 0:t.style)===null||a===void 0)&&a.rx||!((s=t==null?void 0:t.style)===null||s===void 0)&&s.ry)?"bbox|label":l.includes("label")||l.includes("labelCfg")?"style|label":"style"}},n.prototype.setState=function(t,r){var i=this;this.optimize?e.prototype.setState.call(this,t,r):this.runWithBBoxAffected(function(){return e.prototype.setState.call(i,t,r)})},n.prototype.clearStates=function(t){var r=this;this.optimize?e.prototype.clearStates.call(this,t):this.runWithBBoxAffected(function(){return e.prototype.clearStates.call(r,t)})},n.prototype.runWithBBoxAffected=function(t){var r=["r","width","height","rx","ry","lineWidth"],i=this.getKeyShape().attr(),o={};Object.keys(this.getKeyShape().attr()).forEach(function(c){r.includes(c)&&(o[c]=i[c])}),t();for(var a=this.getKeyShape().attr(),s=0;s<r.length;s++){var u=r[s];if(a[u]!==o[u]){this.clearCache(),this.getEdges().forEach(function(c){return c.refresh()});break}}},n}(US),YS="bboxCache",WS="bboxCanvasCache",Cf="sizeCache",VS="anchorPointsCache",G6=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.getDefaultCfg=function(){return{type:"combo",nodes:[],edges:[],combos:[]}},n.prototype.getShapeCfg=function(t){var r=this.get("styles"),i=this.get("bbox");if(r&&i){var o=t,a=xt(t.size)?[t.size,t.size]:t.size,s=xt(t.fixSize)?[t.fixSize,t.fixSize]:t.fixSize,u=a||s||bt.defaultCombo.size,c={r:(Math.max(i.width,i.height)||Math.max(u[0],u[1]))/2,width:i.width||u[0],height:i.height||u[1]};o.style=F(F(F({},r),t.style),c);var l=t.padding||bt.defaultCombo.padding;return xt(l)?(c.r+=l,c.width+=2*l,c.height+=2*l):(c.r=c.r+Math.max.apply(Math,l),c.width+=l[1]+l[3]||2*l[1],c.height+=l[0]+l[2]||2*l[0]),this.set(Cf,c),o}return t},n.prototype.calculateCanvasBBox=function(){if(!this.destroyed){var t=this.get("keyShape"),r=this.get("group"),i=this.get(YS)||{},o=i.x,a=i.x,s=this.get(Cf),u=cf(t,r);return u.centerX=(u.minX+u.maxX)/2,u.centerY=(u.minY+u.maxY)/2,s?(s.width=Math.max(s.width,u.width),s.height=Math.max(s.height,u.height),this.set(Cf,s),t.get("type")==="circle"?(u.width=2*s.r,u.height=2*s.r):(u.width=s.width,u.height=s.height),u.minX=u.centerX-u.width/2,u.minY=u.centerY-u.height/2,u.maxX=u.centerX+u.width/2,u.maxY=u.centerY+u.height/2):(u.width=u.maxX-u.minX,u.height=u.maxY-u.minY,u.centerX=(u.minX+u.maxX)/2,u.centerY=(u.minY+u.maxY)/2),u.x=u.minX,u.y=u.minY,u.x===o&&u.y===a||this.set(VS,null),u}},n.prototype.getChildren=function(){return{nodes:this.getNodes(),combos:this.getCombos()}},n.prototype.getNodes=function(){return this.get("nodes")},n.prototype.getCombos=function(){return this.get("combos")},n.prototype.addChild=function(t){switch(t.getType()){case"node":this.addNode(t);break;case"combo":this.addCombo(t);break;default:return!1}return!0},n.prototype.addCombo=function(t){return this.get("combos").push(t),!0},n.prototype.addNode=function(t){return this.get("nodes").push(t),!0},n.prototype.removeChild=function(t){switch(t.getType()){case"node":this.removeNode(t);break;case"combo":this.removeCombo(t);break;default:return!1}return!0},n.prototype.removeCombo=function(t){if(t){var r=this.getCombos(),i=r.indexOf(t);return i>-1&&(r.splice(i,1),!0)}},n.prototype.removeNode=function(t){if(t){var r=this.getNodes(),i=r.indexOf(t);return i>-1&&(r.splice(i,1),!0)}},n.prototype.getUpdateType=function(t){},n.prototype.getBBox=function(){return this.set(WS,null),this.calculateCanvasBBox()},n.prototype.clearCache=function(){this.set(YS,null),this.set(WS,null),this.set(VS,null)},n.prototype.destroy=function(){if(!this.destroyed){var t=this.get("animate"),r=this.get("group");t&&r.stopAnimate(),r.shapeMap={},this.clearCache(),this.set(Cf,null),this.set("bbox",null),r.remove(),this._cfg=null,this.destroyed=!0}},n}(XS),Af="node",If="edge",HS="vedge",Pc="combo",qS="Mapper",vo="stateStyles",U6=function(){function e(n){var t=this;this.edgeToBeUpdateMap={},this.throttleRefresh=dc(function(r){var i=t.graph;if(i&&!i.get("destroyed")){var o=t.edgeToBeUpdateMap;if(o){var a=Object.values(o);a.length&&(a.forEach(function(s){var u=s.edge;if(u&&!u.destroyed){var c=u.getSource(),l=u.getTarget();c&&!c.destroyed&&l&&!l.destroyed&&u.refresh(s.updateType)}}),t.edgeToBeUpdateMap={})}}},16,{trailing:!0,leading:!0}),this.graph=n,this.destroyed=!1}return e.prototype.addItem=function(n,t){var r=this.graph,i=n===HS?If:n,o=r.get("".concat(i,"Group"))||r.get("group"),a=Vs(i),s=null,u=r.get(i+Vs(vo))||{},c=r.get("default"+a);t[vo]&&(u=t[vo]),c&&ye(c,function(E,M){tr(E)&&!Mt(E)?t[M]=fn({},E,t[M]):Mt(E)?t[M]=t[M]||Kt(c[M]):t[M]=t[M]||c[M]});var l=r.get(i+qS);if(l){var h=l(t);h[vo]&&(u=h[vo],delete h[vo]),ye(h,function(E,M){tr(E)&&!Mt(E)?t[M]=fn({},t[M],E):t[M]=h[M]||t[M]})}if(r.emit("beforeadditem",{type:n,model:t}),n===If||n===HS){var f=void 0,d=void 0;if(f=t.source,d=t.target,f&&Re(f)&&(f=r.findById(f)),d&&Re(d)&&(d=r.findById(d)),!f||!d)return;f.getType&&f.getType()==="combo"&&(t.isComboEdge=!0),d.getType&&d.getType()==="combo"&&(t.isComboEdge=!0),s=new F6({model:t,source:f,target:d,styles:u,linkCenter:r.get("linkCenter"),group:o.addGroup()})}else if(n===Af)s=new XS({model:t,styles:u,group:o.addGroup()});else if(n===Pc){var p=t.children,g=lf(p,r),v=void 0,m=void 0;if(isNaN(g.x)?isNaN(t.x)&&(v=100*Math.random()):v=g.x,isNaN(g.y)?isNaN(t.y)&&(m=100*Math.random()):m=g.y,isNaN(t.x)||isNaN(t.y))t.x=v,t.y=m;else{var y=t.x-v,b=t.y-m;this.updateComboSucceeds(t.id,y,b,p)}var x=o.addGroup();x.setZIndex(t.depth),s=new G6({model:t,styles:u,animate:r.get("animate"),bbox:t.collapsed?lf([],r):g,group:x}),t.collapsed||s.getKeyShape().get("type")!=="circle"||(g.width=Math.hypot(g.height,g.width),g.height=g.width,s.set("bbox",g),s.refresh());var w=s.getModel();(p||[]).forEach(function(E){var M=r.findById(E.id);s.addChild(M),E.depth=w.depth+2})}if(s)return s.setOptimize(r.getNodes().length>r.get("optimizeThreshold")),r.get("".concat(n,"s")).push(s),r.get("itemMap")[s.get("id")]=s,r.emit("afteradditem",{item:s,model:t}),s},e.prototype.updateItem=function(n,t){var r,i,o=this,a=this.graph;if(Re(n)&&(n=a.findById(n)),n&&!n.destroyed){var s="";n.getType&&(s=n.getType());var u=a.get(s+qS),c=n.getModel(),l=c.x,h=c.y,f=n.getUpdateType(t);if(u){var d=u(fn({},c,t)),p=fn({},c,d,t);d[vo]&&(n.set("styles",p[vo]),delete p[vo]),ye(p,function(M,_){t[_]=M})}else ye(t,function(M,_){c[_]&&tr(M)&&!Mt(M)&&(t[_]=F(F({},c[_]),t[_]))});if(a.emit("beforeupdateitem",{item:n,cfg:t}),s===If){if(t.source){var g=t.source;Re(g)&&(g=a.findById(g)),n.setSource(g)}if(t.target){var v=t.target;Re(v)&&(v=a.findById(v)),n.setTarget(v)}n.update(t)}else if(s===Af){n.update(t,f);var m=n.getEdges();f==="move"?ye(m,function(M){o.edgeToBeUpdateMap[M.getID()]={edge:M,updateType:f},o.throttleRefresh()}):f!=null&&f.includes("bbox")&&ye(m,function(M){M.refresh(f)})}else if(s===Pc){if(n.update(t,f),!isNaN(t.x)||!isNaN(t.y)){var y=t.x-l||0,b=t.y-h||0;this.updateComboSucceeds(c.id,y,b)}var x=n.getEdges();if((f!=null&&f.includes("bbox")||f==="move")&&s===Pc){var w=n.get("shapeFactory"),E=c.type||"circle";(c.animate===void 0||t.animate===void 0?!((i=(r=w[E])===null||r===void 0?void 0:r.options)===null||i===void 0)&&i.animate:c.animate||t.animate)?setTimeout(function(){if(n&&!n.destroyed){var M=n.getKeyShape();M&&!M.destroyed&&ye(x,function(_){_&&!_.destroyed&&_.refresh()})}},201):ye(x,function(M){M.refresh()})}}n.setOptimize(a.getNodes().length>a.get("optimizeThreshold")),a.emit("afterupdateitem",{item:n,cfg:t})}},e.prototype.updateCombo=function(n,t,r){var i,o,a=this,s=this.graph;if(Re(n)&&(n=s.findById(n)),n&&!n.destroyed){var u=n.getModel(),c=lf(t,s,n),l=c.x,h=c.y;n.set("bbox",c);var f=l,d=h;r?(f=isNaN(u.x)?l:u.x,d=isNaN(u.y)?h:u.y):(f=isNaN(l)?u.x:l,d=isNaN(h)?u.y:h),n.update({x:f,y:d});var p=n.get("shapeFactory"),g=u.type||"circle";(u.animate===void 0?!((o=(i=p[g])===null||i===void 0?void 0:i.options)===null||o===void 0)&&o.animate:u.animate)?setTimeout(function(){if(n&&!n.destroyed){var v=n.getKeyShape();v&&!v.destroyed&&(n.getShapeCfg(u),a.updateComboEdges(n))}},201):this.updateComboEdges(n)}},e.prototype.updateComboEdges=function(n){for(var t,r,i=n.getEdges()||[],o=0;o<i.length;o++){var a=i[o];a!=null&&a.destroyed||!((t=a==null?void 0:a.getSource())===null||t===void 0)&&t.destroyed||!((r=a==null?void 0:a.getTarget())===null||r===void 0)&&r.destroyed||a.refresh()}},e.prototype.collapseCombo=function(n,t){t===void 0&&(t=!0);var r=this.graph;Re(n)&&(n=r.findById(n));var i=n.getChildren();i.nodes.forEach(function(o){r.hideItem(o,t)}),i.combos.forEach(function(o){r.hideItem(o,t)})},e.prototype.updateComboSucceeds=function(n,t,r,i){var o=this;i===void 0&&(i=[]);var a=this.graph;if(t||r){var s=i;if(!(s!=null&&s.length)){var u=a.get("comboTrees");u==null||u.forEach(function(c){dr(c,function(l){return l.id!==n||(s=l.children,!1)})})}s==null||s.forEach(function(c){var l=a.findById(c.id);if(l){var h=l.getModel();o.updateItem(c.id,{x:(h.x||0)+t,y:(h.y||0)+r})}})}},e.prototype.expandCombo=function(n,t){t===void 0&&(t=!0);var r=this.graph;Re(n)&&(n=r.findById(n));var i=n.getChildren(),o=new Set;i.nodes.forEach(function(a){r.showItem(a,t),a.getEdges().forEach(function(s){return o.add(s)})}),i.combos.forEach(function(a){a.getModel().collapsed?a.show():r.showItem(a,t),a.getEdges().forEach(function(s){return o.add(s)})}),o.forEach(function(a){return a.refresh()})},e.prototype.removeItem=function(n){var t=this,r=this.graph;if(Re(n)&&(n=r.findById(n)),n&&!n.destroyed){var i=Kt(n.getModel()),o="";n.getType&&(o=n.getType()),r.emit("beforeremoveitem",{item:i,type:o});var a=r.get("".concat(o,"s")),s=a.indexOf(n);if(s>-1&&a.splice(s,1),o===If){var u=r.get("v".concat(o,"s")),c=u.indexOf(n);c>-1&&u.splice(c,1)}var l=n.get("id");delete r.get("itemMap")[l];var h=r.get("comboTrees"),f=n.get("id");if(o===Af){var d=n.getModel().comboId;if(h&&d){var p=h,g=!1;h.forEach(function(w){g||dr(w,function(E){if(E.id===f&&p){var M=p.indexOf(E);return p.splice(M,1),g=!0,!1}return p=E.children,!0})})}for(var v=(x=n.getEdges()).length-1;v>=0;v--)r.removeItem(x[v],!1);d&&r.updateCombo(d)}else if(o===Pc){var m,y=n.getModel().parentId,b=!1;(h||[]).forEach(function(w){b||dr(w,function(E){return E.id!==f||(m=E,b=!0,!1)})}),m.removed=!0,m&&m.children&&m.children.forEach(function(w){t.removeItem(w.id)});var x;for(v=(x=n.getEdges()).length;v>=0;v--)r.removeItem(x[v],!1);y&&r.updateCombo(y)}n.destroy(),r.emit("afterremoveitem",{item:i,type:o})}},e.prototype.setItemState=function(n,t,r){var i=this.graph,o=t;Re(r)&&(o="".concat(t,":").concat(r)),n.hasState(o)===r&&r||Re(r)&&n.hasState(o)||(i.emit("beforeitemstatechange",{item:n,state:o,enabled:r}),n.setState(t,r),i.autoPaint(),i.emit("afteritemstatechange",{item:n,state:o,enabled:r}))},e.prototype.priorityState=function(n,t){var r=this.graph,i=n;Re(n)&&(i=r.findById(n)),this.setItemState(i,t,!1),this.setItemState(i,t,!0)},e.prototype.clearItemStates=function(n,t){var r=this.graph;Re(n)&&(n=r.findById(n)),r.emit("beforeitemstatesclear",{item:n,states:t}),n.clearStates(t),r.emit("afteritemstatesclear",{item:n,states:t})},e.prototype.refreshItem=function(n){var t=this.graph;Re(n)&&(n=t.findById(n)),t.emit("beforeitemrefresh",{item:n}),n.refresh(),t.emit("afteritemrefresh",{item:n})},e.prototype.addCombos=function(n,t){var r=this,i=this.graph;(n||[]).forEach(function(a){Vi(a,function(s){var u;return t.forEach(function(c){c.id===s.id&&(c.children=s.children,c.depth=s.depth,u=c)}),u&&r.addItem("combo",u),!0})});var o=i.get("comboGroup");o&&o.sort()},e.prototype.changeItemVisibility=function(n,t){var r=this,i=this.graph;if(Re(n)&&(n=i.findById(n)),n){if(i.emit("beforeitemvisibilitychange",{item:n,visible:t}),n.changeVisibility(t),n.getType&&n.getType()===Af)ye(n.getEdges(),function(c){(!t||c.get("source").isVisible()&&c.get("target").isVisible())&&r.changeItemVisibility(c,t)});else if(n.getType&&n.getType()===Pc){var o=i.get("comboTrees"),a=n.get("id"),s=[],u=!1;(o||[]).forEach(function(c){u||c.children&&c.children.length!==0&&dr(c,function(l){return l.id!==a||(s=l.children,u=!0,!1)})}),s&&(!t||t&&!n.getModel().collapsed)&&s.forEach(function(c){var l=i.findById(c.id);r.changeItemVisibility(l,t)}),ye(n.getEdges(),function(c){(!t||c.get("source").isVisible()&&c.get("target").isVisible())&&r.changeItemVisibility(c,t)})}return i.emit("afteritemvisibilitychange",{item:n,visible:t}),n}},e.prototype.destroy=function(){this.graph=null,this.destroyed=!0},e}(),X6=function(){function e(n){this.graph=n,this.destroyed=!1}return e.prototype.updateState=function(n,t,r){var i=this.graph.get("states"),o=t;Re(r)&&(o="".concat(t,":").concat(r)),i[o]||(i[o]=[]),r?i[o].push(n):i[o]=i[o].filter(function(a){return a!==n}),this.graph.set("states",i),this.graph.emit("graphstatechange",{states:i})},e.prototype.updateStates=function(n,t,r){var i=this.graph.get("states");(Re(t)?[t]:t).forEach(function(o){var a=o;i[a]||(i[a]=[]),Re(r)&&(a="".concat(o,":").concat(r)),r?i[a].push(n):i[a]=i[a].filter(function(s){return s!==n})}),this.graph.set("states",i),this.graph.emit("graphstatechange",{states:t})},e.prototype.destroy=function(){this.graph=null,this.destroyed=!0},e}(),Y6=function(e,n){return e&&n?e.replace(/\\?\{([^{}]+)\}/g,function(t,r){if(t.charAt(0)==="\\")return t.slice(1);var i=n[r];return i===0&&(i="0"),i||""}):e},ZS=function(e){var n=[];if(e.length<2)throw new Error("point length must largn than 2, now it's ".concat(e.length));for(var t=0,r=e;t<r.length;t++){var i=r[t],o=i.x,a=i.y;n.push(o),n.push(a)}var s=SS(n);return s.unshift(["M",e[0].x,e[0].y]),s},Tf=function(e,n,t,r){t===void 0&&(t=0),r===void 0&&(r=0);var i={x:(1-t)*e.x+t*n.x,y:(1-t)*e.y+t*n.y},o=[0,0];$o(o,[n.x-e.x,n.y-e.y]),o&&(o[0]||o[1])||(o=[0,0]);var a=[-o[1]*r,o[0]*r];return i.x+=a[0],i.y+=a[1],i},Mv=function(e){var n=[];return e.forEach(function(t){if(t[0]!=="A")for(var r=1;r<t.length;r+=2)n.push([t[r],t[r+1]]);else{var i=t.length;n.push([t[i-2],t[i-1]])}}),n},Sv=function(e){if(e.length<2)throw new Error("point length must larger than 2, now it's ".concat(e.length));var n=e[0],t=e[1],r=e[e.length-1],i=e[e.length-2];e.unshift(r),e.unshift(i),e.push(n),e.push(t);for(var o=[],a=1;a<e.length-2;a+=1){var s=e[a-1].x,u=e[a-1].y,c=e[a].x,l=e[a].y,h=e[a+1].x,f=e[a+1].y,d=c+(h-s)/6,p=l+(f-u)/6,g=h-((a!==e.length-2?e[a+2].x:h)-c)/6,v=f-((a!==e.length-2?e[a+2].y:f)-l)/6;o.push(["C",d,p,g,v,h,f])}return o.unshift(["M",r.x,r.y]),o},KS=function(e,n){return fr([0,0],$o([0,0],e),n)},$S=function(e,n){var t=[e[1]-n[1],n[0]-e[0]],r=Math.sqrt(t[0]*t[0]+t[1]*t[1]);if(r===0)throw new Error("p0 should not be equal to p1");return[t[0]/r,t[1]/r]},QS=function(e,n){return[n[0]-e[0],n[1]-e[1]]};function _v(e,n){if(!e||e.length<1)return"";if(e.length===1)return function(u){var c=[u[0][0],u[0][1]-n],l=[u[0][0],u[0][1]+n];return"M ".concat(c," A ").concat(n,",").concat(n,",0,0,0,").concat(l," A ").concat(n,",").concat(n,",0,0,0,").concat(c)}(e);if(e.length===2)return function(u){var c=fr([0,0],$S(u[0],u[1]),n),l=fr([0,0],c,-1),h=rr([0,0],u[0],c),f=rr([0,0],u[1],c),d=rr([0,0],u[1],l),p=rr([0,0],u[0],l);return"M ".concat(h," L ").concat(f," A ").concat([n,n,"0,0,0",d].join(",")," L ").concat(p," A ").concat([n,n,"0,0,0",h].join(","))}(e);for(var t=new Array(e.length),r=0;r<t.length;++r){var i=r===0?e[e.length-1]:e[r-1],o=e[r],a=fr([0,0],$S(i,o),n);t[r]=[rr([0,0],i,a),rr([0,0],o,a)]}var s="A ".concat([n,n,"0,0,0,"].join(","));return t=t.map(function(u,c){var l="";return c===0&&(l="M ".concat(t[t.length-1][1]," ")),l+="".concat(s+u[0]," L ").concat(u[1])}),t.join(" ")}function JS(e,n){var t,r,i,o=e.length;if(!e||o<1)return"";if(o===1)return r=[(t=e)[0][0],t[0][1]-n],i=[t[0][0],t[0][1]+n],"M ".concat(r," A ").concat([n,n,"0,0,0",i].join(",")," A ").concat([n,n,"0,0,0",r].join(","));if(o===2)return function(c){var l=QS(c[0],c[1]),h=KS(l,n),f=rr([0,0],c[0],fr([0,0],h,-1)),d=rr([0,0],c[1],h),p=1.2*n,g=KS($o([0,0],l),p),v=fr([0,0],g,-1),m=rr([0,0],f,v),y=rr([0,0],d,v),b=rr([0,0],f,g);return"M ".concat(f," C ").concat([m,y,d].join(",")," S ").concat([b,f].join(",")," Z")}(e);for(var a=e.map(function(c,l){var h=e[(l+1)%o];return{p:c,v:$o([0,0],QS(c,h))}}),s=0;s<a.length;++s){var u=$o([0,0],rr([0,0],a[s>0?s-1:o-1].v,fr([0,0],a[s].v,-1)));a[s].p=rr([0,0],a[s].p,fr([0,0],u,n))}return a.map(function(c){var l=c.p;return{x:l[0],y:l[1]}})}const W6=Object.freeze(Object.defineProperty({__proto__:null,getClosedSpline:Sv,getControlPoint:Tf,getSpline:ZS,getStarPath:function(e,n){for(var t=[],r=0;r<5;r++){var i=Math.cos((18+72*r)/180*Math.PI)*e,o=Math.sin((18+72*r)/180*Math.PI)*e,a=Math.cos((54+72*r)/180*Math.PI)*n,s=Math.sin((54+72*r)/180*Math.PI)*n;r===0?t.push(["M",i,-o]):t.push(["L",i,-o]),t.push(["L",a,-s])}return t.push(["Z"]),t},paddedHull:JS,pathToPoints:Mv,pointsToPolygon:function(e,n){var t=e.length;if(!t)return"";for(var r="",i=0;i<t;i++){var o=e[i];r+=Y6(i===0?"M{x} {y}":"L{x} {y}",o)}return n&&(r+="Z"),r},roundedHull:_v},Symbol.toStringTag,{value:"Module"}));var e_=function(e,n,t){return(e.y-t.y)*(n.x-t.x)-(e.x-t.x)*(n.y-t.y)},t_=function(e){var n=e.map(function(c){return{x:c.getModel().x,y:c.getModel().y}});n.sort(function(c,l){return c.x===l.x?c.y-l.y:c.x-l.x});for(var t={},r=n.length-1;r>=0;r--){var i=n[r],o=i.x,a=i.y;t["".concat(o,"-").concat(a)]&&n.splice(r,1),t["".concat(o,"-").concat(a)]=!0}if(n.length===1)return n;var s=[];for(r=0;r<n.length;r++){for(;s.length>=2&&e_(s[s.length-2],s[s.length-1],n[r])<=0;)s.pop();s.push(n[r])}var u=[];for(r=n.length-1;r>=0;r--){for(;u.length>=2&&e_(u[u.length-2],u[u.length-1],n[r])<=0;)u.pop();u.push(n[r])}return u.pop(),s.pop(),s.concat(u)},V6={maxRoutingIterations:100,maxMarchingIterations:100,pixelGroupSize:2,edgeR0:10,edgeR1:10,nodeR0:5,nodeR1:10,morphBuffer:5,threshold:.001,skip:16,nodeInfluenceFactor:1,edgeInfluenceFactor:1,negativeNodeInfluenceFactor:-.5};function H6(e,n,t){var r=!1,i=function(s,u){return n.cells[s+u*n.width]},o=function(s,u){var c=0;return i(s-1,u-1)>=t&&(c+=1),i(s,u-1)>t&&(c+=2),i(s-1,u)>t&&(c+=4),i(s,u)>t&&(c+=8),c},a=function(s,u){for(var c,l,h=s,f=u,d=0;d<n.width*n.height;d++){if(c=h,l=f,e.findIndex(function(p){return p.x===h&&p.y===f})>-1){if(e[0].x===h&&e[0].y===f)return!0}else e.push({x:h,y:f});switch(o(h,f)){case-1:return!0;case 0:case 3:case 2:case 7:h++;break;case 12:case 14:case 4:h--;break;case 6:c===0&&(l===-1?h-=1:h+=1);break;case 1:case 13:case 5:f--;break;case 9:c===1&&(l===0?f-=1:f+=1);break;case 10:case 8:case 11:f++;break;default:return!0}}};this.march=function(){for(var s=0;s<n.width&&!r;s+=1)for(var u=0;u<n.height&&!r;u+=1)i(s,u)>t&&o(s,u)!==15&&(r=a(s,u));return r}}var n_=function(e,n){var t=Number.POSITIVE_INFINITY,r=null;return e.forEach(function(i){var o=P0(i,n);o>=0&&o<t&&(r=i,t=o)}),r};function q6(e,n,t,r,i){var o=function(u,c,l){var h=null,f=Number.POSITIVE_INFINITY;return c.forEach(function(d){var p={x:u.getModel().x,y:u.getModel().y},g={x:d.getModel().x,y:d.getModel().y},v=af(p,g),m=new qa(p.x,p.y,g.x,g.y),y=l.reduce(function(b,x){return P0(x,m)>0?b+1:b},0);v*Math.pow(y+1,2)<f&&(h=d,f=v*Math.pow(y+1,2))}),h}(e,t,n);if(o===null)return[];var a=function(u,c,l,h){var f=[],d=[];d.push(u);for(var p=!0,g=0,v=function(b,x){var w=!1;return x.forEach(function(E){w||(L0(b,{x:E.x1,y:E.y1})||L0(b,{x:E.x2,y:E.y2}))&&(w=!0)}),w},m=function(b,x){for(var w=0,E=x;w<E.length;w++){var M=E[w].getBBox(),_=[[M.x,M.y],[M.x+M.width,M.y],[M.x,M.y+M.height],[M.x+M.width,M.y+M.height]];if(yc(_,b.x,b.y))return!0}return!1};p&&g<l;){p=!1;for(var y=function(){var b=d.pop(),x=n_(c,b);if(x){var w=GE(x,b),E=w[0];if(w[1]===2){var M=function(_){for(var k=h,S=r_(x,k,E,_),C=v(S,d)||v(S,f),T=m(S,c);!C&&T&&k>=1;)S=r_(x,k/=1.5,E,_),C=v(S,d)||v(S,f),T=m(S,c);!S||C||_&&T||(d.push(new qa(b.x1,b.y1,S.x,S.y)),d.push(new qa(S.x,S.y,b.x2,b.y2)),p=!0)};M(!0),p||M(!1)}}p||f.push(b),g+=1};!p&&d.length;)y()}for(;d.length;)f.push(d.pop());return f}(new qa(e.getModel().x,e.getModel().y,o.getModel().x,o.getModel().y),n,r,i),s=function(u){for(var c=[];u.length>0;){var l=u.pop();if(u.length===0){c.push(l);break}var h=u.pop(),f=new qa(l.x1,l.y1,h.x2,h.y2);n_(n,f)?(c.push(l),u.push(h)):u.push(f)}return c}(a);return s}var Z6=function(e,n,t){var r=Object.assign(V6,t),i=UE(e.map(function(w){return{x:w.getModel().x,y:w.getModel().y}}));e=e.sort(function(w,E){return af({x:w.getModel().x,y:w.getModel().y},i)-af({x:E.getModel().x,y:E.getModel().y},i)});var o=[],a=[];e.forEach(function(w){q6(w,n,o,r.maxRoutingIterations,r.morphBuffer).forEach(function(E){a.push(E)}),o.push(w)});for(var s,u,c,l,h,f=function(w,E,M){var _={minX:Number.POSITIVE_INFINITY,minY:Number.POSITIVE_INFINITY,maxX:Number.NEGATIVE_INFINITY,maxY:Number.NEGATIVE_INFINITY,width:0,height:0,x:0,y:0},k=[];w.forEach(function(A){k.push(A.getBBox())}),E.forEach(function(A){k.push(A.getBBox())});for(var S=0,C=k;S<C.length;S++){var T=C[S];_.minX=(T.minX<_.minX?T.minX:_.minX)-M,_.minY=(T.minY<_.minY?T.minY:_.minY)-M,_.maxX=(T.maxX>_.maxX?T.maxX:_.maxX)+M,_.maxY=(T.maxY>_.maxY?T.maxY:_.maxY)+M}return _.width=_.maxX-_.minX,_.height=_.maxY-_.minY,_.x=_.minX,_.y=_.minY,_}(e,a,r.nodeR0),d=(s=f.width,u=f.height,c=r.pixelGroupSize,l=Math.ceil(s/c),h=Math.ceil(u/c),{cells:new Float32Array(Math.max(0,l*h)).fill(0),width:l,height:h}),p=[],g=[],v=0;v<r.maxMarchingIterations;v++)if(K6(e,n,a,f,d,r),g=[],new H6(p=[],d,r.threshold).march()){var m=p.map(function(w){return{x:Math.round(w.x*r.pixelGroupSize+f.minX),y:Math.round(w.y*r.pixelGroupSize+f.minY)}});if(m){var y=m.length;if(r.skip>1)for(y=Math.floor(m.length/r.skip);y<3&&r.skip>1;)r.skip-=1,y=Math.floor(m.length/r.skip);for(var b=0,x=0;x<y;x+=1,b+=r.skip)g.push({x:m[b].x,y:m[b].y})}if(g&&function(){for(var w=0,E=e;w<E.length;w++){var M=E[w],_=g.map(function(k){return[k.x,k.y]});if(!yc(_,M.getBBox().centerX,M.getBBox().centerY))return!1}return!0}())return g;if(r.threshold*=.9,v<=.5*r.maxMarchingIterations)r.memberInfluenceFactor*=1.2,r.edgeInfluenceFactor*=1.2;else{if(!(r.nonMemberInfluenceFactor!==0&&n.length>0))break;r.nonMemberInfluenceFactor*=.8}}return g};function K6(e,n,t,r,i,o){function a(f,d){var p=Math.floor((f-d)/o.pixelGroupSize);return p<0?0:p}function s(f,d){return f*o.pixelGroupSize+d}var u=(o.nodeR0-o.nodeR1)*(o.nodeR0-o.nodeR1),c=(o.edgeR0-o.edgeR1)*(o.edgeR0-o.edgeR1),l=function(f,d){return[Math.min(a(f.minX,d+r.minX),i.width),Math.min(a(f.minY,d+r.minY),i.height),Math.min(a(f.maxX,-d+r.minX),i.width),Math.min(a(f.maxY,-d+r.minY),i.height)]},h=function(f,d){for(var p=f.getBBox(),g=l(p,o.nodeR1),v=g[0],m=g[1],y=g[2],b=g[3],x=m;x<b;x+=1)for(var w=v;w<y;w+=1)if(!(d<0&&i[w+x*i.width]<=0)){var E=s(w,r.minX),M=s(x,r.minY),_=YE({x:E,y:M},{x:p.minX,y:p.minY,width:p.width,height:p.height});if(_<Math.pow(o.nodeR1,2)){var k=Math.sqrt(_)-o.nodeR1;i.cells[w+x*i.width]+=d*k*k}}};o.nodeInfluenceFactor&&e.forEach(function(f){h(f,o.nodeInfluenceFactor/u)}),o.edgeInfluenceFactor&&t.forEach(function(f){(function(d,p){for(var g=d.getBBox(),v=l(g,o.edgeR1),m=v[0],y=v[1],b=v[2],x=v[3],w=y;w<x;w+=1)for(var E=m;E<b;E+=1)if(!(p<0&&i.cells[E+w*i.width]<=0)){var M=s(E,r.minX),_=s(w,r.minY),k=XE({x:M,y:_},d);if(k<Math.pow(o.edgeR1,2)){var S=Math.sqrt(k)-o.edgeR1;i.cells[E+w*i.width]+=p*S*S}}})(f,o.edgeInfluenceFactor/c)}),o.negativeNodeInfluenceFactor&&n.forEach(function(f){h(f,o.negativeNodeInfluenceFactor/u)})}function r_(e,n,t,r){var i=e.getBBox(),o=t[0],a=t[1],s=t[2],u=t[3],c={topLeft:{x:i.minX-n,y:i.minY-n},topRight:{x:i.maxX+n,y:i.minY-n},bottomLeft:{x:i.minX-n,y:i.maxY+n},bottomRight:{x:i.maxX+n,y:i.maxY+n}},l=i.height*i.width;function h(f,d){return i.width*(.5*(f.y-i.minY+(d.y-i.minY)))}if(a)return o?r?c.topLeft:c.bottomRight:s?r?c.bottomLeft:c.topRight:h(a,u)<.5*l?a.y>u.y?r?c.topLeft:c.bottomRight:r?c.topRight:c.bottomLeft:a.y<u.y?r?c.bottomLeft:c.topRight:r?c.bottomRight:c.topLeft;if(u){if(o)return r?c.topRight:c.bottomLeft;if(s)return r?c.bottomRight:c.topLeft}return h(o,s)<.5*l?o.x>s.x?r?c.topLeft:c.bottomRight:r?c.bottomLeft:c.topRight:o.x<s.x?r?c.topRight:c.bottomLeft:r?c.bottomRight:c.topLeft}var $6=function(){function e(n,t){this.cfg=fn(this.getDefaultCfg(),t),this.graph=n,this.id=this.cfg.id,this.group=this.cfg.group,this.members=this.cfg.members.map(function(r){return Re(r)?n.findById(r):r}),this.nonMembers=this.cfg.nonMembers.map(function(r){return Re(r)?n.findById(r):r}),this.setPadding(),this.setType(),this.path=this.calcPath(this.members,this.nonMembers),this.render()}return e.prototype.getDefaultCfg=function(){return{id:"g6-hull",type:"round-convex",members:[],nonMembers:[],style:{fill:"lightblue",stroke:"blue",opacity:.2},padding:10}},e.prototype.setPadding=function(){var n=this.members.length&&this.members[0].getKeyShape().getCanvasBBox().width/2;this.padding=this.cfg.padding>0?this.cfg.padding+n:10+n,this.cfg.bubbleCfg={nodeR0:this.padding-n,nodeR1:this.padding-n,morphBuffer:this.padding-n}},e.prototype.setType=function(){this.type=this.cfg.type,this.members.length<3&&(this.type="round-convex"),this.type!=="round-convex"&&this.type!=="smooth-convex"&&this.type!=="bubble"&&(this.type="round-convex")},e.prototype.calcPath=function(n,t){var r,i,o;switch(this.type){case"round-convex":o=_v((r=t_(n)).map(function(a){return[a.x,a.y]}),this.padding),i=fv(o);break;case"smooth-convex":(r=t_(n)).length===2?(o=_v(r.map(function(a){return[a.x,a.y]}),this.padding),i=fv(o)):r.length>2&&(o=JS(r.map(function(a){return[a.x,a.y]}),this.padding),i=Sv(o));break;case"bubble":i=(r=Z6(n,t,this.cfg.bubbleCfg)).length>=2&&Sv(r)}return i},e.prototype.render=function(){this.group.addShape("path",{attrs:F({path:this.path},this.cfg.style),id:this.id,name:this.cfg.id,capture:!1}),this.group.toBack()},e.prototype.addMember=function(n){if(n){Re(n)&&(n=this.graph.findById(n)),this.members.push(n);var t=this.nonMembers.indexOf(n);return t>-1&&this.nonMembers.splice(t,1),this.updateData(this.members,this.nonMembers),!0}},e.prototype.addNonMember=function(n){if(n){Re(n)&&(n=this.graph.findById(n)),this.nonMembers.push(n);var t=this.members.indexOf(n);return t>-1&&this.members.splice(t,1),this.updateData(this.members,this.nonMembers),!0}},e.prototype.removeMember=function(n){if(n){Re(n)&&(n=this.graph.findById(n));var t=this.members.indexOf(n);return t>-1&&(this.members.splice(t,1),this.updateData(this.members,this.nonMembers),!0)}},e.prototype.removeNonMember=function(n){if(n){Re(n)&&(n=this.graph.findById(n));var t=this.nonMembers.indexOf(n);return t>-1&&(this.nonMembers.splice(t,1),this.updateData(this.members,this.nonMembers),!0)}},e.prototype.updateData=function(n,t){var r=this;this.group.findById(this.id).remove(),n&&(this.members=n.map(function(i){return Re(i)?r.graph.findById(i):i})),t&&(this.nonMembers=t.map(function(i){return Re(i)?r.graph.findById(i):i})),this.path=this.calcPath(this.members,this.nonMembers),this.render()},e.prototype.updateStyle=function(n){this.group.findById(this.id).attr(F({},n))},e.prototype.updateCfg=function(n){var t=this;this.cfg=fn(this.cfg,n),this.id=this.cfg.id,this.group=this.cfg.group,n.members&&(this.members=this.cfg.members.map(function(r){return Re(r)?t.graph.findById(r):r})),n.nonMembers&&(this.nonMembers=this.cfg.nonMembers.map(function(r){return Re(r)?t.graph.findById(r):r})),this.setPadding(),this.setType(),this.path=this.calcPath(this.members,this.nonMembers),this.render()},e.prototype.contain=function(n){var t,r,i=this,o=(t=Re(n)?this.graph.findById(n):n).getKeyShape();if(t.get("type")==="path")r=Mv(o.attr("path"));else{var a=o.getCanvasBBox();r=[[a.minX,a.minY],[a.maxX,a.minY],[a.maxX,a.maxY],[a.minX,a.maxY]]}return r=r.map(function(s){var u=i.graph.getPointByCanvas(s[0],s[1]);return[u.x,u.y]}),FE(r,Mv(this.path))},e.prototype.destroy=function(){this.group.remove(),this.cfg=null},e}(),kv=Qr,Q6=function(e){function n(t){var r=e.call(this)||this;return r.sortCombos=fc(function(){var i=r.get("comboSorted");if(r&&!r.destroyed&&!i){r.set("comboSorted",!0);var o=[],a={};(r.get("comboTrees")||[]).forEach(function(s){dr(s,function(u){return o[u.depth]?o[u.depth].push(u.id):o[u.depth]=[u.id],a[u.id]=u.depth,!0})}),(r.getEdges().concat(r.get("vedges"))||[]).forEach(function(s){var u=s.getModel(),c=a[u.source]||0,l=a[u.target]||0,h=Math.max(c,l);o[h]?o[h].push(u.id):o[h]=[u.id]}),o.forEach(function(s){if(s&&s.length)for(var u=s.length-1;u>=0;u--){var c=r.findById(s[u]);c&&c.toFront()}})}},500,!1),r.cfg=fn(r.getDefaultCfg(),t),r.init(),r.animating=!1,r.destroyed=!1,r.cfg.enabledStack&&(r.undoStack=new Hs(r.cfg.maxStep),r.redoStack=new Hs(r.cfg.maxStep)),r}return Nt(n,e),n.prototype.init=function(){this.initCanvas();var t=new B6(this),r=new M4(this),i=new U6(this),o=new X6(this);this.set({viewController:t,modeController:r,itemController:i,stateController:o}),this.initLayoutController(),this.initEventController(),this.initGroups(),this.initPlugins()},n.prototype.initGroups=function(){var t=this.get("canvas");if(t){var r=(t.get("el")||{}).id,i=r===void 0?"g6":r,o=t.addGroup({id:"".concat(i,"-root"),className:bt.rootContainerClassName});if(this.get("groupByTypes")){var a=o.addGroup({id:"".concat(i,"-edge"),className:bt.edgeContainerClassName}),s=o.addGroup({id:"".concat(i,"-node"),className:bt.nodeContainerClassName}),u=o.addGroup({id:"".concat(i,"-combo"),className:bt.comboContainerClassName});u.toBack(),this.set({nodeGroup:s,edgeGroup:a,comboGroup:u})}var c=o.addGroup({id:"".concat(i,"-delegate"),className:bt.delegateContainerClassName});this.set({delegateGroup:c}),this.set("group",o)}},n.prototype.getDefaultCfg=function(){return{container:void 0,width:void 0,height:void 0,renderer:"canvas",modes:{},plugins:[],data:{},fitViewPadding:10,minZoom:.02,maxZoom:10,event:!0,groupByTypes:!0,directed:!1,autoPaint:!0,nodes:[],edges:[],combos:[],vedges:[],itemMap:{},linkCenter:!1,defaultNode:{},defaultEdge:{},nodeStateStyles:{},edgeStateStyles:{},states:{},animate:!1,animateCfg:{onFrame:void 0,duration:500,easing:"easeLinear"},callback:void 0,enabledStack:!1,maxStep:10,tooltips:[],optimizeThreshold:1e3}},n.prototype.set=function(t,r){return nr(t)?this.cfg=F(F({},this.cfg),t):this.cfg[t]=r,t!=="enabledStack"||!r||this.undoStack||this.redoStack||(this.undoStack=new Hs(this.cfg.maxStep),this.redoStack=new Hs(this.cfg.maxStep)),this},n.prototype.get=function(t){var r;return(r=this.cfg)===null||r===void 0?void 0:r[t]},n.prototype.getGroup=function(){return this.get("group")},n.prototype.getContainer=function(){return this.get("container")},n.prototype.getMinZoom=function(){return this.get("minZoom")},n.prototype.setMinZoom=function(t){return this.set("minZoom",t)},n.prototype.getMaxZoom=function(){return this.get("maxZoom")},n.prototype.setMaxZoom=function(t){return this.set("maxZoom",t)},n.prototype.getWidth=function(){return this.get("width")},n.prototype.getHeight=function(){return this.get("height")},n.prototype.clearItemStates=function(t,r){Re(t)&&(t=this.findById(t));var i=this.get("itemController");r||(r=t.get("states")),i.clearItemStates(t,r),this.get("stateController").updateStates(t,r,!1)},n.prototype.node=function(t){typeof t=="function"&&this.set("nodeMapper",t)},n.prototype.edge=function(t){typeof t=="function"&&this.set("edgeMapper",t)},n.prototype.combo=function(t){typeof t=="function"&&this.set("comboMapper",t)},n.prototype.findById=function(t){return this.get("itemMap")[t]},n.prototype.find=function(t,r){var i;return ye(this.get("".concat(t,"s")),function(o,a){if(r(o,a))return i=o}),i},n.prototype.findAll=function(t,r){var i=[];return ye(this.get("".concat(t,"s")),function(o,a){r(o,a)&&i.push(o)}),i},n.prototype.findAllByState=function(t,r,i){return i?this.findAll(t,function(o){return o.hasState(r)&&i(o)}):this.findAll(t,function(o){return o.hasState(r)})},n.prototype.translate=function(t,r,i,o){var a=this,s=this.get("group"),u=Kt(s.getMatrix());if(u||(u=[1,0,0,0,1,0,0,0,1]),i){var c=bc({animateCfg:o,callback:function(){return a.emit("viewportchange",{action:"translate",matrix:s.getMatrix()})}});N0(s,{x:s.getCanvasBBox().x+t,y:s.getCanvasBBox().y+r},i,c||{duration:500,easing:"easeCubic"})}else u=kv(u,[["t",t,r]]),s.setMatrix(u),this.emit("viewportchange",{action:"translate",matrix:u}),this.autoPaint()},n.prototype.moveTo=function(t,r,i,o){var a=this.get("group");N0(a,{x:t,y:r},i,o||{duration:500,easing:"easeCubic"}),this.emit("viewportchange",{action:"move",matrix:a.getMatrix()})},n.prototype.fitView=function(t,r,i,o){t&&this.set("fitViewPadding",t);var a=this.get("viewController");r?a.fitViewByRules(r,i,o):a.fitView(i,o),this.autoPaint()},n.prototype.fitCenter=function(t,r){this.get("viewController").fitCenter(t,r),this.autoPaint()},n.prototype.addBehaviors=function(t,r){return this.get("modeController").manipulateBehaviors(t,r,!0),this},n.prototype.removeBehaviors=function(t,r){return this.get("modeController").manipulateBehaviors(t,r,!1),this},n.prototype.updateBehavior=function(t,r,i){return this.get("modeController").updateBehavior(t,r,i),this},n.prototype.zoom=function(t,r,i,o){var a=this,s=this.get("group"),u=Kt(s.getMatrix())||[1,0,0,0,1,0,0,0,1],c=this.get("minZoom"),l=this.get("maxZoom"),h=this.getZoom()||1,f=h*t,d=t,p=!1;if(c&&f<c?(d=c/h,p=!0):l&&f>l&&(d=l/h,p=!0),u=kv(u,r?[["t",-r.x,-r.y],["s",d,d],["t",r.x,r.y]]:[["s",d,d]]),i){var g=Kt(s.getMatrix());g||(g=[1,0,0,0,1,0,0,0,1]);var v=g[0],m=v*d,y=bc({animateCfg:o,callback:function(){return a.emit("viewportchange",{action:"zoom",matrix:s.getMatrix()})}});s.animate(function(b){if(b===1)g=u;else{var x=R0(v,m,b)/g[0];g=kv(g,r?[["t",-r.x,-r.y],["s",x,x],["t",r.x,r.y]]:[["s",x,x]])}return{matrix:g}},y)}else s.setMatrix(u),this.emit("viewportchange",{action:"zoom",matrix:u}),this.autoPaint();return!p},n.prototype.zoomTo=function(t,r,i,o){var a=t/this.getZoom();return this.zoom(a,r,i,o)},n.prototype.focusItem=function(t,r,i){var o=this.get("viewController"),a=!1;r?a=!0:r===void 0&&(a=this.get("animate"));var s={};i?s=i:i===void 0&&(s=this.get("animateCfg")),o.focus(t,a,s),this.autoPaint()},n.prototype.focusItems=function(t,r,i,o){this.get("viewController").focusItems(t,r,i,o)},n.prototype.autoPaint=function(){this.get("autoPaint")&&this.paint()},n.prototype.paint=function(){this.emit("beforepaint"),this.get("canvas").draw(),this.emit("afterpaint")},n.prototype.getPointByClient=function(t,r){return this.get("viewController").getPointByClient(t,r)},n.prototype.getClientByPoint=function(t,r){return this.get("viewController").getClientByPoint(t,r)},n.prototype.getPointByCanvas=function(t,r){return this.get("viewController").getPointByCanvas(t,r)},n.prototype.getCanvasByPoint=function(t,r){return this.get("viewController").getCanvasByPoint(t,r)},n.prototype.getGraphCenterPoint=function(){var t=this.get("group").getCanvasBBox();return{x:(t.minX+t.maxX)/2,y:(t.minY+t.maxY)/2}},n.prototype.getViewPortCenterPoint=function(){return this.getPointByCanvas(this.get("width")/2,this.get("height")/2)},n.prototype.showItem=function(t,r){r===void 0&&(r=!0);var i=this.get("itemController").changeItemVisibility(t,!0);if(r&&this.get("enabledStack")){var o=i.getID(),a={},s={};switch(i.getType()){case"node":a.nodes=[{id:o,visible:!1}],s.nodes=[{id:o,visible:!0}];break;case"edge":a.nodes=[{id:o,visible:!1}],s.edges=[{id:o,visible:!0}];break;case"combo":a.nodes=[{id:o,visible:!1}],s.combos=[{id:o,visible:!0}]}this.pushStack("visible",{before:a,after:s})}},n.prototype.hideItem=function(t,r){r===void 0&&(r=!0);var i=this.get("itemController").changeItemVisibility(t,!1);if(r&&this.get("enabledStack")){var o=i.getID(),a={},s={};switch(i.getType()){case"node":a.nodes=[{id:o,visible:!0}],s.nodes=[{id:o,visible:!1}];break;case"edge":a.nodes=[{id:o,visible:!0}],s.edges=[{id:o,visible:!1}];break;case"combo":a.nodes=[{id:o,visible:!0}],s.combos=[{id:o,visible:!1}]}this.pushStack("visible",{before:a,after:s})}},n.prototype.refreshItem=function(t){this.get("itemController").refreshItem(t)},n.prototype.setAutoPaint=function(t){this.set("autoPaint",t),this.get("canvas").set("autoDraw",t)},n.prototype.remove=function(t,r){r===void 0&&(r=!0),this.removeItem(t,r)},n.prototype.removeItem=function(t,r){r===void 0&&(r=!0);var i=t;if(Re(t)&&(i=this.findById(t)),!(!i&&Re(t))){if(i){var o="";if(i.getType&&(o=i.getType()),r&&this.get("enabledStack")){var a=F(F({},i.getModel()),{itemType:o}),s={};switch(o){case"node":s.nodes=[a],s.edges=[];for(var u=i.getEdges(),c=u.length-1;c>=0;c--)s.edges.push(F(F({},u[c].getModel()),{itemType:"edge"}));break;case"edge":s.edges=[a];break;case"combo":s.combos=[a]}this.pushStack("delete",{before:s,after:{}})}if(o==="node"&&i.getModel().comboId&&this.updateComboTree(i,void 0,!1),this.get("itemController").removeItem(i),o==="combo"){var l=G0(this.get("comboTrees"));this.set("comboTrees",l)}}}},n.prototype.innerAddItem=function(t,r,i){if(!function(p,g){if(p==="node"||p==="combo"){if(g.id&&!Re(g.id))return!1}else if(!(p!=="edge"||g.source&&g.target))return!1;return!0}(t,r))return!1;if(!r.id||!this.findById(r.id)){var o,a=this.get("comboTrees")||[];if(t==="combo"){var s=this.get("itemMap"),u=!1;if(a.forEach(function(p){u||Vi(p,function(g){if(r.parentId===g.id){u=!0;var v=F({id:r.id,depth:g.depth+2},r);g.children?g.children.push(v):g.children=[v],r.depth=v.depth,o=i.addItem(t,r)}var m=s[g.id];return u&&m&&m.getType&&m.getType()==="combo"&&i.updateCombo(m,g.children),!0})}),!u){var c=F({id:r.id,depth:0},r);r.depth=c.depth,a.push(c),o=i.addItem(t,r)}this.set("comboTrees",a),r.collapsed&&(this.collapseCombo(o,!1),this.updateCombo(o))}else if(t==="node"&&Re(r.comboId)&&a){var l;(l=this.findById(r.comboId))&&l.getType&&l.getType(),o=i.addItem(t,r);var h=this.get("itemMap"),f=!1,d=!1;a.forEach(function(p){d||f||Vi(p,function(g){if(g.id===r.id)return d=!0,!1;if(r.comboId===g.id&&!d){f=!0;var v=Kt(r);v.itemType="node",g.children?g.children.push(v):g.children=[v],v.depth=g.depth+1}return f&&h[g.id].getType&&h[g.id].getType()==="combo"&&i.updateCombo(h[g.id],g.children),!0})})}else o=i.addItem(t,r);return(t==="node"&&r.comboId||t==="combo"&&r.parentId)&&(l=this.findById(r.comboId||r.parentId))&&l.getType&&l.getType()==="combo"&&l.addChild(o),o}},n.prototype.addItem=function(t,r,i,o){i===void 0&&(i=!0),o===void 0&&(o=!0);var a=this.get("comboSorted");this.set("comboSorted",a&&!o);var s=this.get("itemController"),u=this.innerAddItem(t,r,s);if(u===!1||u===!0)return u;var c=this.get("combos");if(c&&c.length>0&&this.sortCombos(),this.autoPaint(),i&&this.get("enabledStack")){var l=F(F({},u.getModel()),{itemType:t}),h={};switch(t){case"node":h.nodes=[l];break;case"edge":h.edges=[l];break;case"combo":h.combos=[l]}this.pushStack("add",{before:{},after:h})}return u},n.prototype.addItems=function(t,r,i){t===void 0&&(t=[]),r===void 0&&(r=!0),i===void 0&&(i=!0);var o=this.get("comboSorted");this.set("comboSorted",o&&!i);for(var a=this.get("itemController"),s=[],u=0;u<t.length;u++)(c=t[u]).type!=="edge"&&c.type!=="vedge"?s.push(this.innerAddItem(c.type,c.model,a)):s.push(void 0);for(u=0;u<t.length;u++){var c;(c=t[u]).type!=="edge"&&c.type!=="vedge"||(s[u]=this.innerAddItem(c.type,c.model,a))}if(i){var l=this.get("combos");l&&l.length>0&&this.sortCombos()}if(this.autoPaint(),r&&this.get("enabledStack")){var h={nodes:[],edges:[],combos:[]};for(u=0;u<t.length;u++){var f=t[u].type,d=s[u];if(d&&d!==!0){var p=F(F({},d.getModel()),{itemType:f});switch(f){case"node":h.nodes.push(p);break;case"edge":h.edges.push(p);break;case"combo":h.combos.push(p)}}}this.pushStack("addItems",{before:{},after:h})}return s},n.prototype.add=function(t,r,i,o){return i===void 0&&(i=!0),o===void 0&&(o=!0),this.addItem(t,r,i,o)},n.prototype.updateItem=function(t,r,i){var o=this;i===void 0&&(i=!0);var a,s=this.get("itemController");a=Re(t)?this.findById(t):t;var u,c=i&&this.get("enabledStack");c&&(u=Kt(a.getModel()));var l="";a.getType&&(l=a.getType());var h=Br([],a.getStates(),!0);if(l==="combo"&&ye(h,function(g){return o.setItemState(a,g,!1)}),s.updateItem(a,r),l==="combo"&&ye(h,function(g){return o.setItemState(a,g,!0)}),c){var f={nodes:[],edges:[],combos:[]},d={nodes:[],edges:[],combos:[]},p=F({id:u.id},r);switch(l){case"node":f.nodes.push(u),d.nodes.push(p);break;case"edge":f.edges.push(u),d.edges.push(p);break;case"combo":f.combos.push(u),d.combos.push(p)}this.pushStack("update",{before:f,after:d})}},n.prototype.update=function(t,r,i){i===void 0&&(i=!0),this.updateItem(t,r,i)},n.prototype.setItemState=function(t,r,i){Re(t)&&(t=this.findById(t)),this.get("itemController").setItemState(t,r,i),this.get("stateController").updateState(t,r,i)},n.prototype.priorityState=function(t,r){this.get("itemController").priorityState(t,r)},n.prototype.data=function(t){eM(t),this.set("data",t)},n.prototype.render=function(){var t=this;this.set("comboSorted",!1);var r=this.get("data");if(this.get("enabledStack")&&this.clearStack(),!r)throw new Error("data must be defined first");var i=r.nodes,o=i===void 0?[]:i,a=r.edges,s=a===void 0?[]:a,u=r.combos,c=u===void 0?[]:u;if(this.clear(!0),this.emit("beforerender"),t.addItems(o.map(function(p){return{type:"node",model:p}}),!1,!1),(c==null?void 0:c.length)!==0){var l=F0(c,o);this.set("comboTrees",l),t.addCombos(c)}t.addItems(s.map(function(p){return{type:"edge",model:p}}),!1,!1);var h=t.get("animate");(t.get("fitView")||t.get("fitCenter"))&&t.set("animate",!1);var f=t.get("layoutController");if(f){if(f.layout(d),this.destroyed)return}else d();function d(){(t.get("comboTrees")||[]).forEach(function(p){Vi(p,function(g){var v=t.findById(g.id);return v.getType()==="combo"&&g.collapsed&&(t.collapseCombo(g.id,!1),t.updateCombo(v)),!0})}),t.get("fitView")?t.fitView():t.get("fitCenter")&&t.fitCenter(),t.autoPaint(),t.emit("afterrender"),(t.get("fitView")||t.get("fitCenter"))&&t.set("animate",h),setTimeout(function(){var p;(p=t.getCombos())===null||p===void 0||p.forEach(function(g){g.set("animate",!0)})},0)}this.get("groupByTypes")||(c&&c.length!==0?this.sortCombos():r.nodes&&r.edges&&r.nodes.length<r.edges.length?this.getNodes().forEach(function(p){p.toFront()}):this.getEdges().forEach(function(p){p.toBack()}))},n.prototype.read=function(t){this.data(t),this.render()},n.prototype.diffItems=function(t,r,i){var o,a=this,s=this.get("itemMap");ye(i,function(u){if(o=s[u.id]){if(a.get("animate")&&t==="node"){var c=o.getContainer().getMatrix();c||(c=[1,0,0,0,1,0,0,0,1]),o.set("originAttrs",{x:c[6],y:c[7]})}a.updateItem(o,u,!1)}else o=a.addItem(t,u,!1);o&&r["".concat(t,"s")].push(o)})},n.prototype.changeData=function(t,r){var i,o=this;r===void 0&&(r=!0);var a=this,s=t||a.get("data");if(!eM(s))return this;this.emit("beforechangedata"),r&&this.get("enabledStack")&&this.pushStack("changedata",{before:a.save(),after:s}),this.set("comboSorted",!1),this.removeHulls(),this.getNodes().map(function(b){return a.clearItemStates(b)}),this.getEdges().map(function(b){return a.clearItemStates(b)});var u=this.get("canvas"),c=u.get("localRefresh");u.set("localRefresh",!1),a.get("data")||(a.data(s),a.render());var l=this.get("itemMap"),h={nodes:[],edges:[]},f=s.combos;if(f){var d=F0(f,s.nodes);this.set("comboTrees",d)}else this.set("comboTrees",[]);this.diffItems("node",h,s.nodes),ye(l,function(b,x){l[x].getModel().depth=0,b.getType&&b.getType()==="edge"||(b.getType&&b.getType()==="combo"?(delete l[x],b.destroy()):h.nodes.indexOf(b)<0&&(delete l[x],a.remove(b,!1)))});for(var p=this.getCombos(),g=p.length-1;g>=0;g--)p[g].destroyed&&p.splice(g,1);f&&(a.addCombos(f),this.get("groupByTypes")||this.sortCombos()),this.diffItems("edge",h,s.edges),ye(l,function(b,x){(!b.getType||b.getType()!=="node"&&b.getType()!=="combo")&&h.edges.indexOf(b)<0&&(delete l[x],a.remove(b,!1))}),(this.get("comboTrees")||[]).forEach(function(b){Vi(b,function(x){return o.findById(x.id).getType()==="combo"&&x.collapsed&&o.collapseCombo(x.id,!1),!0})}),this.set({nodes:h.nodes,edges:h.edges});var v=(this.get("layout")||{}).relayoutAtChangeData,m=v===void 0||v,y=this.get("layoutController");return m&&y&&(y.changeData(function(){setTimeout(function(){var b;(b=a.getCombos())===null||b===void 0||b.forEach(function(x){x.set("animate",!0)})},0)}),a.get("animate")&&!y.getLayoutType()?(a.positionsAnimate(),(i=a.getCombos())===null||i===void 0||i.forEach(function(b){return b.set("animate",!0)})):a.autoPaint()),setTimeout(function(){u.set("localRefresh",c)},16),this.set("data",s),this.emit("afterchangedata"),this},n.prototype.addCombos=function(t){var r=this.get("comboTrees");this.get("itemController").addCombos(r,t)},n.prototype.createCombo=function(t,r,i){var o=this;i===void 0&&(i=!0);var a=this.get("itemController");this.set("comboSorted",!1);var s,u="";if(t){if(Re(t))u=t,s={id:t};else{if(!(u=t.id))return;s=t}var c=i&&this.get("enabledStack"),l={nodes:[],combos:[]};c&&r.forEach(function(m){var y=o.findById(m),b=y.getType();if(b==="node"||b==="combo"){var x=y.getModel();l["".concat(b,"s")].push({id:m,parentId:b==="node"?x.comboId:x.parentId})}});var h=this.get("comboTrees"),f=new Set(r),d=new Map;h&&(h.forEach(function(m){Vi(m,function(y,b,x){if(f.has(y.id)){if(b){var w=o.findById(b.id),E=o.findById(y.id);b.children.splice(x,1),w.removeChild(E),a.updateCombo(w,b.children)}y.itemType==="combo"&&d.set(y.id,y)}return!0})}),h=h.filter(function(m){return!f.has(m.id)}),this.set("comboTrees",h));var p={nodes:[],combos:[]},g=r.map(function(m){var y=o.findById(m),b=y.getModel(),x="";y.getType&&(x=y.getType());var w=d.get(m)||{id:y.getID(),itemType:x};return x==="combo"?(w.parentId=u,b.parentId=u):x==="node"&&(w.comboId=u,b.comboId=u),c&&p["".concat(x,"s")].push({id:b.id,parentId:u}),w});s.children=g,this.addItem("combo",s,!1),this.set("comboSorted",!1),h&&(h.forEach(function(m){dr(m,function(y){return y.id!==u||(y.itemType="combo",y.children=g,!1)})}),this.sortCombos()),c&&(p.combos.push(s),this.pushStack("createCombo",{before:l,after:p}));var v=this.findById(u);!v.getModel().parentId&&v.getChildren().combos.length&&this.updateComboTree(v,void 0,!1),setTimeout(function(){v.set("animate",!0)},0)}},n.prototype.uncombo=function(t,r){var i,o,a=this;r===void 0&&(r=!0);var s=t;if(Re(t)&&(s=this.findById(t)),s&&(!s.getType||s.getType()==="combo")){var u=s.getModel(),c=s.getModel().parentId,l=this.get("comboTrees");l||(l=[]);var h,f=this.get("itemMap"),d=s.get("id"),p=[],g=this.get("combos"),v=this.findById(c),m=r&&this.get("enabledStack"),y={};if(m&&((y=Kt(u)).children=[]),l.forEach(function(E){h||Vi(E,function(M){var _;if(M.id===d){h=M,s.getEdges().map(function(C){return C.getID()}).forEach(function(C){a.removeItem(C,!1)});var k=g.indexOf(s);g.splice(k,1),delete f[d];var S=Kt(s.getModel());s.destroy(),a.emit("afterremoveitem",{item:S,type:"combo"})}return!c||!h||M.id!==c||(v.removeCombo(s),(k=(p=M.children).indexOf(h))!==-1&&p.splice(k,1),(_=h.children)===null||_===void 0||_.forEach(function(C){var T=a.findById(C.id),A=T.getModel();T.getType&&T.getType()==="combo"?(C.parentId=c,delete C.comboId,A.parentId=c,delete A.comboId):T.getType&&T.getType()==="node"&&(C.comboId=c,A.comboId=c),v.addChild(T),p.push(C)}),a.updateCombo(v),!1)})}),!c&&h){var b=l.indexOf(h);l.splice(b,1),(i=h.children)===null||i===void 0||i.forEach(function(E){E.parentId=void 0;var M=a.findById(E.id).getModel();delete M.parentId,delete M.comboId,E.itemType!=="node"&&l.push(E)})}if(m){var x={nodes:[],combos:[]},w={nodes:[],combos:[]};(o=h.children)===null||o===void 0||o.forEach(function(E){var M=a.findById(E.id).getType();M!=="node"&&M!=="combo"||(x["".concat(M,"s")].push({id:E.id,parentId:d}),w["".concat(M,"s")].push({id:E.id,parentId:c}))}),x.combos.push(y),this.pushStack("uncombo",{before:x,after:w})}}},n.prototype.updateCombos=function(t){var r=this;t===void 0&&(t=!1);var i=this,o=this.get("comboTrees"),a=i.get("itemController"),s=i.get("itemMap");(o||[]).forEach(function(u){Vi(u,function(c){var l;if(!c)return!0;var h=s[c.id];if(((l=h==null?void 0:h.getType)===null||l===void 0?void 0:l.call(h))==="combo"){var f=Br([],h.getStates(),!0);ye(f,function(d){return r.setItemState(h,d,!1)}),a.updateCombo(h,c.children,t),ye(f,function(d){return r.setItemState(h,d,!0)})}return!0})}),i.sortCombos()},n.prototype.updateCombo=function(t){var r,i=this,o=t;if(Re(t)&&(o=this.findById(t)),o&&(!o.getType||o.getType()==="combo")){r=o.get("id");var a=this.get("comboTrees"),s=this.get("itemController"),u=this.get("itemMap");(a||[]).forEach(function(c){Vi(c,function(l){if(!l)return!0;var h=u[l.id];if(r===l.id&&h&&h.getType&&h.getType()==="combo"){var f=Br([],h.getStates(),!0);ye(f,function(d){h.getStateStyle(d)&&i.setItemState(h,d,!1)}),s.updateCombo(h,l.children),ye(f,function(d){h.getStateStyle(d)&&i.setItemState(h,d,!0)}),r&&(r=l.parentId)}return!0})})}},n.prototype.updateComboTree=function(t,r,i){i===void 0&&(i=!0);var o;this.set("comboSorted",!1);var a,s=(o=Re(t)?this.findById(t):t).getModel(),u=s.comboId||s.parentId,c="";if(o.getType&&(c=o.getType()),r&&c==="combo"){var l,h=this.get("comboTrees"),f=!0;if((h||[]).forEach(function(m){l||dr(m,function(y){if(!l)return y.id===o.getID()&&(l=y),!0})}),dr(l,function(m){return m.id!==r||(f=!1,!1)}),!f)return}if(i&&this.get("enabledStack")){var d={},p={};c==="combo"?(d.combos=[{id:s.id,parentId:s.parentId}],p.combos=[{id:s.id,parentId:r}]):c==="node"&&(d.nodes=[{id:s.id,parentId:s.comboId}],p.nodes=[{id:s.id,parentId:r}]),this.pushStack("updateComboTree",{before:d,after:p})}if(s.parentId||s.comboId){var g=this.findById(s.parentId||s.comboId);g&&g.removeChild(o)}c==="combo"?s.parentId=r:c==="node"&&(s.comboId=r),r&&(a=this.findById(r))&&a.addChild(o),u&&(a=this.findById(u))&&a.removeChild(o);var v=G0(this.get("comboTrees"),s.id,r);this.set("comboTrees",v),this.updateCombos()},n.prototype.save=function(){var t=[],r=[],i=[];return ye(this.get("nodes"),function(o){t.push(o.getModel())}),ye(this.get("edges"),function(o){r.push(o.getModel())}),ye(this.get("combos"),function(o){i.push(o.getModel())}),{nodes:t,edges:r,combos:i}},n.prototype.changeSize=function(t,r){return this.get("viewController").changeSize(t,r),this},n.prototype.refresh=function(){var t=this;if(t.emit("beforegraphrefresh"),t.get("animate"))t.positionsAnimate();else{var r=t.get("nodes"),i=t.get("edges"),o=t.get("edges");ye(r,function(a){a.refresh()}),ye(i,function(a){a.refresh()}),ye(o,function(a){a.refresh()})}t.emit("aftergraphrefresh"),t.autoPaint()},n.prototype.getNodes=function(){return this.get("nodes")},n.prototype.getEdges=function(){return this.get("edges")},n.prototype.getCombos=function(){return this.get("combos")},n.prototype.getComboChildren=function(t){if(Re(t)&&(t=this.findById(t)),t&&(!t.getType||t.getType()==="combo"))return t.getChildren()},n.prototype.positionsAnimate=function(t){var r=this;r.emit("beforeanimate");var i=r.get("animateCfg"),o=i.onFrame,a=t?r.getNodes().concat(r.getCombos()):r.getNodes(),s=a.map(function(c){var l=c.getModel();return{id:l.id,x:l.x,y:l.y}});r.stopAnimate();var u=r.get("canvas");r.animating=!0,setTimeout(function(){u.animate(function(c){ye(s,function(l){var h=r.findById(l.id);if(h&&!h.destroyed){var f=h.get("originAttrs"),d=h.get("model"),p=h.getContainer().getMatrix();if(f==null&&(p&&(f={x:p[6],y:p[7]}),h.set("originAttrs",f||0)),o){var g=o(h,c,l,f||{x:0,y:0});h.set("model",Object.assign(d,g))}else f?(d.x=f.x+(l.x-f.x)*c,d.y=f.y+(l.y-f.y)*c):(d.x=l.x,d.y=l.y)}}),r.refreshPositions(t)},{duration:i.duration,easing:i.easing,callback:function(){ye(a,function(c){c.set("originAttrs",null)}),i.callback&&i.callback(),r.emit("afteranimate"),r.animating=!1}})},0)},n.prototype.refreshPositions=function(t){var r=this;r.emit("beforegraphrefreshposition");var i,o=r.get("nodes"),a=r.get("edges"),s=r.get("vedges"),u=r.get("combos"),c={},l=function(h){ye(h,function(f){i=f.getModel();var d=f.get("originAttrs");if(!d||i.x!==d.x||i.y!==d.y){var p=f.updatePosition({x:i.x,y:i.y});c[i.id]=p,i.comboId&&(c[i.comboId]=c[i.comboId]||p),i.parentId&&(c[i.parentId]=c[i.parentId]||p)}})};l(u),l(o),u&&u.length!==0&&(t&&l(u),r.updateCombos()),ye(a,function(h){var f=h.getSource().getModel(),d=h.getTarget();if(!nr(d)){var p=d.getModel();(c[f.id]||c[p.id]||h.getModel().isComboEdge)&&h.refresh()}}),ye(s,function(h){h.refresh()}),r.emit("aftergraphrefreshposition"),r.autoPaint()},n.prototype.stopAnimate=function(){var t=this.get("canvas").cfg.timeline;t&&t.stopAllAnimations()},n.prototype.isAnimating=function(){return this.animating},n.prototype.getZoom=function(){var t=this.get("group").getMatrix();return t?t[0]:1},n.prototype.getCurrentMode=function(){return this.get("modeController").getMode()},n.prototype.setMode=function(t){return this.get("modeController").setMode(t),this},n.prototype.clear=function(t){var r;return t===void 0&&(t=!1),(r=this.get("canvas"))===null||r===void 0||r.clear(),this.initGroups(),this.set({itemMap:{},nodes:[],edges:[],vedges:[],groups:[],combos:[],comboTrees:[]}),t||this.emit("afterrender"),this},n.prototype.updateLayout=function(t,r,i,o){var a=this;t===void 0&&(t={}),o===void 0&&(o=!0);var s=this.get("layoutController");if(Re(t)&&(t={type:t}),r){var u=i;u||(u=r==="begin"?{x:0,y:0}:{x:this.getWidth()/2,y:this.getHeight()/2}),u=this.getPointByCanvas(u.x,u.y);var c=["force","gForce","fruchterman","force2"];c.includes(t.type)||!t.type&&c.includes(s==null?void 0:s.layoutType)?t.center=[u.x,u.y]:this.once("afterlayout",function(f){var d=a.getGroup().getMatrix()||[1,0,0,0,1,0,0,0,1];u.x=u.x*d[0]+d[6],u.y=u.y*d[0]+d[7];var p=a.getGroup().getCanvasBBox(),g=p.minX,v=p.maxX,m=p.minY,y={x:(g+v)/2,y:(m+p.maxY)/2};r==="begin"&&(y.x=g,y.y=m),a.translate(u.x-y.x,u.y-y.y)})}var l=F({},this.get("layout")),h={};Object.assign(h,l,t),t.pipes&&!t.type?delete h.type:!t.pipes&&h.type&&delete h.pipes,this.set("layout",h),s&&(s.isLayoutTypeSame(h)&&h.gpuEnabled===l.gpuEnabled?s.updateLayoutCfg(h):s.changeLayout(h),o&&this.get("enabledStack")&&this.pushStack("layout",{before:l,after:h}))},n.prototype.destroyLayout=function(){var t=this.get("layoutController");t==null||t.destroyLayout()},n.prototype.layout=function(){var t,r=this.get("layoutController"),i=this.get("layout");i&&r&&(i.workerEnabled?r.layout():!((t=r.layoutMethods)===null||t===void 0)&&t.length?r.relayout(!0):r.layout())},n.prototype.collapseCombo=function(t,r){var i=this;if(r===void 0&&(r=!0),!this.destroyed&&(Re(t)&&(t=this.findById(t)),t)){this.emit("beforecollapseexpandcombo",{action:"collapse",item:t});var o=t.getModel();this.get("itemController").collapseCombo(t,r),o.collapsed=!0;var a=this.getEdges().concat(this.get("vedges")),s=[],u=this.get("comboTrees"),c=!1;(u||[]).forEach(function(h){c||dr(h,function(f){if(c&&f.depth<=o.depth)return!1;if(o.id===f.id&&(c=!0),c){var d=i.findById(f.id);d&&d.getType&&d.getType()==="combo"&&(s=(s=s.concat(d.getNodes())).concat(d.getCombos()))}return!0})});var l={};a.forEach(function(h){var f=h.getModel(),d=f.isVEdge,p=f.size,g=p===void 0?1:p;if(!h.isVisible()||d){var v,m=h.getSource(),y=h.getTarget(),b=null;if(m.getModel().id===o.id||s.includes(m)&&!s.includes(y)?(b=y,v=!1):(y.getModel().id===o.id||!s.includes(m)&&s.includes(y))&&(b=m,v=!0),b){if(d)return void i.removeItem(h,!1);for(var x=b.getModel();!b.isVisible();){var w=x.parentId,E=x.comboId,M=w||E;if(!(b=i.findById(M))||!M)return;x=b.getModel()}var _=x.id,k=v?{source:_,target:o.id,size:g,isVEdge:!0}:{source:o.id,target:_,size:g,isVEdge:!0},S="".concat(k.source,"-").concat(k.target);if(l[S])return void(l[S].size+=g);l[S]=k}}}),this.addItems(Object.values(l).map(function(h){return{type:"vedge",model:h}}),!1),this.emit("aftercollapseexpandcombo",{action:"collapse",item:t})}},n.prototype.expandCombo=function(t,r){var i=this;if(r===void 0&&(r=!0),Re(t)&&(t=this.findById(t)),t&&(!t.getType||t.getType()==="combo")){this.emit("beforecollapseexpandcombo",{action:"expand",item:t});var o=t.getModel();this.get("itemController").expandCombo(t,r),o.collapsed=!1;var a=this.getEdges().concat(this.get("vedges")),s=[],u=this.get("comboTrees"),c=!1;(u||[]).forEach(function(h){c||dr(h,function(f){if(c&&f.depth<=o.depth)return!1;if(o.id===f.id&&(c=!0),c){var d=i.findById(f.id);d&&d.getType&&d.getType()==="combo"&&(s=(s=s.concat(d.getNodes())).concat(d.getCombos()))}return!0})});var l={};a.forEach(function(h){if(!h.isVisible()||h.getModel().isVEdge){var f,d=h.getSource(),p=h.getTarget(),g=d.get("id"),v=p.get("id"),m=null;if(g===o.id||s.includes(d)&&!s.includes(p)?(m=p,f=!1):v===o.id||!s.includes(d)&&s.includes(p)?(m=d,f=!0):s.includes(d)&&s.includes(p)&&d.isVisible()&&p.isVisible()&&h.show(),m){var y=h.getModel(),b=y.isVEdge,x=y.size,w=x===void 0?1:x;if(b)return void i.removeItem(h,!1);for(var E=m.getModel();!m.isVisible();){var M=E.parentId,_=E.comboId,k=M||_;if(!(m=i.findById(k))||!k)return;E=m.getModel()}for(var S=E.id,C=f?p:d,T=C.getModel();!C.isVisible();){var A=T.parentId,D=T.comboId,j=A||D;if(!(C=i.findById(j))||!j)return;if(T.comboId===o.id||T.parentId===o.id)break;T=C.getModel()}var L=T.id;if(S){var B=f?{source:S,target:L,isVEdge:!0,size:w}:{source:L,target:S,isVEdge:!0,size:w},N="".concat(B.source,"-").concat(B.target);if(l[N])return void(l[N].size+=w);l[N]=B}}}}),this.addItems(Object.values(l).map(function(h){return{type:"vedge",model:h}}),!1),this.emit("aftercollapseexpandcombo",{action:"expand",item:t})}},n.prototype.collapseExpandCombo=function(t,r){if(r===void 0&&(r=!0),Re(t)&&(t=this.findById(t)),t&&(!t.getType||t.getType()==="combo")){for(var i=t.getModel(),o=this.findById(i.parentId);o;){var a=o.getModel();if(a.collapsed)return void(o=void 0);o=this.findById(a.parentId)}i.collapsed?this.expandCombo(t,r):this.collapseCombo(t,r),this.updateCombo(t)}},n.prototype.getNeighbors=function(t,r){var i=t;return Re(t)&&(i=this.findById(t)),i.getNeighbors(r)},n.prototype.getNodeDegree=function(t,r,i){r===void 0&&(r=void 0),i===void 0&&(i=!1);var o=t;Re(t)&&(o=this.findById(t));var a=this.get("degrees");a&&!i||(a=go(this.save()),this.set("degrees",a));var s=a[o.getID()],u=0;if(!s)return 0;switch(r){case"in":u=s.inDegree;break;case"out":u=s.outDegree;break;case"all":u=s;break;default:u=s.degree}return u},n.prototype.getUndoStack=function(){return this.undoStack},n.prototype.getRedoStack=function(){return this.redoStack},n.prototype.getStackData=function(){return this.get("enabledStack")?{undoStack:this.undoStack.toArray(),redoStack:this.redoStack.toArray()}:null},n.prototype.clearStack=function(){this.get("enabledStack")&&(this.undoStack.clear(),this.redoStack.clear(),this.emit("stackchange",{undoStack:this.undoStack,redoStack:this.redoStack}))},n.prototype.pushStack=function(t,r,i){if(t===void 0&&(t="update"),i===void 0&&(i="undo"),this.get("enabledStack")){var o=r?Kt(r):{before:{},after:Kt(this.save())};i==="redo"?this.redoStack.push({action:t,data:o}):this.undoStack.push({action:t,data:o}),this.emit("stackchange",{action:t,stackType:i,undoStack:this.undoStack,redoStack:this.redoStack})}},n.prototype.getAdjMatrix=function(t,r){t===void 0&&(t=!0),r===void 0&&(r=this.get("directed"));var i=this.get("adjMatrix");return i&&t||(i=Va(this.save(),r),this.set("adjMatrix",i)),i},n.prototype.getShortestPathMatrix=function(t,r){t===void 0&&(t=!0),r===void 0&&(r=this.get("directed"));var i=this.get("adjMatrix"),o=this.get("shortestPathMatrix");return i&&t||(i=Va(this.save(),r),this.set("adjMatrix",i)),o&&t||(o=mc(this.save(),r),this.set("shortestPathMatrix",o)),o},n.prototype.on=function(t,r,i){return e.prototype.on.call(this,t,r,i)},n.prototype.destroy=function(){var t,r,i,o,a;this.emit("beforedestroy"),this.clear(),this.clearStack(),(t=this.get("itemController"))===null||t===void 0||t.destroy(),(r=this.get("modeController"))===null||r===void 0||r.destroy(),(i=this.get("viewController"))===null||i===void 0||i.destroy(),(o=this.get("stateController"))===null||o===void 0||o.destroy(),(a=this.get("canvas"))===null||a===void 0||a.destroy(),this.cfg=null,this.destroyed=!0,this.redoStack=null,this.undoStack=null,this.emit("afterdestroy")},n.prototype.createHull=function(t){if(t.members&&!(t.members.length<1)){var r=this.get("hullGroup"),i=this.get("hullMap");if(i||(i={},this.set("hullMap",i)),r&&!r.get("destroyed")||((r=this.get("group").addGroup({id:"hullGroup"})).toBack(),this.set("hullGroup",r)),i[t.id])return i[t.id];var o=r.addGroup({id:"".concat(t.id,"-container")}),a=new $6(this,F(F({},t),{group:o}));return i[a.id]=a,a}},n.prototype.getHulls=function(){return this.get("hullMap")},n.prototype.getHullById=function(t){return this.get("hullMap")[t]},n.prototype.removeHull=function(t){var r,i;i=Re(t)?this.getHullById(t):t,(r=this.get("hullMap"))===null||r===void 0||delete r[i.id],i.destroy()},n.prototype.removeHulls=function(){var t=this.getHulls();t&&Object.keys(t).length&&(Object.keys(t).forEach(function(r){t[r].destroy()}),this.set("hullMap",{}))},n}(zw);function Cv(e){return Cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Cv(e)}var Lc=Qr,i_="-shape",Av="-label",Of=["startArrow","endArrow"],o_={lineWidth:1,stroke:void 0,fill:void 0,lineAppendWidth:1,opacity:void 0,strokeOpacity:void 0,fillOpacity:void 0,x:0,y:0,r:10,width:20,height:20,shadowColor:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0},Nf={edge:{lineWidth:1,stroke:"#000",lineDash:void 0,startArrow:!1,endArrow:!1,opacity:void 0,strokeOpacity:void 0,fillOpacity:void 0,shadowColor:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0},node:o_,combo:o_},Iv="-label-bg",Tv={options:{labelCfg:{style:{fontFamily:bt.windowFontFamily}},descriptionCfg:{style:{fontFamily:bt.windowFontFamily}}},itemType:"",type:"",getCustomConfig:function(e){return{}},getOptions:function(e,n){return n==="move"||n!=null&&n.includes("bbox")?e:fn({},this.options,this.getCustomConfig(e)||{},e)},draw:function(e,n){n.shapeMap={},this.mergeStyle=this.getOptions(e);var t=this.drawShape(e,n);if(t.set("className",this.itemType+i_),n.shapeMap[this.itemType+i_]=t,e.label){var r=this.drawLabel(e,n);r.set("className",this.itemType+Av),n.shapeMap[this.itemType+Av]=r}return t},afterDraw:function(e,n,t){},drawShape:function(e,n){return null},drawLabel:function(e,n){var t=(this.mergeStyle||this.getOptions(e)||{}).labelCfg||{},r=this.getLabelStyle(e,t,n),i=r.rotate;delete r.rotate;var o=n.addShape("text",{attrs:r,draggable:!0,className:"text-shape",name:"text-shape",labelRelated:!0});if(n.shapeMap["text-shape"]=o,!isNaN(i)&&i!==""){var a=o.getBBox(),s=[1,0,0,0,1,0,0,0,1];if(r.rotateCenter)switch(r.rotateCenter){case"center":default:s=Lc(s,[["t",-a.width/2,-a.height/2],["r",i],["t",a.width/2,a.height/2]]);break;case"lefttop":s=Lc(s,[["t",-r.x,-r.y],["r",i],["t",r.x,r.y]]);break;case"leftcenter":s=Lc(s,[["t",-r.x,-r.y-a.height/2],["r",i],["t",r.x,r.y+a.height/2]])}else s=Lc(s,[["t",-r.x,-r.y-a.height/2],["r",i],["t",r.x,r.y+a.height/2]]);o.setMatrix(s)}if(r.background){var u=this.drawLabelBg(e,n,o),c=this.itemType+Iv;u.set("classname",c),n.shapeMap[c]=u,o.toFront()}return o},drawLabelBg:function(e,n,t){var r=St({},this.options.labelCfg,e.labelCfg),i=this.getLabelBgStyleByPosition(t,r),o=n.addShape("rect",{name:"text-bg-shape",attrs:i,labelRelated:!0});return n.shapeMap["text-bg-shape"]=o,o},getLabelStyleByPosition:function(e,n,t){return{text:e.label}},getLabelBgStyleByPosition:function(e,n){return{}},getLabelStyle:function(e,n,t){var r=this.getLabelStyleByPosition(e,n,t),i="".concat(this.itemType,"Label"),o=bt[i]?bt[i].style:null;return F(F(F({},o),r),n.style)},getShapeStyle:function(e){return e.style},update:function(e,n,t){this.updateShapeStyle(e,n,t),this.updateLabel(e,n,t)},updateShapeStyle:function(e,n,t){var r,i=n.getContainer(),o=n.getKeyShape(),a=St({},o.attr(),e.style),s=function(c){var l,h=a[c];if(nr(h)){var f=((r=i.shapeMap)===null||r===void 0?void 0:r[c])||i.find(function(d){return d.get("name")===c});f==null||f.attr(h)}else o.attr(((l={})[c]=h,l))};for(var u in a)s(u)},updateLabel:function(e,n,t){var r,i,o=n.getContainer(),a=(this.mergeStyle||this.getOptions({},t)||{}).labelCfg,s=a===void 0?{}:a,u=this.itemType+Av,c=o.shapeMap[u]||o.find(function(b){return b.get("className")===u}),l=this.itemType+Iv,h=o.shapeMap[l]||o.find(function(b){return b.get("className")===l});if(c&&e.label===void 0&&(o.removeChild(c),delete o.shapeMap[u],h&&(o.removeChild(h),delete o.shapeMap[l])),e.label||e.label==="")if(c){(!t||t==="bbox|label"||this.itemType==="edge"&&t!=="style")&&(s=fn(s,e.labelCfg));var f=this.getLabelStyleByPosition(e,s,o),d=(r=e.labelCfg)===null||r===void 0?void 0:r.style,p=F(F({},f),d),g=p.rotate;if(delete p.rotate,isNaN(g)||g==="")((i=c.getMatrix())===null||i===void 0?void 0:i[4])!==1&&c.resetMatrix(),c.attr(p);else{var v=[1,0,0,0,1,0,0,0,1];v=Lc(v,[["t",-p.x,-p.y],["r",g],["t",p.x,p.y]]),p.matrix=v,c.attr(p)}if(h)if(p.background){var m=this.getLabelBgStyleByPosition(c,s);h.attr(m)}else o.removeChild(h);else p.background&&((h=this.drawLabelBg(e,o,c)).set("classname",l),o.shapeMap[l]=h,c.toFront())}else{var y=this.drawLabel(e,o);y.set("className",u),o.shapeMap[u]=y}},afterUpdate:function(e,n){},setState:function(e,n,t){var r,i,o,a=t.get("keyShape");if(a&&!a.destroyed){var s=t.getType(),u=hc(n)?e:"".concat(e,":").concat(n),c=this.getStateStyle(u,t),l=t.getStateStyle(u);if(l||c){var h=St({},l||c),f=t.getContainer(),d={x:1,y:1,cx:1,cy:1,matrix:1};if(s==="combo"&&(d.r=1,d.width=1,d.height=1),n){var p=function(A){var D,j=h[A];if(nr(j)&&!Of.includes(A)){var L=((o=f.shapeMap)===null||o===void 0?void 0:o[A])||f.find(function(B){return B.get("name")===A});L==null||L.attr(j)}else a.attr(((D={})[A]=j,D))};for(var g in h)p(g)}else{var v=hf(t.getCurrentStatesStyle()),m=St({},t.getModel().style,hf(t.getOriginStyle())),y=a.get("name"),b=a.attr(),x={};Object.keys(b).forEach(function(A){if(A!=="img"){var D=b[A];D&&Cv(D)==="object"?x[A]=Kt(D):x[A]=D}});var w={},E=function(A){var D=h[A];if(nr(D)&&!Of.includes(A)){var j=f.shapeMap[A]||f.find(function(N){return N.get("name")===A});if(j){var L=hf(j.attr());ye(D,function(N,R){if(A===y&&x[R]&&!d[R]){delete x[R];var P=m[A][R]||Nf[s][R];a.attr(R,P)}else if(L[R]||L[R]===0){delete L[R];var H=m[A][R]||Nf[s][R];j.attr(R,H)}}),w[A]=L}}else if(x[A]&&!d[A]){delete x[A];var B=m[A]||(m[y]?m[y][A]:void 0)||Nf[s][A];a.attr(A,B)}};for(var M in h)E(M);for(var g in y?w[y]=x:St(w,x),v)if(!d[g]){var _=v[g];nr(_)&&!Of.includes(g)||(y?(St(m[y],((i={})[g]=_,i)),delete m[g]):St(m,((r={})[g]=_,r)),delete v[g])}var k={};fn(k,m,w,v);var S=!1,C=function(A){var D,j,L=k[A];if(nr(L)&&!Of.includes(A)){var B=f.shapeMap[A]||f.find(function(R){return R.get("name")===A});B&&((B.get("type")==="text"||B.get("labelRelated"))&&(delete L.x,delete L.y,delete L.matrix),A===y&&(s==="combo"&&(delete L.r,delete L.width,delete L.height),S=!0),B.attr(L))}else if(!S){var N=L||Nf[s][A];s==="combo"?y||a.attr(((D={})[A]=N,D)):a.attr(((j={})[A]=N,j))}};for(var T in k)C(T)}}}},getStateStyle:function(e,n){var t=n.getModel(),r=n.getType(),i=this.getOptions(t),o=i.stateStyles,a=i.style,s=a===void 0?{}:a,u=t.stateStyles?t.stateStyles[e]:o&&o[e];return r==="combo"?Kt(u):St({},s,u)},getControlPoints:function(e){return e.controlPoints},getAnchorPoints:function(e){var n,t;return(e==null?void 0:e.anchorPoints)||((n=this.getCustomConfig(e))===null||n===void 0?void 0:n.anchorPoints)||((t=this.options)===null||t===void 0?void 0:t.anchorPoints)}},J6={itemType:"node",shapeType:"single-node",labelPosition:"center",offset:bt.nodeLabel.offset,getSize:function(e){var n,t=((n=this.mergeStyle)===null||n===void 0?void 0:n.size)||e.size||this.getOptions({}).size||bt.defaultNode.size;return Mt(t)&&t.length===1&&(t=[t[0],t[0]]),Mt(t)||(t=[t,t]),t},getLabelStyleByPosition:function(e,n){var t=n.maxLength,r=e.label;t&&(r=JE(r,t));var i=n.position||this.labelPosition;if(i==="center")return{x:0,y:0,text:r,textBaseline:"middle",textAlign:"center"};var o=n.offset;yt(o)&&(o=this.offset);var a,s=this.getSize(e);switch(i){case"top":a={x:0,y:-s[1]/2-o,textBaseline:"bottom",textAlign:"center"};break;case"bottom":a={x:0,y:s[1]/2+o,textBaseline:"top",textAlign:"center"};break;case"left":a={x:-s[0]/2-o,y:0,textBaseline:"middle",textAlign:"right"};break;default:a={x:s[0]/2+o,y:0,textBaseline:"middle",textAlign:"left"}}return a.text=r,a},getLabelBgStyleByPosition:function(e,n){var t;if(!e)return{};var r=(t=n.style)===null||t===void 0?void 0:t.background;if(!r)return{};var i=e.getBBox(),o=vv(r.padding),a=i.width+o[1]+o[3],s=i.height+o[0]+o[2];return F(F({x:i.minX-o[3],y:i.minY-o[0]},r),{width:a,height:s})},drawShape:function(e,n){var t=this.shapeType,r=this.getShapeStyle(e),i=n.addShape(t,{attrs:r,draggable:!0,name:"node-shape"});return n.shapeMap["node-shape"]=i,i},updateLinkPoints:function(e,n){var t,r=(this.mergeStyle||this.getOptions(e)).linkPoints,i=n.shapeMap["link-point-left"]||n.find(function(S){return S.get("className")==="link-point-left"}),o=n.shapeMap["link-point-right"]||n.find(function(S){return S.get("className")==="link-point-right"}),a=n.shapeMap["link-point-top"]||n.find(function(S){return S.get("className")==="link-point-top"}),s=n.shapeMap["link-point-bottom"]||n.find(function(S){return S.get("className")==="link-point-bottom"});i&&(t=i.attr()),o&&!t&&(t=o.attr()),a&&!t&&(t=a.attr()),s&&!t&&(t=s.attr()),t||(t=r);var u=St({},t,e.linkPoints),c=u.fill,l=u.stroke,h=u.lineWidth,f=u.size/2;f||(f=u.r);var d=e.linkPoints?e.linkPoints:{left:void 0,right:void 0,top:void 0,bottom:void 0},p=d.left,g=d.right,v=d.top,m=d.bottom,y=this.getSize(e),b=y[0],x=y[1],w={r:f,fill:c,stroke:l,lineWidth:h};if(i)p||p===void 0?i.attr(F(F({},w),{x:-b/2,y:0})):(i.remove(),delete n.shapeMap["link-point-left"]);else if(p){var E="link-point-left";n.shapeMap[E]=n.addShape("circle",{attrs:F(F({},w),{x:-b/2,y:0}),className:E,name:E,isAnchorPoint:!0})}if(o)g||g===void 0||(o.remove(),delete n.shapeMap["link-point-right"]),o.attr(F(F({},w),{x:b/2,y:0}));else if(g){var M="link-point-right";n.shapeMap[M]=n.addShape("circle",{attrs:F(F({},w),{x:b/2,y:0}),className:M,name:M,isAnchorPoint:!0})}if(a)v||v===void 0||(a.remove(),delete n.shapeMap["link-point-top"]),a.attr(F(F({},w),{x:0,y:-x/2}));else if(v){var _="link-point-top";n.shapeMap[_]=n.addShape("circle",{attrs:F(F({},w),{x:0,y:-x/2}),className:_,name:_,isAnchorPoint:!0})}if(s)m||m===void 0?s.attr(F(F({},w),{x:0,y:x/2})):(s.remove(),delete n.shapeMap["link-point-bottom"]);else if(m){var k="link-point-bottom";n.shapeMap[k]=n.addShape("circle",{attrs:F(F({},w),{x:0,y:x/2}),className:k,name:k,isAnchorPoint:!0})}},updateShape:function(e,n,t,r,i){n.get("keyShape").attr(F({},t)),this.updateLabel(e,n,i),r&&this.updateIcon(e,n)},updateIcon:function(e,n){var t=this,r=n.getContainer(),i=(this.mergeStyle||this.getOptions(e)).icon,o=e.icon?e.icon:{show:void 0,text:void 0},a=o.show,s=o.text,u=r.shapeMap["".concat(this.type,"-icon")]||r.find(function(v){return v.get("name")==="".concat(t.type,"-icon")});if(u)if(a||a===void 0){var c=St({},u.attr(),i),l=c.width,h=l===void 0?20:l,f=c.height,d=f===void 0?20:f;(c.fontFamily==="iconfont"||c.hasOwnProperty("text"))&&(h=0,d=0),u.attr(F(F({},c),{x:-h/2,y:-d/2}))}else u.remove(),delete r.shapeMap["".concat(this.type,"-icon")];else if(a){var p="".concat(this.type,"-icon");s?r.shapeMap[p]=r.addShape("text",{attrs:F({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},i),className:p,name:p}):(h=i.width,d=i.height,r.shapeMap[p]=r.addShape("image",{attrs:F(F({},i),{x:-h/2,y:-d/2}),className:p,name:p}));var g=r.shapeMap["node-label"]||r.find(function(v){return v.get("name")==="node-label"});g&&g.toFront()}}},eR=F(F({},Tv),J6);dn.registerNode("single-node",eR);var Df="edge-shape",tR={itemType:"edge",labelPosition:"center",refX:0,refY:0,labelAutoRotate:!1,options:{size:bt.defaultEdge.size,style:{x:0,y:0,stroke:bt.defaultEdge.style.stroke,lineAppendWidth:bt.defaultEdge.style.lineAppendWidth},labelCfg:{style:{fill:bt.edgeLabel.style.fill,fontSize:bt.edgeLabel.style.fontSize,fontFamily:bt.windowFontFamily}},stateStyles:F({},bt.edgeStateStyles)},getPath:function(e){var n=[];return ye(e,function(t,r){r===0?n.push(["M",t.x,t.y]):n.push(["L",t.x,t.y])}),n},getShapeStyle:function(e){var n=St({},this.options.style,{stroke:e.color},e.style),t=e.size||bt.defaultEdge.size,r=(e=this.getPathPoints(e)).startPoint,i=e.endPoint,o=this.getControlPoints(e),a=[r];o&&(a=a.concat(o)),a.push(i);var s=this.getPath(a);return St({},bt.defaultEdge.style,{stroke:bt.defaultEdge.color,lineWidth:t,path:s},n)},updateShapeStyle:function(e,n,t){var r,i=n.getContainer(),o=((r=n.getKeyShape)===null||r===void 0?void 0:r.call(n))||i.shapeMap["edge-shape"],a=e.size,s=(e=this.getPathPoints(e)).startPoint,u=e.endPoint,c=this.getControlPoints(e),l=[s];c&&(l=l.concat(c)),l.push(u);var h=o.attr(),f=e.style||{};f.stroke===void 0&&(f.stroke=e.color);var d=e.sourceNode,p=e.targetNode,g={radius:f.radius};c||(g={source:d,target:p,offset:f.offset,radius:f.radius});var v=this.getPath(l,g),m={};t==="move"?m={path:v}:(h.endArrow&&f.endArrow===!1&&(e.style.endArrow={path:""}),h.startArrow&&f.startArrow===!1&&(e.style.startArrow={path:""}),(m=F({},e.style)).lineWidth===void 0&&(m.lineWidth=(xt(a)?a:a==null?void 0:a[0])||h.lineWidth),m.path===void 0&&(m.path=v),m.stroke===void 0&&(m.stroke=h.stroke||e.color)),o&&o.attr(m)},getLabelStyleByPosition:function(e,n,t){var r,i=n.position||this.labelPosition,o={},a=t==null?void 0:t.shapeMap[Df];r=i==="start"?0:i==="end"?1:.5;var s,u=n.refX||this.refX,c=n.refY||this.refY;if(e.startPoint.x===e.endPoint.x&&e.startPoint.y===e.endPoint.y)return o.x=e.startPoint.x+u,o.y=e.startPoint.y+c,o.text=e.label,o;s=yt(n.autoRotate)?this.labelAutoRotate:n.autoRotate;var l=KE(a,r,u,c,s);return o.x=l.x,o.y=l.y,o.rotate=l.rotate,o.textAlign=this._getTextAlign(i,l.angle),o.text=e.label,o},getLabelBgStyleByPosition:function(e,n){if(!e)return{};var t=e.getBBox(),r=n.style&&n.style.background;if(!r)return{};var i=r.padding,o=t.width+i[1]+i[3],a=t.height+i[0]+i[2],s=F(F({},r),{width:o,height:a,x:t.minX-i[3],y:t.minY-i[0],matrix:[1,0,0,0,1,0,0,0,1]});return(yt(n.autoRotate)?this.labelAutoRotate:n.autoRotate)&&(s.matrix=e.attr("matrix")||[1,0,0,0,1,0,0,0,1]),s},_getTextAlign:function(e,n){var t="center";return n?(n%=2*Math.PI,e!=="center"&&(t=n>=0&&n<=Math.PI/2||n>=1.5*Math.PI&&n<2*Math.PI?e:function(r){var i=r;return r==="start"?i="end":r==="end"&&(i="start"),i}(e)),t):e},getControlPoints:function(e){return e.controlPoints},getPathPoints:function(e){return e},drawShape:function(e,n){var t=this.getShapeStyle(e),r=n.addShape("path",{className:Df,name:Df,attrs:t});return n.shapeMap[Df]=r,r},drawLabel:function(e,n){var t=this.options.labelCfg,r=fn({},t,e.labelCfg),i=this.getLabelStyle(e,r,n),o=i.rotate;delete i.rotate;var a=n.addShape("text",{attrs:i,name:"text-shape",labelRelated:!0,draggable:!0});if(n.shapeMap["text-shape"]=a,isNaN(o)||o===""||a.rotateAtStart(o),i.background){var s=this.drawLabelBg(e,n,a,i,o),u=this.itemType+Iv;s.set("classname",u),n.shapeMap[u]=s,a.toFront()}return a},drawLabelBg:function(e,n,t,r,i){var o=this.options.labelCfg,a=fn({},o,e.labelCfg),s=this.getLabelBgStyleByPosition(t,a),u=n.addShape("rect",{name:"text-bg-shape",attrs:s,labelRelated:!0});return n.shapeMap["text-bg-shape"]=u,u}},nR=F(F({},Tv),tR);dn.registerEdge("single-edge",nR),dn.registerEdge("line",{getControlPoints:function(){}},"single-edge"),dn.registerEdge("spline",{getPath:function(e){return ZS(e)}},"single-edge"),dn.registerEdge("arc",{curveOffset:20,clockwise:1,getControlPoints:function(e){var n,t,r=e.startPoint,i=e.endPoint,o=(r.x+i.x)/2,a=(r.y+i.y)/2;if(e.controlPoints!==void 0){if(t=e.controlPoints[0],n=O0(r,t,i),r.x<=i.x&&r.y>i.y?this.clockwise=n.x>t.x?0:1:r.x<=i.x&&r.y<i.y?this.clockwise=n.x>t.x?1:0:r.x>i.x&&r.y<=i.y?this.clockwise=n.y<t.y?0:1:this.clockwise=n.y<t.y?1:0,(t.x-r.x)/(t.y-r.y)==(i.x-r.x)/(i.y-r.y))return[]}else{e.curveOffset===void 0&&(e.curveOffset=this.curveOffset),Mt(e.curveOffset)&&(e.curveOffset=e.curveOffset[0]),e.curveOffset<0?this.clockwise=0:this.clockwise=1;var s={x:i.x-r.x,y:i.y-r.y},u=Math.atan2(s.y,s.x);t={x:e.curveOffset*Math.cos(-Math.PI/2+u)+o,y:e.curveOffset*Math.sin(-Math.PI/2+u)+a},n=O0(r,t,i)}var c=of(r,n);return[{x:c,y:c}]},getPath:function(e){var n=[];return n.push(["M",e[0].x,e[0].y]),e.length===2?n.push(["L",e[1].x,e[1].y]):n.push(["A",e[1].x,e[1].y,0,0,this.clockwise,e[2].x,e[2].y]),n}},"single-edge"),dn.registerEdge("quadratic",{curvePosition:.5,curveOffset:-20,getControlPoints:function(e){var n=e.controlPoints;if(!n||!n.length){var t=e.startPoint,r=e.endPoint;e.curveOffset===void 0&&(e.curveOffset=this.curveOffset),e.curvePosition===void 0&&(e.curvePosition=this.curvePosition),Mt(e.curveOffset)&&(e.curveOffset=e.curveOffset[0]),Mt(e.curvePosition)&&(e.curvePosition=e.curveOffset[0]),n=[Tf(t,r,e.curvePosition,e.curveOffset)]}return n},getPath:function(e){var n=[];return n.push(["M",e[0].x,e[0].y]),n.push(["Q",e[1].x,e[1].y,e[2].x,e[2].y]),n}},"single-edge"),dn.registerEdge("cubic",{curvePosition:[.5,.5],curveOffset:[-20,20],getControlPoints:function(e){var n=e.controlPoints;if(e.curveOffset===void 0&&(e.curveOffset=this.curveOffset),e.curvePosition===void 0&&(e.curvePosition=this.curvePosition),xt(e.curveOffset)&&(e.curveOffset=[e.curveOffset,-e.curveOffset]),xt(e.curvePosition)&&(e.curvePosition=[e.curvePosition,1-e.curvePosition]),!n||!n.length||n.length<2){var t=e.startPoint,r=e.endPoint;n=[Tf(t,r,e.curvePosition[0],e.curveOffset[0]),Tf(t,r,e.curvePosition[1],e.curveOffset[1])]}return n},getPath:function(e){var n=[];return n.push(["M",e[0].x,e[0].y]),n.push(["C",e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y]),n}},"single-edge"),dn.registerEdge("cubic-vertical",{curvePosition:[.5,.5],minCurveOffset:[0,0],curveOffset:void 0,getControlPoints:function(e){var n=e.startPoint,t=e.endPoint;e.curvePosition===void 0&&(e.curvePosition=this.curvePosition),e.curveOffset===void 0&&(e.curveOffset=this.curveOffset),e.minCurveOffset===void 0&&(e.minCurveOffset=this.minCurveOffset),xt(e.curveOffset)&&(e.curveOffset=[e.curveOffset,-e.curveOffset]),xt(e.minCurveOffset)&&(e.minCurveOffset=[e.minCurveOffset,-e.minCurveOffset]),xt(e.curvePosition)&&(e.curvePosition=[e.curvePosition,1-e.curvePosition]);var r=t.y-n.y,i=[0,0];return e.curveOffset?i=e.curveOffset:Math.abs(r)<Math.abs(e.minCurveOffset[0])&&(i=e.minCurveOffset),[{x:n.x,y:n.y+r*this.curvePosition[0]+i[0]},{x:t.x,y:t.y-r*this.curvePosition[1]+i[1]}]}},"cubic"),dn.registerEdge("cubic-horizontal",{curvePosition:[.5,.5],minCurveOffset:[0,0],curveOffset:void 0,getControlPoints:function(e){var n=e.startPoint,t=e.endPoint;e.curvePosition===void 0&&(e.curvePosition=this.curvePosition),e.curveOffset===void 0&&(e.curveOffset=this.curveOffset),e.minCurveOffset===void 0&&(e.minCurveOffset=this.minCurveOffset),xt(e.curveOffset)&&(e.curveOffset=[e.curveOffset,-e.curveOffset]),xt(e.minCurveOffset)&&(e.minCurveOffset=[e.minCurveOffset,-e.minCurveOffset]),xt(e.curvePosition)&&(e.curvePosition=[e.curvePosition,1-e.curvePosition]);var r=t.x-n.x,i=[0,0];return e.curveOffset?i=e.curveOffset:Math.abs(r)<Math.abs(e.minCurveOffset[0])&&(i=e.minCurveOffset),[{x:n.x+r*this.curvePosition[0]+i[0],y:n.y},{x:t.x-r*this.curvePosition[1]+i[1],y:t.y}]}},"cubic"),dn.registerEdge("loop",{getPathPoints:function(e){return ZE(e)},getControlPoints:function(e){return e.controlPoints},afterDraw:function(e){e.controlPoints=void 0},afterUpdate:function(e){e.controlPoints=void 0}},"cubic");var rR={itemType:"combo",shapeType:"single-combo",labelPosition:"top",refX:bt.comboLabel.refX,refY:bt.comboLabel.refY,options:{style:{stroke:bt.defaultCombo.style.stroke,fill:bt.defaultCombo.style.fill,lineWidth:bt.defaultCombo.style.lineWidth},labelCfg:{style:{fill:bt.comboLabel.style.fill,fontSize:bt.comboLabel.style.fontSize,fontFamily:bt.windowFontFamily}},stateStyles:F({},bt.comboStateStyles),collapsedSubstituteIcon:{show:!1,img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*RsnHRqLfJn4AAAAAAAAAAAAAARQnAQ"}},getSize:function(e){var n=Kt(e.size||this.options.size||bt.defaultCombo.size);return Mt(n)&&n.length===1&&(n=[n[0],n[0]]),Mt(n)||(n=[n,n]),n},getLabelStyleByPosition:function(e,n){var t=n.position||this.labelPosition,r=e.style,i=e.padding||this.options.padding;Mt(i)&&(i=Math.max.apply(Math,i));var o=n.refX,a=n.refY;yt(o)&&(o=this.refX),yt(a)&&(a=this.refY);var s,u=this.getSize(e),c=(Math.max(r.r,u[0]/2)||u[0]/2)+i;switch(t){case"top":s={x:0,y:-c-a,textBaseline:"bottom",textAlign:"center"};break;case"bottom":s={x:0,y:c+a,textBaseline:"bottom",textAlign:"center"};break;case"left":s={x:-c+o,y:0,textAlign:"left"};break;case"center":s={x:0,y:0,text:e.label,textAlign:"center"};break;default:s={x:c+o,y:0,textAlign:"right"}}return s.text=e.label,s},drawShape:function(e,n){var t=this.shapeType,r=this.getShapeStyle(e);return n.addShape(t,{attrs:r,draggable:!0,name:"combo-shape"})},updateCollapsedIcon:function(e,n,t){var r=e.collapsed,i=e.collapsedSubstituteIcon,o=i===void 0?{}:i,a=Object.assign({},this.options.collapsedSubstituteIcon,o),s=a.show,u=a.img,c=a.width,l=a.height,h=n.getContainer(),f=h.find(function(v){return v.get("name")==="combo-collapsed-substitute-icon"}),d=f&&!f.destroyed,p=n.get("keyShape");if(r&&s){if(d)f.show();else{var g={width:c||2*t.r||t.width,height:l||2*t.r||t.height};f=h.addShape("image",{attrs:F({img:u,x:-g.width/2,y:-g.height/2},g),name:"combo-collapsed-substitute-icon",draggable:!0})}p.hide()}else d&&(f.hide(),p.show())},updateShape:function(e,n,t){var r=this,i=n.get("keyShape");n.get("animate")&&(e.animate===void 0?this.options.animate:e.animate)&&i.animate?(e.collapsed||this.updateCollapsedIcon(e,n,t),i.animate(t,{duration:200,easing:"easeLinear",callback:function(){e.collapsed&&r.updateCollapsedIcon(e,n,t)}})):(i.attr(F({},t)),this.updateCollapsedIcon(e,n,t)),this.updateLabel(e,n)}},iR=F(F({},Tv),rR);dn.registerCombo("single-combo",iR),dn.registerCombo("circle",{options:{size:[bt.defaultCombo.size[0],bt.defaultCombo.size[0]],padding:Math.max.apply(Math,bt.defaultCombo.padding),animate:!0,style:{stroke:bt.defaultCombo.style.stroke,fill:bt.defaultCombo.style.fill,lineWidth:bt.defaultCombo.style.lineWidth},labelCfg:{style:{fill:bt.comboLabel.style.fill,fontSize:bt.comboLabel.style.fontSize},refX:0,refY:0},stateStyles:F({},bt.comboStateStyles),collapsedSubstituteIcon:{show:!1,img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*RsnHRqLfJn4AAAAAAAAAAAAAARQnAQ"}},shapeType:"circle",labelPosition:"top",drawShape:function(e,n){var t=this.getShapeStyle(e);return delete t.height,delete t.width,n.addShape("circle",{attrs:t,className:"circle-combo",name:"circle-combo",draggable:!0})},getShapeStyle:function(e){var n=this.options.style,t=e.padding||this.options.padding;Mt(t)&&(t=Math.max.apply(Math,t));var r,i=St({},n,{stroke:e.color},e.style),o=e.collapsed&&e.fixCollapseSize?e.fixCollapseSize:e.fixSize;if(o)r=xt(o)?o/2:o[0]/2;else{var a=this.getSize(e);r=!xt(i.r)||isNaN(i.r)?a[0]/2||bt.defaultCombo.style.r:Math.max(i.r,a[0]/2)||a[0]/2}i.r=r+t;var s=F({x:0,y:0},i);return e.style?e.style.r=r:e.style={r},s},update:function(e,n){var t=this.getSize(e),r=e.padding||this.options.padding;Mt(r)&&(r=Math.max.apply(Math,r));var i,o=Kt(e.style),a=e.collapsed&&e.fixCollapseSize?e.fixCollapseSize:e.fixSize;i=a?xt(a)?a/2:a[0]/2:Math.max(o.r,t[0]/2)||t[0]/2,o.r=i+r;var s=n.get("sizeCache");s&&(s.r=o.r);var u={stroke:e.color},c=St({},n.get("keyShape").attr(),u,o);e.style?e.style.r=i:e.style={r:i},this.updateShape(e,n,c,!0)}},"single-combo"),dn.registerCombo("rect",{options:{size:[40,5],padding:[25,20,15,20],animate:!0,style:{radius:0,stroke:bt.defaultCombo.style.stroke,fill:bt.defaultCombo.style.fill,lineWidth:bt.defaultCombo.style.lineWidth},labelCfg:{style:{fill:bt.comboLabel.style.fill,fontSize:bt.comboLabel.style.fontSize,fontFamily:bt.windowFontFamily}},anchorPoints:[[0,.5],[1,.5]],stateStyles:F({},bt.comboStateStyles),collapsedSubstituteIcon:{show:!1,img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*RsnHRqLfJn4AAAAAAAAAAAAAARQnAQ"}},shapeType:"rect",labelPosition:"top",drawShape:function(e,n){var t=this.getShapeStyle(e);return n.addShape("rect",{attrs:t,className:"rect-combo",name:"rect-combo",draggable:!0})},getLabelStyleByPosition:function(e,n){var t=n.position||this.labelPosition,r=e.style,i=e.padding||this.options.padding;xt(i)&&(i=[i,i,i,i]);var o=n.refX,a=n.refY;yt(o)&&(o=this.refX),yt(a)&&(a=this.refY);var s,u=-r.width/2-i[3],c=r.width/2+i[1],l=-r.height/2-i[0],h=r.height/2+i[2];switch(t){case"top":s={x:u+o,y:l+a,textBaseline:"top",textAlign:"left"};break;case"bottom":s={x:0,y:h+a,textBaseline:"top",textAlign:"center"};break;case"left":s={x:u+a,y:0,textAlign:"left"};break;case"center":s={x:0,y:0,text:e.label,textAlign:"center"};break;case"top-center":s={x:0,y:l+a,textBaseline:"top",textAlign:"center"};break;default:s={x:c+o,y:0,textAlign:"right"}}return s.text=e.label,s},getShapeStyle:function(e){var n=this.options.style,t=e.padding||this.options.padding;xt(t)&&(t=[t,t,t,t]);var r,i,o=St({},n,{stroke:e.color},e.style),a=this.getSize(e),s=e.collapsed&&e.fixCollapseSize?e.fixCollapseSize:e.fixSize;s?xt(s)?(r=s,i=s):(r=s[0],i=s[1]):(r=!xt(o.width)||isNaN(o.width)?a[0]||bt.defaultCombo.style.width:Math.max(o.width,a[0])||a[0],i=!xt(o.height)||isNaN(o.height)?a[1]||bt.defaultCombo.style.height:Math.max(o.height,a[1])||a[1]);var u=-r/2-t[3],c=-i/2-t[0];o.width=r+t[1]+t[3],o.height=i+t[0]+t[2];var l=F({x:u,y:c},o);return e.style?(e.style.width=r,e.style.height=i):e.style={width:r,height:i},l},update:function(e,n){var t=this.getSize(e),r=e.padding||this.options.padding;xt(r)&&(r=[r,r,r,r]);var i,o,a=Kt(e.style),s=e.collapsed&&e.fixCollapseSize?e.fixCollapseSize:e.fixSize;s?xt(s)?(i=s,o=s):(i=s[0],o=s[1]):(i=Math.max(a.width,t[0])||t[0],o=Math.max(a.height,t[1])||t[1]),a.width=i+r[1]+r[3],a.height=o+r[0]+r[2];var u=n.get("sizeCache");u&&(u.width=a.width,u.height=a.height),a.x=-i/2-r[3],a.y=-o/2-r[0];var c={stroke:e.color},l=St({},n.get("keyShape").attr(),c,a);e.style?(e.style.width=i,e.style.height=o):e.style={width:i,height:o},this.updateShape(e,n,l,!1)}},"single-combo"),dn.registerNode("simple-circle",{options:{size:bt.defaultNode.size,style:{x:0,y:0,stroke:bt.defaultNode.style.stroke,fill:bt.defaultNode.style.fill,lineWidth:bt.defaultNode.style.lineWidth},labelCfg:{style:{fill:bt.nodeLabel.style.fill,fontSize:bt.nodeLabel.style.fontSize,fontFamily:bt.windowFontFamily}},stateStyles:F({},bt.nodeStateStyles)},shapeType:"simple-circle",labelPosition:"center",shapeMap:{},drawShape:function(e,n){var t=this.getShapeStyle(e),r="".concat(this.type,"-keyShape"),i=n.addShape("circle",{attrs:t,className:"".concat(this.type,"-keyShape"),name:r,draggable:!0});return n.shapeMap[r]=i,i},getShapeStyle:function(e){var n=(this.mergeStyle||this.getOptions(e)).style,t={stroke:e.color},r=fn({},n,t),i=this.getSize(e)[0]/2;return F({x:0,y:0,r:i},r)},update:function(e,n,t){var r=this.getSize(e),i={stroke:e.color,r:r[0]/2},o=n.get("keyShape"),a=fn({},o.attr(),i,e.style);this.updateShape(e,n,a,!0,t)}},"single-node"),dn.registerNode("simple-rect",{options:{size:[100,30],style:{radius:0,stroke:bt.defaultNode.style.stroke,fill:bt.defaultNode.style.fill,lineWidth:bt.defaultNode.style.lineWidth},labelCfg:{style:{fill:bt.nodeLabel.style.fill,fontSize:bt.nodeLabel.style.fontSize,fontFamily:bt.windowFontFamily}},anchorPoints:[[0,.5],[1,.5]],stateStyles:F({},bt.nodeStateStyles)},shapeType:"simple-rect",labelPosition:"center",drawShape:function(e,n){var t=this.getShapeStyle(e);return n.addShape("rect",{attrs:t,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0})},getShapeStyle:function(e){var n=St({},(this.mergeStyle||this.getOptions(e)).style,{stroke:e.color}),t=this.getSize(e),r=n.width||t[0],i=n.height||t[1];return F({x:-r/2,y:-i/2,width:r,height:i},n)},update:function(e,n,t){n.getContainer();var r=(this.mergeStyle||this.getOptions(e)).style,i=this.getSize(e),o=n.get("keyShape");e.size||(i[0]=o.attr("width")||r.width,i[1]=o.attr("height")||r.height);var a={stroke:e.color,x:-i[0]/2,y:-i[1]/2,width:i[0],height:i[1]},s=St({},r,o.attr(),a);s=St(s,e.style),this.updateShape(e,n,s,!1,t)}},"single-node"),dn.registerNode("image",{options:{img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*eD7nT6tmYgAAAAAAAAAAAABkARQnAQ",size:200,labelCfg:{style:{fontFamily:bt.windowFontFamily}},clipCfg:{show:!1,type:"circle",r:50,rx:50,ry:35,width:50,height:35,points:[[30,12],[12,30],[30,48],[48,30]],path:[["M",25,25],["L",50,25],["A",12.5,12.5,0,1,1,50,50],["A",12.5,12.5,0,1,0,50,50],["L",25,75],["Z"]],x:0,y:0}},shapeType:"image",labelPosition:"bottom",drawShape:function(e,n){var t=this.shapeType,r=this.getShapeStyle(e);delete r.fill;var i=n.addShape(t,{attrs:r,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});return this.drawClip(e,i),i},drawClip:function(e,n){var t=(this.mergeStyle||this.getOptions(e)).clipCfg;if(t.show){var r=t.type,i=t.x,o=t.y,a=t.style;if(r==="circle"){var s=t.r;n.setClip({type:"circle",attrs:F({r:s,x:i,y:o},a)})}else if(r==="rect"){var u=t.width,c=t.height,l=i-u/2,h=o-c/2;n.setClip({type:"rect",attrs:F({x:l,y:h,width:u,height:c},a)})}else if(r==="ellipse"){var f=t.rx,d=t.ry;n.setClip({type:"ellipse",attrs:F({x:i,y:o,rx:f,ry:d},a)})}else if(r==="polygon"){var p=t.points;n.setClip({type:"polygon",attrs:F({points:p},a)})}else if(r==="path"){var g=t.path;n.setClip({type:"path",attrs:F({path:g},a)})}}},getShapeStyle:function(e){var n=this.mergeStyle||this.getOptions(e),t=n.style,r=n.img,i=this.getSize(e),o=i[0],a=i[1];return t&&(o=t.width||i[0],a=t.height||i[1]),F({x:-o/2,y:-a/2,width:o,height:a,img:r},t)},updateShapeStyle:function(e,n){var t=n.getContainer(),r="".concat(this.itemType,"-shape"),i=t.shapeMap[r]||t.find(function(a){return a.get("className")===r})||n.getKeyShape(),o=this.getShapeStyle(e);i&&!i.destroyed&&i.attr(o)}},"single-node");const oR={collapse:function(e,n,t){return[["M",e-t,n],["a",t,t,0,1,0,2*t,0],["a",t,t,0,1,0,2*-t,0],["M",e-t+4,n],["L",e+t-4,n]]},expand:function(e,n,t){return[["M",e-t,n],["a",t,t,0,1,0,2*t,0],["a",t,t,0,1,0,2*-t,0],["M",e-t+4,n],["L",e-t+2*t-4,n],["M",e-t+t,n-t+4],["L",e,n+t-4]]},upTriangle:function(e,n,t){var r=t*Math.cos(Math.PI/6),i=t*Math.sin(Math.PI/6);return[["M",e-r,n+i],["L",e+r,n+i],["L",e,n-t],["Z"]]},downTriangle:function(e,n,t){var r=t*Math.cos(Math.PI/6),i=t*Math.sin(Math.PI/6);return[["M",e-r,n-i],["L",e+r,n-i],["L",e,n+t],["Z"]]}},aR=Object.freeze(Object.defineProperty({__proto__:null,defaultSubjectColors:["#5F95FF","#61DDAA","#65789B","#F6BD16","#7262FD","#78D3F8","#9661BC","#F6903D","#008685","#F08BB4"]},Symbol.toStringTag,{value:"Module"}));var a_=function(e){return e==="force"||e==="g6force"||e==="gForce"||e==="force2"};const sR=Object.freeze(Object.defineProperty({__proto__:null,isForce:a_},Symbol.toStringTag,{value:"Module"}));var uR=Qr,gr=F(F(F(F(F(F(F({},L6),E4),W6),y4),aR),sR),{transform:uR,mat3:Vw}),cR=function(){function e(n){this.graph=n,this.layoutCfg=n.get("layout")||{},this.layoutType=this.getLayoutType(),this.layoutMethods=[],this.initLayout()}return e.prototype.initLayout=function(){},e.prototype.getLayoutType=function(){return this.getLayoutCfgType(this.layoutCfg)},e.prototype.getLayoutCfgType=function(n){var t=n.type;if(t)return t;var r=n.pipes;return Array.isArray(r)?r.map(function(i){return(i==null?void 0:i.type)||""}):null},e.prototype.isLayoutTypeSame=function(n){var t=this.getLayoutCfgType(n),r=Array.isArray(this.layoutType),i=Array.isArray(t);return r&&i?this.layoutType.every(function(o,a){return o===t[a]}):!Array.isArray(t)&&!Array.isArray(this.layoutType)&&(n==null?void 0:n.type)===this.layoutType},e.prototype.refreshLayout=function(){var n=this,t=n.graph,r=n.layoutType,i=n.layoutCfg;if(t){var o=(i===void 0?{}:i).animate,a=o===void 0&&(r==="force"||r==="force2"),s=a_(r)&&(o||a);t.get("animate")&&!s?t.positionsAnimate(r==="comboCombined"):t.refreshPositions(r==="comboCombined")}},e.prototype.changeLayout=function(n){var t=n.disableTriggerLayout,r=Yn(n,["disableTriggerLayout"]);this.layoutCfg=r,this.layoutType=r.type||this.layoutType,t||this.layout()},e.prototype.changeData=function(n){this.layout(n)},e.prototype.destoryLayoutMethods=function(){var n=this.layoutMethods,t=[];return n==null||n.forEach(function(r){var i,o=(i=r.getType)===null||i===void 0?void 0:i.call(r);o&&t.push(o),r.destroy()}),this.layoutMethods=[],t},e.prototype.destroyLayout=function(){this.destoryLayoutMethods();var n=this.graph;n&&!n.get("destroyed")&&n.set("layout",void 0),this.layoutCfg=void 0,this.layoutType=void 0,this.layoutMethods=void 0},e.prototype.setDataFromGraph=function(){for(var n,t=[],r=[],i=[],o=[],a=[],s=[],u=[],c=this.graph.getNodes(),l=this.graph.getEdges(),h=this.graph.getCombos(),f=c.length,d=0;d<f;d++){var p=c[d];if(p&&!p.destroyed){var g=p.getModel();p.isVisible()?t.push(g):r.push(g)}}var v=l.length;for(d=0;d<v;d++){var m=l[d];m&&!m.destroyed&&(g=m.getModel(),m.isVisible()?g.isComboEdge?a.push(g):i.push(g):o.push(g))}var y=h.length;for(d=0;d<y;d++){var b=h[d];b.destroyed||(g=b.getModel(),b.isVisible()?s.push(g):u.push(g))}return{nodes:t,hiddenNodes:r,edges:i,hiddenEdges:o,combos:s,hiddenCombos:u,comboEdges:a,vedges:(n=this.graph.get("vedges"))===null||n===void 0?void 0:n.map(function(x){return x.getModel()})}},e.prototype.relayout=function(n){var t=this,r=this,i=r.graph,o=r.layoutMethods,a=r.layoutCfg;if(i&&!i.get("destroyed")){var s=Promise.resolve();if(n){this.data=this.setDataFromGraph();var u=this.data.nodes;if(!u)return!1;s=this.initPositions(a.center,u)}i.emit("beforelayout"),o==null||o.forEach(function(c,l){var h=a[l]||a;s=s.then(function(){var f,d=t.execLayoutMethod(h,l);return l===o.length-1&&((f=a.onAllLayoutEnd)===null||f===void 0||f.call(a)),d})})}},e.prototype.filterLayoutData=function(n,t){var r,i,o=n.nodes,a=n.edges,s=Yn(n,["nodes","edges"]);if(!o)return n;r=mn(t==null?void 0:t.nodesFilter)?t.nodesFilter:function(){return!0};var u=o.filter(r);if(mn(t==null?void 0:t.edgesFilter))i=t.edgesFilter;else{var c=u.reduce(function(l,h){return l[h.id]=!0,l},{});i=function(l){return c[l.source]&&c[l.target]}}return F({nodes:u,edges:a.filter(i)},s)},e.prototype.getLayoutBBox=function(n){var t=Bh(this.graph.getNodes(),function(i){return i.getModel().layoutOrder}),r=Object.values(t).map(function(i){var o=TS(i);return o.size=[o.width,o.height],o});return{groupNodes:Object.values(Bh(n,"layoutOrder")),layoutNodes:r}},e.prototype.layoutAnimate=function(){},e.prototype.moveToZero=function(){var n=this.graph.get("data").nodes;if(n[0].x!==void 0&&n[0].x!==null&&!Zi(n[0].x)){for(var t=[0,0],r=n.length,i=0;i<r;i++){var o=n[i];t[0]+=o.x,t[1]+=o.y}for(t[0]/=n.length,t[1]/=n.length,i=0;i<r;i++)(o=n[i]).x-=t[0],o.y-=t[1]}},e.prototype.initPositions=function(n,t){var r;return Rr(this,void 0,void 0,function(){var i,o,a;return jr(this,function(s){return i=this.graph,t!=null&&t.length?(o=t.filter(function(u){return Zi(u.x)||Zi(u.y)}),(a=o?o.length:0)?[2,(r=this.initWithPreset)===null||r===void 0?void 0:r.call(this,function(){},function(){var u=.85*i.get("width"),c=.85*i.get("height"),l=Math.ceil(Math.sqrt(a)*(u/c)),h=u/(l-1),f=c/(Math.ceil(a/l)-1);isFinite(h)&&h||(h=0),isFinite(f)&&h||(f=0);for(var d=n[0]-u/2,p=n[1]-c/2,g=0;g<a;g++){var v=o[g];Zi(+v.x)&&(v.x=g%l*h+d),Zi(+v.y)&&(v.y=Math.floor(g/l)*f+p)}})]:[2]):[2,Promise.resolve()]})})},e.prototype.destroy=function(){this.graph=null,this.destoryLayoutMethods(),this.destroyed=!0},e}(),lR=function(e){this.graph=e,this.destroyed=!1,this.initEvents()},mo=dn.registerNode,s_=dn.registerEdge,hR=dn.registerCombo,u_=n0.registerBehavior,it=bt;dn.registerNode,dn.registerEdge,dn.registerCombo,n0.registerBehavior;var Ov={},tn={},Pf={},ia={};Object.defineProperty(ia,"__esModule",{value:!0}),ia.MESSAGE=ia.ALGORITHM=void 0,ia.ALGORITHM={pageRank:"pageRank",breadthFirstSearch:"breadthFirstSearch",connectedComponent:"connectedComponent",depthFirstSearch:"depthFirstSearch",detectCycle:"detectCycle",detectDirectedCycle:"detectDirectedCycle",detectAllCycles:"detectAllCycles",detectAllDirectedCycle:"detectAllDirectedCycle",detectAllUndirectedCycle:"detectAllUndirectedCycle",dijkstra:"dijkstra",findAllPath:"findAllPath",findShortestPath:"findShortestPath",floydWarshall:"floydWarshall",getAdjMatrix:"getAdjMatrix",getDegree:"getDegree",getInDegree:"getInDegree",getNeighbors:"getNeighbors",getOutDegree:"getOutDegree",labelPropagation:"labelPropagation",louvain:"louvain",GADDI:"GADDI",minimumSpanningTree:"minimumSpanningTree",SUCCESS:"SUCCESS",FAILURE:"FAILURE"},ia.MESSAGE={SUCCESS:"SUCCESS",FAILURE:"FAILURE"};var Lf={},c_={},Ja={};Object.defineProperty(Ja,"__esModule",{value:!0}),Ja.default=void 0;var fR=function(e,n){var t=e.nodes,r=e.edges,i=[],o={};if(!t)throw new Error("invalid nodes data!");return t&&t.forEach(function(a,s){o[a.id]=s,i.push([])}),r&&r.forEach(function(a){var s=a.source,u=a.target,c=o[s],l=o[u];!c&&c!==0||!l&&l!==0||(i[c][l]=1,n||(i[l][c]=1))}),i};Ja.default=fR;var Rf={},jf={},tu={};Object.defineProperty(tu,"__esModule",{value:!0}),tu.default=tu.LinkedListNode=void 0;var dR=function(e,n){return e===n},Nv=function(){function e(n,t){t===void 0&&(t=null),this.value=n,this.next=t}return e.prototype.toString=function(n){return n?n(this.value):"".concat(this.value)},e}();tu.LinkedListNode=Nv;var pR=function(){function e(n){n===void 0&&(n=dR),this.head=null,this.tail=null,this.compare=n}return e.prototype.prepend=function(n){var t=new Nv(n,this.head);return this.head=t,this.tail||(this.tail=t),this},e.prototype.append=function(n){var t=new Nv(n);return this.head?(this.tail.next=t,this.tail=t,this):(this.head=t,this.tail=t,this)},e.prototype.delete=function(n){if(!this.head)return null;for(var t=null;this.head&&this.compare(this.head.value,n);)t=this.head,this.head=this.head.next;var r=this.head;if(r!==null)for(;r.next;)this.compare(r.next.value,n)?(t=r.next,r.next=r.next.next):r=r.next;return this.compare(this.tail.value,n)&&(this.tail=r),t},e.prototype.find=function(n){var t=n.value,r=t===void 0?void 0:t,i=n.callback,o=i===void 0?void 0:i;if(!this.head)return null;for(var a=this.head;a;){if(o&&o(a.value)||r!==void 0&&this.compare(a.value,r))return a;a=a.next}return null},e.prototype.deleteTail=function(){var n=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,n;for(var t=this.head;t.next;)t.next.next?t=t.next:t.next=null;return this.tail=t,n},e.prototype.deleteHead=function(){if(!this.head)return null;var n=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),n},e.prototype.fromArray=function(n){var t=this;return n.forEach(function(r){return t.append(r)}),this},e.prototype.toArray=function(){for(var n=[],t=this.head;t;)n.push(t),t=t.next;return n},e.prototype.reverse=function(){for(var n=this.head,t=null,r=null;n;)r=n.next,n.next=t,t=n,n=r;this.tail=this.head,this.head=t},e.prototype.toString=function(n){return n===void 0&&(n=void 0),this.toArray().map(function(t){return t.toString(n)}).toString()},e}(),gR=pR;tu.default=gR,Object.defineProperty(jf,"__esModule",{value:!0}),jf.default=void 0;var Bf,vR=(Bf=tu)&&Bf.__esModule?Bf:{default:Bf},mR=function(){function e(){this.linkedList=new vR.default}return e.prototype.isEmpty=function(){return!this.linkedList.head},e.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},e.prototype.enqueue=function(n){this.linkedList.append(n)},e.prototype.dequeue=function(){var n=this.linkedList.deleteHead();return n?n.value:null},e.prototype.toString=function(n){return this.linkedList.toString(n)},e}();jf.default=mR;var Fn={};Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.uniqueId=Fn.getOutEdgesNodeId=Fn.getNeighbors=Fn.getEdgesByNodeId=void 0,Fn.getNeighbors=function(e,n,t){n===void 0&&(n=[]);var r=n.filter(function(i){return i.source===e||i.target===e});return t==="target"?r.filter(function(i){return i.source===e}).map(function(i){return i.target}):t==="source"?r.filter(function(i){return i.target===e}).map(function(i){return i.source}):r.map(function(i){return i.source===e?i.target:i.source})},Fn.getOutEdgesNodeId=function(e,n){return n.filter(function(t){return t.source===e})},Fn.getEdgesByNodeId=function(e,n){return n.filter(function(t){return t.source===e||t.target===e})},Fn.uniqueId=function(e){e===void 0&&(e=0);var n="".concat(Math.random()).split(".")[1].substr(0,5),t="".concat(Math.random()).split(".")[1].substr(0,5);return"".concat(e,"-").concat(n).concat(t)},Object.defineProperty(Rf,"__esModule",{value:!0}),Rf.default=void 0;var yR=function(e){return e&&e.__esModule?e:{default:e}}(jf),bR=Fn,xR=function(e,n,t,r){r===void 0&&(r=!0);var i=function(l){l===void 0&&(l={});var h,f=l,d=function(){},p=(h={},function(g){var v=g.next;return!h[v]&&(h[v]=!0,!0)});return f.allowTraversal=l.allowTraversal||p,f.enter=l.enter||d,f.leave=l.leave||d,f}(t),o=new yR.default,a=e.edges,s=a===void 0?[]:a;o.enqueue(n);for(var u="",c=function(){var l=o.dequeue();i.enter({current:l,previous:u}),(0,bR.getNeighbors)(l,s,r?"target":void 0).forEach(function(h){i.allowTraversal({previous:u,current:l,next:h})&&o.enqueue(h)}),i.leave({current:l,previous:u}),u=l};!o.isEmpty();)c()};Rf.default=xR;var oa={};Object.defineProperty(oa,"__esModule",{value:!0}),oa.default=function(e,n){return n?f_(e):h_(e)},oa.detectStrongConnectComponents=oa.detectConnectedComponents=void 0;var l_=Fn,h_=function(e){for(var n=e.nodes,t=n===void 0?[]:n,r=e.edges,i=r===void 0?[]:r,o=[],a={},s=[],u=function f(d){s.push(d),a[d.id]=!0;for(var p=(0,l_.getNeighbors)(d.id,i),g=function(m){var y=p[m];if(!a[y]){var b=t.filter(function(x){return x.id===y});b.length>0&&f(b[0])}},v=0;v<p.length;++v)g(v)},c=0;c<t.length;c++){var l=t[c];if(!a[l.id]){u(l);for(var h=[];s.length>0;)h.push(s.pop());o.push(h)}}return o};oa.detectConnectedComponents=h_;var f_=function(e){for(var n=e.nodes,t=n===void 0?[]:n,r=e.edges,i=r===void 0?[]:r,o=[],a={},s={},u={},c=[],l=0,h=function g(v){s[v.id]=l,u[v.id]=l,l+=1,o.push(v),a[v.id]=!0;for(var m=(0,l_.getNeighbors)(v.id,i,"target").filter(function(E){return t.map(function(M){return M.id}).indexOf(E)>-1}),y=function(E){var M=m[E];if(s[M]||s[M]===0)a[M]&&(u[v.id]=Math.min(u[v.id],s[M]));else{var _=t.filter(function(k){return k.id===M});_.length>0&&g(_[0]),u[v.id]=Math.min(u[v.id],u[M])}},b=0;b<m.length;b++)y(b);if(u[v.id]===s[v.id]){for(var x=[];o.length>0;){var w=o.pop();if(a[w.id]=!1,x.push(w),w===v)break}x.length>0&&c.push(x)}},f=0,d=t;f<d.length;f++){var p=d[f];s[p.id]||s[p.id]===0||h(p)}return c};oa.detectStrongConnectComponents=f_;var yo={};Object.defineProperty(yo,"__esModule",{value:!0}),yo.getOutDegree=yo.getInDegree=yo.default=void 0;var Rc=function(e){var n={},t=e.nodes,r=t===void 0?[]:t,i=e.edges,o=i===void 0?[]:i;return r.forEach(function(a){n[a.id]={degree:0,inDegree:0,outDegree:0}}),o.forEach(function(a){n[a.source].degree++,n[a.source].outDegree++,n[a.target].degree++,n[a.target].inDegree++}),n},wR=Rc;yo.default=wR,yo.getInDegree=function(e,n){return Rc(e)[n]?Rc(e)[n].inDegree:0},yo.getOutDegree=function(e,n){return Rc(e)[n]?Rc(e)[n].outDegree:0};var $i={},zf={};Object.defineProperty(zf,"__esModule",{value:!0}),zf.default=function(e,n,t,r){r===void 0&&(r=!0),d_(e,n,"",function(i){i===void 0&&(i={});var o=i,a=function(){},s=(u={},function(c){var l=c.next;return!u[l]&&(u[l]=!0,!0)}),u;return o.allowTraversal=i.allowTraversal||s,o.enter=i.enter||a,o.leave=i.leave||a,o}(t),r)};var ER=Fn;function d_(e,n,t,r,i){i===void 0&&(i=!0),r.enter({current:n,previous:t});var o=e.edges,a=o===void 0?[]:o;(0,ER.getNeighbors)(n,a,i?"target":void 0).forEach(function(s){r.allowTraversal({previous:t,current:n,next:s})&&d_(e,s,n,r,i)}),r.leave({current:n,previous:t})}function Dv(e){return Dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Dv(e)}Object.defineProperty($i,"__esModule",{value:!0}),$i.detectAllUndirectedCycle=$i.detectAllDirectedCycle=$i.detectAllCycles=$i.default=void 0;var MR=function(e){return e&&e.__esModule?e:{default:e}}(zf),p_=function(e,n){if(e&&e.__esModule)return e;if(e===null||Dv(e)!=="object"&&typeof e!="function")return{default:e};var t=v_(n);if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}(oa),g_=Fn;function v_(e){if(typeof WeakMap!="function")return null;var n=new WeakMap,t=new WeakMap;return(v_=function(r){return r?t:n})(e)}var m_=function(e,n,t){var r,i;t===void 0&&(t=!0);for(var o=[],a=0,s=(0,p_.default)(e,!1);a<s.length;a++){var u=s[a];if(u.length)for(var c=u[0],l=c.id,h=[c],f=((r={})[l]=c,r),d=((i={})[l]=new Set,i);h.length>0;)for(var p=h.pop(),g=p.id,v=(0,g_.getNeighbors)(g,e.edges),m=function(b){var x,w=v[b],E=e.nodes.find(function(T){return T.id===w});if(w===g)o.push(((x={})[w]=p,x));else if(w in d){if(!d[g].has(E)){for(var M=!0,_=[E,p],k=f[g];d[w].size&&!d[w].has(k)&&(_.push(k),k!==f[k.id]);)k=f[k.id];if(_.push(k),n&&t?(M=!1,_.findIndex(function(T){return n.indexOf(T.id)>-1})>-1&&(M=!0)):n&&!t&&_.findIndex(function(T){return n.indexOf(T.id)>-1})>-1&&(M=!1),M){for(var S={},C=1;C<_.length;C+=1)S[_[C-1].id]=_[C];_.length&&(S[_[_.length-1].id]=_[0]),o.push(S)}d[w].add(p)}}else f[w]=p,h.push(E),d[w]=new Set([p])},y=0;y<v.length;y+=1)m(y)}return o};$i.detectAllUndirectedCycle=m_;var y_=function(e,n,t){t===void 0&&(t=!0);for(var r=[],i=new Set,o=[],a=[],s={},u={},c=function k(S,C,T){var A=!1;if(n&&t===!1&&n.indexOf(S.id)>-1)return A;r.push(S),i.add(S);for(var D=T[S.id],j=0;j<D.length;j+=1)if((N=s[D[j]])===C){for(var L={},B=1;B<r.length;B+=1)L[r[B-1].id]=r[B];r.length&&(L[r[r.length-1].id]=r[0]),a.push(L),A=!0}else i.has(N)||k(N,C,T)&&(A=!0);if(A)(function(R){for(var P=[R];P.length>0;){var H=P.pop();i.has(H)&&(i.delete(H),o[H.id].forEach(function(ne){P.push(ne)}),o[H.id].clear())}})(S);else for(j=0;j<D.length;j+=1){var N=s[D[j]];o[N.id].has(S)||o[N.id].add(S)}return r.pop(),A},l=e.nodes,h=l===void 0?[]:l,f=0;f<h.length;f+=1){var d=h[f],p=d.id;u[p]=f,s[f]=d}if(n&&t){var g=function(k){var S=n[k];u[h[k].id]=u[S],u[S]=0,s[0]=h.find(function(C){return C.id===S}),s[u[h[k].id]]=h[k]};for(f=0;f<n.length;f++)g(f)}for(var v=function(k){for(var S,C,T=1/0,A=0;A<k.length;A+=1)for(var D=k[A],j=0;j<D.length;j++){var L=u[D[j].id];L<T&&(T=L,C=A)}var B=k[C],N=[];for(A=0;A<B.length;A+=1){var R=B[A];N[R.id]=[];for(var P=0,H=(0,g_.getNeighbors)(R.id,e.edges,"target").filter(function(Z){return B.map(function(q){return q.id}).indexOf(Z)>-1});P<H.length;P++){var ne=H[P];ne!==R.id||t===!1&&n.indexOf(R.id)>-1?N[R.id].push(u[ne]):a.push(((S={})[R.id]=R,S))}}return{component:B,adjList:N,minIdx:T}},m=0;m<h.length;){var y=h.filter(function(k){return u[k.id]>=m}),b=(0,p_.detectStrongConnectComponents)({nodes:y,edges:e.edges}).filter(function(k){return k.length>1});if(b.length===0)break;var x=v(b),w=x.minIdx,E=x.adjList,M=x.component;if(!(M.length>1))break;M.forEach(function(k){o[k.id]=new Set});var _=s[w];if(n&&t&&n.indexOf(_.id)===-1)return a;c(_,_,E),m=w+1}return a};$i.detectAllDirectedCycle=y_,$i.detectAllCycles=function(e,n,t,r){return r===void 0&&(r=!0),n?y_(e,t,r):m_(e,t,r)};var SR=function(e){var n=null,t=e.nodes,r={},i={},o={},a={};(t===void 0?[]:t).forEach(function(c){i[c.id]=c});for(var s={enter:function(c){var l=c.current,h=c.previous;if(o[l]){n={};for(var f=l,d=h;d!==l;)n[f]=d,f=d,d=r[d];n[f]=d}else o[l]=l,delete i[l],r[l]=h},leave:function(c){var l=c.current;a[l]=l,delete o[l]},allowTraversal:function(c){var l=c.next;return!n&&!a[l]}};Object.keys(i).length;){var u=Object.keys(i)[0];(0,MR.default)(e,u,s)}return n};$i.default=SR;var nu={};const b_=ji(IP),jc=ji(WP);Object.defineProperty(nu,"__esModule",{value:!0}),nu.default=void 0;var x_=b_,_R=jc,w_=Fn,kR=function(e,n,t,r){var i=e.nodes,o=i===void 0?[]:i,a=e.edges,s=a===void 0?[]:a,u={},c={},l={};o.forEach(function(m,y){var b=m.id;c[b]=1/0,b===n&&(c[b]=0)});for(var h=o.length,f=function(m){var y=function(x,w,E){for(var M,_=1/0,k=0;k<w.length;k++){var S=w[k].id;!E[S]&&x[S]<=_&&(_=x[S],M=w[k])}return M}(c,o,u),b=y.id;if(u[b]=!0,c[b]===1/0)return"continue";(t?(0,w_.getOutEdgesNodeId)(b,s):(0,w_.getEdgesByNodeId)(b,s)).forEach(function(x){var w=x.target,E=x.source,M=w===b?E:w,_=r&&x[r]?x[r]:1;c[M]>c[y.id]+_?(c[M]=c[y.id]+_,l[M]=[y.id]):c[M]===c[y.id]+_&&l[M].push(y.id)})},d=0;d<h;d++)f();l[n]=[n];var p={};for(var g in c)c[g]!==1/0&&E_(n,g,l,p);var v={};for(var g in p)v[g]=p[g][0];return{length:c,path:v,allPath:p}};function E_(e,n,t,r){if(e===n)return[e];if(r[n])return r[n];for(var i=[],o=0,a=t[n];o<a.length;o++){var s=E_(e,a[o],t,r);if(!s)return;for(var u=0,c=s;u<c.length;u++){var l=c[u];(0,_R.isArray)(l)?i.push((0,x_.__spreadArray)((0,x_.__spreadArray)([],l,!0),[n],!1)):i.push([l,n])}}return r[n]=i,r[n]}nu.default=kR;var ru={};Object.defineProperty(ru,"__esModule",{value:!0}),ru.findShortestPath=ru.findAllPath=void 0;var CR=function(e){return e&&e.__esModule?e:{default:e}}(nu),Ff=Fn;ru.findShortestPath=function(e,n,t,r,i){var o=(0,CR.default)(e,n,r,i),a=o.length,s=o.path,u=o.allPath;return{length:a[t],path:s[t],allPath:u[t]}},ru.findAllPath=function(e,n,t,r){var i;if(n===t)return[[n]];var o=e.edges,a=o===void 0?[]:o,s=[n],u=((i={})[n]=!0,i),c=[],l=[],h=r?(0,Ff.getNeighbors)(n,a,"target"):(0,Ff.getNeighbors)(n,a);for(c.push(h);s.length>0&&c.length>0;){var f=c[c.length-1];if(f.length){var d=f.shift();if(d&&(s.push(d),u[d]=!0,h=r?(0,Ff.getNeighbors)(d,a,"target"):(0,Ff.getNeighbors)(d,a),c.push(h.filter(function(v){return!u[v]}))),s[s.length-1]===t){var p=s.map(function(v){return v});l.push(p),g=s.pop(),u[g]=!1,c.pop()}}else{var g=s.pop();u[g]=!1,c.pop()}}return l};var Bc={};Object.defineProperty(Bc,"__esModule",{value:!0}),Bc.default=void 0;var AR=function(e){return e&&e.__esModule?e:{default:e}}(Ja),IR=function(e,n){for(var t=(0,AR.default)(e,n),r=[],i=t.length,o=0;o<i;o+=1){r[o]=[];for(var a=0;a<i;a+=1)o===a?r[o][a]=0:t[o][a]!==0&&t[o][a]?r[o][a]=t[o][a]:r[o][a]=1/0}for(var s=0;s<i;s+=1)for(o=0;o<i;o+=1)for(a=0;a<i;a+=1)r[o][a]>r[o][s]+r[s][a]&&(r[o][a]=r[o][s]+r[s][a]);return r};Bc.default=IR;var Gf={};Object.defineProperty(Gf,"__esModule",{value:!0}),Gf.default=void 0;var TR=function(e){return e&&e.__esModule?e:{default:e}}(Ja),OR=Fn,NR=function(e,n,t,r){n===void 0&&(n=!1),t===void 0&&(t="weight"),r===void 0&&(r=1e3);var i=e.nodes,o=i===void 0?[]:i,a=e.edges,s=a===void 0?[]:a,u={},c={};o.forEach(function(m,y){var b=(0,OR.uniqueId)();m.clusterId=b,u[b]={id:b,nodes:[m]},c[m.id]={node:m,idx:y}});var l=(0,TR.default)(e,n),h={};l.forEach(function(m,y){var b=o[y].id;h[b]={},m.forEach(function(x,w){if(x){var E=o[w].id;h[b][E]=x}})});for(var f=0,d=function(){var m=!1;if(o.forEach(function(y){var b={};Object.keys(h[y.id]).forEach(function(C){var T=h[y.id][C],A=c[C].node.clusterId;b[A]||(b[A]=0),b[A]+=T});var x=-1/0,w=[];if(Object.keys(b).forEach(function(C){x<b[C]?(x=b[C],w=[C]):x===b[C]&&w.push(C)}),w.length!==1||w[0]!==y.clusterId){var E=w.indexOf(y.clusterId);if(E>=0&&w.splice(E,1),w&&w.length){m=!0;var M=u[y.clusterId],_=M.nodes.indexOf(y);M.nodes.splice(_,1);var k=Math.floor(Math.random()*w.length),S=u[w[k]];S.nodes.push(y),y.clusterId=S.id}}}),!m)return"break";f++};f<r&&d()!=="break";);Object.keys(u).forEach(function(m){var y=u[m];y.nodes&&y.nodes.length||delete u[m]});var p=[],g={};s.forEach(function(m){var y=m.source,b=m.target,x=m[t]||1,w=c[y].node.clusterId,E=c[b].node.clusterId,M="".concat(w,"---").concat(E);if(g[M])g[M].weight+=x,g[M].count++;else{var _={source:w,target:E,weight:x,count:1};g[M]=_,p.push(_)}});var v=[];return Object.keys(u).forEach(function(m){v.push(u[m])}),{clusters:v,clusterEdges:p}};Gf.default=NR;var Uf={},zc={};Object.defineProperty(zc,"__esModule",{value:!0}),zc.default=void 0;var DR=jc,PR=function(){function e(n){this.arr=n}return e.prototype.getArr=function(){return this.arr||[]},e.prototype.add=function(n){var t,r=n.arr;if(!(!((t=this.arr)===null||t===void 0)&&t.length))return new e(r);if(!(r!=null&&r.length))return new e(this.arr);if(this.arr.length===r.length){var i=[];for(var o in this.arr)i[o]=this.arr[o]+r[o];return new e(i)}},e.prototype.subtract=function(n){var t,r=n.arr;if(!(!((t=this.arr)===null||t===void 0)&&t.length))return new e(r);if(!(r!=null&&r.length))return new e(this.arr);if(this.arr.length===r.length){var i=[];for(var o in this.arr)i[o]=this.arr[o]-r[o];return new e(i)}},e.prototype.avg=function(n){var t=[];if(n!==0)for(var r in this.arr)t[r]=this.arr[r]/n;return new e(t)},e.prototype.negate=function(){var n=[];for(var t in this.arr)n[t]=-this.arr[t];return new e(n)},e.prototype.squareEuclideanDistance=function(n){var t,r=n.arr;if(!(!((t=this.arr)===null||t===void 0)&&t.length)||!(r!=null&&r.length))return 0;if(this.arr.length===r.length){var i=0;for(var o in this.arr)i+=Math.pow(this.arr[o]-n.arr[o],2);return i}},e.prototype.euclideanDistance=function(n){var t,r=n.arr;if(!(!((t=this.arr)===null||t===void 0)&&t.length)||!(r!=null&&r.length))return 0;if(this.arr.length===r.length){var i=0;for(var o in this.arr)i+=Math.pow(this.arr[o]-n.arr[o],2);return Math.sqrt(i)}},e.prototype.normalize=function(){var n=[],t=(0,DR.clone)(this.arr);t.sort(function(a,s){return a-s});var r=t[t.length-1],i=t[0];for(var o in this.arr)n[o]=(this.arr[o]-i)/(r-i);return new e(n)},e.prototype.norm2=function(){var n;if(!(!((n=this.arr)===null||n===void 0)&&n.length))return 0;var t=0;for(var r in this.arr)t+=Math.pow(this.arr[r],2);return Math.sqrt(t)},e.prototype.dot=function(n){var t,r=n.arr;if(!(!((t=this.arr)===null||t===void 0)&&t.length)||!(r!=null&&r.length))return 0;if(this.arr.length===r.length){var i=0;for(var o in this.arr)i+=this.arr[o]*n.arr[o];return i}},e.prototype.equal=function(n){var t,r=n.arr;if(((t=this.arr)===null||t===void 0?void 0:t.length)!==(r==null?void 0:r.length))return!1;for(var i in this.arr)if(this.arr[i]!==r[i])return!1;return!0},e}(),LR=PR;zc.default=LR;var Qi={},iu={};Object.defineProperty(iu,"__esModule",{value:!0}),iu.secondReg=iu.dateReg=void 0,iu.secondReg=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/,iu.dateReg=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.getPropertyWeight=Qi.getAllSortProperties=Qi.getAllProperties=Qi.default=void 0;var M_=iu,Pv=function(e,n){e===void 0&&(e=[]),n===void 0&&(n=100);var t={};e.forEach(function(i){i.properties&&Object.keys(i.properties).forEach(function(o){o==="id"||!"".concat(i.properties[o]).match(M_.secondReg)&&!"".concat(i.properties[o]).match(M_.dateReg)&&isNaN(Number(i.properties[o]))?t.hasOwnProperty(o)&&delete t[o]:t.hasOwnProperty(o)?t[o]+=1:t[o]=1})});var r=Object.keys(t).sort(function(i,o){return t[o]-t[i]});return r.length<n?r:r.slice(0,n)};Qi.getAllSortProperties=Pv;var RR=function(e,n){return n.map(function(t){return e.hasOwnProperty(t)?e[t]:0})},S_=function(e){for(var n=Pv(e),t=[],r=0;r<e.length;r++)t[r]=RR(e[r].properties,n);return t};Qi.getPropertyWeight=S_;var __=function(e,n){n===void 0&&(n=void 0);var t=[];return e.forEach(function(r){n===void 0&&t.push(r),r[n]!==void 0&&t.push(r[n])}),t};Qi.getAllProperties=__;var jR={getAllSortProperties:Pv,getPropertyWeight:S_,getAllProperties:__};Qi.default=jR;var Lv,Ji={},Fc={};Object.defineProperty(Fc,"__esModule",{value:!0}),Fc.DistanceType=void 0,Fc.DistanceType=Lv,function(e){e.EuclideanDistance="euclideanDistance"}(Lv||(Fc.DistanceType=Lv={})),Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.oneHot=Ji.getDistance=Ji.getAllKeyValueMap=Ji.default=void 0;var k_=jc,C_=Fc,A_=function(e){return e&&e.__esModule?e:{default:e}}(zc),Rv=function(e,n,t){var r=[];n!=null&&n.length?r=n:(e.forEach(function(o){r=r.concat(Object.keys(o))}),r=(0,k_.uniq)(r));var i={};return r.forEach(function(o){var a=[];e.forEach(function(s){s[o]!==void 0&&s[o]!==""&&a.push(s[o])}),a.length&&!(t!=null&&t.includes(o))&&(i[o]=(0,k_.uniq)(a))}),i};Ji.getAllKeyValueMap=Rv;var I_=function(e,n,t){var r=Rv(e,n,t),i=[];if(!Object.keys(r).length)return i;var o=Object.values(r).every(function(a){return a.every(function(s){return typeof s=="number"})});return e.forEach(function(a,s){var u=[];Object.keys(r).forEach(function(c){var l=a[c],h=r[c],f=h.findIndex(function(g){return l===g}),d=[];if(o)d.push(l);else for(var p=0;p<h.length;p++)p===f?d.push(1):d.push(0);u=u.concat(d)}),i[s]=u}),i};Ji.oneHot=I_;var T_=function(e,n,t,r){t===void 0&&(t=C_.DistanceType.EuclideanDistance);var i=0;return t===C_.DistanceType.EuclideanDistance&&(i=new A_.default(e).euclideanDistance(new A_.default(n))),i};Ji.getDistance=T_;var BR={getAllKeyValueMap:Rv,oneHot:I_,getDistance:T_};Ji.default=BR,Object.defineProperty(Uf,"__esModule",{value:!0}),Uf.default=void 0;var zR=jc,FR=O_(Ja),Gc=O_(zc),GR=Qi,UR=Ji;function O_(e){return e&&e.__esModule?e:{default:e}}var N_=function(e,n,t,r){for(var i=n.length,o=2*r,a=0,s=0;s<i;s++)for(var u=e[s].clusterId,c=0;c<i;c++)u===e[c].clusterId&&(a+=(n[s][c]||0)-(t[s]||0)*(t[c]||0)/o);return a*=1/o},jv=function(e,n){e===void 0&&(e=[]);for(var t=e.length,r=new Gc.default([]),i=0;i<t;i++)r=r.add(new Gc.default(n[i]));var o=r.avg(t);o.normalize();var a=0;for(i=0;i<t;i++)a+=(u=new Gc.default(n[i])).squareEuclideanDistance(o);var s=[];for(e.forEach(function(){s.push([])}),i=0;i<t;i++){var u=new Gc.default(n[i]);e[i].clusterInertial=0;for(var c=0;c<t;c++)if(i!==c){var l=new Gc.default(n[c]);s[i][c]=u.squareEuclideanDistance(l),e[i].clusterInertial+=s[i][c]}else s[i][c]=0}var h=0,f=2*t*a;for(i=0;i<t;i++){var d=e[i].clusterId;for(c=0;c<t;c++){var p=e[c].clusterId;i!==c&&d===p&&(h+=e[i].clusterInertial*e[c].clusterInertial/Math.pow(f,2)-s[i][c]/f)}}return Number(h.toFixed(4))},XR=function(e,n,t,r,i,o,a,s,u){n===void 0&&(n=!1),t===void 0&&(t="weight"),r===void 0&&(r=1e-4),i===void 0&&(i=!1),o===void 0&&(o=void 0),a===void 0&&(a=[]),s===void 0&&(s=["id"]),u===void 0&&(u=1);var c=e.nodes,l=c===void 0?[]:c,h=e.edges,f=h===void 0?[]:h,d=[];if(i){l.forEach(function(N,R){N.properties=N.properties||{},N.originIndex=R});var p=[];l.every(function(N){return N.hasOwnProperty("nodeType")})&&(p=Array.from(new Set(l.map(function(N){return N.nodeType}))),l.forEach(function(N){N.properties.nodeType=p.findIndex(function(R){return R===N.nodeType})}));var g=(0,GR.getAllProperties)(l,o);d=(0,UR.oneHot)(g,a,s)}var v=1,m={},y={};l.forEach(function(N,R){var P=String(v++);N.clusterId=P,m[P]={id:P,nodes:[N]},y[N.id]={node:N,idx:R}});var b=(0,FR.default)(e,n),x=[],w={},E=0;b.forEach(function(N,R){var P=0,H=l[R].id;w[H]={},N.forEach(function(ne,Z){if(ne){P+=ne;var q=l[Z].id;w[H][q]=ne,E+=ne}}),x.push(P)}),E/=2;for(var M=1/0,_=1/0,k=0,S=[],C={};;){M=i&&l.every(function(N){return N.hasOwnProperty("properties")})?N_(l,b,x,E)+jv(l,d)*u:N_(l,b,x,E),k===0&&(_=M,S=l,C=m);var T=M>0&&M>_&&M-_<r;if(M>_&&(S=l.map(function(N){return{node:N,clusterId:N.clusterId}}),C=(0,zR.clone)(m),_=M),T||k>100)break;k++,Object.keys(m).forEach(function(N){var R=0;f.forEach(function(P){var H=P.source,ne=P.target,Z=y[H].node.clusterId,q=y[ne].node.clusterId;(Z===N&&q!==N||q===N&&Z!==N)&&(R+=P[t]||1)}),m[N].sumTot=R}),l.forEach(function(N,R){var P,H=m[N.clusterId],ne=0,Z=x[R]/(2*E),q=0,te=H.nodes;te.forEach(function(Te){var Xe=y[Te.id].idx;q+=b[R][Xe]||0});var we=q-H.sumTot*Z,pe=te.filter(function(Te){return Te.id!==N.id});pe.forEach(function(Te,Xe){d[Te.originIndex]});var Me=jv(pe,d)*u,Be=w[N.id];if(Object.keys(Be).forEach(function(Te){var Xe=y[Te].node.clusterId;if(Xe!==N.clusterId){var Oe=m[Xe],Se=Oe.nodes;if(Se&&Se.length){var We=0;Se.forEach(function(Ze){var Je=y[Ze.id].idx;We+=b[R][Je]||0});var Ve=We-Oe.sumTot*Z,O=Se.concat([N]);O.forEach(function(Ze,Je){d[Ze.originIndex]});var he=jv(O,d)*u,_e=Ve-we;i&&(_e=Ve+he-(we+Me)),_e>ne&&(ne=_e,P=Oe)}}}),ne>0){P.nodes.push(N);var dt=N.clusterId;N.clusterId=P.id;var It=H.nodes.indexOf(N);H.nodes.splice(It,1);var at=0,Ue=0;f.forEach(function(Te){var Xe=Te.source,Oe=Te.target,Se=y[Xe].node.clusterId,We=y[Oe].node.clusterId;(Se===P.id&&We!==P.id||We===P.id&&Se!==P.id)&&(at+=Te[t]||1),(Se===dt&&We!==dt||We===dt&&Se!==dt)&&(Ue+=Te[t]||1)}),P.sumTot=at,H.sumTot=Ue}})}var A={},D=0;Object.keys(C).forEach(function(N){var R=C[N];if(R.nodes&&R.nodes.length){var P=String(D+1);P!==N&&(R.id=P,R.nodes=R.nodes.map(function(H){return{id:H.id,clusterId:P}}),C[P]=R,A[N]=P,delete C[N],D++)}else delete C[N]}),S.forEach(function(N){var R=N.node,P=N.clusterId;R&&(R.clusterId=P,R.clusterId&&A[R.clusterId]&&(R.clusterId=A[R.clusterId]))});var j=[],L={};f.forEach(function(N){var R=N.source,P=N.target,H=N[t]||1,ne=y[R].node.clusterId,Z=y[P].node.clusterId;if(ne&&Z){var q="".concat(ne,"---").concat(Z);if(L[q])L[q].weight+=H,L[q].count++;else{var te={source:ne,target:Z,weight:H,count:1};L[q]=te,j.push(te)}}});var B=[];return Object.keys(C).forEach(function(N){B.push(C[N])}),{clusters:B,clusterEdges:j}};Uf.default=XR;var Xf={},Yf={};Object.defineProperty(Yf,"__esModule",{value:!0}),Yf.default=void 0;var YR=function(){function e(n){this.count=n.length,this.parent={};for(var t=0,r=n;t<r.length;t++){var i=r[t];this.parent[i]=i}}return e.prototype.find=function(n){for(;this.parent[n]!==n;)n=this.parent[n];return n},e.prototype.union=function(n,t){var r=this.find(n),i=this.find(t);r!==i&&(r<i?(this.parent[t]!==t&&this.union(this.parent[t],n),this.parent[t]=this.parent[n]):(this.parent[n]!==n&&this.union(this.parent[n],t),this.parent[n]=this.parent[t]))},e.prototype.connected=function(n,t){return this.find(n)===this.find(t)},e}(),WR=YR;Yf.default=WR;var Wf={};Object.defineProperty(Wf,"__esModule",{value:!0}),Wf.default=void 0;var VR=function(e,n){return e-n},HR=function(){function e(n){n===void 0&&(n=VR),this.compareFn=n,this.list=[]}return e.prototype.getLeft=function(n){return 2*n+1},e.prototype.getRight=function(n){return 2*n+2},e.prototype.getParent=function(n){return n===0?null:Math.floor((n-1)/2)},e.prototype.isEmpty=function(){return this.list.length<=0},e.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},e.prototype.delMin=function(){var n=this.top(),t=this.list.pop();return this.list.length>0&&(this.list[0]=t,this.moveDown(0)),n},e.prototype.insert=function(n){if(n!==null){this.list.push(n);var t=this.list.length-1;return this.moveUp(t),!0}return!1},e.prototype.moveUp=function(n){for(var t=this.getParent(n);n&&n>0&&this.compareFn(this.list[t],this.list[n])>0;){var r=this.list[t];this.list[t]=this.list[n],this.list[n]=r,n=t,t=this.getParent(n)}},e.prototype.moveDown=function(n){var t,r=n,i=this.getLeft(n),o=this.getRight(n),a=this.list.length;i!==null&&i<a&&this.compareFn(this.list[r],this.list[i])>0?r=i:o!==null&&o<a&&this.compareFn(this.list[r],this.list[o])>0&&(r=o),n!==r&&(t=[this.list[r],this.list[n]],this.list[n]=t[0],this.list[r]=t[1],this.moveDown(r))},e}(),qR=HR;Wf.default=qR,Object.defineProperty(Xf,"__esModule",{value:!0}),Xf.default=void 0;var ZR=D_(Yf),KR=D_(Wf),Bv=Fn;function D_(e){return e&&e.__esModule?e:{default:e}}var $R=function(e,n){var t=[],r=e.nodes,i=r===void 0?[]:r,o=e.edges,a=o===void 0?[]:o;if(i.length===0)return t;var s=i[0],u=new Set;u.add(s);var c=new KR.default(function(d,p){return n?d.weight-p.weight:0});for((0,Bv.getEdgesByNodeId)(s.id,a).forEach(function(d){c.insert(d)});!c.isEmpty();){var l=c.delMin(),h=l.source,f=l.target;u.has(h)&&u.has(f)||(t.push(l),u.has(h)||(u.add(h),(0,Bv.getEdgesByNodeId)(h,a).forEach(function(d){c.insert(d)})),u.has(f)||(u.add(f),(0,Bv.getEdgesByNodeId)(f,a).forEach(function(d){c.insert(d)})))}return t},P_=function(e,n){var t=[],r=e.nodes,i=r===void 0?[]:r,o=e.edges,a=o===void 0?[]:o;if(i.length===0)return t;var s=a.map(function(f){return f});n&&s.sort(function(f,d){return f.weight-d.weight});for(var u=new ZR.default(i.map(function(f){return f.id}));s.length>0;){var c=s.shift(),l=c.source,h=c.target;u.connected(l,h)||(t.push(c),u.union(l,h))}return t},QR=function(e,n,t){return t?{prim:$R,kruskal:P_}[t](e,n):P_(e,n)};Xf.default=QR;var Vf={};Object.defineProperty(Vf,"__esModule",{value:!0}),Vf.default=void 0;var JR=function(e){return e&&e.__esModule?e:{default:e}}(yo),ej=Fn,tj=function(e,n,t){typeof n!="number"&&(n=1e-6),typeof t!="number"&&(t=.85);for(var r,i=1,o=0,a=1e3,s=e.nodes,u=s===void 0?[]:s,c=e.edges,l=c===void 0?[]:c,h=u.length,f={},d={},p=0;p<h;++p)f[v=(w=u[p]).id]=1/h,d[v]=1/h;for(var g=(0,JR.default)(e);a>0&&i>n;){for(o=0,p=0;p<h;++p){var v=(w=u[p]).id;if(r=0,g[w.id].inDegree===0)f[v]=0;else{for(var m=(0,ej.getNeighbors)(v,l,"source"),y=0;y<m.length;++y){var b=m[y],x=g[b].outDegree;x>0&&(r+=d[b]/x)}f[v]=t*r,o+=f[v]}}for(o=(1-o)/h,i=0,p=0;p<h;++p){var w;r=f[v=(w=u[p]).id]+o,i+=Math.abs(r-d[v]),d[v]=r}a-=1}return d};Vf.default=tj;var Hf={},qf={},Gn={};Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.VACANT_NODE_LABEL=Gn.VACANT_NODE_ID=Gn.VACANT_GRAPH_ID=Gn.VACANT_EDGE_LABEL=Gn.VACANT_EDGE_ID=Gn.Node=Gn.Graph=Gn.Edge=Gn.AUTO_EDGE_ID=void 0,Gn.VACANT_EDGE_ID=-1,Gn.VACANT_NODE_ID=-1,Gn.VACANT_EDGE_LABEL="-1",Gn.VACANT_NODE_LABEL="-1",Gn.VACANT_GRAPH_ID=-1,Gn.AUTO_EDGE_ID="-1";var zv=function(e,n,t,r){e===void 0&&(e=-1),n===void 0&&(n=-1),t===void 0&&(t=-1),r===void 0&&(r="-1"),this.id=e,this.from=n,this.to=t,this.label=r};Gn.Edge=zv;var L_=function(){function e(n,t){n===void 0&&(n=-1),t===void 0&&(t="-1"),this.id=n,this.label=t,this.edges=[],this.edgeMap={}}return e.prototype.addEdge=function(n){this.edges.push(n),this.edgeMap[n.id]=n},e}();Gn.Node=L_;var nj=function(){function e(n,t,r){n===void 0&&(n=-1),t===void 0&&(t=!0),r===void 0&&(r=!1),this.id=n,this.edgeIdAutoIncrease=t,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=r}return e.prototype.getNodeNum=function(){return this.nodes.length},e.prototype.addNode=function(n,t){if(!this.nodeMap[n]){var r=new L_(n,t);this.nodes.push(r),this.nodeMap[n]=r,this.nodeLabelMap[t]||(this.nodeLabelMap[t]=[]),this.nodeLabelMap[t].push(n)}},e.prototype.addEdge=function(n,t,r,i){if((this.edgeIdAutoIncrease||n===void 0)&&(n=this.counter++),!(this.nodeMap[t]&&this.nodeMap[r]&&this.nodeMap[r].edgeMap[n])){var o=new zv(n,t,r,i);if(this.edges.push(o),this.edgeMap[n]=o,this.nodeMap[t].addEdge(o),this.edgeLabelMap[i]||(this.edgeLabelMap[i]=[]),this.edgeLabelMap[i].push(o),!this.directed){var a=new zv(n,r,t,i);this.nodeMap[r].addEdge(a),this.edgeLabelMap[i].push(a)}}},e}();Gn.Graph=nj,Object.defineProperty(qf,"__esModule",{value:!0}),qf.default=void 0;var rj=jc,Ar=Gn,es=function(){function e(n,t,r,i,o){this.fromNode=n,this.toNode=t,this.nodeEdgeNodeLabel={nodeLabel1:r||Ar.VACANT_NODE_LABEL,edgeLabel:i||Ar.VACANT_EDGE_LABEL,nodeLabel2:o||Ar.VACANT_NODE_LABEL}}return e.prototype.equalTo=function(n){return this.fromNode===n.formNode&&this.toNode===n.toNode&&this.nodeEdgeNodeLabel===n.nodeEdgeNodeLabel},e.prototype.notEqualTo=function(n){return!this.equalTo(n)},e}(),R_=function(){function e(){this.rmpath=[],this.dfsEdgeList=[]}return e.prototype.equalTo=function(n){var t=this.dfsEdgeList.length;if(t!==n.length)return!1;for(var r=0;r<t;r++)if(this.dfsEdgeList[r]!==n[r])return!1;return!0},e.prototype.notEqualTo=function(n){return!this.equalTo(n)},e.prototype.pushBack=function(n,t,r,i,o){return this.dfsEdgeList.push(new es(n,t,r,i,o)),this.dfsEdgeList},e.prototype.toGraph=function(n,t){n===void 0&&(n=Ar.VACANT_GRAPH_ID),t===void 0&&(t=!1);var r=new Ar.Graph(n,!0,t);return this.dfsEdgeList.forEach(function(i){var o=i.fromNode,a=i.toNode,s=i.nodeEdgeNodeLabel,u=s.nodeLabel1,c=s.edgeLabel,l=s.nodeLabel2;u!==Ar.VACANT_NODE_LABEL&&r.addNode(o,u),l!==Ar.VACANT_NODE_LABEL&&r.addNode(a,l),u!==Ar.VACANT_NODE_LABEL&&l!==u&&r.addEdge(void 0,o,a,c)}),r},e.prototype.buildRmpath=function(){this.rmpath=[];for(var n=void 0,t=this.dfsEdgeList.length-1;t>=0;t--){var r=this.dfsEdgeList[t],i=r.fromNode,o=r.toNode;i<o&&(n===void 0||o===n)&&(this.rmpath.push(t),n=i)}return this.rmpath},e.prototype.getNodeNum=function(){var n={};return this.dfsEdgeList.forEach(function(t){n[t.fromNode]||(n[t.fromNode]=!0),n[t.toNode]||(n[t.toNode]=!0)}),Object.keys(n).length},e}(),Zf=function(){function e(n){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],n){for(;n;){var t=n.edge;this.edges.push(t),this.nodesUsed[t.from]=1,this.nodesUsed[t.to]=1,this.edgesUsed[t.id]=1,n=n.preNode}this.edges=this.edges.reverse()}}return e.prototype.hasNode=function(n){return this.nodesUsed[n.id]===1},e.prototype.hasEdge=function(n){return this.edgesUsed[n.id]===1},e}(),ij=function(){function e(n){var t=n.graphs,r=n.minSupport,i=r===void 0?2:r,o=n.minNodeNum,a=o===void 0?1:o,s=n.maxNodeNum,u=s===void 0?4:s,c=n.top,l=c===void 0?10:c,h=n.directed,f=h!==void 0&&h,d=n.verbose,p=d!==void 0&&d;this.graphs=t,this.dfsCode=new R_,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=i,this.top=l,this.directed=f,this.counter=0,this.maxNodeNum=u,this.minNodeNum=a,this.verbose=p,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}return e.prototype.findForwardRootEdges=function(n,t){var r=this,i=[],o=n.nodeMap;return t.edges.forEach(function(a){(r.directed||t.label<=o[a.to].label)&&i.push(a)}),i},e.prototype.findBackwardEdge=function(n,t,r,i){if(!this.directed&&t===r)return null;for(var o=n.nodeMap,a=o[r.to].edges,s=a.length,u=0;u<s;u++){var c=a[u];if(!i.hasEdge(c)&&c.to===t.from){if(this.directed){if(o[t.from].label<o[r.to].label||o[t.from].label===o[r.to].label&&t.label<=c.label)return c}else if(t.label<c.label||t.label===c.label&&o[t.to].label<=o[r.to].label)return c}}return null},e.prototype.findForwardPureEdges=function(n,t,r,i){for(var o=[],a=t.to,s=n.nodeMap[a].edges,u=s.length,c=0;c<u;c++){var l=s[c],h=n.nodeMap[l.to];r<=h.label&&!i.hasNode(h)&&o.push(l)}return o},e.prototype.findForwardRmpathEdges=function(n,t,r,i){for(var o=[],a=n.nodeMap,s=a[t.to].label,u=a[t.from].edges,c=u.length,l=0;l<c;l++){var h=u[l],f=a[h.to].label;t.to===h.to||r>f||i.hasNode(a[h.to])||(t.label<h.label||t.label===h.label&&s<=f)&&o.push(h)}return o},e.prototype.getSupport=function(n){var t={};return n.forEach(function(r){t[r.graphId]||(t[r.graphId]=!0)}),Object.keys(t).length},e.prototype.findMinLabel=function(n){var t=void 0;return Object.keys(n).forEach(function(r){var i=n[r],o=i.nodeLabel1,a=i.edgeLabel,s=i.nodeLabel2;t?(o<t.nodeLabel1||o===t.nodeLabel1&&a<t.edgeLabel||o===t.nodeLabel1&&a===t.edgeLabel&&s<t.nodeLabel2)&&(t={nodeLabel1:o,edgeLabel:a,nodeLabel2:s}):t={nodeLabel1:o,edgeLabel:a,nodeLabel2:s}}),t},e.prototype.isMin=function(){var n=this,t=this.dfsCode;if(this.verbose,t.dfsEdgeList.length===1)return!0;var r=this.directed,i=t.toGraph(Ar.VACANT_GRAPH_ID,r),o=i.nodeMap,a=new R_,s={};i.nodes.forEach(function(l){n.findForwardRootEdges(i,l).forEach(function(h){var f=o[h.to],d="".concat(l.label,"-").concat(h.label,"-").concat(f.label);s[d]||(s[d]={projected:[],nodeLabel1:l.label,edgeLabel:h.label,nodeLabel2:f.label});var p={graphId:i.id,edge:h,preNode:null};s[d].projected.push(p)})});var u=this.findMinLabel(s);if(u){a.dfsEdgeList.push(new es(0,1,u.nodeLabel1,u.edgeLabel,u.nodeLabel2));var c="".concat(u.nodeLabel1,"-").concat(u.edgeLabel,"-").concat(u.nodeLabel2);return function l(h){for(var f=a.buildRmpath(),d=a.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,p=a.dfsEdgeList[f[0]].toNode,g={},v=!1,m=0,y=r?-1:0,b=function(A){if(v)return"break";h.forEach(function(D){var j=new Zf(D),L=n.findBackwardEdge(i,j.edges[f[A]],j.edges[f[0]],j);L&&(g[L.label]||(g[L.label]={projected:[],edgeLabel:L.label}),g[L.label].projected.push({graphId:i.id,edge:g,preNode:D}),m=a.dfsEdgeList[f[A]].fromNode,v=!0)})},x=f.length-1;x>y&&b(x)!=="break";x--);if(v){var w=n.findMinLabel(g);a.dfsEdgeList.push(new es(p,m,Ar.VACANT_NODE_LABEL,w.edgeLabel,Ar.VACANT_NODE_LABEL));var E=a.dfsEdgeList.length-1;return n.dfsCode.dfsEdgeList[E]===a.dfsEdgeList[E]&&l(g[w.edgeLabel].projected)}var M={};v=!1;var _=0;h.forEach(function(A){var D=new Zf(A),j=n.findForwardPureEdges(i,D.edges[f[0]],d,D);j.length>0&&(v=!0,_=p,j.forEach(function(L){var B="".concat(L.label,"-").concat(o[L.to].label);M[B]||(M[B]={projected:[],edgeLabel:L.label,nodeLabel2:o[L.to].label}),M[B].projected.push({graphId:i.id,edge:L,preNode:A})}))});var k=f.length,S=function(A){if(v)return"break";var D=f[A];h.forEach(function(j){var L=new Zf(j),B=n.findForwardRmpathEdges(i,L.edges[D],d,L);B.length>0&&(v=!0,_=a.dfsEdgeList[D].fromNode,B.forEach(function(N){var R="".concat(N.label,"-").concat(o[N.to].label);M[R]||(M[R]={projected:[],edgeLabel:N.label,nodeLabel2:o[N.to].label}),M[R].projected.push({graphId:i.id,edge:N,preNode:j})}))})};for(x=0;x<k&&S(x)!=="break";x++);if(!v)return!0;var C=n.findMinLabel(M);a.dfsEdgeList.push(new es(_,p+1,Ar.VACANT_NODE_LABEL,C.edgeLabel,C.nodeLabel2));var T=a.dfsEdgeList.length-1;return t.dfsEdgeList[T]===a.dfsEdgeList[T]&&l(M["".concat(C.edgeLabel,"-").concat(C.nodeLabel2)].projected)}(s[c].projected)}},e.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var n=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push((0,rj.clone)(n))}},e.prototype.subGraphMining=function(n){var t=this;if(!(this.getSupport(n)<this.minSupport)&&this.isMin()){this.report();var r=this.dfsCode.getNodeNum(),i=this.dfsCode.buildRmpath(),o=this.dfsCode.dfsEdgeList[i[0]].toNode,a=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,s={},u={};n.forEach(function(c){for(var l=t.graphs[c.graphId],h=l.nodeMap,f=new Zf(c),d=i.length-1;d>=0;d--){var p=t.findBackwardEdge(l,f.edges[i[d]],f.edges[i[0]],f);if(p){var g="".concat(t.dfsCode.dfsEdgeList[i[d]].fromNode,"-").concat(p.label);u[g]||(u[g]={projected:[],toNodeId:t.dfsCode.dfsEdgeList[i[d]].fromNode,edgeLabel:p.label}),u[g].projected.push({graphId:c.graphId,edge:p,preNode:c})}}if(!(r>=t.maxNodeNum)){t.findForwardPureEdges(l,f.edges[i[0]],a,f).forEach(function(m){var y="".concat(o,"-").concat(m.label,"-").concat(h[m.to].label);s[y]||(s[y]={projected:[],fromNodeId:o,edgeLabel:m.label,nodeLabel2:h[m.to].label}),s[y].projected.push({graphId:c.graphId,edge:m,preNode:c})});var v=function(m){t.findForwardRmpathEdges(l,f.edges[i[m]],a,f).forEach(function(y){var b="".concat(t.dfsCode.dfsEdgeList[i[m]].fromNode,"-").concat(y.label,"-").concat(h[y.to].label);s[b]||(s[b]={projected:[],fromNodeId:t.dfsCode.dfsEdgeList[i[m]].fromNode,edgeLabel:y.label,nodeLabel2:h[y.to].label}),s[b].projected.push({graphId:c.graphId,edge:y,preNode:c})})};for(d=0;d<i.length;d++)v(d)}}),Object.keys(u).forEach(function(c){var l=u[c],h=l.toNodeId,f=l.edgeLabel;t.dfsCode.dfsEdgeList.push(new es(o,h,"-1",f,"-1")),t.subGraphMining(u[c].projected),t.dfsCode.dfsEdgeList.pop()}),Object.keys(s).forEach(function(c){var l=s[c],h=l.fromNodeId,f=l.edgeLabel,d=l.nodeLabel2;t.dfsCode.dfsEdgeList.push(new es(h,o+1,Ar.VACANT_NODE_LABEL,f,d)),t.subGraphMining(s[c].projected),t.dfsCode.dfsEdgeList.pop()})}},e.prototype.generate1EdgeFrequentSubGraphs=function(){var n=this.graphs,t=this.directed,r=this.minSupport,i=this.frequentSize1Subgraphs,o={},a={},s={};return Object.keys(n).forEach(function(u){var c=n[u],l=c.nodeMap;c.nodes.forEach(function(h,f){var d=h.label,p="".concat(u,"-").concat(d);if(!s[p]){var g=o[d]||0;g++,o[d]=g}s[p]={graphKey:u,label:d},h.edges.forEach(function(v){var m=d,y=l[v.to].label;if(!t&&m>y){var b=y;y=m,m=b}var x=v.label,w="".concat(m,"-").concat(x,"-").concat(y);if(!a[w]){var E=a[w]||0;E++,a[w]=E}})})}),Object.keys(o).forEach(function(u){if(!(o[u]<r)){var c={nodes:[],edges:[]};c.nodes.push({id:"0",label:u}),i.push(c)}}),i},e.prototype.run=function(){var n=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var t=this.graphs;this.directed;var r={};Object.keys(t).forEach(function(i){var o=t[i],a=o.nodeMap;o.nodes.forEach(function(s){n.findForwardRootEdges(o,s).forEach(function(u){var c=a[u.to],l="".concat(s.label,"-").concat(u.label,"-").concat(c.label);r[l]||(r[l]={projected:[],nodeLabel1:s.label,edgeLabel:u.label,nodeLabel2:c.label});var h={graphId:i,edge:u,preNode:null};r[l].projected.push(h)})})}),Object.keys(r).forEach(function(i){var o=r[i],a=o.projected,s=o.nodeLabel1,u=o.edgeLabel,c=o.nodeLabel2;n.dfsCode.dfsEdgeList.push(new es(0,1,s,u,c)),n.subGraphMining(a),n.dfsCode.dfsEdgeList.pop()})}},e}(),j_="cluster",oj=function(e){var n=e.graphs,t=e.directed,r=t!==void 0&&t,i=e.nodeLabelProp,o=i===void 0?j_:i,a=e.edgeLabelProp,s=a===void 0?j_:a,u=function(v,m,y,b){var x={};return Object.keys(v).forEach(function(w,E){var M=v[w],_=new Ar.Graph(E,!0,m),k={};M.nodes.forEach(function(S,C){_.addNode(C,S[y]),k[S.id]=C}),M.edges.forEach(function(S,C){var T=k[S.source],A=k[S.target];_.addEdge(-1,T,A,S[b])}),_&&_.getNodeNum()&&(x[_.id]=_)}),x}(n,r,o,s),c=e.minSupport,l=e.maxNodeNum,h=e.minNodeNum,f=e.verbose,d=e.top,p=new ij({graphs:u,minSupport:c,maxNodeNum:l,minNodeNum:h,top:d,verbose:f,directed:r});p.run();var g=function(v,m,y){var b=[];return v.forEach(function(x){var w={nodes:[],edges:[]};x.nodes.forEach(function(E){var M;w.nodes.push(((M={id:"".concat(E.id)})[m]=E.label,M))}),x.edges.forEach(function(E){var M;w.edges.push(((M={source:"".concat(E.from),target:"".concat(E.to)})[y]=E.label,M))}),b.push(w)}),b}(p.frequentSubgraphs,o,s);return g};qf.default=oj,Object.defineProperty(Hf,"__esModule",{value:!0}),Hf.default=void 0;var B_=b_,z_=Fv(Bc),aj=Fv(qf),F_=Fv(nu),sj=Fn;function Fv(e){return e&&e.__esModule?e:{default:e}}var G_=function(e,n,t,r){t===void 0&&(t="cluster"),r===void 0&&(r=2);var i=[],o=e.nodes;return n.forEach(function(a,s){i.push(U_(o,a,s,t,r))}),i},U_=function(e,n,t,r,i){var o=[t],a=[],s={};return n.forEach(function(u,c){if(u<=i&&t!==c){o.push(c),a.push(e[c]);var l=e[c][r];s[l]?(s[l].count++,s[l].dists.push(u)):s[l]={count:1,dists:[u]}}}),Object.keys(s).forEach(function(u){s[u].dists=s[u].dists.sort(function(c,l){return c-l})}),{nodeIdx:t,nodeId:e[t].id,nodeIdxs:o,neighbors:a,neighborNum:o.length-1,nodeLabelCountMap:s}},Kf=function(e,n,t,r){var i=t.nodes;return r||(r={}),Object.keys(e).forEach(function(o){var a,s;if(!r||!r[o]){r[o]={nodes:[],edges:[]};var u=e[o],c=(a=n[u.start])===null||a===void 0?void 0:a.nodeIdxs,l=(s=n[u.end])===null||s===void 0?void 0:s.nodeIdxs;if(c&&l){var h=new Set(l),f=c.filter(function(m){return h.has(m)});if(f&&f.length){for(var d={},p=f.length,g=0;g<p;g++){var v=i[f[g]];r[o].nodes.push(v),d[v.id]=!0}t.edges.forEach(function(m){d[m.source]&&d[m.target]&&r[o].edges.push(m)})}}}}),r},$f=function(e,n,t,r){var i,o,a={};e.nodes.forEach(function(u){a[u.id]=u});var s=0;return!(!((i=n==null?void 0:n.edges)===null||i===void 0)&&i.length)||((o=n==null?void 0:n.nodes)===null||o===void 0?void 0:o.length)<2?0:(e.edges.forEach(function(u){var c=a[u.source][t],l=a[u.target][t],h=n==null?void 0:n.nodes[0][t],f=n==null?void 0:n.nodes[1][t],d=n==null?void 0:n.edges[0][r];u[r]===d&&(c===h&&l===f||c===f&&l===h)&&s++}),s)},X_=function(e,n){var t={},r={};return e.forEach(function(i,o){t[i.id]={idx:o,node:i,degree:0,inDegree:0,outDegree:0};var a=i[n];r[a]||(r[a]=[]),r[a].push(i)}),{nodeMap:t,nodeLabelMap:r}},Y_=function(e,n,t){var r={},i={};return e.forEach(function(o,a){r["".concat(sj.uniqueId)]={idx:a,edge:o};var s=o[n];i[s]||(i[s]=[]),i[s].push(o);var u=t[o.source];u&&(u.degree++,u.outDegree++);var c=t[o.target];c&&(c.degree++,c.inDegree++)}),{edgeMap:r,edgeLabelMap:i}},W_=function(e,n,t){var r=n.length,i={};return n.forEach(function(o,a){for(var s=t?0:a+1,u=e[a].id,c=s;c<r;c++)if(a!==c){var l=e[c].id,h=o[c];i["".concat(u,"-").concat(l)]=h,t||(i["".concat(l,"-").concat(u)]=h)}}),i},uj=function(e,n,t,r,i,o,a,s,u,c,l){var h,f="".concat(n.id,"-").concat(t.id);if(c&&c[f])return c[f];var d=l?l[f]:void 0;if(!d){var p=((h={})[f]={start:r[n.id].idx,end:r[t.id].idx,distance:i},h);d=(l=Kf(p,o,e,l))[f]}return $f(d,a,s,u)},V_=function(e,n,t,r){var i,o,a,s=(i=e[n])===null||i===void 0?void 0:i.degree,u=(o=e[n])===null||o===void 0?void 0:o.inDegree,c=(a=e[n])===null||a===void 0?void 0:a.outDegree;return e[n]===void 0&&(s=1/0,u=1/0,c=1/0,r[n].forEach(function(l){var h=t[l.id].degree;s>h&&(s=h);var f=t[l.id].inDegree;u>f&&(u=f);var d=t[l.id].outDegree;c>d&&(c=d)}),e[n]={degree:s,inDegree:u,outDegree:c}),{minPatternNodeLabelDegree:s,minPatternNodeLabelInDegree:u,minPatternNodeLabelOutDegree:c}},cj=function(e,n,t,r,i,o,a){var s;if(t===void 0&&(t=!1),o===void 0&&(o="cluster"),a===void 0&&(a="cluster"),e&&e.nodes){var u=e.nodes.length;if(u){var c=(0,z_.default)(e,t),l=(0,z_.default)(n,t),h=W_(e.nodes,c,t),f=W_(n.nodes,l,t),d=X_(e.nodes,o),p=d.nodeMap,g=d.nodeLabelMap,v=X_(n.nodes,o),m=v.nodeMap,y=v.nodeLabelMap;Y_(e.edges,a,p);var b=Y_(n.edges,a,m).edgeLabelMap,x=[];l==null||l.forEach(function(Ue){x=x.concat(Ue)}),i||(i=Math.max.apply(Math,(0,B_.__spreadArray)((0,B_.__spreadArray)([],x,!1),[2],!1))),r||(r=i);var w=G_(e,c,o,r),E=G_(n,l,o,r),M=function(Ue,Te,Xe,Oe,Se){var We=Math.ceil(Xe/Te),Ve={},O=0;return Oe.forEach(function(he,_e){for(var Ze=0,Je=0,qe=he.nodeIdxs,vt=he.neighborNum-1;Ze<We;){for(var pt=qe[1+Math.floor(Math.random()*vt)],Et=0;(Ve["".concat(_e,"-").concat(pt)]||Ve["".concat(pt,"-").concat(_e)])&&(pt=Math.floor(Math.random()*Te),!(++Et>2*Te)););if(Et<2*Te&&(Ve["".concat(_e,"-").concat(pt)]={start:_e,end:pt,distance:Se[_e][pt]},Ze++,++O>=Xe))return Ve;if(++Je>2*Te)break}Ze<We&&(We=(We+(We-Ze))/(Te-_e-1))}),Ve}(0,u,Math.min(100,u*(u-1)/2),w,c),_=Kf(M,w,e),k={graphs:_,nodeLabelProp:o,edgeLabelProp:a,minSupport:1,minNodeNum:1,maxNodeNum:4,directed:t},S=(0,aj.default)(k).slice(0,10),C=S.length,T=[];S.forEach(function(Ue,Te){T[Te]={},Object.keys(_).forEach(function(Xe){var Oe=_[Xe],Se=$f(Oe,Ue,o,a);T[Te][Xe]=Se})});var A=function(Ue,Te,Xe){for(var Oe=1/0,Se=0,We=function(O){var he=Ue[O],_e=Object.keys(he).sort(function(Et,Tt){return he[Et]-he[Tt]}),Ze=[];_e.forEach(function(Et,Tt){Ze[Tt%10]||(Ze[Tt%10]={graphs:[],totalCount:0,aveCount:0}),Ze[Tt%10].graphs.push(Et),Ze[Tt%10].totalCount+=he[Et]});var Je=0,qe=[];Ze.forEach(function(Et){var Tt=Et.totalCount/Et.graphs.length;Et.aveCount=Tt,qe.push(Tt);var Rt=0,ln=Et.length;Et.graphs.forEach(function(xn,ar){var Mr=he[xn];Et.graphs.forEach(function(hr,Di){ar!==Di&&(Rt+=Math.abs(Mr-he[hr]))})}),Je+=Rt/=ln*(ln-1)/2}),Je/=Ze.length;var vt=0;qe.forEach(function(Et,Tt){qe.forEach(function(Rt,ln){Tt!==ln&&(vt+=Math.abs(Et-Rt))}),vt/=qe.length*(qe.length-1)/2});var pt=vt-Je;Oe<pt&&(Oe=pt,Se=O)},Ve=0;Ve<Te;Ve++)We(Ve);return{structure:Xe[Se],structureCountMap:Ue[Se]}}(T,C,S),D=A.structure,j=A.structureCountMap,L=n.nodes[0],B=[],N=(s=n.nodes[0])===null||s===void 0?void 0:s[o],R=-1/0;n.nodes.forEach(function(Ue){var Te=Ue[o],Xe=g[Te];(Xe==null?void 0:Xe.length)>R&&(R=Xe.length,B=Xe,N=Te,L=Ue)});var P={},H={},ne={},Z={},q={},te={};Object.keys(y).forEach(function(Ue,Te){q[Ue]=[],t&&(te[Ue]=[]);var Xe=y[Ue],Oe={};Xe.forEach(function(O){var he=f["".concat(L.id,"-").concat(O.id)];if(he&&q[Ue].push(he),Oe["".concat(L.id,"-").concat(O.id)]={start:0,end:m[O.id].idx,distance:he},t){var _e=f["".concat(O.id,"-").concat(L.id)];_e&&te[Ue].push(_e)}}),q[Ue]=q[Ue].sort(function(O,he){return O-he}),t&&(te[Ue]=te[Ue].sort(function(O,he){return O-he})),H=Kf(Oe,E,n,H);var Se=[];if(Object.keys(Oe).forEach(function(O){if(ne[O])Se.push(ne[O]);else{var he=H[O];ne[O]=$f(he,D,o,a),Se.push(ne[O])}}),Se=Se.sort(function(O,he){return he-O}),Z["".concat(L.id,"-").concat(Ue)]=Se,Ue!==N)for(var We=function(O){var he=B[O],_e=w[p[he.id].idx],Ze=_e.nodeLabelCountMap[Ue],Je=y[Ue].length;if(!Ze||Ze.count<Je)return B.splice(O,1),"continue";for(var qe=!1,vt=0;vt<Je;vt++)if(Ze.dists[vt]>q[Ue][vt]){qe=!0;break}if(qe)return B.splice(O,1),"continue";var pt={};_e.neighbors.forEach(function(Rt){var ln=h["".concat(he.id,"-").concat(Rt.id)];pt["".concat(he.id,"-").concat(Rt.id)]={start:p[he.id].idx,end:p[Rt.id].idx,distance:ln}}),_=Kf(pt,w,e,_);var Et=[];Object.keys(pt).forEach(function(Rt){if(j[Rt])Et.push(j[Rt]);else{var ln=_[Rt];j[Rt]=$f(ln,D,o,a),Et.push(j[Rt])}}),Et=Et.sort(function(Rt,ln){return ln-Rt});var Tt=!1;for(vt=0;vt<Je;vt++)if(Et[vt]<Se[vt]){Tt=!0;break}return Tt?(B.splice(O,1),"continue"):void 0},Ve=((B==null?void 0:B.length)||0)-1;Ve>=0;Ve--)We(Ve)});var we=[];B==null||B.forEach(function(Ue){for(var Te=p[Ue.id].idx,Xe=U_(e.nodes,c[Te],Te,o,i).neighbors,Oe=!1,Se=Xe.length-1;Se>=0;Se--){if(Xe.length+1<n.nodes.length)return void(Oe=!0);var We=Xe[Se],Ve=We[o];if(y[Ve]&&y[Ve].length)if(q[Ve]&&q[Ve].length){var O="".concat(Ue.id,"-").concat(We.id),he=h[O],_e=q[Ve].length-1;if(he>q[Ve][_e])Xe.splice(Se,1);else{if(t){var Ze="".concat(We.id,"-").concat(Ue.id),Je=h[Ze];if(_e=te[Ve].length-1,Je>te[Ve][_e]){Xe.splice(Se,1);continue}}var qe=j[O]?j[O]:uj(e,Ue,We,p,he,w,D,o,a,j,_),vt="".concat(L.id,"-").concat(Ve);if(qe<Z[vt][Z[vt].length-1])Xe.splice(Se,1);else{var pt=V_(P,Ve,m,y),Et=pt.minPatternNodeLabelDegree;pt.minPatternNodeLabelInDegree,pt.minPatternNodeLabelOutDegree,p[We.id].degree<Et&&Xe.splice(Se,1)}}}else Xe.splice(Se,1);else Xe.splice(Se,1)}Oe||we.push({nodes:[Ue].concat(Xe)})});var pe=(0,F_.default)(n,L.id,!1).length,Me={};t?(Object.keys(pe).forEach(function(Ue){var Te=m[Ue].node[o];Me[Te]?Me[Te].push(pe[Ue]):Me[Te]=[pe[Ue]]}),Object.keys(Me).forEach(function(Ue){Me[Ue].sort(function(Te,Xe){return Te-Xe})})):Me=q;for(var Be=function(Ue){var Te=we[Ue],Xe=Te.nodes[0],Oe={},Se={};Te.nodes.forEach(function(Dt,zt){Se[Dt.id]={idx:zt,node:Dt,degree:0,inDegree:0,outDegree:0};var hn=Dt[o];Oe[hn]?Oe[hn]++:Oe[hn]=1});var We=[],Ve={};e.edges.forEach(function(Dt){Se[Dt.source]&&Se[Dt.target]&&(We.push(Dt),Ve[Dt[a]]?Ve[Dt[a]]++:Ve[Dt[a]]=1,Se[Dt.source].degree++,Se[Dt.target].degree++,Se[Dt.source].outDegree++,Se[Dt.target].inDegree++)});for(var O=Object.keys(b).length,he=!1,_e=0;_e<O;_e++){var Ze=Object.keys(b)[_e];if(!Ve[Ze]||Ve[Ze]<b[Ze].length){he=!0;break}}if(he)return we.splice(Ue,1),"continue";var Je=We.length;if(Je<n.edges.length)return we.splice(Ue,1),"break";var qe=!1,vt=function(Dt){var zt=We[Dt],hn=zt[a],cr=b[hn];if(!cr||!cr.length)return Ve[hn]--,cr&&Ve[hn]<cr.length?(qe=!0,"break"):(We.splice(Dt,1),Se[zt.source].degree--,Se[zt.target].degree--,Se[zt.source].outDegree--,Se[zt.target].inDegree--,"continue");var Ta=Se[zt.source].node[o],Go=Se[zt.target].node[o],Uo=!1;return cr.forEach(function(Oa){var Na=m[Oa.source].node,rh=m[Oa.target].node;Na[o]===Ta&&rh[o]===Go&&(Uo=!0),t||Na[o]!==Go||rh[o]!==Ta||(Uo=!0)}),Uo?void 0:(Ve[hn]--,cr&&Ve[hn]<cr.length?(qe=!0,"break"):(We.splice(Dt,1),Se[zt.source].degree--,Se[zt.target].degree--,Se[zt.source].outDegree--,Se[zt.target].inDegree--,"continue"))};for(_e=Je-1;_e>=0&&vt(_e)!=="break";_e--);if(qe)return we.splice(Ue,1),"continue";Te.edges=We;var pt=(0,F_.default)(Te,Te.nodes[0].id,!1).length;if(Object.keys(pt).reverse().forEach(function(Dt){if(Dt!==Te.nodes[0].id&&!qe){if(pt[Dt]===1/0){var zt=Se[Dt].node[o];if(Oe[zt]--,Oe[zt]<y[zt].length)return void(qe=!0);var hn=Te.nodes.indexOf(Se[Dt].node);return Te.nodes.splice(hn,1),void(Se[Dt]=void 0)}var cr=p[Dt].node[o];if(!Me[cr]||!Me[cr].length||pt[Dt]>Me[cr][Me[cr].length-1]){if(zt=Se[Dt].node[o],Oe[zt]--,Oe[zt]<y[zt].length)return void(qe=!0);hn=Te.nodes.indexOf(Se[Dt].node),Te.nodes.splice(hn,1),Se[Dt]=void 0}}}),qe)return we.splice(Ue,1),"continue";for(var Et=!0,Tt=0;Et&&!qe;){if(Et=!1,t?Se[Xe.id].degree<m[L.id].degree||Se[Xe.id].inDegree<m[L.id].inDegree||Se[Xe.id].outDegree<m[L.id].outDegree:Se[Xe.id].degree<m[L.id].degree){qe=!0;break}if(Oe[Xe[o]]<y[Xe[o]].length){qe=!0;break}for(var Rt=Te.nodes.length-1;Rt>=0;Rt--){var ln=Te.nodes[Rt],xn=Se[ln.id].degree,ar=Se[ln.id].inDegree,Mr=Se[ln.id].outDegree,hr=ln[o],Di=V_(P,hr,m,y),ks=Di.minPatternNodeLabelDegree,Vu=Di.minPatternNodeLabelInDegree,Fo=Di.minPatternNodeLabelOutDegree;if(t?xn<ks||ar<Vu||Mr<Fo:xn<ks){if(Oe[ln[o]]--,Oe[ln[o]]<y[ln[o]].length){qe=!0;break}Te.nodes.splice(Rt,1),Se[ln.id]=void 0,Et=!0}}if(qe||!Et&&Tt!==0)break;for(var sr=(Je=We.length)-1;sr>=0;sr--){var ur=We[sr];if(!Se[ur.source]||!Se[ur.target]){We.splice(sr,1);var sn=ur[a];if(Ve[sn]--,Se[ur.source]&&(Se[ur.source].degree--,Se[ur.source].outDegree--),Se[ur.target]&&(Se[ur.target].degree--,Se[ur.target].inDegree--),b[sn]&&Ve[sn]<b[sn].length){qe=!0;break}Et=!0}}Tt++}return qe||qe||Te.nodes.length<n.nodes.length||We.length<n.edges.length?(we.splice(Ue,1),"continue"):void 0},dt=we.length-1;dt>=0&&Be(dt)!=="break";dt--);var It=we.length,at=function(Ue){var Te=we[Ue],Xe={};Te.edges.forEach(function(We){var Ve="".concat(We.source,"-").concat(We.target,"-").concat(We.label);Xe[Ve]?Xe[Ve]++:Xe[Ve]=1});for(var Oe=function(We){var Ve=we[We],O={};Ve.edges.forEach(function(_e){var Ze="".concat(_e.source,"-").concat(_e.target,"-").concat(_e.label);O[Ze]?O[Ze]++:O[Ze]=1});var he=!0;Object.keys(O).length!==Object.keys(Xe).length?he=!1:Object.keys(Xe).forEach(function(_e){O[_e]!==Xe[_e]&&(he=!1)}),he&&we.splice(We,1)},Se=It-1;Se>Ue;Se--)Oe(Se);It=we.length};for(dt=0;dt<=It-1;dt++)at(dt);return we}}};function Gv(e){return Gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Gv(e)}Hf.default=cj,function(e){function n(b){return n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},n(b)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"GADDI",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(e,"breadthFirstSearch",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"connectedComponent",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"depthFirstSearch",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"detectCycle",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"dijkstra",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"findAllPath",{enumerable:!0,get:function(){return c.findAllPath}}),Object.defineProperty(e,"findShortestPath",{enumerable:!0,get:function(){return c.findShortestPath}}),Object.defineProperty(e,"floydWarshall",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"getAdjMatrix",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"getDegree",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"getInDegree",{enumerable:!0,get:function(){return o.getInDegree}}),Object.defineProperty(e,"getNeighbors",{enumerable:!0,get:function(){return v.getNeighbors}}),Object.defineProperty(e,"getOutDegree",{enumerable:!0,get:function(){return o.getOutDegree}}),Object.defineProperty(e,"labelPropagation",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(e,"louvain",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(e,"minimumSpanningTree",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(e,"pageRank",{enumerable:!0,get:function(){return p.default}});var t=y(Ja),r=y(Rf),i=y(oa),o=function(b,x){if(b&&b.__esModule)return b;if(b===null||n(b)!=="object"&&typeof b!="function")return{default:b};var w=m(x);if(w&&w.has(b))return w.get(b);var E={},M=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var _ in b)if(_!=="default"&&Object.prototype.hasOwnProperty.call(b,_)){var k=M?Object.getOwnPropertyDescriptor(b,_):null;k&&(k.get||k.set)?Object.defineProperty(E,_,k):E[_]=b[_]}return E.default=b,w&&w.set(b,E),E}(yo),a=y($i),s=y(zf),u=y(nu),c=ru,l=y(Bc),h=y(Gf),f=y(Uf),d=y(Xf),p=y(Vf),g=y(Hf),v=Fn;function m(b){if(typeof WeakMap!="function")return null;var x=new WeakMap,w=new WeakMap;return(m=function(E){return E?w:x})(b)}function y(b){return b&&b.__esModule?b:{default:b}}}(c_),Object.defineProperty(Lf,"__esModule",{value:!0}),Lf.default=void 0;var Uv=function(e,n){if(e&&e.__esModule)return e;if(e===null||Gv(e)!=="object"&&typeof e!="function")return{default:e};var t=q_(n);if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}(c_),H_=ia;function q_(e){if(typeof WeakMap!="function")return null;var n=new WeakMap,t=new WeakMap;return(q_=function(r){return r?t:n})(e)}var Xv=typeof self<"u"?self:{};Xv.onmessage=function(e){var n=e.data,t=n._algorithmType,r=n.data;if(t)if(typeof Uv[t]!="function")Xv.postMessage({_algorithmType:H_.MESSAGE.FAILURE});else{var i=Uv[t].apply(Uv,r);Xv.postMessage({_algorithmType:H_.MESSAGE.SUCCESS,data:i})}},Lf.default=null,Object.defineProperty(Pf,"__esModule",{value:!0}),Pf.default=void 0;var lj=ia,hj=function(e){return e&&e.__esModule?e:{default:e}}(Lf),fj=function(e){return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return new Promise(function(r,i){var o=new hj.default;o.postMessage({_algorithmType:e,data:n}),o.onmessage=function(a){var s=a.data,u=s.data,c=s._algorithmType;lj.MESSAGE.SUCCESS===c?r(u):i(),o.terminate()}})}};Pf.default=fj,Object.defineProperty(tn,"__esModule",{value:!0}),tn.pageRankAsync=tn.minimumSpanningTreeAsync=tn.louvainAsync=tn.labelPropagationAsync=tn.getOutDegreeAsync=tn.getNeighborsAsync=tn.getInDegreeAsync=tn.getDegreeAsync=tn.getAdjMatrixAsync=tn.floydWarshallAsync=tn.findShortestPathAsync=tn.findAllPathAsync=tn.dijkstraAsync=tn.detectCycleAsync=tn.detectAllUndirectedCycleAsync=tn.detectAllDirectedCycleAsync=tn.detectAllCyclesAsync=tn.connectedComponentAsync=tn.GADDIAsync=void 0;var Wn=function(e){return e&&e.__esModule?e:{default:e}}(Pf),Vn=ia;tn.getAdjMatrixAsync=function(e,n){return(0,Wn.default)(Vn.ALGORITHM.getAdjMatrix).apply(void 0,[e,n])},tn.connectedComponentAsync=function(e,n){return(0,Wn.default)(Vn.ALGORITHM.connectedComponent).apply(void 0,[e,n])},tn.getDegreeAsync=function(e){return(0,Wn.default)(Vn.ALGORITHM.getDegree)(e)},tn.getInDegreeAsync=function(e,n){return(0,Wn.default)(Vn.ALGORITHM.getInDegree)(e,n)},tn.getOutDegreeAsync=function(e,n){return(0,Wn.default)(Vn.ALGORITHM.getOutDegree)(e,n)},tn.detectCycleAsync=function(e){return(0,Wn.default)(Vn.ALGORITHM.detectCycle)(e)},tn.detectAllCyclesAsync=function(e){return(0,Wn.default)(Vn.ALGORITHM.detectAllCycles)(e)},tn.detectAllDirectedCycleAsync=function(e){return(0,Wn.default)(Vn.ALGORITHM.detectAllDirectedCycle)(e)},tn.detectAllUndirectedCycleAsync=function(e){return(0,Wn.default)(Vn.ALGORITHM.detectAllUndirectedCycle)(e)},tn.dijkstraAsync=function(e,n,t,r){return(0,Wn.default)(Vn.ALGORITHM.dijkstra).apply(void 0,[e,n,t,r])},tn.findAllPathAsync=function(e,n,t,r){return(0,Wn.default)(Vn.ALGORITHM.findAllPath).apply(void 0,[e,n,t,r])},tn.findShortestPathAsync=function(e,n,t,r,i){return(0,Wn.default)(Vn.ALGORITHM.findShortestPath).apply(void 0,[e,n,t,r,i])},tn.floydWarshallAsync=function(e,n){return(0,Wn.default)(Vn.ALGORITHM.floydWarshall).apply(void 0,[e,n])},tn.labelPropagationAsync=function(e,n,t,r){return r===void 0&&(r=1e3),(0,Wn.default)(Vn.ALGORITHM.labelPropagation)(e,n,t,r)},tn.louvainAsync=function(e,n,t,r){return(0,Wn.default)(Vn.ALGORITHM.louvain)(e,n,t,r)},tn.minimumSpanningTreeAsync=function(e,n,t){return(0,Wn.default)(Vn.ALGORITHM.minimumSpanningTree).apply(void 0,[e,n,t])},tn.pageRankAsync=function(e,n,t){return(0,Wn.default)(Vn.ALGORITHM.pageRank).apply(void 0,[e,n,t])},tn.getNeighborsAsync=function(e,n,t){return(0,Wn.default)(Vn.ALGORITHM.getNeighbors).apply(void 0,[e,n,t])},tn.GADDIAsync=function(e,n,t,r,i,o,a){return t===void 0&&(t=!1),o===void 0&&(o="cluster"),a===void 0&&(a="cluster"),(0,Wn.default)(Vn.ALGORITHM.GADDI).apply(void 0,[e,n,t,r,i,o,a])},function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"GADDIAsync",{enumerable:!0,get:function(){return n.GADDIAsync}}),Object.defineProperty(e,"connectedComponentAsync",{enumerable:!0,get:function(){return n.connectedComponentAsync}}),e.default=void 0,Object.defineProperty(e,"detectAllCyclesAsync",{enumerable:!0,get:function(){return n.detectAllCyclesAsync}}),Object.defineProperty(e,"detectAllDirectedCycleAsync",{enumerable:!0,get:function(){return n.detectAllDirectedCycleAsync}}),Object.defineProperty(e,"detectAllUndirectedCycleAsync",{enumerable:!0,get:function(){return n.detectAllUndirectedCycleAsync}}),Object.defineProperty(e,"detectCycleAsync",{enumerable:!0,get:function(){return n.detectCycleAsync}}),e.detectDirectedCycleAsync=void 0,Object.defineProperty(e,"dijkstraAsync",{enumerable:!0,get:function(){return n.dijkstraAsync}}),Object.defineProperty(e,"findAllPathAsync",{enumerable:!0,get:function(){return n.findAllPathAsync}}),Object.defineProperty(e,"findShortestPathAsync",{enumerable:!0,get:function(){return n.findShortestPathAsync}}),Object.defineProperty(e,"floydWarshallAsync",{enumerable:!0,get:function(){return n.floydWarshallAsync}}),Object.defineProperty(e,"getAdjMatrixAsync",{enumerable:!0,get:function(){return n.getAdjMatrixAsync}}),Object.defineProperty(e,"getDegreeAsync",{enumerable:!0,get:function(){return n.getDegreeAsync}}),Object.defineProperty(e,"getInDegreeAsync",{enumerable:!0,get:function(){return n.getInDegreeAsync}}),Object.defineProperty(e,"getNeighborsAsync",{enumerable:!0,get:function(){return n.getNeighborsAsync}}),Object.defineProperty(e,"getOutDegreeAsync",{enumerable:!0,get:function(){return n.getOutDegreeAsync}}),Object.defineProperty(e,"labelPropagationAsync",{enumerable:!0,get:function(){return n.labelPropagationAsync}}),Object.defineProperty(e,"louvainAsync",{enumerable:!0,get:function(){return n.louvainAsync}}),Object.defineProperty(e,"minimumSpanningTreeAsync",{enumerable:!0,get:function(){return n.minimumSpanningTreeAsync}}),Object.defineProperty(e,"pageRankAsync",{enumerable:!0,get:function(){return n.pageRankAsync}});var n=tn,t=n.detectCycleAsync;e.detectDirectedCycleAsync=t;var r={getAdjMatrixAsync:n.getAdjMatrixAsync,connectedComponentAsync:n.connectedComponentAsync,getDegreeAsync:n.getDegreeAsync,getInDegreeAsync:n.getInDegreeAsync,getOutDegreeAsync:n.getOutDegreeAsync,detectCycleAsync:n.detectCycleAsync,detectDirectedCycleAsync:t,detectAllCyclesAsync:n.detectAllCyclesAsync,detectAllDirectedCycleAsync:n.detectAllDirectedCycleAsync,detectAllUndirectedCycleAsync:n.detectAllUndirectedCycleAsync,dijkstraAsync:n.dijkstraAsync,findAllPathAsync:n.findAllPathAsync,findShortestPathAsync:n.findShortestPathAsync,floydWarshallAsync:n.floydWarshallAsync,labelPropagationAsync:n.labelPropagationAsync,louvainAsync:n.louvainAsync,minimumSpanningTreeAsync:n.minimumSpanningTreeAsync,pageRankAsync:n.pageRankAsync,getNeighborsAsync:n.getNeighborsAsync,GADDIAsync:n.GADDIAsync};e.default=r}(Ov);const dj=_P({__proto__:null,default:Bi(Ov)},[Ov]);function Z_(e,n,t,r){var i=e-t,o=n-r;return Math.sqrt(i*i+o*o)}function ts(e,n,t,r,i,o){return i>=e&&i<=e+t&&o>=n&&o<=n+r}function Uc(e,n){return!(n.minX>e.maxX||n.maxX<e.minX||n.minY>e.maxY||n.maxY<e.minY)}function K_(e,n){return e[0]===n[0]&&e[1]===n[1]}var pj=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,gj=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,vj=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,$_=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function Q_(e,n){ye(e.match($_),function(t){var r=t.split(":");n.addColorStop(r[0],r[1])})}function mj(e,n,t){var r=n.getBBox();if(isNaN(r.x)||isNaN(r.y)||isNaN(r.width)||isNaN(r.height))return t;if(Re(t)){if(t[1]==="("||t[2]==="("){if(t[0]==="l")return function(i,o,a){var s,u,c=pj.exec(a),l=parseFloat(c[1])%360*(Math.PI/180),h=c[2],f=o.getBBox();l>=0&&l<.5*Math.PI?(s={x:f.minX,y:f.minY},u={x:f.maxX,y:f.maxY}):.5*Math.PI<=l&&l<Math.PI?(s={x:f.maxX,y:f.minY},u={x:f.minX,y:f.maxY}):Math.PI<=l&&l<1.5*Math.PI?(s={x:f.maxX,y:f.maxY},u={x:f.minX,y:f.minY}):(s={x:f.minX,y:f.maxY},u={x:f.maxX,y:f.minY});var d=Math.tan(l),p=d*d,g=(u.x-s.x+d*(u.y-s.y))/(p+1)+s.x,v=d*(u.x-s.x+d*(u.y-s.y))/(p+1)+s.y,m=i.createLinearGradient(s.x,s.y,g,v);return Q_(h,m),m}(e,n,t);if(t[0]==="r")return function(i,o,a){var s=gj.exec(a),u=parseFloat(s[1]),c=parseFloat(s[2]),l=parseFloat(s[3]),h=s[4];if(l===0){var f=h.match($_);return f[f.length-1].split(":")[1]}var d=o.getBBox(),p=d.maxX-d.minX,g=d.maxY-d.minY,v=Math.sqrt(p*p+g*g)/2,m=i.createRadialGradient(d.minX+p*u,d.minY+g*c,0,d.minX+p/2,d.minY+g/2,l*v);return Q_(h,m),m}(e,n,t);if(t[0]==="p")return function(i,o,a){if(o.get("patternSource")&&o.get("patternSource")===a)return o.get("pattern");var s,u,c=vj.exec(a),l=c[1],h=c[2];function f(){s=i.createPattern(u,l),o.set("pattern",s),o.set("patternSource",a)}switch(l){case"a":l="repeat";break;case"x":l="repeat-x";break;case"y":l="repeat-y";break;default:l="no-repeat"}return u=new Image,h.match(/^data:/i)||(u.crossOrigin="Anonymous"),u.src=h,u.complete?f():(u.onload=f,u.src=u.src),s}(e,n,t)}return t}return t instanceof CanvasPattern?t:void 0}function Qf(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Yv(e,n){return Qf(e)*Qf(n)?(e[0]*n[0]+e[1]*n[1])/(Qf(e)*Qf(n)):1}function J_(e,n){return(e[0]*n[1]<e[1]*n[0]?-1:1)*Math.acos(Yv(e,n))}function ek(e,n){var t=n[1],r=n[2],i=Fh(Gh(n[3]),2*Math.PI),o=n[4],a=n[5],s=e[0],u=e[1],c=n[6],l=n[7],h=Math.cos(i)*(s-c)/2+Math.sin(i)*(u-l)/2,f=-1*Math.sin(i)*(s-c)/2+Math.cos(i)*(u-l)/2,d=h*h/(t*t)+f*f/(r*r);d>1&&(t*=Math.sqrt(d),r*=Math.sqrt(d));var p=t*t*(f*f)+r*r*(h*h),g=p?Math.sqrt((t*t*(r*r)-p)/p):1;o===a&&(g*=-1),isNaN(g)&&(g=0);var v=r?g*t*f/r:0,m=t?g*-r*h/t:0,y=(s+c)/2+Math.cos(i)*v-Math.sin(i)*m,b=(u+l)/2+Math.sin(i)*v+Math.cos(i)*m,x=[(h-v)/t,(f-m)/r],w=[(-1*h-v)/t,(-1*f-m)/r],E=J_([1,0],x),M=J_(x,w);return Yv(x,w)<=-1&&(M=Math.PI),Yv(x,w)>=1&&(M=0),a===0&&M>0&&(M-=2*Math.PI),a===1&&M<0&&(M+=2*Math.PI),{cx:y,cy:b,rx:K_(e,[c,l])?0:t,ry:K_(e,[c,l])?0:r,startAngle:E,endAngle:E+M,xRotation:i,arcFlag:o,sweepFlag:a}}var Jf=Math.sin,ed=Math.cos,Wv=Math.atan2,td=Math.PI;function tk(e,n,t,r,i,o,a){var s=n.stroke,u=n.lineWidth,c=Wv(r-o,t-i),l=new Qv({type:"path",canvas:e.get("canvas"),isArrowShape:!0,attrs:{path:"M"+10*ed(td/6)+","+10*Jf(td/6)+" L0,0 L"+10*ed(td/6)+",-"+10*Jf(td/6),stroke:s,lineWidth:u}});l.translate(i,o),l.rotateAtPoint(i,o,c),e.set(a?"startArrowShape":"endArrowShape",l)}function nk(e,n,t,r,i,o,a){var s=n.startArrow,u=n.endArrow,c=n.stroke,l=n.lineWidth,h=a?s:u,f=h.d,d=h.fill,p=h.stroke,g=h.lineWidth,v=Yn(h,["d","fill","stroke","lineWidth"]),m=Wv(r-o,t-i);f&&(i-=ed(m)*f,o-=Jf(m)*f);var y=new Qv({type:"path",canvas:e.get("canvas"),isArrowShape:!0,attrs:F(F({},v),{stroke:p||c,lineWidth:g||l,fill:d})});y.translate(i,o),y.rotateAtPoint(i,o,m),e.set(a?"startArrowShape":"endArrowShape",y)}function ns(e,n,t,r,i){var o=Wv(r-n,t-e);return{dx:ed(o)*i,dy:Jf(o)*i}}function Vv(e,n,t,r,i,o){typeof n.startArrow=="object"?nk(e,n,t,r,i,o,!0):n.startArrow?tk(e,n,t,r,i,o,!0):e.set("startArrowShape",null)}function Hv(e,n,t,r,i,o){typeof n.endArrow=="object"?nk(e,n,t,r,i,o,!1):n.endArrow?tk(e,n,t,r,i,o,!1):e.set("startArrowShape",null)}var rk={fill:"fillStyle",stroke:"strokeStyle",opacity:"globalAlpha"};function ou(e,n){var t=n.attr();for(var r in t){var i=t[r],o=rk[r]?rk[r]:r;o==="matrix"&&i?e.transform(i[0],i[1],i[3],i[4],i[6],i[7]):o==="lineDash"&&e.setLineDash?Mt(i)&&e.setLineDash(i):(o==="strokeStyle"||o==="fillStyle"?i=mj(e,n,i):o==="globalAlpha"&&(i*=e.globalAlpha),e[o]=i)}}function qv(e,n,t){for(var r=0;r<n.length;r++){var i=n[r];i.cfg.visible?i.draw(e,t):i.skipDraw()}}function yj(e,n,t){var r=e.get("refreshElements");ye(r,function(i){if(i!==e)for(var o=i.cfg.parent;o&&o!==e&&!o.cfg.refresh;)o.cfg.refresh=!0,o=o.cfg.parent}),r[0]===e?Kv(n):Zv(n,t)}function Zv(e,n){for(var t=0;t<e.length;t++){var r=e[t];if(r.cfg.visible)if(r.cfg.hasChanged)r.cfg.refresh=!0,r.isGroup()&&Kv(r.cfg.children);else if(r.cfg.refresh)r.isGroup()&&Zv(r.cfg.children,n);else{var i=bj(r,n);r.cfg.refresh=i,i&&r.isGroup()&&Zv(r.cfg.children,n)}}}function ik(e){for(var n=0;n<e.length;n++){var t=e[n];t.cfg.hasChanged=!1,t.isGroup()&&!t.destroyed&&ik(t.cfg.children)}}function Kv(e,n){for(var t=0;t<e.length;t++){var r=e[t];r.cfg.visible&&(r.cfg.refresh=!0,r.isGroup()&&Kv(r.get("children")))}}function bj(e,n){var t=e.cfg.cacheCanvasBBox;return e.cfg.isInView&&t&&Uc(t,n)}function ok(e,n,t,r){var i=t.path,o=t.startArrow,a=t.endArrow;if(i){var s=[0,0],u=[0,0],c={dx:0,dy:0};n.beginPath();for(var l=0;l<i.length;l++){var h=i[l],f=h[0];if(l===0&&o&&o.d)c=ns((d=e.getStartTangent())[0][0],d[0][1],d[1][0],d[1][1],o.d);else if(l===i.length-2&&i[l+1][0]==="Z"&&a&&a.d)i[l+1][0]==="Z"&&(c=ns((d=e.getEndTangent())[0][0],d[0][1],d[1][0],d[1][1],a.d));else if(l===i.length-1&&a&&a.d){var d;i[0]!=="Z"&&(c=ns((d=e.getEndTangent())[0][0],d[0][1],d[1][0],d[1][1],a.d))}var p=c.dx,g=c.dy;switch(f){case"M":n.moveTo(h[1]-p,h[2]-g),u=[h[1],h[2]];break;case"L":n.lineTo(h[1]-p,h[2]-g);break;case"Q":n.quadraticCurveTo(h[1],h[2],h[3]-p,h[4]-g);break;case"C":n.bezierCurveTo(h[1],h[2],h[3],h[4],h[5]-p,h[6]-g);break;case"A":var v=void 0;r?(v=r[l])||(v=ek(s,h),r[l]=v):v=ek(s,h);var m=v.cx,y=v.cy,b=v.rx,x=v.ry,w=v.startAngle,E=v.endAngle,M=v.xRotation,_=v.sweepFlag;if(n.ellipse)n.ellipse(m,y,b,x,M,w,E,1-_);else{var k=b>x?b:x,S=b>x?1:b/x,C=b>x?x/b:1;n.translate(m,y),n.rotate(M),n.scale(S,C),n.arc(0,0,k,w,E,1-_),n.scale(1/S,1/C),n.rotate(-M),n.translate(-m,-y)}break;case"Z":n.closePath()}if(f==="Z")s=u;else{var T=h.length;s=[h[T-2],h[T-1]]}}}}function ak(e,n){var t=e.get("canvas");t&&(n==="remove"&&(e._cacheCanvasBBox=e.get("cacheCanvasBBox")),e.get("hasChanged")||(e.set("hasChanged",!0),e.cfg.parent&&e.cfg.parent.get("hasChanged")||(t.refreshElement(e,n,t),t.get("autoDraw")&&t.draw())))}function xj(e){var n,t,r;if(e.destroyed)n=e._cacheCanvasBBox;else{var i=e.get("cacheCanvasBBox"),o=i&&!(!i.width||!i.height),a=e.getCanvasBBox(),s=a&&!(!a.width||!a.height);o&&s?(r=a,n=(t=i)&&r?{minX:Math.min(t.minX,r.minX),minY:Math.min(t.minY,r.minY),maxX:Math.max(t.maxX,r.maxX),maxY:Math.max(t.maxY,r.maxY)}:t||r):o?n=i:s&&(n=a)}return n}var sk=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.onCanvasChange=function(t){ak(this,t)},n.prototype.getShapeBase=function(){return Vg},n.prototype.getGroupBase=function(){return n},n.prototype._applyClip=function(t,r){r&&(t.save(),ou(t,r),r.createPath(t),t.restore(),t.clip(),r._afterDraw())},n.prototype.cacheCanvasBBox=function(){var t=this.cfg.children,r=[],i=[];ye(t,function(f){var d=f.cfg.cacheCanvasBBox;d&&f.cfg.isInView&&(r.push(d.minX,d.maxX),i.push(d.minY,d.maxY))});var o=null;if(r.length){var a=Fi(r),s=zi(r),u=Fi(i),c=zi(i);o={minX:a,minY:u,x:a,y:u,maxX:s,maxY:c,width:s-a,height:c-u};var l=this.cfg.canvas;if(l){var h=l.getViewRange();this.set("isInView",Uc(o,h))}}else this.set("isInView",!1);this.set("cacheCanvasBBox",o)},n.prototype.draw=function(t,r){var i=this.cfg.children,o=!r||this.cfg.refresh;i.length&&o&&(t.save(),ou(t,this),this._applyClip(t,this.getClip()),qv(t,i,r),t.restore(),this.cacheCanvasBBox()),this.cfg.refresh=null,this.set("hasChanged",!1)},n.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("hasChanged",!1)},n}(oS),wi=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},n.prototype.getShapeBase=function(){return Vg},n.prototype.getGroupBase=function(){return sk},n.prototype.onCanvasChange=function(t){ak(this,t)},n.prototype.calculateBBox=function(){var t=this.get("type"),r=this.getHitLineWidth(),i=uS(t)(this),o=r/2,a=i.x-o,s=i.y-o,u=i.x+i.width+o,c=i.y+i.height+o;return{x:a,minX:a,y:s,minY:s,width:i.width+r,height:i.height+r,maxX:u,maxY:c}},n.prototype.isFill=function(){return!!this.attrs.fill||this.isClipShape()},n.prototype.isStroke=function(){return!!this.attrs.stroke},n.prototype._applyClip=function(t,r){r&&(t.save(),ou(t,r),r.createPath(t),t.restore(),t.clip(),r._afterDraw())},n.prototype.draw=function(t,r){var i=this.cfg.clipShape;if(r){if(this.cfg.refresh===!1)return void this.set("hasChanged",!1);if(!Uc(r,this.getCanvasBBox()))return this.set("hasChanged",!1),void(this.cfg.isInView&&this._afterDraw())}t.save(),ou(t,this),this._applyClip(t,i),this.drawPath(t),t.restore(),this._afterDraw()},n.prototype.getCanvasViewBox=function(){var t=this.cfg.canvas;return t?t.getViewRange():null},n.prototype.cacheCanvasBBox=function(){var t=this.getCanvasViewBox();if(t){var r=this.getCanvasBBox(),i=Uc(r,t);this.set("isInView",i),i?this.set("cacheCanvasBBox",r):this.set("cacheCanvasBBox",null)}},n.prototype._afterDraw=function(){this.cacheCanvasBBox(),this.set("hasChanged",!1),this.set("refresh",null)},n.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("isInView",null),this.set("hasChanged",!1)},n.prototype.drawPath=function(t){this.createPath(t),this.strokeAndFill(t),this.afterDrawPath(t)},n.prototype.fill=function(t){t.fill()},n.prototype.stroke=function(t){t.stroke()},n.prototype.strokeAndFill=function(t){var r=this.attrs,i=r.lineWidth,o=r.opacity,a=r.strokeOpacity,s=r.fillOpacity;this.isFill()&&(yt(s)||s===1?this.fill(t):(t.globalAlpha=s,this.fill(t),t.globalAlpha=o)),this.isStroke()&&i>0&&(yt(a)||a===1||(t.globalAlpha=a),this.stroke(t)),this.afterDrawPath(t)},n.prototype.createPath=function(t){},n.prototype.afterDrawPath=function(t){},n.prototype.isInShape=function(t,r){var i=this.isStroke(),o=this.isFill(),a=this.getHitLineWidth();return this.isInStrokeOrPath(t,r,i,o,a)},n.prototype.isInStrokeOrPath=function(t,r,i,o,a){return!1},n.prototype.getHitLineWidth=function(){if(!this.isStroke())return 0;var t=this.attrs;return t.lineWidth+t.lineAppendWidth},n}(aS),wj=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{x:0,y:0,r:0})},n.prototype.isInStrokeOrPath=function(t,r,i,o,a){var s=this.attr(),u=s.x,c=s.y,l=s.r,h=a/2,f=Z_(u,c,t,r);return o&&i?f<=l+h:o?f<=l:!!i&&f>=l-h&&f<=l+h},n.prototype.createPath=function(t){var r=this.attr(),i=r.x,o=r.y,a=r.r;t.beginPath(),t.arc(i,o,a,0,2*Math.PI,!1),t.closePath()},n}(wi);function nd(e,n,t,r){return e/(t*t)+n/(r*r)}var Ej=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{x:0,y:0,rx:0,ry:0})},n.prototype.isInStrokeOrPath=function(t,r,i,o,a){var s=this.attr(),u=a/2,c=s.x,l=s.y,h=s.rx,f=s.ry,d=(t-c)*(t-c),p=(r-l)*(r-l);return o&&i?nd(d,p,h+u,f+u)<=1:o?nd(d,p,h,f)<=1:!!i&&nd(d,p,h-u,f-u)>=1&&nd(d,p,h+u,f+u)<=1},n.prototype.createPath=function(t){var r=this.attr(),i=r.x,o=r.y,a=r.rx,s=r.ry;if(t.beginPath(),t.ellipse)t.ellipse(i,o,a,s,0,0,2*Math.PI,!1);else{var u=a>s?a:s,c=a>s?1:a/s,l=a>s?s/a:1;t.save(),t.translate(i,o),t.scale(c,l),t.arc(0,0,u,0,2*Math.PI),t.restore(),t.closePath()}},n}(wi);function uk(e){return e instanceof HTMLElement&&Re(e.nodeName)&&e.nodeName.toUpperCase()==="CANVAS"}var Mj=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{x:0,y:0,width:0,height:0})},n.prototype.initAttrs=function(t){this._setImage(t.img)},n.prototype.isStroke=function(){return!1},n.prototype.isOnlyHitBox=function(){return!0},n.prototype._afterLoading=function(){if(this.get("toDraw")===!0){var t=this.get("canvas");t?t.draw():this.createPath(this.get("context"))}},n.prototype._setImage=function(t){var r=this,i=this.attrs;if(Re(t)){var o=new Image;o.onload=function(){if(r.destroyed)return!1;r.attr("img",o),r.set("loading",!1),r._afterLoading();var a=r.get("callback");a&&a.call(r)},o.crossOrigin="Anonymous",o.src=t,this.set("loading",!0)}else t instanceof Image?(i.width||(i.width=t.width),i.height||(i.height=t.height)):uk(t)&&(i.width||(i.width=Number(t.getAttribute("width"))),i.height||(i.height,Number(t.getAttribute("height"))))},n.prototype.onAttrChange=function(t,r,i){e.prototype.onAttrChange.call(this,t,r,i),t==="img"&&this._setImage(r)},n.prototype.createPath=function(t){if(this.get("loading"))return this.set("toDraw",!0),void this.set("context",t);var r=this.attr(),i=r.x,o=r.y,a=r.width,s=r.height,u=r.sx,c=r.sy,l=r.swidth,h=r.sheight,f=r.img;(f instanceof Image||uk(f))&&(yt(u)||yt(c)||yt(l)||yt(h)?t.drawImage(f,i,o,a,s):t.drawImage(f,u,c,l,h,i,o,a,s))},n}(wi);function aa(e,n,t,r,i,o,a){var s=Math.min(e,t),u=Math.max(e,t),c=Math.min(n,r),l=Math.max(n,r),h=i/2;return o>=s-h&&o<=u+h&&a>=c-h&&a<=l+h&&pr.pointToLine(e,n,t,r,o,a)<=i/2}var Sj=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},n.prototype.initAttrs=function(t){this.setArrow()},n.prototype.onAttrChange=function(t,r,i){e.prototype.onAttrChange.call(this,t,r,i),this.setArrow()},n.prototype.setArrow=function(){var t=this.attr(),r=t.x1,i=t.y1,o=t.x2,a=t.y2,s=t.startArrow,u=t.endArrow;s&&Vv(this,t,o,a,r,i),u&&Hv(this,t,r,i,o,a)},n.prototype.isInStrokeOrPath=function(t,r,i,o,a){if(!i||!a)return!1;var s=this.attr();return aa(s.x1,s.y1,s.x2,s.y2,a,t,r)},n.prototype.createPath=function(t){var r=this.attr(),i=r.x1,o=r.y1,a=r.x2,s=r.y2,u=r.startArrow,c=r.endArrow,l={dx:0,dy:0},h={dx:0,dy:0};u&&u.d&&(l=ns(i,o,a,s,r.startArrow.d)),c&&c.d&&(h=ns(i,o,a,s,r.endArrow.d)),t.beginPath(),t.moveTo(i+l.dx,o+l.dy),t.lineTo(a-h.dx,s-h.dy)},n.prototype.afterDrawPath=function(t){var r=this.get("startArrowShape"),i=this.get("endArrowShape");r&&r.draw(t),i&&i.draw(t)},n.prototype.getTotalLength=function(){var t=this.attr(),r=t.x1,i=t.y1,o=t.x2,a=t.y2;return pr.length(r,i,o,a)},n.prototype.getPoint=function(t){var r=this.attr(),i=r.x1,o=r.y1,a=r.x2,s=r.y2;return pr.pointAt(i,o,a,s,t)},n}(wi),_j={circle:function(e,n,t){return[["M",e-t,n],["A",t,t,0,1,0,e+t,n],["A",t,t,0,1,0,e-t,n]]},square:function(e,n,t){return[["M",e-t,n-t],["L",e+t,n-t],["L",e+t,n+t],["L",e-t,n+t],["Z"]]},diamond:function(e,n,t){return[["M",e-t,n],["L",e,n-t],["L",e+t,n],["L",e,n+t],["Z"]]},triangle:function(e,n,t){var r=t*Math.sin(.3333333333333333*Math.PI);return[["M",e-t,n+r],["L",e,n-r],["L",e+t,n+r],["Z"]]},"triangle-down":function(e,n,t){var r=t*Math.sin(.3333333333333333*Math.PI);return[["M",e-t,n-r],["L",e+t,n-r],["L",e,n+r],["Z"]]}},kj=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.initAttrs=function(t){this._resetParamsCache()},n.prototype._resetParamsCache=function(){this.set("paramsCache",{})},n.prototype.onAttrChange=function(t,r,i){e.prototype.onAttrChange.call(this,t,r,i),["symbol","x","y","r","radius"].indexOf(t)!==-1&&this._resetParamsCache()},n.prototype.isOnlyHitBox=function(){return!0},n.prototype._getR=function(t){return yt(t.r)?t.radius:t.r},n.prototype._getPath=function(){var t,r,i=this.attr(),o=i.x,a=i.y,s=i.symbol||"circle",u=this._getR(i);if(mn(s))r=kS(r=(t=s)(o,a,u));else{if(!(t=n.Symbols[s]))return null;r=t(o,a,u)}return r},n.prototype.createPath=function(t){ok(this,t,{path:this._getPath()},this.get("paramsCache"))},n.Symbols=_j,n}(wi);function ck(e,n,t){var r=wS();return e.createPath(r),r.isPointInPath(n,t)}function $v(e){return Math.abs(e)<1e-6?0:e<0?-1:1}function Cj(e,n,t){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])&&Math.min(e[0],n[0])<=t[0]&&t[0]<=Math.max(e[0],n[0])&&Math.min(e[1],n[1])<=t[1]&&t[1]<=Math.max(e[1],n[1])}function lk(e,n,t){var r=!1,i=e.length;if(i<=2)return!1;for(var o=0;o<i;o++){var a=e[o],s=e[(o+1)%i];if(Cj(a,s,[n,t]))return!0;$v(a[1]-t)>0!=$v(s[1]-t)>0&&$v(n-(t-a[1])*(a[0]-s[0])/(a[1]-s[1])-a[0])<0&&(r=!r)}return r}function Xc(e,n,t,r,i,o,a,s){var u=(Math.atan2(s-n,a-e)+2*Math.PI)%(2*Math.PI);if(u<r||u>i)return!1;var c={x:e+t*Math.cos(u),y:n+t*Math.sin(u)};return Z_(c.x,c.y,a,s)<=o/2}var Aj=Qr;const rd=F({hasArc:function(e){for(var n=!1,t=e.length,r=0;r<t;r++){var i=e[r][0];if(i==="C"||i==="A"||i==="Q"){n=!0;break}}return n},extractPolygons:function(e){for(var n=e.length,t=[],r=[],i=[],o=0;o<n;o++){var a=e[o],s=a[0];s==="M"?(i.length&&(r.push(i),i=[]),i.push([a[1],a[2]])):s==="Z"?i.length&&(t.push(i),i=[]):i.push([a[1],a[2]])}return i.length>0&&r.push(i),{polygons:t,polylines:r}},isPointInStroke:function(e,n,t,r,i){for(var o=!1,a=n/2,s=0;s<e.length;s++){var u=e[s],c=u.currentPoint,l=u.params,h=u.prePoint,f=u.box;if(!f||ts(f.x-a,f.y-a,f.width+n,f.height+n,t,r)){switch(u.command){case"L":case"Z":o=aa(h[0],h[1],c[0],c[1],n,t,r);break;case"Q":o=vS.pointDistance(h[0],h[1],l[1],l[2],l[3],l[4],t,r)<=n/2;break;case"C":o=Nc.pointDistance(h[0],h[1],l[1],l[2],l[3],l[4],l[5],l[6],t,r,i)<=n/2;break;case"A":var d=u.arcParams,p=d.cx,g=d.cy,v=d.rx,m=d.ry,y=d.startAngle,b=d.endAngle,x=d.xRotation,w=[t,r,1],E=v>m?v:m;Vh(w,w,Aj(null,[["t",-p,-g],["r",-x],["s",1/(v>m?1:v/m),1/(v>m?m/v:1)]])),o=Xc(0,0,E,y,b,n,w[0],w[1])}if(o)break}}return o}},P4);function hk(e,n,t){for(var r=!1,i=0;i<e.length&&!(r=lk(e[i],n,t));i++);return r}var Qv=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{startArrow:!1,endArrow:!1})},n.prototype.initAttrs=function(t){this._setPathArr(t.path),this.setArrow()},n.prototype.onAttrChange=function(t,r,i){e.prototype.onAttrChange.call(this,t,r,i),t==="path"&&this._setPathArr(r),this.setArrow()},n.prototype._setPathArr=function(t){this.attrs.path=kS(t);var r=rd.hasArc(t);this.set("hasArc",r),this.set("paramsCache",{}),this.set("segments",null),this.set("curve",null),this.set("tCache",null),this.set("totalLength",null)},n.prototype.getSegments=function(){var t=this.get("segements");return t||(t=IS(this.attr("path")),this.set("segments",t)),t},n.prototype.setArrow=function(){var t,r=this.attr(),i=r.startArrow,o=r.endArrow;i&&Vv(this,r,(t=this.getStartTangent())[0][0],t[0][1],t[1][0],t[1][1]),o&&Hv(this,r,(t=this.getEndTangent())[0][0],t[0][1],t[1][0],t[1][1])},n.prototype.isInStrokeOrPath=function(t,r,i,o,a){var s=this.getSegments(),u=this.get("hasArc"),c=!1;if(i){var l=this.getTotalLength();c=rd.isPointInStroke(s,a,t,r,l)}if(!c&&o)if(u)c=ck(this,t,r);else{var h=this.attr("path"),f=rd.extractPolygons(h);c=hk(f.polygons,t,r)||hk(f.polylines,t,r)}return c},n.prototype.createPath=function(t){ok(this,t,this.attr(),this.get("paramsCache"))},n.prototype.afterDrawPath=function(t){var r=this.get("startArrowShape"),i=this.get("endArrowShape");r&&r.draw(t),i&&i.draw(t)},n.prototype.getTotalLength=function(){var t=this.get("totalLength");return yt(t)?(this._calculateCurve(),this._setTcache(),this.get("totalLength")):t},n.prototype.getPoint=function(t){var r,i,o=this.get("tCache");o||(this._calculateCurve(),this._setTcache(),o=this.get("tCache"));var a=this.get("curve");if(!o||o.length===0)return a?{x:a[0][1],y:a[0][2]}:null;ye(o,function(l,h){t>=l[0]&&t<=l[1]&&(r=(t-l[0])/(l[1]-l[0]),i=h)});var s=a[i];if(yt(s)||yt(i))return null;var u=s.length,c=a[i+1];return Nc.pointAt(s[u-2],s[u-1],c[1],c[2],c[3],c[4],c[5],c[6],r)},n.prototype._calculateCurve=function(){var t=this.attr().path;this.set("curve",rd.pathToCurve(t))},n.prototype._setTcache=function(){var t,r,i,o,a=0,s=0,u=[],c=this.get("curve");c&&(ye(c,function(l,h){i=c[h+1],o=l.length,i&&(a+=Nc.length(l[o-2],l[o-1],i[1],i[2],i[3],i[4],i[5],i[6])||0)}),this.set("totalLength",a),a!==0?(ye(c,function(l,h){i=c[h+1],o=l.length,i&&((t=[])[0]=s/a,r=Nc.length(l[o-2],l[o-1],i[1],i[2],i[3],i[4],i[5],i[6]),s+=r||0,t[1]=s/a,u.push(t))}),this.set("tCache",u)):this.set("tCache",[]))},n.prototype.getStartTangent=function(){var t,r=this.getSegments();if(r.length>1){var i=r[0].currentPoint,o=r[1].currentPoint,a=r[1].startTangent;t=[],a?(t.push([i[0]-a[0],i[1]-a[1]]),t.push([i[0],i[1]])):(t.push([o[0],o[1]]),t.push([i[0],i[1]]))}return t},n.prototype.getEndTangent=function(){var t,r=this.getSegments(),i=r.length;if(i>1){var o=r[i-2].currentPoint,a=r[i-1].currentPoint,s=r[i-1].endTangent;t=[],s?(t.push([a[0]-s[0],a[1]-s[1]]),t.push([a[0],a[1]])):(t.push([o[0],o[1]]),t.push([a[0],a[1]]))}return t},n}(wi);function fk(e,n,t,r,i){var o=e.length;if(o<2)return!1;for(var a=0;a<o-1;a++)if(aa(e[a][0],e[a][1],e[a+1][0],e[a+1][1],n,t,r))return!0;if(i){var s=e[0],u=e[o-1];if(aa(s[0],s[1],u[0],u[1],n,t,r))return!0}return!1}var Ij=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.isInStrokeOrPath=function(t,r,i,o,a){var s=this.attr().points,u=!1;return i&&(u=fk(s,a,t,r,!0)),!u&&o&&(u=lk(s,t,r)),u},n.prototype.createPath=function(t){var r=this.attr().points;if(!(r.length<2)){t.beginPath();for(var i=0;i<r.length;i++){var o=r[i];i===0?t.moveTo(o[0],o[1]):t.lineTo(o[0],o[1])}t.closePath()}},n}(wi),Tj=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{startArrow:!1,endArrow:!1})},n.prototype.initAttrs=function(t){this.setArrow()},n.prototype.onAttrChange=function(t,r,i){e.prototype.onAttrChange.call(this,t,r,i),this.setArrow(),["points"].indexOf(t)!==-1&&this._resetCache()},n.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},n.prototype.setArrow=function(){var t=this.attr(),r=this.attrs,i=r.points,o=r.startArrow,a=r.endArrow,s=i.length,u=i[0][0],c=i[0][1],l=i[s-1][0],h=i[s-1][1];o&&Vv(this,t,i[1][0],i[1][1],u,c),a&&Hv(this,t,i[s-2][0],i[s-2][1],l,h)},n.prototype.isFill=function(){return!1},n.prototype.isInStrokeOrPath=function(t,r,i,o,a){return!(!i||!a)&&fk(this.attr().points,a,t,r,!1)},n.prototype.isStroke=function(){return!0},n.prototype.createPath=function(t){var r=this.attr(),i=r.points,o=r.startArrow,a=r.endArrow,s=i.length;if(!(i.length<2)){var u,c=i[0][0],l=i[0][1],h=i[s-1][0],f=i[s-1][1];o&&o.d&&(c+=(u=ns(c,l,i[1][0],i[1][1],o.d)).dx,l+=u.dy),a&&a.d&&(h-=(u=ns(i[s-2][0],i[s-2][1],h,f,a.d)).dx,f-=u.dy),t.beginPath(),t.moveTo(c,l);for(var d=0;d<s-1;d++){var p=i[d];t.lineTo(p[0],p[1])}t.lineTo(h,f)}},n.prototype.afterDrawPath=function(t){var r=this.get("startArrowShape"),i=this.get("endArrowShape");r&&r.draw(t),i&&i.draw(t)},n.prototype.getTotalLength=function(){var t=this.attr().points,r=this.get("totalLength");return yt(r)?(this.set("totalLength",bS(t)),this.get("totalLength")):r},n.prototype.getPoint=function(t){var r,i,o=this.attr().points,a=this.get("tCache");return a||(this._setTcache(),a=this.get("tCache")),ye(a,function(s,u){t>=s[0]&&t<=s[1]&&(r=(t-s[0])/(s[1]-s[0]),i=u)}),pr.pointAt(o[i][0],o[i][1],o[i+1][0],o[i+1][1],r)},n.prototype._setTcache=function(){var t=this.attr().points;if(t&&t.length!==0){var r=this.getTotalLength();if(!(r<=0)){var i,o,a=0,s=[];ye(t,function(u,c){t[c+1]&&((i=[])[0]=a/r,o=pr.length(u[0],u[1],t[c+1][0],t[c+1][1]),a+=o,i[1]=a/r,s.push(i))}),this.set("tCache",s)}}},n.prototype.getStartTangent=function(){var t=this.attr().points,r=[];return r.push([t[1][0],t[1][1]]),r.push([t[0][0],t[0][1]]),r},n.prototype.getEndTangent=function(){var t=this.attr().points,r=t.length-1,i=[];return i.push([t[r-1][0],t[r-1][1]]),i.push([t[r][0],t[r][1]]),i},n}(wi),Oj=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{x:0,y:0,width:0,height:0,radius:0})},n.prototype.isInStrokeOrPath=function(t,r,i,o,a){var s=this.attr(),u=s.x,c=s.y,l=s.width,h=s.height,f=s.radius;if(f){var d=!1;return i&&(d=function(g,v,m,y,b,x,w,E){return aa(g+b,v,g+m-b,v,x,w,E)||aa(g+m,v+b,g+m,v+y-b,x,w,E)||aa(g+m-b,v+y,g+b,v+y,x,w,E)||aa(g,v+y-b,g,v+b,x,w,E)||Xc(g+m-b,v+b,b,1.5*Math.PI,2*Math.PI,x,w,E)||Xc(g+m-b,v+y-b,b,0,.5*Math.PI,x,w,E)||Xc(g+b,v+y-b,b,.5*Math.PI,Math.PI,x,w,E)||Xc(g+b,v+b,b,Math.PI,1.5*Math.PI,x,w,E)}(u,c,l,h,f,a,t,r)),!d&&o&&(d=ck(this,t,r)),d}var p=a/2;return o&&i?ts(u-p,c-p,l+p,h+p,t,r):o?ts(u,c,l,h,t,r):i?function(g,v,m,y,b,x,w){var E=b/2;return ts(g-E,v-E,m,b,x,w)||ts(g+m-E,v-E,b,y,x,w)||ts(g+E,v+y-E,m,b,x,w)||ts(g-E,v+E,b,y,x,w)}(u,c,l,h,a,t,r):void 0},n.prototype.createPath=function(t){var r=this.attr(),i=r.x,o=r.y,a=r.width,s=r.height,u=r.radius;if(t.beginPath(),u===0)t.rect(i,o,a,s);else{var c=function(p){var g=0,v=0,m=0,y=0;return Mt(p)?p.length===1?g=v=m=y=p[0]:p.length===2?(g=m=p[0],v=y=p[1]):p.length===3?(g=p[0],v=y=p[1],m=p[2]):(g=p[0],v=p[1],m=p[2],y=p[3]):g=v=m=y=p,[g,v,m,y]}(u),l=c[0],h=c[1],f=c[2],d=c[3];t.moveTo(i+l,o),t.lineTo(i+a-h,o),h!==0&&t.arc(i+a-h,o+h,h,-Math.PI/2,0),t.lineTo(i+a,o+s-f),f!==0&&t.arc(i+a-f,o+s-f,f,0,Math.PI/2),t.lineTo(i+d,o+s),d!==0&&t.arc(i+d,o+s-d,d,Math.PI/2,Math.PI),t.lineTo(i,o+l),l!==0&&t.arc(i+l,o+l,l,Math.PI,1.5*Math.PI),t.closePath()}},n}(wi),Nj=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},n.prototype.isOnlyHitBox=function(){return!0},n.prototype.initAttrs=function(t){this._assembleFont(),t.text&&this._setText(t.text)},n.prototype._assembleFont=function(){var t=this.attrs;t.font=MS(t)},n.prototype._setText=function(t){var r=null;Re(t)&&t.indexOf(`
`)!==-1&&(r=t.split(`
`)),this.set("textArr",r)},n.prototype.onAttrChange=function(t,r,i){e.prototype.onAttrChange.call(this,t,r,i),t.startsWith("font")&&this._assembleFont(),t==="text"&&this._setText(r)},n.prototype._getSpaceingY=function(){var t=this.attrs,r=t.lineHeight,i=1*t.fontSize;return r?r-i:.14*i},n.prototype._drawTextArr=function(t,r,i){var o,a=this.attrs,s=a.textBaseline,u=a.x,c=a.y,l=1*a.fontSize,h=this._getSpaceingY(),f=ES(a.text,a.fontSize,a.lineHeight);ye(r,function(d,p){o=c+p*(h+l)-f+l,s==="middle"&&(o+=f-l-(f-l)/2),s==="top"&&(o+=f-l),yt(d)||(i?t.fillText(d,u,o):t.strokeText(d,u,o))})},n.prototype._drawText=function(t,r){var i=this.attr(),o=i.x,a=i.y,s=this.get("textArr");if(s)this._drawTextArr(t,s,r);else{var u=i.text;yt(u)||(r?t.fillText(u,o,a):t.strokeText(u,o,a))}},n.prototype.strokeAndFill=function(t){var r=this.attrs,i=r.lineWidth,o=r.opacity,a=r.strokeOpacity,s=r.fillOpacity;this.isStroke()&&i>0&&(yt(a)||a===1||(t.globalAlpha=o),this.stroke(t)),this.isFill()&&(yt(s)||s===1?this.fill(t):(t.globalAlpha=s,this.fill(t),t.globalAlpha=o)),this.afterDrawPath(t)},n.prototype.fill=function(t){this._drawText(t,!0)},n.prototype.stroke=function(t){this._drawText(t,!1)},n}(wi);function dk(e,n,t){var r=e.getTotalMatrix();if(r){var i=function(o,a){return a?Za(bM(a),o):o}([n,t,1],r);return[i[0],i[1]]}return[n,t]}function pk(e,n,t){if(e.isCanvas&&e.isCanvas())return!0;if(!q0(e)||e.cfg.isInView===!1)return!1;if(e.cfg.clipShape){var r=dk(e,n,t),i=r[0],o=r[1];if(e.isClipped(i,o))return!1}var a=e.cfg.cacheCanvasBBox||e.getCanvasBBox();return n>=a.minX&&n<=a.maxX&&t>=a.minY&&t<=a.maxY}function gk(e,n,t){if(!pk(e,n,t))return null;for(var r=null,i=e.getChildren(),o=i.length-1;o>=0;o--){var a=i[o];if(a.isGroup())r=gk(a,n,t);else if(pk(a,n,t)){var s=a,u=dk(a,n,t),c=u[0],l=u[1];s.isInShape(c,l)&&(r=a)}if(r)break}return r}var bo=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return t.renderer="canvas",t.autoDraw=!0,t.localRefresh=!0,t.refreshElements=[],t.clipView=!0,t.quickHit=!1,t},n.prototype.onCanvasChange=function(t){t!=="attr"&&t!=="sort"&&t!=="changeSize"||(this.set("refreshElements",[this]),this.draw())},n.prototype.getShapeBase=function(){return Vg},n.prototype.getGroupBase=function(){return sk},n.prototype.getPixelRatio=function(){var t=this.get("pixelRatio")||(window?window.devicePixelRatio:1);return t>=1?Math.ceil(t):1},n.prototype.getViewRange=function(){return{minX:0,minY:0,maxX:this.cfg.width,maxY:this.cfg.height}},n.prototype.createDom=function(){var t=document.createElement("canvas"),r=t.getContext("2d");return this.set("context",r),t},n.prototype.setDOMSize=function(t,r){e.prototype.setDOMSize.call(this,t,r);var i=this.get("context"),o=this.get("el"),a=this.getPixelRatio();o.width=a*t,o.height=a*r,a>1&&i.scale(a,a)},n.prototype.clear=function(){e.prototype.clear.call(this),this._clearFrame();var t=this.get("context"),r=this.get("el");t.clearRect(0,0,r.width,r.height)},n.prototype.getShape=function(t,r){return this.get("quickHit")?gk(this,t,r):e.prototype.getShape.call(this,t,r,null)},n.prototype._getRefreshRegion=function(){var t,r=this.get("refreshElements"),i=this.getViewRange();return r.length&&r[0]===this?t=i:(t=function(o){if(!o.length)return null;var a=[],s=[],u=[],c=[];return ye(o,function(l){var h=xj(l);h&&(a.push(h.minX),s.push(h.minY),u.push(h.maxX),c.push(h.maxY))}),{minX:Fi(a),minY:Fi(s),maxX:zi(u),maxY:zi(c)}}(r),t&&(t.minX=Math.floor(t.minX),t.minY=Math.floor(t.minY),t.maxX=Math.ceil(t.maxX),t.maxY=Math.ceil(t.maxY),t.maxY+=1,this.get("clipView")&&(t=function(o,a){return o&&a&&Uc(o,a)?{minX:Math.max(o.minX,a.minX),minY:Math.max(o.minY,a.minY),maxX:Math.min(o.maxX,a.maxX),maxY:Math.min(o.maxY,a.maxY)}:null}(t,i)))),t},n.prototype.refreshElement=function(t){this.get("refreshElements").push(t)},n.prototype._clearFrame=function(){var t=this.get("drawFrame");t&&(Pw(t),this.set("drawFrame",null),this.set("refreshElements",[]))},n.prototype.draw=function(){var t=this.get("drawFrame");this.get("autoDraw")&&t||this._startDraw()},n.prototype._drawAll=function(){var t=this.get("context"),r=this.get("el"),i=this.getChildren();t.clearRect(0,0,r.width,r.height),ou(t,this),qv(t,i),this.set("refreshElements",[])},n.prototype._drawRegion=function(){var t=this.get("context"),r=this.get("refreshElements"),i=this.getChildren(),o=this._getRefreshRegion();o?(t.clearRect(o.minX,o.minY,o.maxX-o.minX,o.maxY-o.minY),t.save(),t.beginPath(),t.rect(o.minX,o.minY,o.maxX-o.minX,o.maxY-o.minY),t.clip(),ou(t,this),yj(this,i,o),qv(t,i,o),t.restore()):r.length&&ik(r),ye(r,function(a){a.get("hasChanged")&&a.set("hasChanged",!1)}),this.set("refreshElements",[])},n.prototype._startDraw=function(){var t=this,r=this.get("drawFrame"),i=this.get("drawFrameCallback");r||(r=Dw(function(){t.get("localRefresh")?t._drawRegion():t._drawAll(),t.set("drawFrame",null),i&&i()}),this.set("drawFrame",r))},n.prototype.skipDraw=function(){},n.prototype.removeDom=function(){var t=this.get("el");t.width=0,t.height=0,t.parentNode.removeChild(t)},n}(iS),Jv={rect:"path",circle:"circle",line:"line",path:"path",marker:"path",text:"text",polyline:"polyline",polygon:"polygon",image:"image",ellipse:"ellipse",dom:"foreignObject"},an={opacity:"opacity",fillStyle:"fill",fill:"fill",fillOpacity:"fill-opacity",strokeStyle:"stroke",strokeOpacity:"stroke-opacity",stroke:"stroke",x:"x",y:"y",r:"r",rx:"rx",ry:"ry",width:"width",height:"height",x1:"x1",x2:"x2",y1:"y1",y2:"y2",lineCap:"stroke-linecap",lineJoin:"stroke-linejoin",lineWidth:"stroke-width",lineDash:"stroke-dasharray",lineDashOffset:"stroke-dashoffset",miterLimit:"stroke-miterlimit",font:"font",fontSize:"font-size",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",fontFamily:"font-family",startArrow:"marker-start",endArrow:"marker-end",path:"d",class:"class",id:"id",style:"style",preserveAspectRatio:"preserveAspectRatio"};function ei(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function vk(e){var n=Jv[e.type],t=e.getParent();if(!n)throw new Error("the type "+e.type+" is not supported by svg");var r=ei(n);if(e.get("id")&&(r.id=e.get("id")),e.set("el",r),e.set("attrs",{}),t){var i=t.get("el");i||(i=t.createDom(),t.set("el",i)),i.appendChild(r)}return r}function mk(e,n){var t=e.get("el"),r=Bw(t.children).sort(n),i=document.createDocumentFragment();r.forEach(function(o){i.appendChild(o)}),t.appendChild(i)}function Yc(e){var n=e.attr().matrix;if(n){for(var t=e.cfg.el,r=[],i=0;i<9;i+=3)r.push(n[i]+","+n[i+1]);(r=r.join(",")).indexOf("NaN")===-1&&t.setAttribute("transform","matrix("+r+")")}}function Wc(e,n){var t=e.getClip(),r=e.get("el");if(t){if(t&&!r.hasAttribute("clip-path")){vk(t),t.createPath(n);var i=n.addClip(t);r.setAttribute("clip-path","url(#"+i+")")}}else r.removeAttribute("clip-path")}function yk(e,n){n.forEach(function(t){t.draw(e)})}function bk(e,n){var t=e.get("canvas");if(t&&t.get("autoDraw")){var r=t.get("context"),i=e.getParent(),o=i?i.getChildren():[t],a=e.get("el");if(n==="remove")if(e.get("isClipShape")){var s=a&&a.parentNode,u=s&&s.parentNode;s&&u&&u.removeChild(s)}else a&&a.parentNode&&a.parentNode.removeChild(a);else if(n==="show")a.setAttribute("visibility","visible");else if(n==="hide")a.setAttribute("visibility","hidden");else if(n==="zIndex")(function(l,h){var f=l.parentNode,d=Array.from(f.childNodes).filter(function(m){return m.nodeType===1&&m.nodeName.toLowerCase()!=="defs"}),p=d[h],g=d.indexOf(l);if(p){if(g>h)f.insertBefore(l,p);else if(g<h){var v=d[h+1];v?f.insertBefore(l,v):f.appendChild(l)}}else f.appendChild(l)})(a,o.indexOf(e));else if(n==="sort"){var c=e.get("children");c&&c.length&&mk(e,function(l,h){return c.indexOf(l)-c.indexOf(h)?1:0})}else n==="clear"?a&&(a.innerHTML=""):n==="matrix"?Yc(e):n==="clip"?Wc(e,r):n==="attr"||n==="add"&&e.draw(r)}}var xk=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return Nt(n,e),n.prototype.isEntityGroup=function(){return!0},n.prototype.createDom=function(){var t=ei("g");this.set("el",t);var r=this.getParent();if(r){var i=r.get("el");i||(i=r.createDom(),r.set("el",i)),i.appendChild(t)}return t},n.prototype.afterAttrsChange=function(t){e.prototype.afterAttrsChange.call(this,t);var r=this.get("canvas");if(r&&r.get("autoDraw")){var i=r.get("context");this.createPath(i,t)}},n.prototype.onCanvasChange=function(t){bk(this,t)},n.prototype.getShapeBase=function(){return Hg},n.prototype.getGroupBase=function(){return n},n.prototype.draw=function(t){var r=this.getChildren(),i=this.get("el");this.get("destroyed")?i&&i.parentNode.removeChild(i):(i||this.createDom(),Wc(this,t),this.createPath(t),r.length&&yk(t,r))},n.prototype.createPath=function(t,r){var i=this.attr(),o=this.get("el");ye(r||i,function(a,s){an[s]&&o.setAttribute(an[s],a)}),Yc(this)},n}(oS),ti=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="svg",t.canFill=!1,t.canStroke=!1,t}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},n.prototype.afterAttrsChange=function(t){e.prototype.afterAttrsChange.call(this,t);var r=this.get("canvas");if(r&&r.get("autoDraw")){var i=r.get("context");this.draw(i,t)}},n.prototype.getShapeBase=function(){return Hg},n.prototype.getGroupBase=function(){return xk},n.prototype.onCanvasChange=function(t){bk(this,t)},n.prototype.calculateBBox=function(){var t=this.get("el"),r=null;if(t)r=t.getBBox();else{var i=uS(this.get("type"));i&&(r=i(this))}if(r){var o=r.x,a=r.y,s=r.width,u=r.height,c=this.getHitLineWidth(),l=c/2,h=o-l,f=a-l;return{x:h,y:f,minX:h,minY:f,maxX:o+s+l,maxY:a+u+l,width:s+c,height:u+c}}return{x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0}},n.prototype.isFill=function(){var t=this.attr(),r=t.fill,i=t.fillStyle;return(r||i||this.isClipShape())&&this.canFill},n.prototype.isStroke=function(){var t=this.attr(),r=t.stroke,i=t.strokeStyle;return(r||i)&&this.canStroke},n.prototype.draw=function(t,r){var i=this.get("el");this.get("destroyed")?i&&i.parentNode.removeChild(i):(i||vk(this),Wc(this,t),this.createPath(t,r),this.shadow(t,r),this.strokeAndFill(t,r),this.transform(r))},n.prototype.createPath=function(t,r){},n.prototype.strokeAndFill=function(t,r){var i=r||this.attr(),o=i.fill,a=i.fillStyle,s=i.stroke,u=i.strokeStyle,c=i.fillOpacity,l=i.strokeOpacity,h=i.lineWidth,f=this.get("el");this.canFill&&(r?"fill"in i?this._setColor(t,"fill",o):"fillStyle"in i&&this._setColor(t,"fill",a):this._setColor(t,"fill",o||a),c&&f.setAttribute(an.fillOpacity,c)),this.canStroke&&h>0&&(r?"stroke"in i?this._setColor(t,"stroke",s):"strokeStyle"in i&&this._setColor(t,"stroke",u):this._setColor(t,"stroke",s||u),l&&f.setAttribute(an.strokeOpacity,l),h&&f.setAttribute(an.lineWidth,h))},n.prototype._setColor=function(t,r,i){var o=this.get("el");if(i)if(i=i.trim(),/^[r,R,L,l]{1}[\s]*\(/.test(i))(a=t.find("gradient",i))||(a=t.addGradient(i)),o.setAttribute(an[r],"url(#"+a+")");else if(/^[p,P]{1}[\s]*\(/.test(i)){var a;(a=t.find("pattern",i))||(a=t.addPattern(i)),o.setAttribute(an[r],"url(#"+a+")")}else o.setAttribute(an[r],i);else o.setAttribute(an[r],"none")},n.prototype.shadow=function(t,r){var i=this.attr(),o=r||i,a=o.shadowOffsetX,s=o.shadowOffsetY,u=o.shadowBlur,c=o.shadowColor;(a||s||u||c)&&function(l,h){var f=l.cfg.el,d=l.attr(),p={dx:d.shadowOffsetX,dy:d.shadowOffsetY,blur:d.shadowBlur,color:d.shadowColor};if(p.dx||p.dy||p.blur||p.color){var g=h.find("filter",p);g||(g=h.addShadow(p)),f.setAttribute("filter","url(#"+g+")")}else f.removeAttribute("filter")}(this,t)},n.prototype.transform=function(t){var r=this.attr();(t||r).matrix&&Yc(this)},n.prototype.isInShape=function(t,r){return this.isPointInPath(t,r)},n.prototype.isPointInPath=function(t,r){var i=this.get("el"),o=this.get("canvas").get("el").getBoundingClientRect(),a=t+o.left,s=r+o.top,u=document.elementFromPoint(a,s);return!(!u||!u.isEqualNode(i))},n.prototype.getHitLineWidth=function(){var t=this.attrs,r=t.lineWidth,i=t.lineAppendWidth;return this.isStroke()?r+i:0},n}(aS),Dj=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="circle",t.canFill=!0,t.canStroke=!0,t}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{x:0,y:0,r:0})},n.prototype.createPath=function(t,r){var i=this.attr(),o=this.get("el");ye(r||i,function(a,s){s==="x"||s==="y"?o.setAttribute("c"+s,a):an[s]&&o.setAttribute(an[s],a)})},n}(ti),Pj=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="dom",t.canFill=!1,t.canStroke=!1,t}return Nt(n,e),n.prototype.createPath=function(t,r){var i=this.attr(),o=this.get("el");if(ye(r||i,function(c,l){an[l]&&o.setAttribute(an[l],c)}),typeof i.html=="function"){var a=i.html.call(this,i);if(a instanceof Element||a instanceof HTMLDocument){for(var s=o.childNodes,u=s.length-1;u>=0;u--)o.removeChild(s[u]);o.appendChild(a)}else o.innerHTML=a}else o.innerHTML=i.html},n}(ti),Lj=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="ellipse",t.canFill=!0,t.canStroke=!0,t}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{x:0,y:0,rx:0,ry:0})},n.prototype.createPath=function(t,r){var i=this.attr(),o=this.get("el");ye(r||i,function(a,s){s==="x"||s==="y"?o.setAttribute("c"+s,a):an[s]&&o.setAttribute(an[s],a)})},n}(ti),Rj=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="image",t.canFill=!1,t.canStroke=!1,t}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{x:0,y:0,width:0,height:0})},n.prototype.createPath=function(t,r){var i=this,o=this.attr(),a=this.get("el");ye(r||o,function(s,u){u==="img"?i._setImage(o.img):an[u]&&a.setAttribute(an[u],s)})},n.prototype.setAttr=function(t,r){this.attrs[t]=r,t==="img"&&this._setImage(r)},n.prototype._setImage=function(t){var r=this.attr(),i=this.get("el");if(Re(t))i.setAttribute("href",t);else if(t instanceof window.Image)r.width||(i.setAttribute("width",t.width),this.attr("width",t.width)),r.height||(i.setAttribute("height",t.height),this.attr("height",t.height)),i.setAttribute("href",t.src);else if(t instanceof HTMLElement&&Re(t.nodeName)&&t.nodeName.toUpperCase()==="CANVAS")i.setAttribute("href",t.toDataURL());else if(t instanceof ImageData){var o=document.createElement("canvas");o.setAttribute("width",""+t.width),o.setAttribute("height",""+t.height),o.getContext("2d").putImageData(t,0,0),r.width||(i.setAttribute("width",""+t.width),this.attr("width",t.width)),r.height||(i.setAttribute("height",""+t.height),this.attr("height",t.height)),i.setAttribute("href",o.toDataURL())}},n}(ti),jj=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="line",t.canFill=!1,t.canStroke=!0,t}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},n.prototype.createPath=function(t,r){var i=this.attr(),o=this.get("el");ye(r||i,function(a,s){if(s==="startArrow"||s==="endArrow")if(a){var u=tr(a)?t.addArrow(i,an[s]):t.getDefaultArrow(i,an[s]);o.setAttribute(an[s],"url(#"+u+")")}else o.removeAttribute(an[s]);else an[s]&&o.setAttribute(an[s],a)})},n.prototype.getTotalLength=function(){var t=this.attr(),r=t.x1,i=t.y1,o=t.x2,a=t.y2;return pr.length(r,i,o,a)},n.prototype.getPoint=function(t){var r=this.attr(),i=r.x1,o=r.y1,a=r.x2,s=r.y2;return pr.pointAt(i,o,a,s,t)},n}(ti),id={circle:function(e,n,t){return[["M",e,n],["m",-t,0],["a",t,t,0,1,0,2*t,0],["a",t,t,0,1,0,2*-t,0]]},square:function(e,n,t){return[["M",e-t,n-t],["L",e+t,n-t],["L",e+t,n+t],["L",e-t,n+t],["Z"]]},diamond:function(e,n,t){return[["M",e-t,n],["L",e,n-t],["L",e+t,n],["L",e,n+t],["Z"]]},triangle:function(e,n,t){var r=t*Math.sin(.3333333333333333*Math.PI);return[["M",e-t,n+r],["L",e,n-r],["L",e+t,n+r],["z"]]},triangleDown:function(e,n,t){var r=t*Math.sin(.3333333333333333*Math.PI);return[["M",e-t,n-r],["L",e+t,n-r],["L",e,n+r],["Z"]]}};const wk={get:function(e){return id[e]},register:function(e,n){id[e]=n},remove:function(e){delete id[e]},getAll:function(){return id}};var Bj=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="marker",t.canFill=!0,t.canStroke=!0,t}return Nt(n,e),n.prototype.createPath=function(t){this.get("el").setAttribute("d",this._assembleMarker())},n.prototype._assembleMarker=function(){var t=this._getPath();return Mt(t)?t.map(function(r){return r.join(" ")}).join(""):t},n.prototype._getPath=function(){var t,r=this.attr(),i=r.x,o=r.y,a=r.r||r.radius,s=r.symbol||"circle";return(t=mn(s)?s:wk.get(s))?t(i,o,a):null},n.symbolsFactory=wk,n}(ti),zj=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="path",t.canFill=!0,t.canStroke=!0,t}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{startArrow:!1,endArrow:!1})},n.prototype.createPath=function(t,r){var i=this,o=this.attr(),a=this.get("el");ye(r||o,function(s,u){if(u==="path"&&Mt(s))a.setAttribute("d",i._formatPath(s));else if(u==="startArrow"||u==="endArrow")if(s){var c=tr(s)?t.addArrow(o,an[u]):t.getDefaultArrow(o,an[u]);a.setAttribute(an[u],"url(#"+c+")")}else a.removeAttribute(an[u]);else an[u]&&a.setAttribute(an[u],s)})},n.prototype._formatPath=function(t){var r=t.map(function(i){return i.join(" ")}).join("");return~r.indexOf("NaN")?"":r},n.prototype.getTotalLength=function(){var t=this.get("el");return t?t.getTotalLength():null},n.prototype.getPoint=function(t){var r=this.get("el"),i=this.getTotalLength();if(i===0)return null;var o=r?r.getPointAtLength(t*i):null;return o?{x:o.x,y:o.y}:null},n}(ti),Fj=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="polygon",t.canFill=!0,t.canStroke=!0,t}return Nt(n,e),n.prototype.createPath=function(t,r){var i=this.attr(),o=this.get("el");ye(r||i,function(a,s){s==="points"&&Mt(a)&&a.length>=2?o.setAttribute("points",a.map(function(u){return u[0]+","+u[1]}).join(" ")):an[s]&&o.setAttribute(an[s],a)})},n}(ti),Gj=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="polyline",t.canFill=!0,t.canStroke=!0,t}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{startArrow:!1,endArrow:!1})},n.prototype.onAttrChange=function(t,r,i){e.prototype.onAttrChange.call(this,t,r,i),["points"].indexOf(t)!==-1&&this._resetCache()},n.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},n.prototype.createPath=function(t,r){var i=this.attr(),o=this.get("el");ye(r||i,function(a,s){s==="points"&&Mt(a)&&a.length>=2?o.setAttribute("points",a.map(function(u){return u[0]+","+u[1]}).join(" ")):an[s]&&o.setAttribute(an[s],a)})},n.prototype.getTotalLength=function(){var t=this.attr().points,r=this.get("totalLength");return yt(r)?(this.set("totalLength",bS(t)),this.get("totalLength")):r},n.prototype.getPoint=function(t){var r,i,o=this.attr().points,a=this.get("tCache");return a||(this._setTcache(),a=this.get("tCache")),ye(a,function(s,u){t>=s[0]&&t<=s[1]&&(r=(t-s[0])/(s[1]-s[0]),i=u)}),pr.pointAt(o[i][0],o[i][1],o[i+1][0],o[i+1][1],r)},n.prototype._setTcache=function(){var t=this.attr().points;if(t&&t.length!==0){var r=this.getTotalLength();if(!(r<=0)){var i,o,a=0,s=[];ye(t,function(u,c){t[c+1]&&((i=[])[0]=a/r,o=pr.length(u[0],u[1],t[c+1][0],t[c+1][1]),a+=o,i[1]=a/r,s.push(i))}),this.set("tCache",s)}}},n.prototype.getStartTangent=function(){var t=this.attr().points,r=[];return r.push([t[1][0],t[1][1]]),r.push([t[0][0],t[0][1]]),r},n.prototype.getEndTangent=function(){var t=this.attr().points,r=t.length-1,i=[];return i.push([t[r-1][0],t[r-1][1]]),i.push([t[r][0],t[r][1]]),i},n}(ti),Uj=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="rect",t.canFill=!0,t.canStroke=!0,t}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{x:0,y:0,width:0,height:0,radius:0})},n.prototype.createPath=function(t,r){var i=this,o=this.attr(),a=this.get("el"),s=!1,u=["x","y","width","height","radius"];ye(r||o,function(c,l){u.indexOf(l)===-1||s?u.indexOf(l)===-1&&an[l]&&a.setAttribute(an[l],c):(a.setAttribute("d",i._assembleRect(o)),s=!0)})},n.prototype._assembleRect=function(t){var r=t.x,i=t.y,o=t.width,a=t.height,s=t.radius;if(!s)return"M "+r+","+i+" l "+o+",0 l 0,"+a+" l"+-o+" 0 z";var u=function(c){var l=0,h=0,f=0,d=0;return Mt(c)?c.length===1?l=h=f=d=c[0]:c.length===2?(l=f=c[0],h=d=c[1]):c.length===3?(l=c[0],h=d=c[1],f=c[2]):(l=c[0],h=c[1],f=c[2],d=c[3]):l=h=f=d=c,{r1:l,r2:h,r3:f,r4:d}}(s);return Mt(s)?s.length===1?u.r1=u.r2=u.r3=u.r4=s[0]:s.length===2?(u.r1=u.r3=s[0],u.r2=u.r4=s[1]):s.length===3?(u.r1=s[0],u.r2=u.r4=s[1],u.r3=s[2]):(u.r1=s[0],u.r2=s[1],u.r3=s[2],u.r4=s[3]):u.r1=u.r2=u.r3=u.r4=s,[["M "+(r+u.r1)+","+i],["l "+(o-u.r1-u.r2)+",0"],["a "+u.r2+","+u.r2+",0,0,1,"+u.r2+","+u.r2],["l 0,"+(a-u.r2-u.r3)],["a "+u.r3+","+u.r3+",0,0,1,"+-u.r3+","+u.r3],["l "+(u.r3+u.r4-o)+",0"],["a "+u.r4+","+u.r4+",0,0,1,"+-u.r4+","+-u.r4],["l 0,"+(u.r4+u.r1-a)],["a "+u.r1+","+u.r1+",0,0,1,"+u.r1+","+-u.r1],["z"]].join(" ")},n}(ti),Xj={top:"before-edge",middle:"central",bottom:"after-edge",alphabetic:"baseline",hanging:"hanging"},Yj={top:"text-before-edge",middle:"central",bottom:"text-after-edge",alphabetic:"alphabetic",hanging:"hanging"},Wj={left:"left",start:"left",center:"middle",right:"end",end:"end"},Vj=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="text",t.canFill=!0,t.canStroke=!0,t}return Nt(n,e),n.prototype.getDefaultAttrs=function(){var t=e.prototype.getDefaultAttrs.call(this);return F(F({},t),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},n.prototype.createPath=function(t,r){var i=this,o=this.attr(),a=this.get("el");this._setFont(),ye(r||o,function(s,u){u==="text"?i._setText(""+s):u==="matrix"&&s?Yc(i):an[u]&&a.setAttribute(an[u],s)}),a.setAttribute("paint-order","stroke"),a.setAttribute("style","stroke-linecap:butt; stroke-linejoin:miter;")},n.prototype._setFont=function(){var t=this.get("el"),r=this.attr(),i=r.textBaseline,o=r.textAlign,a=mM();a&&a.name==="firefox"?t.setAttribute("dominant-baseline",Yj[i]||"alphabetic"):t.setAttribute("alignment-baseline",Xj[i]||"baseline"),t.setAttribute("text-anchor",Wj[o]||"left")},n.prototype._setText=function(t){var r=this.get("el"),i=this.attr(),o=i.x,a=i.textBaseline,s=a===void 0?"bottom":a;if(t)if(~t.indexOf(`
`)){var u=t.split(`
`),c=u.length-1,l="";ye(u,function(h,f){f===0?s==="alphabetic"?l+='<tspan x="'+o+'" dy="'+-c+'em">'+h+"</tspan>":s==="top"?l+='<tspan x="'+o+'" dy="0.9em">'+h+"</tspan>":s==="middle"?l+='<tspan x="'+o+'" dy="'+-(c-1)/2+'em">'+h+"</tspan>":s==="bottom"?l+='<tspan x="'+o+'" dy="-'+(c+.3)+'em">'+h+"</tspan>":s==="hanging"&&(l+='<tspan x="'+o+'" dy="'+(-(c-1)-.3)+'em">'+h+"</tspan>"):l+='<tspan x="'+o+'" dy="1em">'+h+"</tspan>"}),r.innerHTML=l}else r.innerHTML=t;else r.innerHTML=""},n}(ti),Hj=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,qj=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,Zj=/[\d.]+:(#[^\s]+|[^)]+\))/gi;function Ek(e){var n=e.match(Zj);if(!n)return"";var t="";return n.sort(function(r,i){return r=r.split(":"),i=i.split(":"),Number(r[0])-Number(i[0])}),ye(n,function(r){r=r.split(":"),t+='<stop offset="'+r[0]+'" stop-color="'+r[1]+'"></stop>'}),t}var Vc,em,Mk,tm,Kj=function(){function e(n){this.cfg={};var t=null,r=Ui("gradient_");return n.toLowerCase()[0]==="l"?function(i,o){var a,s,u=Hj.exec(i),c=Fh(Gh(parseFloat(u[1])),2*Math.PI),l=u[2];c>=0&&c<.5*Math.PI?(a={x:0,y:0},s={x:1,y:1}):.5*Math.PI<=c&&c<Math.PI?(a={x:1,y:0},s={x:0,y:1}):Math.PI<=c&&c<1.5*Math.PI?(a={x:1,y:1},s={x:0,y:0}):(a={x:0,y:1},s={x:1,y:0});var h=Math.tan(c),f=h*h,d=(s.x-a.x+h*(s.y-a.y))/(f+1)+a.x,p=h*(s.x-a.x+h*(s.y-a.y))/(f+1)+a.y;o.setAttribute("x1",a.x),o.setAttribute("y1",a.y),o.setAttribute("x2",d),o.setAttribute("y2",p),o.innerHTML=Ek(l)}(n,t=ei("linearGradient")):function(i,o){var a=qj.exec(i),s=parseFloat(a[1]),u=parseFloat(a[2]),c=parseFloat(a[3]),l=a[4];o.setAttribute("cx",s),o.setAttribute("cy",u),o.setAttribute("r",c),o.innerHTML=Ek(l)}(n,t=ei("radialGradient")),t.setAttribute("id",r),this.el=t,this.id=r,this.cfg=n,this}return e.prototype.match=function(n,t){return this.cfg===t},e}(),$j={shadowColor:"color",shadowOpacity:"opacity",shadowBlur:"blur",shadowOffsetX:"dx",shadowOffsetY:"dy"},Qj={x:"-40%",y:"-40%",width:"200%",height:"200%"},Jj=function(){function e(n){this.type="filter",this.cfg={},this.type="filter";var t=ei("filter");return ye(Qj,function(r,i){t.setAttribute(i,r)}),this.el=t,this.id=Ui("filter_"),this.el.id=this.id,this.cfg=n,this._parseShadow(n,t),this}return e.prototype.match=function(n,t){if(this.type!==n)return!1;var r=!0,i=this.cfg;return ye(Object.keys(i),function(o){if(i[o]!==t[o])return r=!1,!1}),r},e.prototype.update=function(n,t){var r=this.cfg;return r[$j[n]]=t,this._parseShadow(r,this.el),this},e.prototype._parseShadow=function(n,t){var r=`<feDropShadow
      dx="`+(n.dx||0)+`"
      dy="`+(n.dy||0)+`"
      stdDeviation="`+(n.blur?n.blur/10:0)+`"
      flood-color="`+(n.color?n.color:"#000")+`"
      flood-opacity="`+(n.opacity?n.opacity:1)+`"
      />`;t.innerHTML=r},e}(),Sk=function(){function e(n,t){this.cfg={};var r=ei("marker"),i=Ui("marker_");r.setAttribute("id",i);var o=ei("path");o.setAttribute("stroke",n.stroke||"none"),o.setAttribute("fill",n.fill||"none"),r.appendChild(o),r.setAttribute("overflow","visible"),r.setAttribute("orient","auto-start-reverse"),this.el=r,this.child=o,this.id=i;var a=n[t==="marker-start"?"startArrow":"endArrow"];return this.stroke=n.stroke||"#000",a===!0?this._setDefaultPath(t,o):(this.cfg=a,this._setMarker(n.lineWidth,o)),this}return e.prototype.match=function(){return!1},e.prototype._setDefaultPath=function(n,t){var r=this.el;t.setAttribute("d","M0,0 L"+10*Math.cos(Math.PI/6)+",5 L0,10"),r.setAttribute("refX",""+10*Math.cos(Math.PI/6)),r.setAttribute("refY","5")},e.prototype._setMarker=function(n,t){var r=this.el,i=this.cfg.path,o=this.cfg.d;Mt(i)&&(i=i.map(function(a){return a.join(" ")}).join("")),t.setAttribute("d",i),r.appendChild(t),o&&r.setAttribute("refX",""+o/n)},e.prototype.update=function(n){var t=this.child;t.attr?t.attr("fill",n):t.setAttribute("fill",n)},e}(),eB=function(){function e(n){this.type="clip",this.cfg={};var t=ei("clipPath");this.el=t,this.id=Ui("clip_"),t.id=this.id;var r=n.cfg.el;return t.appendChild(r),this.cfg=n,this}return e.prototype.match=function(){return!1},e.prototype.remove=function(){var n=this.el;n.parentNode.removeChild(n)},e}(),tB=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,nB=function(){function e(n){this.cfg={};var t=ei("pattern");t.setAttribute("patternUnits","userSpaceOnUse");var r=ei("image");t.appendChild(r);var i=Ui("pattern_");t.id=i,this.el=t,this.id=i,this.cfg=n;var o=tB.exec(n)[2];r.setAttribute("href",o);var a=new Image;function s(){t.setAttribute("width",""+a.width),t.setAttribute("height",""+a.height)}return o.match(/^data:/i)||(a.crossOrigin="Anonymous"),a.src=o,a.complete?s():(a.onload=s,a.src=a.src),this}return e.prototype.match=function(n,t){return this.cfg===t},e}(),rB=function(){function e(n){var t=ei("defs"),r=Ui("defs_");t.id=r,n.appendChild(t),this.children=[],this.defaultArrow={},this.el=t,this.canvas=n}return e.prototype.find=function(n,t){for(var r=this.children,i=null,o=0;o<r.length;o++)if(r[o].match(n,t)){i=r[o].id;break}return i},e.prototype.findById=function(n){for(var t=this.children,r=null,i=0;i<t.length;i++)if(t[i].id===n){r=t[i];break}return r},e.prototype.add=function(n){this.children.push(n),n.canvas=this.canvas,n.parent=this},e.prototype.getDefaultArrow=function(n,t){var r=n.stroke||n.strokeStyle;if(this.defaultArrow[r])return this.defaultArrow[r].id;var i=new Sk(n,t);return this.defaultArrow[r]=i,this.el.appendChild(i.el),this.add(i),i.id},e.prototype.addGradient=function(n){var t=new Kj(n);return this.el.appendChild(t.el),this.add(t),t.id},e.prototype.addArrow=function(n,t){var r=new Sk(n,t);return this.el.appendChild(r.el),this.add(r),r.id},e.prototype.addShadow=function(n){var t=new Jj(n);return this.el.appendChild(t.el),this.add(t),t.id},e.prototype.addPattern=function(n){var t=new nB(n);return this.el.appendChild(t.el),this.add(t),t.id},e.prototype.addClip=function(n){var t=new eB(n);return this.el.appendChild(t.el),this.add(t),t.id},e}(),Hc=function(e){function n(t){return e.call(this,F(F({},t),{autoDraw:!0,renderer:"svg"}))||this}return Nt(n,e),n.prototype.getShapeBase=function(){return Hg},n.prototype.getGroupBase=function(){return xk},n.prototype.getShape=function(t,r,i){var o=i.target||i.srcElement;if(!Jv[o.tagName]){for(var a=o.parentNode;a&&!Jv[a.tagName];)a=a.parentNode;o=a}return this.find(function(s){return s.get("el")===o})},n.prototype.createDom=function(){var t=ei("svg"),r=new rB(t);return t.setAttribute("width",""+this.get("width")),t.setAttribute("height",""+this.get("height")),this.set("context",r),t},n.prototype.onCanvasChange=function(t){var r=this.get("context"),i=this.get("el");if(t==="sort"){var o=this.get("children");o&&o.length&&mk(this,function(s,u){return o.indexOf(s)-o.indexOf(u)?1:0})}else if(t==="clear"){if(i){i.innerHTML="";var a=r.el;a.innerHTML="",i.appendChild(a)}}else t==="matrix"?Yc(this):t==="clip"?Wc(this,r):t==="changeSize"&&(i.setAttribute("width",""+this.get("width")),i.setAttribute("height",""+this.get("height")))},n.prototype.draw=function(){var t=this.get("context"),r=this.getChildren();Wc(this,t),r.length&&yk(t,r)},n}(iS);function od(e,n,t){if(e){if(typeof e.addEventListener=="function")return e.addEventListener(n,t,!1),{remove:function(){e.removeEventListener(n,t,!1)}};if(typeof e.attachEvent=="function")return e.attachEvent("on"+n,t),{remove:function(){e.detachEvent("on"+n,t)}}}}function gn(e){Vc||(Vc=document.createElement("table"),em=document.createElement("tr"),Mk=/^\s*<(\w+|!)[^>]*>/,tm={tr:document.createElement("tbody"),tbody:Vc,thead:Vc,tfoot:Vc,td:em,th:em,"*":document.createElement("div")});var n=Mk.test(e)&&RegExp.$1;n&&n in tm||(n="*");var t=tm[n];e=typeof e=="string"?e.replace(/(^\s*)|(\s*$)/g,""):e,t.innerHTML=""+e;var r=t.childNodes[0];return r&&t.contains(r)&&t.removeChild(r),r}function qt(e,n){if(e)for(var t in n)n.hasOwnProperty(t)&&(e.style[t]=n[t]);return e}var _k={exports:{}},kk={exports:{}},iB=function(e){return!(!e||typeof e=="string")&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String"))},oB=Array.prototype.concat,aB=Array.prototype.slice,Ck=kk.exports=function(e){for(var n=[],t=0,r=e.length;t<r;t++){var i=e[t];iB(i)?n=oB.call(n,aB.call(i)):n.push(i)}return n};Ck.wrap=function(e){return function(){return e(Ck(arguments))}};var sB=kk.exports,qc={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Zc=sB,Ak=Object.hasOwnProperty,Ik=Object.create(null);for(var nm in qc)Ak.call(qc,nm)&&(Ik[qc[nm]]=nm);var Gr=_k.exports={to:{},get:{}};function sa(e,n,t){return Math.min(Math.max(n,e),t)}function ad(e){var n=Math.round(e).toString(16).toUpperCase();return n.length<2?"0"+n:n}Gr.get=function(e){var n,t;switch(e.substring(0,3).toLowerCase()){case"hsl":n=Gr.get.hsl(e),t="hsl";break;case"hwb":n=Gr.get.hwb(e),t="hwb";break;default:n=Gr.get.rgb(e),t="rgb"}return n?{model:t,value:n}:null},Gr.get.rgb=function(e){if(!e)return null;var n,t,r,i=[0,0,0,1];if(n=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(r=n[2],n=n[1],t=0;t<3;t++){var o=2*t;i[t]=parseInt(n.slice(o,o+2),16)}r&&(i[3]=parseInt(r,16)/255)}else if(n=e.match(/^#([a-f0-9]{3,4})$/i)){for(r=(n=n[1])[3],t=0;t<3;t++)i[t]=parseInt(n[t]+n[t],16);r&&(i[3]=parseInt(r+r,16)/255)}else if(n=e.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(t=0;t<3;t++)i[t]=parseInt(n[t+1],0);n[4]&&(n[5]?i[3]=.01*parseFloat(n[4]):i[3]=parseFloat(n[4]))}else{if(!(n=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(n=e.match(/^(\w+)$/))?n[1]==="transparent"?[0,0,0,0]:Ak.call(qc,n[1])?((i=qc[n[1]])[3]=1,i):null:null;for(t=0;t<3;t++)i[t]=Math.round(2.55*parseFloat(n[t+1]));n[4]&&(n[5]?i[3]=.01*parseFloat(n[4]):i[3]=parseFloat(n[4]))}for(t=0;t<3;t++)i[t]=sa(i[t],0,255);return i[3]=sa(i[3],0,1),i},Gr.get.hsl=function(e){if(!e)return null;var n=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(n){var t=parseFloat(n[4]);return[(parseFloat(n[1])%360+360)%360,sa(parseFloat(n[2]),0,100),sa(parseFloat(n[3]),0,100),sa(isNaN(t)?1:t,0,1)]}return null},Gr.get.hwb=function(e){if(!e)return null;var n=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(n){var t=parseFloat(n[4]);return[(parseFloat(n[1])%360+360)%360,sa(parseFloat(n[2]),0,100),sa(parseFloat(n[3]),0,100),sa(isNaN(t)?1:t,0,1)]}return null},Gr.to.hex=function(){var e=Zc(arguments);return"#"+ad(e[0])+ad(e[1])+ad(e[2])+(e[3]<1?ad(Math.round(255*e[3])):"")},Gr.to.rgb=function(){var e=Zc(arguments);return e.length<4||e[3]===1?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},Gr.to.rgb.percent=function(){var e=Zc(arguments),n=Math.round(e[0]/255*100),t=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||e[3]===1?"rgb("+n+"%, "+t+"%, "+r+"%)":"rgba("+n+"%, "+t+"%, "+r+"%, "+e[3]+")"},Gr.to.hsl=function(){var e=Zc(arguments);return e.length<4||e[3]===1?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},Gr.to.hwb=function(){var e=Zc(arguments),n="";return e.length>=4&&e[3]!==1&&(n=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+n+")"},Gr.to.keyword=function(e){return Ik[e.slice(0,3)]};var uB=_k.exports,Tk={exports:{}},rs={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Ok={};for(var rm in rs)rs.hasOwnProperty(rm)&&(Ok[rs[rm]]=rm);var Ct=Tk.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var Ir in Ct)if(Ct.hasOwnProperty(Ir)){if(!("channels"in Ct[Ir]))throw new Error("missing channels property: "+Ir);if(!("labels"in Ct[Ir]))throw new Error("missing channel labels property: "+Ir);if(Ct[Ir].labels.length!==Ct[Ir].channels)throw new Error("channel and label counts mismatch: "+Ir);var cB=Ct[Ir].channels,lB=Ct[Ir].labels;delete Ct[Ir].channels,delete Ct[Ir].labels,Object.defineProperty(Ct[Ir],"channels",{value:cB}),Object.defineProperty(Ct[Ir],"labels",{value:lB})}function hB(e,n){return Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2)+Math.pow(e[2]-n[2],2)}Ct.rgb.hsl=function(e){var n,t,r=e[0]/255,i=e[1]/255,o=e[2]/255,a=Math.min(r,i,o),s=Math.max(r,i,o),u=s-a;return s===a?n=0:r===s?n=(i-o)/u:i===s?n=2+(o-r)/u:o===s&&(n=4+(r-i)/u),(n=Math.min(60*n,360))<0&&(n+=360),t=(a+s)/2,[n,100*(s===a?0:t<=.5?u/(s+a):u/(2-s-a)),100*t]},Ct.rgb.hsv=function(e){var n,t,r,i,o,a=e[0]/255,s=e[1]/255,u=e[2]/255,c=Math.max(a,s,u),l=c-Math.min(a,s,u),h=function(f){return(c-f)/6/l+.5};return l===0?i=o=0:(o=l/c,n=h(a),t=h(s),r=h(u),a===c?i=r-t:s===c?i=1/3+n-r:u===c&&(i=2/3+t-n),i<0?i+=1:i>1&&(i-=1)),[360*i,100*o,100*c]},Ct.rgb.hwb=function(e){var n=e[0],t=e[1],r=e[2];return[Ct.rgb.hsl(e)[0],100*(1/255*Math.min(n,Math.min(t,r))),100*(r=1-1/255*Math.max(n,Math.max(t,r)))]},Ct.rgb.cmyk=function(e){var n,t=e[0]/255,r=e[1]/255,i=e[2]/255;return[100*((1-t-(n=Math.min(1-t,1-r,1-i)))/(1-n)||0),100*((1-r-n)/(1-n)||0),100*((1-i-n)/(1-n)||0),100*n]},Ct.rgb.keyword=function(e){var n=Ok[e];if(n)return n;var t,r=1/0;for(var i in rs)if(rs.hasOwnProperty(i)){var o=hB(e,rs[i]);o<r&&(r=o,t=i)}return t},Ct.keyword.rgb=function(e){return rs[e]},Ct.rgb.xyz=function(e){var n=e[0]/255,t=e[1]/255,r=e[2]/255;return[100*(.4124*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.3576*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.1805*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)),100*(.2126*n+.7152*t+.0722*r),100*(.0193*n+.1192*t+.9505*r)]},Ct.rgb.lab=function(e){var n=Ct.rgb.xyz(e),t=n[0],r=n[1],i=n[2];return r/=100,i/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(t-r),200*(r-(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116))]},Ct.hsl.rgb=function(e){var n,t,r,i,o,a=e[0]/360,s=e[1]/100,u=e[2]/100;if(s===0)return[o=255*u,o,o];n=2*u-(t=u<.5?u*(1+s):u+s-u*s),i=[0,0,0];for(var c=0;c<3;c++)(r=a+1/3*-(c-1))<0&&r++,r>1&&r--,o=6*r<1?n+6*(t-n)*r:2*r<1?t:3*r<2?n+(t-n)*(2/3-r)*6:n,i[c]=255*o;return i},Ct.hsl.hsv=function(e){var n=e[0],t=e[1]/100,r=e[2]/100,i=t,o=Math.max(r,.01);return t*=(r*=2)<=1?r:2-r,i*=o<=1?o:2-o,[n,100*(r===0?2*i/(o+i):2*t/(r+t)),100*((r+t)/2)]},Ct.hsv.rgb=function(e){var n=e[0]/60,t=e[1]/100,r=e[2]/100,i=Math.floor(n)%6,o=n-Math.floor(n),a=255*r*(1-t),s=255*r*(1-t*o),u=255*r*(1-t*(1-o));switch(r*=255,i){case 0:return[r,u,a];case 1:return[s,r,a];case 2:return[a,r,u];case 3:return[a,s,r];case 4:return[u,a,r];case 5:return[r,a,s]}},Ct.hsv.hsl=function(e){var n,t,r,i=e[0],o=e[1]/100,a=e[2]/100,s=Math.max(a,.01);return r=(2-o)*a,t=o*s,[i,100*(t=(t/=(n=(2-o)*s)<=1?n:2-n)||0),100*(r/=2)]},Ct.hwb.rgb=function(e){var n,t,r,i,o,a,s,u=e[0]/360,c=e[1]/100,l=e[2]/100,h=c+l;switch(h>1&&(c/=h,l/=h),r=6*u-(n=Math.floor(6*u)),1&n&&(r=1-r),i=c+r*((t=1-l)-c),n){default:case 6:case 0:o=t,a=i,s=c;break;case 1:o=i,a=t,s=c;break;case 2:o=c,a=t,s=i;break;case 3:o=c,a=i,s=t;break;case 4:o=i,a=c,s=t;break;case 5:o=t,a=c,s=i}return[255*o,255*a,255*s]},Ct.cmyk.rgb=function(e){var n=e[0]/100,t=e[1]/100,r=e[2]/100,i=e[3]/100;return[255*(1-Math.min(1,n*(1-i)+i)),255*(1-Math.min(1,t*(1-i)+i)),255*(1-Math.min(1,r*(1-i)+i))]},Ct.xyz.rgb=function(e){var n,t,r,i=e[0]/100,o=e[1]/100,a=e[2]/100;return t=-.9689*i+1.8758*o+.0415*a,r=.0557*i+-.204*o+1.057*a,n=(n=3.2406*i+-1.5372*o+-.4986*a)>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,t=t>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*(n=Math.min(Math.max(0,n),1)),255*(t=Math.min(Math.max(0,t),1)),255*(r=Math.min(Math.max(0,r),1))]},Ct.xyz.lab=function(e){var n=e[0],t=e[1],r=e[2];return t/=100,r/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(t=t>.008856?Math.pow(t,1/3):7.787*t+16/116)-16,500*(n-t),200*(t-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},Ct.lab.xyz=function(e){var n,t,r,i=e[0];n=e[1]/500+(t=(i+16)/116),r=t-e[2]/200;var o=Math.pow(t,3),a=Math.pow(n,3),s=Math.pow(r,3);return t=o>.008856?o:(t-16/116)/7.787,n=a>.008856?a:(n-16/116)/7.787,r=s>.008856?s:(r-16/116)/7.787,[n*=95.047,t*=100,r*=108.883]},Ct.lab.lch=function(e){var n,t=e[0],r=e[1],i=e[2];return(n=360*Math.atan2(i,r)/2/Math.PI)<0&&(n+=360),[t,Math.sqrt(r*r+i*i),n]},Ct.lch.lab=function(e){var n,t=e[0],r=e[1];return n=e[2]/360*2*Math.PI,[t,r*Math.cos(n),r*Math.sin(n)]},Ct.rgb.ansi16=function(e){var n=e[0],t=e[1],r=e[2],i=1 in arguments?arguments[1]:Ct.rgb.hsv(e)[2];if((i=Math.round(i/50))===0)return 30;var o=30+(Math.round(r/255)<<2|Math.round(t/255)<<1|Math.round(n/255));return i===2&&(o+=60),o},Ct.hsv.ansi16=function(e){return Ct.rgb.ansi16(Ct.hsv.rgb(e),e[2])},Ct.rgb.ansi256=function(e){var n=e[0],t=e[1],r=e[2];return n===t&&t===r?n<8?16:n>248?231:Math.round((n-8)/247*24)+232:16+36*Math.round(n/255*5)+6*Math.round(t/255*5)+Math.round(r/255*5)},Ct.ansi16.rgb=function(e){var n=e%10;if(n===0||n===7)return e>50&&(n+=3.5),[n=n/10.5*255,n,n];var t=.5*(1+~~(e>50));return[(1&n)*t*255,(n>>1&1)*t*255,(n>>2&1)*t*255]},Ct.ansi256.rgb=function(e){if(e>=232){var n=10*(e-232)+8;return[n,n,n]}var t;return e-=16,[Math.floor(e/36)/5*255,Math.floor((t=e%36)/6)/5*255,t%6/5*255]},Ct.rgb.hex=function(e){var n=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(n.length)+n},Ct.hex.rgb=function(e){var n=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!n)return[0,0,0];var t=n[0];n[0].length===3&&(t=t.split("").map(function(i){return i+i}).join(""));var r=parseInt(t,16);return[r>>16&255,r>>8&255,255&r]},Ct.rgb.hcg=function(e){var n,t=e[0]/255,r=e[1]/255,i=e[2]/255,o=Math.max(Math.max(t,r),i),a=Math.min(Math.min(t,r),i),s=o-a;return n=s<=0?0:o===t?(r-i)/s%6:o===r?2+(i-t)/s:4+(t-r)/s+4,n/=6,[360*(n%=1),100*s,100*(s<1?a/(1-s):0)]},Ct.hsl.hcg=function(e){var n=e[1]/100,t=e[2]/100,r=1,i=0;return(r=t<.5?2*n*t:2*n*(1-t))<1&&(i=(t-.5*r)/(1-r)),[e[0],100*r,100*i]},Ct.hsv.hcg=function(e){var n=e[1]/100,t=e[2]/100,r=n*t,i=0;return r<1&&(i=(t-r)/(1-r)),[e[0],100*r,100*i]},Ct.hcg.rgb=function(e){var n=e[0]/360,t=e[1]/100,r=e[2]/100;if(t===0)return[255*r,255*r,255*r];var i,o=[0,0,0],a=n%1*6,s=a%1,u=1-s;switch(Math.floor(a)){case 0:o[0]=1,o[1]=s,o[2]=0;break;case 1:o[0]=u,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=s;break;case 3:o[0]=0,o[1]=u,o[2]=1;break;case 4:o[0]=s,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=u}return i=(1-t)*r,[255*(t*o[0]+i),255*(t*o[1]+i),255*(t*o[2]+i)]},Ct.hcg.hsv=function(e){var n=e[1]/100,t=n+e[2]/100*(1-n),r=0;return t>0&&(r=n/t),[e[0],100*r,100*t]},Ct.hcg.hsl=function(e){var n=e[1]/100,t=e[2]/100*(1-n)+.5*n,r=0;return t>0&&t<.5?r=n/(2*t):t>=.5&&t<1&&(r=n/(2*(1-t))),[e[0],100*r,100*t]},Ct.hcg.hwb=function(e){var n=e[1]/100,t=n+e[2]/100*(1-n);return[e[0],100*(t-n),100*(1-t)]},Ct.hwb.hcg=function(e){var n=e[1]/100,t=1-e[2]/100,r=t-n,i=0;return r<1&&(i=(t-r)/(1-r)),[e[0],100*r,100*i]},Ct.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},Ct.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},Ct.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},Ct.gray.hsl=Ct.gray.hsv=function(e){return[0,0,e[0]]},Ct.gray.hwb=function(e){return[0,100,e[0]]},Ct.gray.cmyk=function(e){return[0,0,0,e[0]]},Ct.gray.lab=function(e){return[e[0],0,0]},Ct.gray.hex=function(e){var n=255&Math.round(e[0]/100*255),t=((n<<16)+(n<<8)+n).toString(16).toUpperCase();return"000000".substring(t.length)+t},Ct.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]};var Nk=Tk.exports,sd=Nk;function fB(e){var n=function(){for(var c={},l=Object.keys(sd),h=l.length,f=0;f<h;f++)c[l[f]]={distance:-1,parent:null};return c}(),t=[e];for(n[e].distance=0;t.length;)for(var r=t.pop(),i=Object.keys(sd[r]),o=i.length,a=0;a<o;a++){var s=i[a],u=n[s];u.distance===-1&&(u.distance=n[r].distance+1,u.parent=r,t.unshift(s))}return n}function dB(e,n){return function(t){return n(e(t))}}function pB(e,n){for(var t=[n[e].parent,e],r=sd[n[e].parent][e],i=n[e].parent;n[i].parent;)t.unshift(n[i].parent),r=dB(sd[n[i].parent][i],r),i=n[i].parent;return r.conversion=t,r}var im=Nk,gB=function(e){for(var n=fB(e),t={},r=Object.keys(n),i=r.length,o=0;o<i;o++){var a=r[o];n[a].parent!==null&&(t[a]=pB(a,n))}return t},au={};Object.keys(im).forEach(function(e){au[e]={},Object.defineProperty(au[e],"channels",{value:im[e].channels}),Object.defineProperty(au[e],"labels",{value:im[e].labels});var n=gB(e);Object.keys(n).forEach(function(t){var r=n[t];au[e][t]=function(i){var o=function(a){if(a==null)return a;arguments.length>1&&(a=Array.prototype.slice.call(arguments));var s=i(a);if(typeof s=="object")for(var u=s.length,c=0;c<u;c++)s[c]=Math.round(s[c]);return s};return"conversion"in i&&(o.conversion=i.conversion),o}(r),au[e][t].raw=function(i){var o=function(a){return a==null?a:(arguments.length>1&&(a=Array.prototype.slice.call(arguments)),i(a))};return"conversion"in i&&(o.conversion=i.conversion),o}(r)})});var Kc=uB,Ur=au,om=[].slice,Dk=["keyword","gray","hex"],am={};Object.keys(Ur).forEach(function(e){am[om.call(Ur[e].labels).sort().join("")]=e});var ud={};function lr(e,n){if(!(this instanceof lr))return new lr(e,n);if(n&&n in Dk&&(n=null),n&&!(n in Ur))throw new Error("Unknown model: "+n);var t,r;if(e==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof lr)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if(typeof e=="string"){var i=Kc.get(e);if(i===null)throw new Error("Unable to parse color from string: "+e);this.model=i.model,r=Ur[this.model].channels,this.color=i.value.slice(0,r),this.valpha=typeof i.value[r]=="number"?i.value[r]:1}else if(e.length){this.model=n||"rgb",r=Ur[this.model].channels;var o=om.call(e,0,r);this.color=sm(o,r),this.valpha=typeof e[r]=="number"?e[r]:1}else if(typeof e=="number")e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var a=Object.keys(e);"alpha"in e&&(a.splice(a.indexOf("alpha"),1),this.valpha=typeof e.alpha=="number"?e.alpha:0);var s=a.sort().join("");if(!(s in am))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=am[s];var u=Ur[this.model].labels,c=[];for(t=0;t<u.length;t++)c.push(e[u[t]]);this.color=sm(c)}if(ud[this.model])for(r=Ur[this.model].channels,t=0;t<r;t++){var l=ud[this.model][t];l&&(this.color[t]=l(this.color[t]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function On(e,n,t){return(e=Array.isArray(e)?e:[e]).forEach(function(r){(ud[r]||(ud[r]=[]))[n]=t}),e=e[0],function(r){var i;return arguments.length?(t&&(r=t(r)),(i=this[e]()).color[n]=r,i):(i=this[e]().color[n],t&&(i=t(i)),i)}}function Hn(e){return function(n){return Math.max(0,Math.min(e,n))}}function sm(e,n){for(var t=0;t<n;t++)typeof e[t]!="number"&&(e[t]=0);return e}lr.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var n=this.model in Kc.to?this:this.rgb(),t=(n=n.round(typeof e=="number"?e:1)).valpha===1?n.color:n.color.concat(this.valpha);return Kc.to[n.model](t)},percentString:function(e){var n=this.rgb().round(typeof e=="number"?e:1),t=n.valpha===1?n.color:n.color.concat(this.valpha);return Kc.to.rgb.percent(t)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},n=Ur[this.model].channels,t=Ur[this.model].labels,r=0;r<n;r++)e[t[r]]=this.color[r];return this.valpha!==1&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,this.valpha!==1&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,this.valpha!==1&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new lr(this.color.map(function(n){return function(t){return function(r,i){return Number(r.toFixed(i))}(t,n)}}(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new lr(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:On("rgb",0,Hn(255)),green:On("rgb",1,Hn(255)),blue:On("rgb",2,Hn(255)),hue:On(["hsl","hsv","hsl","hwb","hcg"],0,function(e){return(e%360+360)%360}),saturationl:On("hsl",1,Hn(100)),lightness:On("hsl",2,Hn(100)),saturationv:On("hsv",1,Hn(100)),value:On("hsv",2,Hn(100)),chroma:On("hcg",1,Hn(100)),gray:On("hcg",2,Hn(100)),white:On("hwb",1,Hn(100)),wblack:On("hwb",2,Hn(100)),cyan:On("cmyk",0,Hn(100)),magenta:On("cmyk",1,Hn(100)),yellow:On("cmyk",2,Hn(100)),black:On("cmyk",3,Hn(100)),x:On("xyz",0,Hn(100)),y:On("xyz",1,Hn(100)),z:On("xyz",2,Hn(100)),l:On("lab",0,Hn(100)),a:On("lab",1),b:On("lab",2),keyword:function(e){return arguments.length?new lr(e):Ur[this.model].keyword(this.color)},hex:function(e){return arguments.length?new lr(e):Kc.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,n=[],t=0;t<e.length;t++){var r=e[t]/255;n[t]=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}return .2126*n[0]+.7152*n[1]+.0722*n[2]},contrast:function(e){var n=this.luminosity(),t=e.luminosity();return n>t?(n+.05)/(t+.05):(t+.05)/(n+.05)},level:function(e){var n=this.contrast(e);return n>=7.1?"AAA":n>=4.5?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),n=0;n<3;n++)e.color[n]=255-e.color[n];return e},lighten:function(e){var n=this.hsl();return n.color[2]+=n.color[2]*e,n},darken:function(e){var n=this.hsl();return n.color[2]-=n.color[2]*e,n},saturate:function(e){var n=this.hsl();return n.color[1]+=n.color[1]*e,n},desaturate:function(e){var n=this.hsl();return n.color[1]-=n.color[1]*e,n},whiten:function(e){var n=this.hwb();return n.color[1]+=n.color[1]*e,n},blacken:function(e){var n=this.hwb();return n.color[2]+=n.color[2]*e,n},grayscale:function(){var e=this.rgb().color,n=.3*e[0]+.59*e[1]+.11*e[2];return lr.rgb(n,n,n)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var n=this.hsl(),t=n.color[0];return t=(t=(t+e)%360)<0?360+t:t,n.color[0]=t,n},mix:function(e,n){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var t=e.rgb(),r=this.rgb(),i=n===void 0?.5:n,o=2*i-1,a=t.alpha()-r.alpha(),s=((o*a==-1?o:(o+a)/(1+o*a))+1)/2,u=1-s;return lr.rgb(s*t.red()+u*r.red(),s*t.green()+u*r.green(),s*t.blue()+u*r.blue(),t.alpha()*i+r.alpha()*(1-i))}},Object.keys(Ur).forEach(function(e){if(Dk.indexOf(e)===-1){var n=Ur[e].channels;lr.prototype[e]=function(){if(this.model===e)return new lr(this);if(arguments.length)return new lr(arguments,e);var t,r=typeof arguments[n]=="number"?n:this.valpha;return new lr((t=Ur[this.model][e].raw(this.color),Array.isArray(t)?t:[t]).concat(r),e)},lr[e]=function(t){return typeof t=="number"&&(t=sm(om.call(arguments),n)),new lr(t,e)}}});const $c=Bi(lr);function cd(e){return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},cd(e)}var vB=/^\s+/,mB=/\s+$/;function At(e,n){if(n=n||{},(e=e||"")instanceof At)return e;if(!(this instanceof At))return new At(e,n);var t=function(r){var i={r:0,g:0,b:0},o=1,a=null,s=null,u=null,c=!1,l=!1;return typeof r=="string"&&(r=function(h){h=h.replace(vB,"").replace(mB,"").toLowerCase();var f,d=!1;if(um[h])h=um[h],d=!0;else if(h=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(f=Mi.rgb.exec(h))?{r:f[1],g:f[2],b:f[3]}:(f=Mi.rgba.exec(h))?{r:f[1],g:f[2],b:f[3],a:f[4]}:(f=Mi.hsl.exec(h))?{h:f[1],s:f[2],l:f[3]}:(f=Mi.hsla.exec(h))?{h:f[1],s:f[2],l:f[3],a:f[4]}:(f=Mi.hsv.exec(h))?{h:f[1],s:f[2],v:f[3]}:(f=Mi.hsva.exec(h))?{h:f[1],s:f[2],v:f[3],a:f[4]}:(f=Mi.hex8.exec(h))?{r:Xr(f[1]),g:Xr(f[2]),b:Xr(f[3]),a:Gk(f[4]),format:d?"name":"hex8"}:(f=Mi.hex6.exec(h))?{r:Xr(f[1]),g:Xr(f[2]),b:Xr(f[3]),format:d?"name":"hex"}:(f=Mi.hex4.exec(h))?{r:Xr(f[1]+""+f[1]),g:Xr(f[2]+""+f[2]),b:Xr(f[3]+""+f[3]),a:Gk(f[4]+""+f[4]),format:d?"name":"hex8"}:(f=Mi.hex3.exec(h))?{r:Xr(f[1]+""+f[1]),g:Xr(f[2]+""+f[2]),b:Xr(f[3]+""+f[3]),format:d?"name":"hex"}:!1}(r)),cd(r)=="object"&&(xo(r.r)&&xo(r.g)&&xo(r.b)?(i=function(h,f,d){return{r:255*wn(h,255),g:255*wn(f,255),b:255*wn(d,255)}}(r.r,r.g,r.b),c=!0,l=String(r.r).substr(-1)==="%"?"prgb":"rgb"):xo(r.h)&&xo(r.s)&&xo(r.v)?(a=Qc(r.s),s=Qc(r.v),i=function(h,f,d){h=6*wn(h,360),f=wn(f,100),d=wn(d,100);var p=Math.floor(h),g=h-p,v=d*(1-f),m=d*(1-g*f),y=d*(1-(1-g)*f),b=p%6,x=[d,m,v,v,y,d][b],w=[y,d,d,m,v,v][b],E=[v,v,y,d,d,m][b];return{r:255*x,g:255*w,b:255*E}}(r.h,a,s),c=!0,l="hsv"):xo(r.h)&&xo(r.s)&&xo(r.l)&&(a=Qc(r.s),u=Qc(r.l),i=function(h,f,d){var p,g,v;function m(x,w,E){return E<0&&(E+=1),E>1&&(E-=1),E<1/6?x+6*(w-x)*E:E<.5?w:E<2/3?x+(w-x)*(2/3-E)*6:x}if(h=wn(h,360),f=wn(f,100),d=wn(d,100),f===0)p=g=v=d;else{var y=d<.5?d*(1+f):d+f-d*f,b=2*d-y;p=m(b,y,h+1/3),g=m(b,y,h),v=m(b,y,h-1/3)}return{r:255*p,g:255*g,b:255*v}}(r.h,a,u),c=!0,l="hsl"),r.hasOwnProperty("a")&&(o=r.a)),o=zk(o),{ok:c,format:r.format||l,r:Math.min(255,Math.max(i.r,0)),g:Math.min(255,Math.max(i.g,0)),b:Math.min(255,Math.max(i.b,0)),a:o}}(e);this._originalInput=e,this._r=t.r,this._g=t.g,this._b=t.b,this._a=t.a,this._roundA=Math.round(100*this._a)/100,this._format=n.format||t.format,this._gradientType=n.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=t.ok}function Pk(e,n,t){e=wn(e,255),n=wn(n,255),t=wn(t,255);var r,i,o=Math.max(e,n,t),a=Math.min(e,n,t),s=(o+a)/2;if(o==a)r=i=0;else{var u=o-a;switch(i=s>.5?u/(2-o-a):u/(o+a),o){case e:r=(n-t)/u+(n<t?6:0);break;case n:r=(t-e)/u+2;break;case t:r=(e-n)/u+4}r/=6}return{h:r,s:i,l:s}}function Lk(e,n,t){e=wn(e,255),n=wn(n,255),t=wn(t,255);var r,i,o=Math.max(e,n,t),a=Math.min(e,n,t),s=o,u=o-a;if(i=o===0?0:u/o,o==a)r=0;else{switch(o){case e:r=(n-t)/u+(n<t?6:0);break;case n:r=(t-e)/u+2;break;case t:r=(e-n)/u+4}r/=6}return{h:r,s:i,v:s}}function Rk(e,n,t,r){var i=[Ei(Math.round(e).toString(16)),Ei(Math.round(n).toString(16)),Ei(Math.round(t).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function jk(e,n,t,r){return[Ei(Fk(r)),Ei(Math.round(e).toString(16)),Ei(Math.round(n).toString(16)),Ei(Math.round(t).toString(16))].join("")}function yB(e,n){n=n===0?0:n||10;var t=At(e).toHsl();return t.s-=n/100,t.s=ld(t.s),At(t)}function bB(e,n){n=n===0?0:n||10;var t=At(e).toHsl();return t.s+=n/100,t.s=ld(t.s),At(t)}function xB(e){return At(e).desaturate(100)}function wB(e,n){n=n===0?0:n||10;var t=At(e).toHsl();return t.l+=n/100,t.l=ld(t.l),At(t)}function EB(e,n){n=n===0?0:n||10;var t=At(e).toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(-n/100*255))),t.g=Math.max(0,Math.min(255,t.g-Math.round(-n/100*255))),t.b=Math.max(0,Math.min(255,t.b-Math.round(-n/100*255))),At(t)}function MB(e,n){n=n===0?0:n||10;var t=At(e).toHsl();return t.l-=n/100,t.l=ld(t.l),At(t)}function SB(e,n){var t=At(e).toHsl(),r=(t.h+n)%360;return t.h=r<0?360+r:r,At(t)}function _B(e){var n=At(e).toHsl();return n.h=(n.h+180)%360,At(n)}function Bk(e,n){if(isNaN(n)||n<=0)throw new Error("Argument to polyad must be a positive number");for(var t=At(e).toHsl(),r=[At(e)],i=360/n,o=1;o<n;o++)r.push(At({h:(t.h+o*i)%360,s:t.s,l:t.l}));return r}function kB(e){var n=At(e).toHsl(),t=n.h;return[At(e),At({h:(t+72)%360,s:n.s,l:n.l}),At({h:(t+216)%360,s:n.s,l:n.l})]}function CB(e,n,t){n=n||6,t=t||30;var r=At(e).toHsl(),i=360/t,o=[At(e)];for(r.h=(r.h-(i*n>>1)+720)%360;--n;)r.h=(r.h+i)%360,o.push(At(r));return o}function AB(e,n){n=n||6;for(var t=At(e).toHsv(),r=t.h,i=t.s,o=t.v,a=[],s=1/n;n--;)a.push(At({h:r,s:i,v:o})),o=(o+s)%1;return a}At.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,n,t,r=this.toRgb();return e=r.r/255,n=r.g/255,t=r.b/255,.2126*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))},setAlpha:function(e){return this._a=zk(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=Lk(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=Lk(this._r,this._g,this._b),n=Math.round(360*e.h),t=Math.round(100*e.s),r=Math.round(100*e.v);return this._a==1?"hsv("+n+", "+t+"%, "+r+"%)":"hsva("+n+", "+t+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=Pk(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=Pk(this._r,this._g,this._b),n=Math.round(360*e.h),t=Math.round(100*e.s),r=Math.round(100*e.l);return this._a==1?"hsl("+n+", "+t+"%, "+r+"%)":"hsla("+n+", "+t+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return Rk(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return function(n,t,r,i,o){var a=[Ei(Math.round(n).toString(16)),Ei(Math.round(t).toString(16)),Ei(Math.round(r).toString(16)),Ei(Fk(i))];return o&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*wn(this._r,255))+"%",g:Math.round(100*wn(this._g,255))+"%",b:Math.round(100*wn(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(100*wn(this._r,255))+"%, "+Math.round(100*wn(this._g,255))+"%, "+Math.round(100*wn(this._b,255))+"%)":"rgba("+Math.round(100*wn(this._r,255))+"%, "+Math.round(100*wn(this._g,255))+"%, "+Math.round(100*wn(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(IB[Rk(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var n="#"+jk(this._r,this._g,this._b,this._a),t=n,r=this._gradientType?"GradientType = 1, ":"";if(e){var i=At(e);t="#"+jk(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+n+",endColorstr="+t+")"},toString:function(e){var n=!!e;e=e||this._format;var t=!1,r=this._a<1&&this._a>=0;return n||!r||e!=="hex"&&e!=="hex6"&&e!=="hex3"&&e!=="hex4"&&e!=="hex8"&&e!=="name"?(e==="rgb"&&(t=this.toRgbString()),e==="prgb"&&(t=this.toPercentageRgbString()),e!=="hex"&&e!=="hex6"||(t=this.toHexString()),e==="hex3"&&(t=this.toHexString(!0)),e==="hex4"&&(t=this.toHex8String(!0)),e==="hex8"&&(t=this.toHex8String()),e==="name"&&(t=this.toName()),e==="hsl"&&(t=this.toHslString()),e==="hsv"&&(t=this.toHsvString()),t||this.toHexString()):e==="name"&&this._a===0?this.toName():this.toRgbString()},clone:function(){return At(this.toString())},_applyModification:function(e,n){var t=e.apply(null,[this].concat([].slice.call(n)));return this._r=t._r,this._g=t._g,this._b=t._b,this.setAlpha(t._a),this},lighten:function(){return this._applyModification(wB,arguments)},brighten:function(){return this._applyModification(EB,arguments)},darken:function(){return this._applyModification(MB,arguments)},desaturate:function(){return this._applyModification(yB,arguments)},saturate:function(){return this._applyModification(bB,arguments)},greyscale:function(){return this._applyModification(xB,arguments)},spin:function(){return this._applyModification(SB,arguments)},_applyCombination:function(e,n){return e.apply(null,[this].concat([].slice.call(n)))},analogous:function(){return this._applyCombination(CB,arguments)},complement:function(){return this._applyCombination(_B,arguments)},monochromatic:function(){return this._applyCombination(AB,arguments)},splitcomplement:function(){return this._applyCombination(kB,arguments)},triad:function(){return this._applyCombination(Bk,[3])},tetrad:function(){return this._applyCombination(Bk,[4])}},At.fromRatio=function(e,n){if(cd(e)=="object"){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=r==="a"?e[r]:Qc(e[r]));e=t}return At(e,n)},At.equals=function(e,n){return!(!e||!n)&&At(e).toRgbString()==At(n).toRgbString()},At.random=function(){return At.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},At.mix=function(e,n,t){t=t===0?0:t||50;var r=At(e).toRgb(),i=At(n).toRgb(),o=t/100;return At({r:(i.r-r.r)*o+r.r,g:(i.g-r.g)*o+r.g,b:(i.b-r.b)*o+r.b,a:(i.a-r.a)*o+r.a})},At.readability=function(e,n){var t=At(e),r=At(n);return(Math.max(t.getLuminance(),r.getLuminance())+.05)/(Math.min(t.getLuminance(),r.getLuminance())+.05)},At.isReadable=function(e,n,t){var r,i,o=At.readability(e,n);switch(i=!1,r=function(a){var s,u;return s=((a=a||{level:"AA",size:"small"}).level||"AA").toUpperCase(),u=(a.size||"small").toLowerCase(),s!=="AA"&&s!=="AAA"&&(s="AA"),u!=="small"&&u!=="large"&&(u="small"),{level:s,size:u}}(t),r.level+r.size){case"AAsmall":case"AAAlarge":i=o>=4.5;break;case"AAlarge":i=o>=3;break;case"AAAsmall":i=o>=7}return i},At.mostReadable=function(e,n,t){var r,i,o,a,s=null,u=0;i=(t=t||{}).includeFallbackColors,o=t.level,a=t.size;for(var c=0;c<n.length;c++)(r=At.readability(e,n[c]))>u&&(u=r,s=At(n[c]));return At.isReadable(e,s,{level:o,size:a})||!i?s:(t.includeFallbackColors=!1,At.mostReadable(e,["#fff","#000"],t))};var um=At.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},IB=At.hexNames=function(e){var n={};for(var t in e)e.hasOwnProperty(t)&&(n[e[t]]=t);return n}(um);function zk(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function wn(e,n){(function(r){return typeof r=="string"&&r.indexOf(".")!=-1&&parseFloat(r)===1})(e)&&(e="100%");var t=function(r){return typeof r=="string"&&r.indexOf("%")!=-1}(e);return e=Math.min(n,Math.max(0,parseFloat(e))),t&&(e=parseInt(e*n,10)/100),Math.abs(e-n)<1e-6?1:e%n/parseFloat(n)}function ld(e){return Math.min(1,Math.max(0,e))}function Xr(e){return parseInt(e,16)}function Ei(e){return e.length==1?"0"+e:""+e}function Qc(e){return e<=1&&(e=100*e+"%"),e}function Fk(e){return Math.round(255*parseFloat(e)).toString(16)}function Gk(e){return Xr(e)/255}var ua,hd,fd,Mi=(hd="[\\s|\\(]+("+(ua="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+ua+")[,|\\s]+("+ua+")\\s*\\)?",fd="[\\s|\\(]+("+ua+")[,|\\s]+("+ua+")[,|\\s]+("+ua+")[,|\\s]+("+ua+")\\s*\\)?",{CSS_UNIT:new RegExp(ua),rgb:new RegExp("rgb"+hd),rgba:new RegExp("rgba"+fd),hsl:new RegExp("hsl"+hd),hsla:new RegExp("hsla"+fd),hsv:new RegExp("hsv"+hd),hsva:new RegExp("hsva"+fd),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function xo(e){return!!Mi.CSS_UNIT.exec(e)}var TB=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function Uk(e,n,t){var r;return(r=Math.round(e.h)>=60&&Math.round(e.h)<=240?t?Math.round(e.h)-2*n:Math.round(e.h)+2*n:t?Math.round(e.h)+2*n:Math.round(e.h)-2*n)<0?r+=360:r>=360&&(r-=360),r}function Xk(e,n,t){return e.h===0&&e.s===0?e.s:((r=t?e.s-.16*n:n===4?e.s+.16:e.s+.05*n)>1&&(r=1),t&&n===5&&r>.1&&(r=.1),r<.06&&(r=.06),Number(r.toFixed(2)));var r}function Yk(e,n,t){var r;return(r=t?e.v+.05*n:e.v-.15*n)>1&&(r=1),Number(r.toFixed(2))}function dd(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=[],r=At(e),i=5;i>0;i-=1){var o=r.toHsv(),a=At({h:Uk(o,i,!0),s:Xk(o,i,!0),v:Yk(o,i,!0)}).toHexString();t.push(a)}t.push(r.toHexString());for(var s=1;s<=4;s+=1){var u=r.toHsv(),c=At({h:Uk(u,s),s:Xk(u,s),v:Yk(u,s)}).toHexString();t.push(c)}return n.theme==="dark"?TB.map(function(l){var h=l.index,f=l.opacity;return At.mix(n.backgroundColor||"#141414",t[h],100*f).toHexString()}):t}var cm={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},lm={},hm={};Object.keys(cm).forEach(function(e){lm[e]=dd(cm[e]),lm[e].primary=lm[e][5],hm[e]=dd(cm[e],{theme:"dark",backgroundColor:"#141414"}),hm[e].primary=hm[e][5]});var qn=function(e,n,t){var r=$c(e),i=$c(n);return $c([(1-t)*r.red()+t*i.red(),(1-t)*r.green()+t*i.green(),(1-t)*r.blue()+t*i.blue()]).rgb()},fm=function(e,n,t,r){return n===void 0&&(n="#fff"),t===void 0&&(t="default"),t==="default"?function(i,o,a){o===void 0&&(o="#fff");var s=qn(o,i,.05).rgb().toString(),u=qn(o,i,.1).rgb().toString(),c=qn(o,i,.2).rgb().toString(),l=qn(o,i,.4).rgb().toString(),h=qn(o,a,.02).rgb().toString(),f=qn(o,a,.05).rgb().toString(),d=qn(o,a,.1).rgb().toString(),p=qn(o,a,.2).rgb().toString(),g=qn(o,a,.3).rgb().toString(),v=dd(i,{theme:"default",backgroundColor:o}),m=$c(i).hex().toLowerCase(),y=v.indexOf(m),b=i;return y!==-1&&(b=v[y+1]),{mainStroke:i,mainFill:u,activeStroke:i,activeFill:s,inactiveStroke:l,inactiveFill:s,selectedStroke:i,selectedFill:o,highlightStroke:b,highlightFill:c,disableStroke:g,disableFill:f,edgeMainStroke:g,edgeActiveStroke:i,edgeInactiveStroke:p,edgeSelectedStroke:i,edgeHighlightStroke:i,edgeDisableStroke:d,comboMainStroke:g,comboMainFill:h,comboActiveStroke:i,comboActiveFill:s,comboInactiveStroke:g,comboInactiveFill:h,comboSelectedStroke:i,comboSelectedFill:h,comboHighlightStroke:b,comboHighlightFill:h,comboDisableStroke:p,comboDisableFill:f}}(e,n,"rgb(150, 150, 150)"):function(i,o,a){o===void 0&&(o="#fff");var s=qn(o,i,.2).rgb().toString(),u=qn(o,i,.3).rgb().toString(),c=qn(o,i,.6).rgb().toString(),l=qn(o,i,.8).rgb().toString(),h=qn(o,a,.2).rgb().toString(),f=qn(o,a,.25).rgb().toString(),d=qn(o,a,.3).rgb().toString(),p=qn(o,a,.4).rgb().toString(),g=qn(o,a,.5).rgb().toString(),v=dd(i,{theme:"dark",backgroundColor:o}),m=$c(i).hex().toLowerCase(),y=v.indexOf(m),b=i;return y!==-1&&(b=v[y+1]),{mainStroke:l,mainFill:s,activeStroke:i,activeFill:u,inactiveStroke:l,inactiveFill:s,selectedStroke:i,selectedFill:s,highlightStroke:i,highlightFill:c,disableStroke:g,disableFill:f,edgeMainStroke:a,edgeActiveStroke:i,edgeInactiveStroke:a,edgeSelectedStroke:i,edgeHighlightStroke:i,edgeDisableStroke:d,comboMainStroke:p,comboMainFill:f,comboActiveStroke:i,comboActiveFill:h,comboInactiveStroke:p,comboInactiveFill:f,comboSelectedStroke:i,comboSelectedFill:h,comboHighlightStroke:b,comboHighlightFill:f,comboDisableStroke:p,comboDisableFill:h}}(e,n,"#777")};const OB=Object.freeze(Object.defineProperty({__proto__:null,getColorSetsBySubjectColors:function(e,n,t,r){n===void 0&&(n="#fff"),t===void 0&&(t="default");var i=[];return e.forEach(function(o){i.push(fm(o,n,t))}),i},getColorsWithSubjectColor:fm,mixColor:qn},Symbol.toStringTag,{value:"Module"}));var Wk="rgb(0, 0, 0)",nn=fm("rgb(95, 149, 255)","rgb(255, 255, 255)");const is={version:"0.8.23",rootContainerClassName:"root-container",nodeContainerClassName:"node-container",edgeContainerClassName:"edge-container",comboContainerClassName:"combo-container",delegateContainerClassName:"delegate-container",defaultLoopPosition:"top",nodeLabel:{style:{fill:"#000",fontSize:12,textAlign:"center",textBaseline:"middle"},offset:4},defaultNode:{type:"circle",style:{lineWidth:1,stroke:nn.mainStroke,fill:nn.mainFill},size:20,color:nn.mainStroke,linkPoints:{size:8,lineWidth:1,fill:nn.activeFill,stroke:nn.activeStroke}},nodeStateStyles:{active:{fill:nn.activeFill,stroke:nn.activeStroke,lineWidth:2,shadowColor:nn.mainStroke,shadowBlur:10},selected:{fill:nn.selectedFill,stroke:nn.selectedStroke,lineWidth:4,shadowColor:nn.selectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{fill:nn.highlightFill,stroke:nn.highlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{fill:nn.inactiveFill,stroke:nn.inactiveStroke,lineWidth:1},disable:{fill:nn.disableFill,stroke:nn.disableStroke,lineWidth:1}},edgeLabel:{style:{fill:Wk,textAlign:"center",textBaseline:"middle",fontSize:12}},defaultEdge:{type:"line",size:1,style:{stroke:nn.edgeMainStroke,lineAppendWidth:2},color:nn.edgeMainStroke},edgeStateStyles:{active:{stroke:nn.edgeActiveStroke,lineWidth:1},selected:{stroke:nn.edgeSelectedStroke,lineWidth:2,shadowColor:nn.edgeSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:nn.edgeHighlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{stroke:nn.edgeInactiveStroke,lineWidth:1},disable:{stroke:nn.edgeDisableStroke,lineWidth:1}},comboLabel:{style:{fill:Wk,textBaseline:"middle",fontSize:12},refY:10,refX:10},defaultCombo:{type:"circle",style:{fill:nn.comboMainFill,lineWidth:1,stroke:nn.comboMainStroke,r:5,width:20,height:10},size:[20,5],color:nn.comboMainStroke,padding:[25,20,15,20]},comboStateStyles:{active:{stroke:nn.comboActiveStroke,lineWidth:1,fill:nn.comboActiveFill},selected:{stroke:nn.comboSelectedStroke,lineWidth:2,fill:nn.comboSelectedFill,shadowColor:nn.comboSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:nn.comboHighlightStroke,lineWidth:2,fill:nn.comboHighlightFill,"text-shape":{fontWeight:500}},inactive:{stroke:nn.comboInactiveStroke,fill:nn.comboInactiveFill,lineWidth:1},disable:{stroke:nn.comboDisableStroke,fill:nn.comboDisableFill,lineWidth:1}},delegateStyle:{fill:"#F3F9FF",fillOpacity:.5,stroke:"#1890FF",strokeOpacity:.9,lineDash:[5,5]},textWaterMarkerConfig:{width:150,height:100,compatible:!1,text:{x:0,y:60,lineHeight:20,rotate:20,fontSize:14,fontFamily:"Microsoft YaHei",fill:"rgba(0, 0, 0, 0.1)",baseline:"Middle"}},imageWaterMarkerConfig:{width:150,height:130,compatible:!1,image:{x:0,y:0,width:30,height:20,rotate:0}},waterMarkerImage:"https://gw.alipayobjects.com/os/s/prod/antv/assets/image/logo-with-text-73b8a.svg"};var NB=function e(n,t){var r;n.isGroup()&&t.isGroup()&&((r=n.get("children"))===null||r===void 0||r.forEach(function(s,u){var c=t.get("children")[u];e(s,c)}));var i=n.get("type"),o=t.get("type");if(i==="image"&&o==="image"){var a=n.get("clipShape");a&&t.setClip({type:a.get("type"),attrs:a.attr()})}},DB=gr.cloneEvent,PB=gr.isViewportChanged,LB=function(e){function n(t){var r=e.call(this,t)||this;return r.extendEvents=[],r.dragging=!1,r.mousedown=!1,r.preItem=null,r.destroy(),r.graph=t,r.destroyed=!1,r.initEvents(),r}return Nt(n,e),n.prototype.initEvents=function(){var t=this.graph,r=this.extendEvents,i=r===void 0?[]:r,o=t.get("canvas"),a=o.get("el"),s=Ya(this,"onCanvasEvents"),u=Ya(this,"onExtendEvents"),c=Ya(this,"onWheelEvent");o.off("*").on("*",s),this.canvasHandler=s,i.push(od(a,"wheel",c)),typeof window<"u"&&(i.push(od(window,"keydown",u)),i.push(od(window,"keyup",u)),i.push(od(window,"focus",u))),this.resetHandler&&t.off("afterchangedata",this.resetHandler),this.resetHandler=Ya(this,"resetStatus"),t.on("afterchangedata",this.resetHandler)},n.getItemRoot=function(t){for(;t&&!t.get("item");)t=t.get("parent");return t},n.prototype.onCanvasEvents=function(t){var r=this,i=this.graph,o=i.get("canvas"),a=t.target,s=t.type;switch(s){case"drag":this.onCanvasEvents(Object.assign({},t,{type:"mousemove"}));break;case"dragend":this.onCanvasEvents(Object.assign({},t,{type:"mouseup"}));break;case"mousedown":this.mousedown=!0;break;case"mouseup":setTimeout(function(){return r.mousedown=!1});break;case"click":if(!this.mousedown)return}t.canvasX=t.x,t.canvasY=t.y;var u={x:t.canvasX,y:t.canvasY},c=i.get("group").getMatrix();if(c||(c=[1,0,0,0,1,0,0,0,1]),PB(c)&&(u=i.getPointByClient(t.clientX,t.clientY)),t.x=u.x,t.y=u.y,t.currentTarget=i,a===o)return s!=="mousemove"&&s!=="mouseleave"||this.handleMouseMove(t,"canvas"),t.target=o,t.item=null,i.emit(s,t),void i.emit("canvas:".concat(s),t);var l=n.getItemRoot(a);if(l){var h=l.get("item");if(!h.destroyed){var f=h.getType();if(t.target=a,t.item=h,t.canvasX===t.x&&t.canvasY===t.y){var d=i.getCanvasByPoint(t.x,t.y);t.canvasX=d.x,t.canvasY=d.y}t.name&&!t.name.includes(":")?(i.emit("".concat(f,":").concat(s),t),i.emit(s,t)):t.name&&i.emit(t.name,t),s==="dragstart"&&(this.dragging=!0),s==="dragend"&&(this.dragging=!1),s==="mousemove"&&this.handleMouseMove(t,f)}}else i.emit(s,t)},n.prototype.onExtendEvents=function(t){this.graph.emit(t.type,t)},n.prototype.onWheelEvent=function(t){yt(t.wheelDelta)&&(t.wheelDelta=-t.detail),this.graph.emit("wheel",t)},n.prototype.handleMouseMove=function(t,r){var i=this.graph,o=this.preItem,a=i.get("canvas"),s=t.target===a?null:t.item;t=DB(t),o&&o!==s&&!o.destroyed&&(t.item=o,this.emitCustomEvent(o.getType(),"mouseleave",t),this.dragging&&this.emitCustomEvent(o.getType(),"dragleave",t)),s&&o!==s&&(t.item=s,this.emitCustomEvent(r,"mouseenter",t),this.dragging&&this.emitCustomEvent(r,"dragenter",t)),this.preItem=s},n.prototype.emitCustomEvent=function(t,r,i){i.type=r,this.graph.emit("".concat(t,":").concat(r),i)},n.prototype.resetStatus=function(){this.mousedown=!1,this.dragging=!1,this.preItem=null},n.prototype.destroy=function(){var t=this,r=t.graph,i=t.canvasHandler,o=t.extendEvents;r.get("canvas").off("*",i),ye(o,function(a){a.remove()}),this.resetStatus(),this.extendEvents.length=0,this.canvasHandler=null,this.resetHandler=null,this.destroyed=!0},n}(lR),$t={},wo={},Nn={};Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.Base=void 0;var RB=function(){function e(){this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.hiddenNodes=[],this.hiddenEdges=[],this.hiddenCombos=[],this.vedges=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=function(){}}return e.prototype.layout=function(n){return this.init(n),this.execute(!0)},e.prototype.init=function(n){this.nodes=n.nodes||[],this.edges=n.edges||[],this.combos=n.combos||[],this.comboEdges=n.comboEdges||[],this.hiddenNodes=n.hiddenNodes||[],this.hiddenEdges=n.hiddenEdges||[],this.hiddenCombos=n.hiddenCombos||[],this.vedges=n.vedges||[]},e.prototype.execute=function(n){},e.prototype.executeWithWorker=function(){},e.prototype.getDefaultCfg=function(){return{}},e.prototype.updateCfg=function(n){n&&Object.assign(this,n)},e.prototype.getType=function(){return"base"},e.prototype.destroy=function(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0},e}();Nn.Base=RB;var Vk={},su={};Object.defineProperty(su,"__esModule",{value:!0}),su.camelize=su.isString=void 0,su.isString=function(e){return typeof e=="string"};var jB=/-(\w)/g;su.camelize=function(e){var n=Object.create(null);return function(t){return n[t]||(n[t]=e(t))}}(function(e){return e.replace(jB,function(n,t){return t?t.toUpperCase():""})});var Jc={};Object.defineProperty(Jc,"__esModule",{value:!0}),Jc.isArray=void 0,Jc.isArray=Array.isArray;var pd={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.toNumber=e.isNaN=e.isNumber=void 0,e.isNumber=function(n){return typeof n=="number"},e.isNaN=function(n){return Number.isNaN(Number(n))},e.toNumber=function(n){var t=parseFloat(n);return(0,e.isNaN)(t)?n:t}})(pd);var gd={},dm={};(function(e){var n=xe&&xe.__assign||function(){return n=Object.assign||function(t){for(var r,i=1,o=arguments.length;i<o;i++)for(var a in r=arguments[i])Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);return t},n.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.clone=e.isObject=void 0,e.isObject=function(t){return t!==null&&typeof t=="object"},e.clone=function(t){if(t===null)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){var r=[];return t.forEach(function(o){r.push(o)}),r.map(function(o){return(0,e.clone)(o)})}if(typeof t=="object"&&Object.keys(t).length){var i=n({},t);return Object.keys(i).forEach(function(o){i[o]=(0,e.clone)(i[o])}),i}return t}})(dm),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getCoreNodeAndRelativeLeafNodes=e.getAvgNodePosition=e.getLayoutBBox=e.traverseTreeUp=e.scaleMatrix=e.getAdjMatrix=e.floydWarshall=e.getDegreeMap=e.getDegree=e.getEdgeTerminal=void 0;var n=Jc,t=pd,r=dm;e.getEdgeTerminal=function(s,u){var c=s[u];return(0,r.isObject)(c)?c.cell:c},e.getDegree=function(s,u,c){for(var l=[],h=0;h<s;h++)l[h]={in:0,out:0,all:0};return c&&c.forEach(function(f){var d=(0,e.getEdgeTerminal)(f,"source"),p=(0,e.getEdgeTerminal)(f,"target");d&&l[u[d]]&&(l[u[d]].out+=1,l[u[d]].all+=1),p&&l[u[p]]&&(l[u[p]].in+=1,l[u[p]].all+=1)}),l},e.getDegreeMap=function(s,u){var c={};return s.forEach(function(l){c[l.id]={in:0,out:0,all:0}}),u&&u.forEach(function(l){var h=(0,e.getEdgeTerminal)(l,"source"),f=(0,e.getEdgeTerminal)(l,"target");h&&(c[h].out+=1,c[h].all+=1),f&&(c[f].in+=1,c[f].all+=1)}),c},e.floydWarshall=function(s){for(var u=[],c=s.length,l=0;l<c;l+=1){u[l]=[];for(var h=0;h<c;h+=1)l===h?u[l][h]=0:s[l][h]!==0&&s[l][h]?u[l][h]=s[l][h]:u[l][h]=1/0}for(var f=0;f<c;f+=1)for(l=0;l<c;l+=1)for(h=0;h<c;h+=1)u[l][h]>u[l][f]+u[f][h]&&(u[l][h]=u[l][f]+u[f][h]);return u},e.getAdjMatrix=function(s,u){var c=s.nodes,l=s.edges,h=[],f={};if(!c)throw new Error("invalid nodes data!");return c&&c.forEach(function(d,p){f[d.id]=p,h.push([])}),l==null||l.forEach(function(d){var p=(0,e.getEdgeTerminal)(d,"source"),g=(0,e.getEdgeTerminal)(d,"target"),v=f[p],m=f[g];v!==void 0&&m!==void 0&&(h[v][m]=1,u||(h[m][v]=1))}),h},e.scaleMatrix=function(s,u){var c=[];return s.forEach(function(l){var h=[];l.forEach(function(f){h.push(f*u)}),c.push(h)}),c};var i=function(s,u){if(s&&s.children){for(var c=s.children.length-1;c>=0;c--)if(!i(s.children[c],u))return}return!!u(s)};e.traverseTreeUp=function(s,u){typeof u=="function"&&i(s,u)},e.getLayoutBBox=function(s){var u=1/0,c=1/0,l=-1/0,h=-1/0;return s.forEach(function(f){var d=f.size;(0,n.isArray)(d)?d.length===1&&(d=[d[0],d[0]]):(0,t.isNumber)(d)?d=[d,d]:(d===void 0||isNaN(d))&&(d=[30,30]);var p=[d[0]/2,d[1]/2],g=f.x-p[0],v=f.x+p[0],m=f.y-p[1],y=f.y+p[1];u>g&&(u=g),c>m&&(c=m),l<v&&(l=v),h<y&&(h=y)}),{minX:u,minY:c,maxX:l,maxY:h}},e.getAvgNodePosition=function(s){var u={x:0,y:0};s.forEach(function(l){u.x+=l.x||0,u.y+=l.y||0});var c=s.length||1;return{x:u.x/c,y:u.y/c}};var o=function(s,u,c){var l,h;return s==="source"?((l=c==null?void 0:c.find(function(f){return f.target===u.id}))===null||l===void 0?void 0:l.source)||{}:((h=c==null?void 0:c.find(function(f){return f.source===u.id}))===null||h===void 0?void 0:h.target)||{}},a=function(s,u,c){var l=[];switch(s){case"source":l=c==null?void 0:c.filter(function(f){return f.source===u.id}).map(function(f){return f.target});break;case"target":l=c==null?void 0:c.filter(function(f){return f.target===u.id}).map(function(f){return f.source});break;case"both":l=c==null?void 0:c.filter(function(f){return f.source===u.id}).map(function(f){return f.target}).concat(c==null?void 0:c.filter(function(f){return f.target===u.id}).map(function(f){return f.source}))}var h=new Set(l);return Array.from(h)};e.getCoreNodeAndRelativeLeafNodes=function(s,u,c,l,h,f){var d=h[u.id],p=d.in,g=d.out,v=u,m=[];p===0?(v=o("source",u,c),m=a("both",v,c).map(function(b){return f[b]})):g===0&&(v=o("target",u,c),m=a("both",v,c).map(function(b){return f[b]})),m=m.filter(function(b){return h[b.id]&&(h[b.id].in===0||h[b.id].out===0)});var y=function(b,x,w,E,M){var _=w[x]||"",k=(E==null?void 0:E.filter(function(S){return S[x]===_}))||[];return b==="leaf"&&(k=k.filter(function(S){var C,T;return((C=M[S.id])===null||C===void 0?void 0:C.in)===0||((T=M[S.id])===null||T===void 0?void 0:T.out)===0})),k}(s,l,u,m,h);return{coreNode:v,relativeLeafNodes:m,sameTypeLeafNodes:y}}}(gd);var Hk,qk,Zk={};function _n(){return qk||(qk=1,function(e){var n=xe&&xe.__createBinding||(Object.create?function(r,i,o,a){a===void 0&&(a=o);var s=Object.getOwnPropertyDescriptor(i,o);s&&!("get"in s?!i.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(r,a,s)}:function(r,i,o,a){a===void 0&&(a=o),r[a]=i[o]}),t=xe&&xe.__exportStar||function(r,i){for(var o in r)o==="default"||Object.prototype.hasOwnProperty.call(i,o)||n(i,r,o)};Object.defineProperty(e,"__esModule",{value:!0}),t(su,e),t(Jc,e),t(pd,e),t(gd,e),t(dm,e),t((Hk||(Hk=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.getFuncByUnknownType=r.getFunc=r.isFunction=void 0;var i=_n(),o=pd;r.isFunction=function(a){return typeof a=="function"},r.getFunc=function(a,s,u){return u||((0,o.isNumber)(a)?function(){return a}:function(){return s})},r.getFuncByUnknownType=function(a,s,u){return u===void 0&&(u=!0),s||s===0?(0,r.isFunction)(s)?s:(0,o.isNumber)(s)?function(){return s}:(0,i.isArray)(s)?function(){if(u){var c=Math.max.apply(Math,s);return isNaN(c)?a:c}return s}:(0,i.isObject)(s)?function(){if(u){var c=Math.max(s.width,s.height);return isNaN(c)?a:c}return[s.width,s.height]}:function(){return a}:function(c){return c.size?(0,i.isArray)(c.size)?c.size[0]>c.size[1]?c.size[0]:c.size[1]:(0,i.isObject)(c.size)?c.size.width>c.size.height?c.size.width:c.size.height:c.size:a}}}(Zk)),Zk),e)}(Vk)),Vk}var BB=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(wo,"__esModule",{value:!0}),wo.getLayoutByName=wo.unRegisterLayout=wo.registerLayout=void 0;var zB=Nn,FB=_n(),ca=new Map;wo.registerLayout=function(e,n){if(ca.get(e),(0,FB.isObject)(n)){var t=function(r){function i(o){var a,s,u=a=r.call(this)||this,c={},l=Object.assign({},u.getDefaultCfg(),((s=n.getDefaultCfg)===null||s===void 0?void 0:s.call(n))||{});return Object.assign(c,l,n,o),Object.keys(c).forEach(function(h){var f=c[h];u[h]=f}),a}return BB(i,r),i}(zB.Base);ca.set(e,t)}else ca.set(e,n);return ca.get(e)},wo.unRegisterLayout=function(e){ca.has(e)&&ca.delete(e)},wo.getLayoutByName=function(e){return ca.has(e)?ca.get(e):null};var Kk={},el={},GB=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(el,"__esModule",{value:!0}),el.GridLayout=void 0;var uu=_n(),UB=function(e){function n(t){var r=e.call(this)||this;return r.begin=[0,0],r.preventOverlap=!0,r.preventOverlapPadding=10,r.condense=!1,r.sortBy="degree",r.nodes=[],r.edges=[],r.width=300,r.height=300,r.row=0,r.col=0,r.cellWidth=0,r.cellHeight=0,r.cellUsed={},r.id2manPos={},r.onLayoutEnd=function(){},r.updateCfg(t),r}return GB(n,e),n.prototype.getDefaultCfg=function(){return{begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30}},n.prototype.execute=function(){var t=this,r=t.nodes,i=t.edges,o=t.begin,a=r.length;if(a===0)return t.onLayoutEnd&&t.onLayoutEnd(),{nodes:r,edges:i};if(a===1)return r[0].x=o[0],r[0].y=o[1],t.onLayoutEnd&&t.onLayoutEnd(),{nodes:r,edges:i};var s=t.sortBy,u=t.width,c=t.height,l=t.condense,h=t.preventOverlapPadding,f=t.preventOverlap,d=t.nodeSpacing,p=t.nodeSize,g=[];r.forEach(function(T){g.push(T)});var v={};if(g.forEach(function(T,A){v[T.id]=A}),(s==="degree"||!(0,uu.isString)(s)||g[0][s]===void 0)&&(s="degree",(0,uu.isNaN)(r[0].degree))){var m=(0,uu.getDegree)(g.length,v,i);g.forEach(function(T,A){T.degree=m[A].all})}g.sort(function(T,A){return A[s]-T[s]}),u||typeof window>"u"||(u=window.innerWidth),c||typeof window>"u"||(c=window.innerHeight);var y=t.rows,b=t.cols!=null?t.cols:t.columns;if(t.cells=a,y!=null&&b!=null?(t.rows=y,t.cols=b):y!=null&&b==null?(t.rows=y,t.cols=Math.ceil(t.cells/t.rows)):y==null&&b!=null?(t.cols=b,t.rows=Math.ceil(t.cells/t.cols)):(t.splits=Math.sqrt(t.cells*t.height/t.width),t.rows=Math.round(t.splits),t.cols=Math.round(t.width/t.height*t.splits)),t.rows=Math.max(t.rows,1),t.cols=Math.max(t.cols,1),t.cols*t.rows>t.cells)((w=t.small())-1)*(x=t.large())>=t.cells?t.small(w-1):(x-1)*w>=t.cells&&t.large(x-1);else for(;t.cols*t.rows<t.cells;){var x,w=t.small();((x=t.large())+1)*w>=t.cells?t.large(x+1):t.small(w+1)}if(t.cellWidth=u/t.cols,t.cellHeight=c/t.rows,l&&(t.cellWidth=0,t.cellHeight=0),f||d){var E=(0,uu.getFuncByUnknownType)(10,d),M=(0,uu.getFuncByUnknownType)(30,p,!1);g.forEach(function(T){T.x&&T.y||(T.x=0,T.y=0);var A,D,j=M(T)||30;(0,uu.isArray)(j)?(A=j[0],D=j[1]):(A=j,D=j);var L=E!==void 0?E(T):h,B=A+L,N=D+L;t.cellWidth=Math.max(t.cellWidth,B),t.cellHeight=Math.max(t.cellHeight,N)})}t.cellUsed={},t.row=0,t.col=0,t.id2manPos={};for(var _=0;_<g.length;_++){var k=g[_],S=void 0;if(t.position&&(S=t.position(k)),S&&(S.row!==void 0||S.col!==void 0)){var C={row:S.row,col:S.col};if(C.col===void 0)for(C.col=0;t.used(C.row,C.col);)C.col++;else if(C.row===void 0)for(C.row=0;t.used(C.row,C.col);)C.row++;t.id2manPos[k.id]=C,t.use(C.row,C.col)}t.getPos(k)}return t.onLayoutEnd&&t.onLayoutEnd(),{edges:i,nodes:g}},n.prototype.small=function(t){var r,i=this,o=i.rows||5,a=i.cols||5;return t==null?r=Math.min(o,a):Math.min(o,a)===i.rows?i.rows=t:i.cols=t,r},n.prototype.large=function(t){var r,i=this,o=i.rows||5,a=i.cols||5;return t==null?r=Math.max(o,a):Math.max(o,a)===i.rows?i.rows=t:i.cols=t,r},n.prototype.used=function(t,r){return this.cellUsed["c-".concat(t,"-").concat(r)]||!1},n.prototype.use=function(t,r){this.cellUsed["c-".concat(t,"-").concat(r)]=!0},n.prototype.moveToNextCell=function(){var t=this,r=t.cols||5;t.col++,t.col>=r&&(t.col=0,t.row++)},n.prototype.getPos=function(t){var r,i,o=this,a=o.begin,s=o.cellWidth,u=o.cellHeight,c=o.id2manPos[t.id];if(c)r=c.col*s+s/2+a[0],i=c.row*u+u/2+a[1];else{for(;o.used(o.row,o.col);)o.moveToNextCell();r=o.col*s+s/2+a[0],i=o.row*u+u/2+a[1],o.use(o.row,o.col),o.moveToNextCell()}t.x=r,t.y=i},n.prototype.getType=function(){return"grid"},n}(Nn.Base);el.GridLayout=UB;var tl={},XB=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(tl,"__esModule",{value:!0}),tl.RandomLayout=void 0;var YB=function(e){function n(t){var r=e.call(this)||this;return r.center=[0,0],r.width=300,r.height=300,r.nodes=[],r.edges=[],r.onLayoutEnd=function(){},r.updateCfg(t),r}return XB(n,e),n.prototype.getDefaultCfg=function(){return{center:[0,0],width:300,height:300}},n.prototype.execute=function(){var t=this,r=t.nodes,i=t.center;return t.width||typeof window>"u"||(t.width=window.innerWidth),t.height||typeof window>"u"||(t.height=window.innerHeight),r&&r.forEach(function(o){o.x=.9*(Math.random()-.5)*t.width+i[0],o.y=.9*(Math.random()-.5)*t.height+i[1]}),t.onLayoutEnd&&t.onLayoutEnd(),{nodes:r,edges:this.edges}},n.prototype.getType=function(){return"random"},n}(Nn.Base);tl.RandomLayout=YB;var nl={},WB=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(nl,"__esModule",{value:!0}),nl.GForceLayout=void 0;var VB=Nn,vr=_n(),pm=function(e,n){return e?(0,vr.isNumber)(e)?function(t){return e}:e:function(t){return n}},HB=function(e){function n(t){var r=e.call(this)||this;return r.maxIteration=500,r.workerEnabled=!1,r.edgeStrength=200,r.nodeStrength=1e3,r.coulombDisScale=.005,r.damping=.9,r.maxSpeed=1e3,r.minMovement=.5,r.interval=.02,r.factor=1,r.linkDistance=1,r.gravity=10,r.preventOverlap=!0,r.collideStrength=1,r.tick=function(){},r.nodes=[],r.edges=[],r.width=300,r.height=300,r.nodeMap={},r.nodeIdxMap={},r.animate=!0,r.updateCfg(t),r}return WB(n,e),n.prototype.getDefaultCfg=function(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}},n.prototype.execute=function(){var t,r,i=this,o=i.nodes;if(i.timeInterval!==void 0&&typeof window<"u"&&window.clearInterval(i.timeInterval),o&&o.length!==0){i.width||typeof window>"u"||(i.width=window.innerWidth),i.height||typeof window>"u"||(i.height=window.innerHeight),i.center||(i.center=[i.width/2,i.height/2]);var a=i.center;if(o.length===1)return o[0].x=a[0],o[0].y=a[1],void((r=i.onLayoutEnd)===null||r===void 0||r.call(i));var s={},u={};o.forEach(function(p,g){(0,vr.isNumber)(p.x)||(p.x=Math.random()*i.width),(0,vr.isNumber)(p.y)||(p.y=Math.random()*i.height),s[p.id]=p,u[p.id]=g}),i.nodeMap=s,i.nodeIdxMap=u,i.linkDistance=pm(i.linkDistance,1),i.nodeStrength=pm(i.nodeStrength,1),i.edgeStrength=pm(i.edgeStrength,1);var c,l=i.nodeSize;if(i.preventOverlap){var h,f=i.nodeSpacing;h=(0,vr.isNumber)(f)?function(){return f}:(0,vr.isFunction)(f)?f:function(){return 0},c=l?(0,vr.isArray)(l)?function(p){return Math.max(l[0],l[1])+h(p)}:function(p){return l+h(p)}:function(p){return p.size?(0,vr.isArray)(p.size)?Math.max(p.size[0],p.size[1])+h(p):(0,vr.isObject)(p.size)?Math.max(p.size.width,p.size.height)+h(p):p.size+h(p):10+h(p)}}i.nodeSize=c;var d=i.edges;i.degrees=(0,vr.getDegree)(o.length,i.nodeIdxMap,d),i.getMass||(i.getMass=function(p){return p.mass||i.degrees[i.nodeIdxMap[p.id]].all||1}),i.run()}else(t=i.onLayoutEnd)===null||t===void 0||t.call(i)},n.prototype.run=function(){var t,r=this,i=r.maxIteration,o=r.nodes,a=r.workerEnabled,s=r.minMovement,u=r.animate;if(o)if(a||!u){for(var c=0;c<i;c++){var l=r.runOneStep(c);if(r.reachMoveThreshold(o,l,s))break}(t=r.onLayoutEnd)===null||t===void 0||t.call(r)}else{if(typeof window>"u")return;var h=0;this.timeInterval=window.setInterval(function(){var f,d;if(o){var p=r.runOneStep(h)||[];r.reachMoveThreshold(o,p,s)&&((f=r.onLayoutEnd)===null||f===void 0||f.call(r),window.clearInterval(r.timeInterval)),++h>=i&&((d=r.onLayoutEnd)===null||d===void 0||d.call(r),window.clearInterval(r.timeInterval))}},0)}},n.prototype.reachMoveThreshold=function(t,r,i){var o=0;return t.forEach(function(a,s){var u=a.x-r[s].x,c=a.y-r[s].y;o+=Math.sqrt(u*u+c*c)}),(o/=t.length)<i},n.prototype.runOneStep=function(t){var r,i=this,o=i.nodes,a=i.edges,s=[],u=[];if(o){o.forEach(function(h,f){s[2*f]=0,s[2*f+1]=0,u[2*f]=0,u[2*f+1]=0}),i.calRepulsive(s,o),a&&i.calAttractive(s,a),i.calGravity(s,o);var c=Math.max(.02,i.interval-.002*t);i.updateVelocity(s,u,c,o);var l=[];return o.forEach(function(h){l.push({x:h.x,y:h.y})}),i.updatePosition(u,c,o),(r=i.tick)===null||r===void 0||r.call(i),l}},n.prototype.calRepulsive=function(t,r){var i=this,o=i.getMass,a=i.factor,s=i.coulombDisScale,u=i.preventOverlap,c=i.collideStrength,l=c===void 0?1:c,h=i.nodeStrength,f=i.nodeSize;r.forEach(function(d,p){var g=o?o(d):1;r.forEach(function(v,m){if(!(p>=m)){var y=d.x-v.x,b=d.y-v.y;y===0&&b===0&&(y=.01*Math.random(),b=.01*Math.random());var x=y*y+b*b,w=Math.sqrt(x),E=(w+.1)*s,M=y/w,_=b/w,k=.5*(h(d)+h(v))*a/(E*E),S=o?o(v):1;if(t[2*p]+=M*k,t[2*p+1]+=_*k,t[2*m]-=M*k,t[2*m+1]-=_*k,u&&(f(d)+f(v))/2>w){var C=l*(h(d)+h(v))*.5/x;t[2*p]+=M*C/g,t[2*p+1]+=_*C/g,t[2*m]-=M*C/S,t[2*m+1]-=_*C/S}}})})},n.prototype.calAttractive=function(t,r){var i=this,o=i.nodeMap,a=i.nodeIdxMap,s=i.linkDistance,u=i.edgeStrength,c=i.nodeSize,l=i.getMass;r.forEach(function(h,f){var d=(0,vr.getEdgeTerminal)(h,"source"),p=(0,vr.getEdgeTerminal)(h,"target"),g=o[d],v=o[p],m=v.x-g.x,y=v.y-g.y;m===0&&y===0&&(m=.01*Math.random(),y=.01*Math.random());var b=Math.sqrt(m*m+y*y),x=m/b,w=y/b,E=((s(h,g,v)||1+(c(g)+c(v)||0)/2)-b)*u(h),M=a[d],_=a[p],k=l?l(g):1,S=l?l(v):1;t[2*M]-=x*E/k,t[2*M+1]-=w*E/k,t[2*_]+=x*E/S,t[2*_+1]+=w*E/S})},n.prototype.calGravity=function(t,r){for(var i=this,o=i.center,a=i.gravity,s=i.degrees,u=r.length,c=0;c<u;c++){var l=r[c],h=l.x-o[0],f=l.y-o[1],d=a;if(i.getCenter){var p=i.getCenter(l,s[c].all);p&&(0,vr.isNumber)(p[0])&&(0,vr.isNumber)(p[1])&&(0,vr.isNumber)(p[2])&&(h=l.x-p[0],f=l.y-p[1],d=p[2])}d&&(t[2*c]-=d*h,t[2*c+1]-=d*f)}},n.prototype.updateVelocity=function(t,r,i,o){var a=this,s=i*a.damping;o.forEach(function(u,c){var l=t[2*c]*s||.01,h=t[2*c+1]*s||.01,f=Math.sqrt(l*l+h*h);if(f>a.maxSpeed){var d=a.maxSpeed/f;l*=d,h*=d}r[2*c]=l,r[2*c+1]=h})},n.prototype.updatePosition=function(t,r,i){i.forEach(function(o,a){if((0,vr.isNumber)(o.fx)&&(0,vr.isNumber)(o.fy))return o.x=o.fx,void(o.y=o.fy);var s=t[2*a]*r,u=t[2*a+1]*r;o.x+=s,o.y+=u})},n.prototype.stop=function(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval)},n.prototype.destroy=function(){var t=this;t.stop(),t.tick=null,t.nodes=null,t.edges=null,t.destroyed=!0},n.prototype.getType=function(){return"gForce"},n}(VB.Base);nl.GForceLayout=HB;var rl={},vd={};function $k(e,n,t,r){if(isNaN(n)||isNaN(t))return e;var i,o,a,s,u,c,l,h,f,d=e._root,p={data:r},g=e._x0,v=e._y0,m=e._x1,y=e._y1;if(!d)return e._root=p,e;for(;d.length;)if((c=n>=(o=(g+m)/2))?g=o:m=o,(l=t>=(a=(v+y)/2))?v=a:y=a,i=d,!(d=d[h=l<<1|c]))return i[h]=p,e;if(s=+e._x.call(null,d.data),u=+e._y.call(null,d.data),n===s&&t===u)return p.next=d,i?i[h]=p:e._root=p,e;do i=i?i[h]=new Array(4):e._root=new Array(4),(c=n>=(o=(g+m)/2))?g=o:m=o,(l=t>=(a=(v+y)/2))?v=a:y=a;while((h=l<<1|c)==(f=(u>=a)<<1|s>=o));return i[f]=d,i[h]=p,e}function xr(e,n,t,r,i){this.node=e,this.x0=n,this.y0=t,this.x1=r,this.y1=i}function qB(e){return e[0]}function ZB(e){return e[1]}function md(e,n,t){var r=new gm(n??qB,t??ZB,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function gm(e,n,t,r,i,o){this._x=e,this._y=n,this._x0=t,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function Qk(e){for(var n={data:e.data},t=n;e=e.next;)t=t.next={data:e.data};return n}var wr=md.prototype=gm.prototype;wr.copy=function(){var e,n,t=new gm(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return t;if(!r.length)return t._root=Qk(r),t;for(e=[{source:r,target:t._root=new Array(4)}];r=e.pop();)for(var i=0;i<4;++i)(n=r.source[i])&&(n.length?e.push({source:n,target:r.target[i]=new Array(4)}):r.target[i]=Qk(n));return t},wr.add=function(e){const n=+this._x.call(null,e),t=+this._y.call(null,e);return $k(this.cover(n,t),n,t,e)},wr.addAll=function(e){var n,t,r,i,o=e.length,a=new Array(o),s=new Array(o),u=1/0,c=1/0,l=-1/0,h=-1/0;for(t=0;t<o;++t)isNaN(r=+this._x.call(null,n=e[t]))||isNaN(i=+this._y.call(null,n))||(a[t]=r,s[t]=i,r<u&&(u=r),r>l&&(l=r),i<c&&(c=i),i>h&&(h=i));if(u>l||c>h)return this;for(this.cover(u,c).cover(l,h),t=0;t<o;++t)$k(this,a[t],s[t],e[t]);return this},wr.cover=function(e,n){if(isNaN(e=+e)||isNaN(n=+n))return this;var t=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(t))i=(t=Math.floor(e))+1,o=(r=Math.floor(n))+1;else{for(var a,s,u=i-t||1,c=this._root;t>e||e>=i||r>n||n>=o;)switch(s=(n<r)<<1|e<t,(a=new Array(4))[s]=c,c=a,u*=2,s){case 0:i=t+u,o=r+u;break;case 1:t=i-u,o=r+u;break;case 2:i=t+u,r=o-u;break;case 3:t=i-u,r=o-u}this._root&&this._root.length&&(this._root=c)}return this._x0=t,this._y0=r,this._x1=i,this._y1=o,this},wr.data=function(){var e=[];return this.visit(function(n){if(!n.length)do e.push(n.data);while(n=n.next)}),e},wr.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},wr.find=function(e,n,t){var r,i,o,a,s,u,c,l=this._x0,h=this._y0,f=this._x1,d=this._y1,p=[],g=this._root;for(g&&p.push(new xr(g,l,h,f,d)),t==null?t=1/0:(l=e-t,h=n-t,f=e+t,d=n+t,t*=t);u=p.pop();)if(!(!(g=u.node)||(i=u.x0)>f||(o=u.y0)>d||(a=u.x1)<l||(s=u.y1)<h))if(g.length){var v=(i+a)/2,m=(o+s)/2;p.push(new xr(g[3],v,m,a,s),new xr(g[2],i,m,v,s),new xr(g[1],v,o,a,m),new xr(g[0],i,o,v,m)),(c=(n>=m)<<1|e>=v)&&(u=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=u)}else{var y=e-+this._x.call(null,g.data),b=n-+this._y.call(null,g.data),x=y*y+b*b;if(x<t){var w=Math.sqrt(t=x);l=e-w,h=n-w,f=e+w,d=n+w,r=g.data}}return r},wr.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(a=+this._y.call(null,e)))return this;var n,t,r,i,o,a,s,u,c,l,h,f,d=this._root,p=this._x0,g=this._y0,v=this._x1,m=this._y1;if(!d)return this;if(d.length)for(;;){if((c=o>=(s=(p+v)/2))?p=s:v=s,(l=a>=(u=(g+m)/2))?g=u:m=u,n=d,!(d=d[h=l<<1|c]))return this;if(!d.length)break;(n[h+1&3]||n[h+2&3]||n[h+3&3])&&(t=n,f=h)}for(;d.data!==e;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):n?(i?n[h]=i:delete n[h],(d=n[0]||n[1]||n[2]||n[3])&&d===(n[3]||n[2]||n[1]||n[0])&&!d.length&&(t?t[f]=d:this._root=d),this):(this._root=i,this)},wr.removeAll=function(e){for(var n=0,t=e.length;n<t;++n)this.remove(e[n]);return this},wr.root=function(){return this._root},wr.size=function(){var e=0;return this.visit(function(n){if(!n.length)do++e;while(n=n.next)}),e},wr.visit=function(e){var n,t,r,i,o,a,s=[],u=this._root;for(u&&s.push(new xr(u,this._x0,this._y0,this._x1,this._y1));n=s.pop();)if(!e(u=n.node,r=n.x0,i=n.y0,o=n.x1,a=n.y1)&&u.length){var c=(r+o)/2,l=(i+a)/2;(t=u[3])&&s.push(new xr(t,c,l,o,a)),(t=u[2])&&s.push(new xr(t,r,l,c,a)),(t=u[1])&&s.push(new xr(t,c,i,o,l)),(t=u[0])&&s.push(new xr(t,r,i,c,l))}return this},wr.visitAfter=function(e){var n,t=[],r=[];for(this._root&&t.push(new xr(this._root,this._x0,this._y0,this._x1,this._y1));n=t.pop();){var i=n.node;if(i.length){var o,a=n.x0,s=n.y0,u=n.x1,c=n.y1,l=(a+u)/2,h=(s+c)/2;(o=i[0])&&t.push(new xr(o,a,s,l,h)),(o=i[1])&&t.push(new xr(o,l,s,u,h)),(o=i[2])&&t.push(new xr(o,a,h,l,c)),(o=i[3])&&t.push(new xr(o,l,h,u,c))}r.push(n)}for(;n=r.pop();)e(n.node,n.x0,n.y0,n.x1,n.y1);return this},wr.x=function(e){return arguments.length?(this._x=e,this):this._x},wr.y=function(e){return arguments.length?(this._y=e,this):this._y};const KB=ji(Object.freeze(Object.defineProperty({__proto__:null,quadtree:md},Symbol.toStringTag,{value:"Module"})));Object.defineProperty(vd,"__esModule",{value:!0}),vd.forceNBody=void 0;var $B=KB;function QB(e){var n=0,t=0,r=0;if(e.length){for(var i=0;i<4;i++)(o=e[i])&&o.weight&&(n+=o.weight,t+=o.x*o.weight,r+=o.y*o.weight);e.x=t/n,e.y=r/n,e.weight=n}else{var o=e;e.x=o.data.x,e.y=o.data.y,e.weight=o.data.weight}}vd.forceNBody=function(e,n,t,r,i){var o=t/r,a=e.map(function(u,c){var l=n[u.id],h=l.data,f=l.x,d=l.y,p=l.size,g=h.layout.force.nodeStrength;return{x:f,y:d,size:p,index:c,vx:0,vy:0,weight:o*g}}),s=(0,$B.quadtree)(a,function(u){return u.x},function(u){return u.y}).visitAfter(QB);return a.forEach(function(u){(function(c,l){l.visit(function(h,f,d,p,g){return JB(h,f,d,p,g,c)})})(u,s)}),a.map(function(u,c){var l=n[e[c].id].data.layout.force.mass,h=l===void 0?1:l;i[2*c]=u.vx/h,i[2*c+1]=u.vy/h}),i};var JB=function(e,n,t,r,i,o){var a=o.x-e.x||.1,s=o.y-e.y||.1,u=r-n,c=a*a+s*s,l=Math.sqrt(c)*c;if(u*u*.81<c){var h=e.weight/l;return o.vx+=a*h,o.vy+=s*h,!0}if(e.length)return!1;e.data!==o&&(h=e.data.weight/l,o.vx+=a*h,o.vy+=s*h)},ez=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Si=xe&&xe.__assign||function(){return Si=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},Si.apply(this,arguments)};Object.defineProperty(rl,"__esModule",{value:!0}),rl.Force2Layout=void 0;var tz=Nn,Zn=_n(),nz=vd,vm=function(e,n){return e?(0,Zn.isNumber)(e)?function(t){return e}:e:function(t){return n}},rz=function(e){function n(t){var r=e.call(this)||this;r.maxIteration=1e3,r.workerEnabled=!1,r.edgeStrength=200,r.nodeStrength=1e3,r.coulombDisScale=.005,r.damping=.9,r.maxSpeed=500,r.minMovement=.4,r.interval=.02,r.factor=1,r.linkDistance=200,r.gravity=0,r.clusterNodeStrength=20,r.preventOverlap=!0,r.distanceThresholdMode="mean",r.tick=function(){},r.nodes=[],r.edges=[],r.width=300,r.height=300,r.nodeMap={},r.nodeIdxMap={},r.judgingDistance=0,r.centripetalOptions={leaf:2,single:2,others:1,center:function(o){return{x:r.width/2,y:r.height/2}}};var i=t.getMass;return r.propsGetMass=i,r.updateCfg(t),r}return ez(n,e),n.prototype.getCentripetalOptions=function(){var t,r=this,i=r.leafCluster,o=r.clustering,a=r.nodeClusterBy,s=r.nodes,u=r.nodeMap,c=r.clusterNodeStrength,l=function(b){return typeof c=="function"?c(b):c},h={};if(i){t=this.getSameTypeLeafMap()||{};var f=Array.from(new Set(s==null?void 0:s.map(function(b){return b[a]})))||[];h={single:100,leaf:function(b,x,w){var E=t[b.id]||{},M=E.relativeLeafNodes,_=E.sameTypeLeafNodes;return(_==null?void 0:_.length)===(M==null?void 0:M.length)||(f==null?void 0:f.length)===1?1:l(b)},others:1,center:function(b,x,w){var E,M,_=(((E=b.data)===null||E===void 0?void 0:E.layout)||{}).degree;if(!_)return{x:100,y:100};if(_===1){var k=(t[b.id]||{}).sameTypeLeafNodes,S=k===void 0?[]:k;S.length===1?M=void 0:S.length>1&&(M=(0,Zn.getAvgNodePosition)(S))}else M=void 0;return{x:M==null?void 0:M.x,y:M==null?void 0:M.y}}}}if(o){t||(t=this.getSameTypeLeafMap());var d=Array.from(new Set(s.map(function(b,x){return b[a]}))).filter(function(b){return b!==void 0}),p={};d.forEach(function(b){var x=s.filter(function(w){return w[a]===b}).map(function(w){return u[w.id]});p[b]=(0,Zn.getAvgNodePosition)(x)}),h={single:function(b){return l(b)},leaf:function(b){return l(b)},others:function(b){return l(b)},center:function(b,x,w){var E=p[b[a]];return{x:E==null?void 0:E.x,y:E==null?void 0:E.y}}}}this.centripetalOptions=Si(Si({},this.centripetalOptions),h);var g=this.centripetalOptions,v=g.leaf,m=g.single,y=g.others;v&&typeof v!="function"&&(this.centripetalOptions.leaf=function(){return v}),m&&typeof m!="function"&&(this.centripetalOptions.single=function(){return m}),y&&typeof y!="function"&&(this.centripetalOptions.others=function(){return y})},n.prototype.updateCfg=function(t){t&&Object.assign(this,t)},n.prototype.getDefaultCfg=function(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}},n.prototype.execute=function(){var t=this;t.stop();var r=t.nodes,i=t.edges,o=t.defSpringLen;if(t.judgingDistance=0,r&&r.length!==0){t.width||typeof window>"u"||(t.width=window.innerWidth),t.height||typeof window>"u"||(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]);var a=t.center;if(r.length===1)return r[0].x=a[0],r[0].y=a[1],void t.onLayoutEnd([Si({},r[0])]);t.degreesMap=(0,Zn.getDegreeMap)(r,i),t.propsGetMass?t.getMass=t.propsGetMass:t.getMass=function(d){var p=1;(0,Zn.isNumber)(d.mass)&&(p=d.mass);var g=t.degreesMap[d.id].all;return!g||g<5?p:5*g*p};var s,u=t.nodeSize;if(t.preventOverlap){var c,l=t.nodeSpacing;c=(0,Zn.isNumber)(l)?function(){return l}:(0,Zn.isFunction)(l)?l:function(){return 0},s=u?(0,Zn.isArray)(u)?function(d){return Math.max(u[0],u[1])+c(d)}:function(d){return u+c(d)}:function(d){return d.size?(0,Zn.isArray)(d.size)?Math.max(d.size[0],d.size[1])+c(d):(0,Zn.isObject)(d.size)?Math.max(d.size.width,d.size.height)+c(d):d.size+c(d):10+c(d)}}t.nodeSize=s,t.linkDistance=vm(t.linkDistance,1),t.nodeStrength=vm(t.nodeStrength,1),t.edgeStrength=vm(t.edgeStrength,1);var h={},f={};r.forEach(function(d,p){(0,Zn.isNumber)(d.x)||(d.x=Math.random()*t.width),(0,Zn.isNumber)(d.y)||(d.y=Math.random()*t.height);var g=t.degreesMap[d.id];h[d.id]=Si(Si({},d),{data:Si(Si({},d.data),{size:t.nodeSize(d)||30,layout:{inDegree:g.in,outDegree:g.out,degree:g.all,tDegree:g.in,sDegree:g.out,force:{mass:t.getMass(d),nodeStrength:t.nodeStrength(d,i)}}})}),f[d.id]=p}),t.nodeMap=h,t.nodeIdxMap=f,t.edgeInfos=[],i==null||i.forEach(function(d){var p=h[d.source],g=h[d.target];p&&g?t.edgeInfos.push({edgeStrength:t.edgeStrength(d),linkDistance:o?o(Si(Si({},d),{source:p,target:g}),p,g):t.linkDistance(d,p,g)||1+(u(p)+u(p)||0)/2}):elf.edgeInfos.push({})}),this.getCentripetalOptions(),t.onLayoutEnd=t.onLayoutEnd||function(){},t.run()}else t.onLayoutEnd([])},n.prototype.run=function(){var t=this,r=t.maxIteration,i=t.nodes,o=t.edges,a=t.workerEnabled,s=t.minMovement,u=t.animate,c=t.nodeMap,l=t.height;if(t.currentMinY=0,t.currentMaxY=l,i){var h=[];if(i.forEach(function(v,m){h[2*m]=0,h[2*m+1]=0}),this.defSideCoe&&typeof this.defSideCoe=="function"){var f={};o.forEach(function(v){var m=v.source,y=v.target;f[m]=f[m]||[],f[m].push(v),f[y]=f[y]||[],f[y].push(v)}),this.relatedEdges=f}var d=r;if(a||!u){for(var p=0;(t.judgingDistance>s||p<1)&&p<d;p++)t.runOneStep(p,h);t.onLayoutEnd(Object.values(c))}else{if(typeof window>"u")return;var g=0;this.timeInterval=window.setInterval(function(){i&&(t.runOneStep(g,h),(++g>=d||t.judgingDistance<s)&&(t.onLayoutEnd(Object.values(c)),window.clearInterval(t.timeInterval)))},0)}}},n.prototype.runOneStep=function(t,r){var i,o=this,a=o.nodes,s=o.edges;o.nodeMap;var u=o.monitor,c=[];if(a!=null&&a.length){o.calRepulsive(c),s&&o.calAttractive(c),o.calGravity(c),o.attractToSide(c);var l=o.interval;o.updateVelocity(c,r,l),o.updatePosition(r,l),(i=o.tick)===null||i===void 0||i.call(o),u&&u({energy:this.calTotalEnergy(c),nodes:a,edges:s,iterations:t})}},n.prototype.calTotalEnergy=function(t){var r=this.nodes,i=this.nodeMap;if(!(r!=null&&r.length))return 0;var o=0;return r.forEach(function(a,s){var u=t[2*s],c=t[2*s+1],l=u*u+c*c,h=i[a.id].data.layout.force.mass;o+=(h===void 0?1:h)*l*.5}),o},n.prototype.calRepulsive=function(t){var r=this,i=r.nodes,o=r.nodeMap,a=r.factor,s=r.coulombDisScale;r.nodeSize,(0,nz.forceNBody)(i,o,a,s*s,t)},n.prototype.calAttractive=function(t){var r=this,i=r.edges,o=r.nodeMap,a=r.nodeIdxMap,s=r.edgeInfos;r.nodeSize,i.forEach(function(u,c){var l=(0,Zn.getEdgeTerminal)(u,"source"),h=(0,Zn.getEdgeTerminal)(u,"target"),f=o[l],d=o[h];if(f&&d){var p=d.x-f.x,g=d.y-f.y;p||g||(p=.01*Math.random(),g=.01*Math.random());var v=Math.sqrt(p*p+g*g),m=p/v,y=g/v,b=s[c]||{},x=b.linkDistance,w=x===void 0?200:x,E=b.edgeStrength,M=(w-v)*(E===void 0?200:E),_=1/(f.data.layout.force.mass||1),k=1/(d.data.layout.force.mass||1),S=m*M,C=y*M,T=2*a[l],A=2*a[h];t[T]-=S*_,t[T+1]-=C*_,t[A]+=S*k,t[A+1]+=C*k}})},n.prototype.calGravity=function(t){var r,i=this,o=i.nodes,a=i.edges,s=a===void 0?[]:a,u=i.nodeMap,c=i.width,l=i.height,h=i.center,f=i.gravity,d=i.degreesMap,p=i.centripetalOptions;if(o)for(var g=o.length,v=0;v<g;v++){var m=2*v,y=u[o[v].id],b=y.data.layout.force.mass,x=b===void 0?1:b,w=0,E=0,M=f,_=d[y.id],k=_.in,S=_.out,C=_.all,T=(r=i.getCenter)===null||r===void 0?void 0:r.call(i,y,C);if(T){var A=T[0],D=T[1],j=T[2];w=y.x-A,E=y.y-D,M=j}else w=y.x-h[0],E=y.y-h[1];if(M&&(t[m]-=M*w/x,t[m+1]-=M*E/x),p){var L=p.leaf,B=p.single,N=p.others,R=p.center,P=(R==null?void 0:R(y,o,s,c,l))||{x:0,y:0,centerStrength:0},H=P.x,ne=P.y,Z=P.centerStrength;if(!(0,Zn.isNumber)(H)||!(0,Zn.isNumber)(ne))continue;var q=(y.x-H)/x,te=(y.y-ne)/x;if(Z&&(t[m]-=Z*q,t[m+1]-=Z*te),C===0){var we=B(y);if(!we)continue;t[m]-=we*q,t[m+1]-=we*te;continue}if(k===0||S===0){var pe=L(y,o,s);if(!pe)continue;t[m]-=pe*q,t[m+1]-=pe*te;continue}var Me=N(y);if(!Me)continue;t[m]-=Me*q,t[m+1]-=Me*te}}},n.prototype.attractToSide=function(t){var r=this,i=r.defSideCoe;r.height;var o=r.nodes,a=r.relatedEdges,s=r.currentMinY,u=s===void 0?0:s,c=r.currentMaxY,l=c===void 0?this.height:c;i&&typeof i=="function"&&(o!=null&&o.length)&&o.forEach(function(h,f){var d=i(h,a[h.id]||[]);if(d!==0){var p=d<0?u:l,g=Math.abs(d);t[2*f+1]-=g*(h.y-p)}})},n.prototype.updateVelocity=function(t,r,i){var o=this,a=o.nodes,s=o.damping,u=o.maxSpeed;a!=null&&a.length&&a.forEach(function(c,l){var h=(r[2*l]+t[2*l]*i)*s||.01,f=(r[2*l+1]+t[2*l+1]*i)*s||.01,d=Math.sqrt(h*h+f*f);if(d>u){var p=u/d;h*=p,f*=p}r[2*l]=h,r[2*l+1]=f})},n.prototype.updatePosition=function(t,r){var i=this,o=i.nodes,a=i.distanceThresholdMode,s=i.nodeMap;if(o!=null&&o.length){var u=0;a==="max"?i.judgingDistance=-1/0:a==="min"&&(i.judgingDistance=1/0);var c=1/0,l=-1/0;o.forEach(function(h,f){var d=s[h.id];if((0,Zn.isNumber)(h.fx)&&(0,Zn.isNumber)(h.fy))return h.x=h.fx,h.y=h.fy,d.x=h.x,void(d.y=h.y);var p=t[2*f]*r,g=t[2*f+1]*r;h.x+=p,h.y+=g,d.x=h.x,d.y=h.y,h.y<c&&(c=h.y),h.y>l&&(l=h.y);var v=Math.sqrt(p*p+g*g);switch(a){case"max":i.judgingDistance<v&&(i.judgingDistance=v);break;case"min":i.judgingDistance>v&&(i.judgingDistance=v);break;default:u+=v}}),this.currentMinY=c,this.currentMaxY=l,a&&a!=="mean"||(i.judgingDistance=u/o.length)}else this.judgingDistance=0},n.prototype.stop=function(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval)},n.prototype.destroy=function(){var t=this;t.stop(),t.tick=null,t.nodes=null,t.edges=null,t.destroyed=!0},n.prototype.getType=function(){return"force2"},n.prototype.getSameTypeLeafMap=function(){var t=this,r=t.nodeClusterBy,i=t.nodes,o=t.edges,a=t.nodeMap,s=t.degreesMap;if(i!=null&&i.length){var u={};return i.forEach(function(c,l){s[c.id].all===1&&(u[c.id]=(0,Zn.getCoreNodeAndRelativeLeafNodes)("leaf",c,o,r,s,a))}),u}},n}(tz.Base);rl.Force2Layout=rz;var mm={},yd={};function Kn(e){return function(){return e}}function la(e){return 1e-6*(e()-.5)}function iz(e){return e.x+e.vx}function oz(e){return e.y+e.vy}function az(e){return e.index}function Jk(e,n){var t=e.get(n);if(!t)throw new Error("node not found: "+n);return t}var sz={value:()=>{}};function eC(){for(var e,n=0,t=arguments.length,r={};n<t;++n){if(!(e=arguments[n]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new bd(r)}function bd(e){this._=e}function uz(e,n){for(var t,r=0,i=e.length;r<i;++r)if((t=e[r]).name===n)return t.value}function tC(e,n,t){for(var r=0,i=e.length;r<i;++r)if(e[r].name===n){e[r]=sz,e=e.slice(0,r).concat(e.slice(r+1));break}return t!=null&&e.push({name:n,value:t}),e}bd.prototype=eC.prototype={constructor:bd,on:function(e,n){var t,r=this._,i=function(s,u){return s.trim().split(/^|\s+/).map(function(c){var l="",h=c.indexOf(".");if(h>=0&&(l=c.slice(h+1),c=c.slice(0,h)),c&&!u.hasOwnProperty(c))throw new Error("unknown type: "+c);return{type:c,name:l}})}(e+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++o<a;)if(t=(e=i[o]).type)r[t]=tC(r[t],e.name,n);else if(n==null)for(t in r)r[t]=tC(r[t],e.name,null);return this}for(;++o<a;)if((t=(e=i[o]).type)&&(t=uz(r[t],e.name)))return t},copy:function(){var e={},n=this._;for(var t in n)e[t]=n[t].slice();return new bd(e)},call:function(e,n){if((t=arguments.length-2)>0)for(var t,r,i=new Array(t),o=0;o<t;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,t=(r=this._[e]).length;o<t;++o)r[o].value.apply(n,i)},apply:function(e,n,t){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(n,t)}};var xd,il,cu=0,ol=0,al=0,wd=0,os=0,Ed=0,sl=typeof performance=="object"&&performance.now?performance:Date,nC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function rC(){return os||(nC(cz),os=sl.now()+Ed)}function cz(){os=0}function ym(){this._call=this._time=this._next=null}function iC(e,n,t){var r=new ym;return r.restart(e,n,t),r}function oC(){os=(wd=sl.now())+Ed,cu=ol=0;try{(function(){rC(),++cu;for(var e,n=xd;n;)(e=os-n._time)>=0&&n._call.call(null,e),n=n._next;--cu})()}finally{cu=0,function(){for(var e,n,t=xd,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:xd=n);il=e,bm(r)}(),os=0}}function lz(){var e=sl.now(),n=e-wd;n>1e3&&(Ed-=n,wd=e)}function bm(e){cu||(ol&&(ol=clearTimeout(ol)),e-os>24?(e<1/0&&(ol=setTimeout(oC,e-sl.now()-Ed)),al&&(al=clearInterval(al))):(al||(wd=sl.now(),al=setInterval(lz,1e3)),cu=1,nC(oC)))}ym.prototype=iC.prototype={constructor:ym,restart:function(e,n,t){if(typeof e!="function")throw new TypeError("callback is not a function");t=(t==null?rC():+t)+(n==null?0:+n),this._next||il===this||(il?il._next=this:xd=this,il=this),this._call=e,this._time=t,bm()},stop:function(){this._call&&(this._call=null,this._time=1/0,bm())}};const aC=4294967296;function hz(e){return e.x}function fz(e){return e.y}var dz=Math.PI*(3-Math.sqrt(5));const pz=Object.freeze(Object.defineProperty({__proto__:null,forceCenter:function(e,n){var t,r=1;function i(){var o,a,s=t.length,u=0,c=0;for(o=0;o<s;++o)u+=(a=t[o]).x,c+=a.y;for(u=(u/s-e)*r,c=(c/s-n)*r,o=0;o<s;++o)(a=t[o]).x-=u,a.y-=c}return e==null&&(e=0),n==null&&(n=0),i.initialize=function(o){t=o},i.x=function(o){return arguments.length?(e=+o,i):e},i.y=function(o){return arguments.length?(n=+o,i):n},i.strength=function(o){return arguments.length?(r=+o,i):r},i},forceCollide:function(e){var n,t,r,i=1,o=1;function a(){for(var c,l,h,f,d,p,g,v=n.length,m=0;m<o;++m)for(l=md(n,iz,oz).visitAfter(s),c=0;c<v;++c)h=n[c],p=t[h.index],g=p*p,f=h.x+h.vx,d=h.y+h.vy,l.visit(y);function y(b,x,w,E,M){var _=b.data,k=b.r,S=p+k;if(!_)return x>f+S||E<f-S||w>d+S||M<d-S;if(_.index>h.index){var C=f-_.x-_.vx,T=d-_.y-_.vy,A=C*C+T*T;A<S*S&&(C===0&&(A+=(C=la(r))*C),T===0&&(A+=(T=la(r))*T),A=(S-(A=Math.sqrt(A)))/A*i,h.vx+=(C*=A)*(S=(k*=k)/(g+k)),h.vy+=(T*=A)*S,_.vx-=C*(S=1-S),_.vy-=T*S)}}}function s(c){if(c.data)return c.r=t[c.data.index];for(var l=c.r=0;l<4;++l)c[l]&&c[l].r>c.r&&(c.r=c[l].r)}function u(){if(n){var c,l,h=n.length;for(t=new Array(h),c=0;c<h;++c)l=n[c],t[l.index]=+e(l,c,n)}}return typeof e!="function"&&(e=Kn(e==null?1:+e)),a.initialize=function(c,l){n=c,r=l,u()},a.iterations=function(c){return arguments.length?(o=+c,a):o},a.strength=function(c){return arguments.length?(i=+c,a):i},a.radius=function(c){return arguments.length?(e=typeof c=="function"?c:Kn(+c),u(),a):e},a},forceLink:function(e){var n,t,r,i,o,a,s=az,u=function(g){return 1/Math.min(i[g.source.index],i[g.target.index])},c=Kn(30),l=1;function h(g){for(var v=0,m=e.length;v<l;++v)for(var y,b,x,w,E,M,_,k=0;k<m;++k)b=(y=e[k]).source,w=(x=y.target).x+x.vx-b.x-b.vx||la(a),E=x.y+x.vy-b.y-b.vy||la(a),w*=M=((M=Math.sqrt(w*w+E*E))-t[k])/M*g*n[k],E*=M,x.vx-=w*(_=o[k]),x.vy-=E*_,b.vx+=w*(_=1-_),b.vy+=E*_}function f(){if(r){var g,v,m=r.length,y=e.length,b=new Map(r.map((x,w)=>[s(x,w,r),x]));for(g=0,i=new Array(m);g<y;++g)(v=e[g]).index=g,typeof v.source!="object"&&(v.source=Jk(b,v.source)),typeof v.target!="object"&&(v.target=Jk(b,v.target)),i[v.source.index]=(i[v.source.index]||0)+1,i[v.target.index]=(i[v.target.index]||0)+1;for(g=0,o=new Array(y);g<y;++g)v=e[g],o[g]=i[v.source.index]/(i[v.source.index]+i[v.target.index]);n=new Array(y),d(),t=new Array(y),p()}}function d(){if(r)for(var g=0,v=e.length;g<v;++g)n[g]=+u(e[g],g,e)}function p(){if(r)for(var g=0,v=e.length;g<v;++g)t[g]=+c(e[g],g,e)}return e==null&&(e=[]),h.initialize=function(g,v){r=g,a=v,f()},h.links=function(g){return arguments.length?(e=g,f(),h):e},h.id=function(g){return arguments.length?(s=g,h):s},h.iterations=function(g){return arguments.length?(l=+g,h):l},h.strength=function(g){return arguments.length?(u=typeof g=="function"?g:Kn(+g),d(),h):u},h.distance=function(g){return arguments.length?(c=typeof g=="function"?g:Kn(+g),p(),h):c},h},forceManyBody:function(){var e,n,t,r,i,o=Kn(-30),a=1,s=1/0,u=.81;function c(d){var p,g=e.length,v=md(e,hz,fz).visitAfter(h);for(r=d,p=0;p<g;++p)n=e[p],v.visit(f)}function l(){if(e){var d,p,g=e.length;for(i=new Array(g),d=0;d<g;++d)p=e[d],i[p.index]=+o(p,d,e)}}function h(d){var p,g,v,m,y,b=0,x=0;if(d.length){for(v=m=y=0;y<4;++y)(p=d[y])&&(g=Math.abs(p.value))&&(b+=p.value,x+=g,v+=g*p.x,m+=g*p.y);d.x=v/x,d.y=m/x}else{(p=d).x=p.data.x,p.y=p.data.y;do b+=i[p.data.index];while(p=p.next)}d.value=b}function f(d,p,g,v){if(!d.value)return!0;var m=d.x-n.x,y=d.y-n.y,b=v-p,x=m*m+y*y;if(b*b/u<x)return x<s&&(m===0&&(x+=(m=la(t))*m),y===0&&(x+=(y=la(t))*y),x<a&&(x=Math.sqrt(a*x)),n.vx+=m*d.value*r/x,n.vy+=y*d.value*r/x),!0;if(!(d.length||x>=s)){(d.data!==n||d.next)&&(m===0&&(x+=(m=la(t))*m),y===0&&(x+=(y=la(t))*y),x<a&&(x=Math.sqrt(a*x)));do d.data!==n&&(b=i[d.data.index]*r/x,n.vx+=m*b,n.vy+=y*b);while(d=d.next)}}return c.initialize=function(d,p){e=d,t=p,l()},c.strength=function(d){return arguments.length?(o=typeof d=="function"?d:Kn(+d),l(),c):o},c.distanceMin=function(d){return arguments.length?(a=d*d,c):Math.sqrt(a)},c.distanceMax=function(d){return arguments.length?(s=d*d,c):Math.sqrt(s)},c.theta=function(d){return arguments.length?(u=d*d,c):Math.sqrt(u)},c},forceRadial:function(e,n,t){var r,i,o,a=Kn(.1);function s(c){for(var l=0,h=r.length;l<h;++l){var f=r[l],d=f.x-n||1e-6,p=f.y-t||1e-6,g=Math.sqrt(d*d+p*p),v=(o[l]-g)*i[l]*c/g;f.vx+=d*v,f.vy+=p*v}}function u(){if(r){var c,l=r.length;for(i=new Array(l),o=new Array(l),c=0;c<l;++c)o[c]=+e(r[c],c,r),i[c]=isNaN(o[c])?0:+a(r[c],c,r)}}return typeof e!="function"&&(e=Kn(+e)),n==null&&(n=0),t==null&&(t=0),s.initialize=function(c){r=c,u()},s.strength=function(c){return arguments.length?(a=typeof c=="function"?c:Kn(+c),u(),s):a},s.radius=function(c){return arguments.length?(e=typeof c=="function"?c:Kn(+c),u(),s):e},s.x=function(c){return arguments.length?(n=+c,s):n},s.y=function(c){return arguments.length?(t=+c,s):t},s},forceSimulation:function(e){var n,t=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,u=iC(h),c=eC("tick","end"),l=function(){let g=1;return()=>(g=(1664525*g+1013904223)%aC)/aC}();function h(){f(),c.call("tick",n),t<r&&(u.stop(),c.call("end",n))}function f(g){var v,m,y=e.length;g===void 0&&(g=1);for(var b=0;b<g;++b)for(t+=(o-t)*i,s.forEach(function(x){x(t)}),v=0;v<y;++v)(m=e[v]).fx==null?m.x+=m.vx*=a:(m.x=m.fx,m.vx=0),m.fy==null?m.y+=m.vy*=a:(m.y=m.fy,m.vy=0);return n}function d(){for(var g,v=0,m=e.length;v<m;++v){if((g=e[v]).index=v,g.fx!=null&&(g.x=g.fx),g.fy!=null&&(g.y=g.fy),isNaN(g.x)||isNaN(g.y)){var y=10*Math.sqrt(.5+v),b=v*dz;g.x=y*Math.cos(b),g.y=y*Math.sin(b)}(isNaN(g.vx)||isNaN(g.vy))&&(g.vx=g.vy=0)}}function p(g){return g.initialize&&g.initialize(e,l),g}return e==null&&(e=[]),d(),n={tick:f,restart:function(){return u.restart(h),n},stop:function(){return u.stop(),n},nodes:function(g){return arguments.length?(e=g,d(),s.forEach(p),n):e},alpha:function(g){return arguments.length?(t=+g,n):t},alphaMin:function(g){return arguments.length?(r=+g,n):r},alphaDecay:function(g){return arguments.length?(i=+g,n):+i},alphaTarget:function(g){return arguments.length?(o=+g,n):o},velocityDecay:function(g){return arguments.length?(a=1-g,n):1-a},randomSource:function(g){return arguments.length?(l=g,s.forEach(p),n):l},force:function(g,v){return arguments.length>1?(v==null?s.delete(g):s.set(g,p(v)),n):s.get(g)},find:function(g,v,m){var y,b,x,w,E,M=0,_=e.length;for(m==null?m=1/0:m*=m,M=0;M<_;++M)(x=(y=g-(w=e[M]).x)*y+(b=v-w.y)*b)<m&&(E=w,m=x);return E},on:function(g,v){return arguments.length>1?(c.on(g,v),n):c.on(g)}}},forceX:function(e){var n,t,r,i=Kn(.1);function o(s){for(var u,c=0,l=n.length;c<l;++c)(u=n[c]).vx+=(r[c]-u.x)*t[c]*s}function a(){if(n){var s,u=n.length;for(t=new Array(u),r=new Array(u),s=0;s<u;++s)t[s]=isNaN(r[s]=+e(n[s],s,n))?0:+i(n[s],s,n)}}return typeof e!="function"&&(e=Kn(e==null?0:+e)),o.initialize=function(s){n=s,a()},o.strength=function(s){return arguments.length?(i=typeof s=="function"?s:Kn(+s),a(),o):i},o.x=function(s){return arguments.length?(e=typeof s=="function"?s:Kn(+s),a(),o):e},o},forceY:function(e){var n,t,r,i=Kn(.1);function o(s){for(var u,c=0,l=n.length;c<l;++c)(u=n[c]).vy+=(r[c]-u.y)*t[c]*s}function a(){if(n){var s,u=n.length;for(t=new Array(u),r=new Array(u),s=0;s<u;++s)t[s]=isNaN(r[s]=+e(n[s],s,n))?0:+i(n[s],s,n)}}return typeof e!="function"&&(e=Kn(e==null?0:+e)),o.initialize=function(s){n=s,a()},o.strength=function(s){return arguments.length?(i=typeof s=="function"?s:Kn(+s),a(),o):i},o.y=function(s){return arguments.length?(e=typeof s=="function"?s:Kn(+s),a(),o):e},o}},Symbol.toStringTag,{value:"Module"})),xm=ji(pz);var wm={},gz=xe&&xe.__createBinding||(Object.create?function(e,n,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(n,t);i&&!("get"in i?!n.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(e,r,i)}:function(e,n,t,r){r===void 0&&(r=t),e[r]=n[t]}),vz=xe&&xe.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),mz=xe&&xe.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var t in e)t!=="default"&&Object.prototype.hasOwnProperty.call(e,t)&&gz(n,e,t);return vz(n,e),n};Object.defineProperty(wm,"__esModule",{value:!0});var lu=mz(xm),Md=_n();wm.default=function(){function e(w){return function(){return w}}var n,t=function(w){return w.cluster},r=e(1),i=e(-1),o=e(100),a=e(.1),s=[0,0],u=[],c={},l=[],h=100,f=100,d={none:{x:0,y:0}},p=[],g="force",v=!0,m=.1;function y(w){if(!v)return y;n.tick(),x();for(var E=0,M=u.length,_=void 0,k=w*m;E<M;++E)(_=u[E]).vx+=(d[t(_)].x-_.x)*k,_.vy+=(d[t(_)].y-_.y)*k}function b(){u&&function(){if(!(!u||!u.length)){if(t(u[0])===void 0)throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy('clusterAttr') before calling .links()");var w=(E=[],M=[],_={},k={},S=[],k=function(C){var T={};return C.forEach(function(A){var D=t(A);T[D]||(T[D]={count:0,sumforceNodeSize:0})}),C.forEach(function(A){var D=t(A),j=r(A),L=T[D];L.count=L.count+1,L.sumforceNodeSize=L.sumforceNodeSize+Math.PI*(j*j)*1.3,T[D]=L}),T}(u),S=function(C){var T={},A=[];return C.forEach(function(D){var j=function(B){var N=(0,Md.getEdgeTerminal)(B,"source"),R=(0,Md.getEdgeTerminal)(B,"target"),P=t(c[N]),H=t(c[R]);return P<=H?"".concat(P,"~").concat(H):"".concat(H,"~").concat(P)}(D),L=0;T[j]!==void 0&&(L=T[j]),L+=1,T[j]=L}),Object.entries(T).forEach(function(D){var j=D[0],L=D[1],B=j.split("~")[0],N=j.split("~")[1];B!==void 0&&N!==void 0&&A.push({source:B,target:N,count:L})}),A}(l),Object.keys(k).forEach(function(C,T){var A=k[C];E.push({id:C,size:A.count,r:Math.sqrt(A.sumforceNodeSize/Math.PI)}),_[C]=T}),S.forEach(function(C){var T=(0,Md.getEdgeTerminal)(C,"source"),A=(0,Md.getEdgeTerminal)(C,"target"),D=_[T],j=_[A];D!==void 0&&j!==void 0&&M.push({source:D,target:j,count:C.count})}),{nodes:E,links:M}),E,M,_,k,S;n=lu.forceSimulation(w.nodes).force("x",lu.forceX(h).strength(.1)).force("y",lu.forceY(f).strength(.1)).force("collide",lu.forceCollide(function(C){return C.r}).iterations(4)).force("charge",lu.forceManyBody().strength(i)).force("links",lu.forceLink(w.nodes.length?w.links:[]).distance(o).strength(a)),p=n.nodes(),x()}}()}function x(){return d={none:{x:0,y:0}},p.forEach(function(w){d[w.id]={x:w.x-s[0],y:w.y-s[1]}}),d}return y.initialize=function(w){u=w,b()},y.template=function(w){return arguments.length?(g=w,b(),y):g},y.groupBy=function(w){return arguments.length?typeof w=="string"?(t=function(E){return E[w]},y):(t=w,y):t},y.enableGrouping=function(w){return arguments.length?(v=w,y):v},y.strength=function(w){return arguments.length?(m=w,y):m},y.centerX=function(w){return arguments.length?(h=w,y):h},y.centerY=function(w){return arguments.length?(f=w,y):f},y.nodes=function(w){return arguments.length?(function(E){c={},E.forEach(function(M){c[M.id]=M})}(w||[]),u=w||[],y):u},y.links=function(w){return arguments.length?(l=w||[],b(),y):l},y.forceNodeSize=function(w){return arguments.length?(r=typeof w=="function"?w:e(+w),b(),y):r},y.nodeSize=y.forceNodeSize,y.forceCharge=function(w){return arguments.length?(i=typeof w=="function"?w:e(+w),b(),y):i},y.forceLinkDistance=function(w){return arguments.length?(o=typeof w=="function"?w:e(+w),b(),y):o},y.forceLinkStrength=function(w){return arguments.length?(a=typeof w=="function"?w:e(+w),b(),y):a},y.offset=function(w){return arguments.length?(s=w,y):s},y.getFocis=x,y};var Eo={};Object.defineProperty(Eo,"__esModule",{value:!0}),Eo.FORCE_LAYOUT_TYPE_MAP=Eo.LAYOUT_MESSAGE=void 0,Eo.LAYOUT_MESSAGE={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"},Eo.FORCE_LAYOUT_TYPE_MAP={gForce:!0,force2:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0};var yz=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),bz=xe&&xe.__createBinding||(Object.create?function(e,n,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(n,t);i&&!("get"in i?!n.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(e,r,i)}:function(e,n,t,r){r===void 0&&(r=t),e[r]=n[t]}),xz=xe&&xe.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),wz=xe&&xe.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var t in e)t!=="default"&&Object.prototype.hasOwnProperty.call(e,t)&&bz(n,e,t);return xz(n,e),n},Ez=xe&&xe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yd,"__esModule",{value:!0}),yd.ForceLayout=void 0;var hu=wz(xm),Mz=Ez(wm),as=_n(),Sz=Eo,_z=function(e){function n(t){var r=e.call(this)||this;return r.center=[0,0],r.nodeStrength=null,r.edgeStrength=null,r.preventOverlap=!1,r.clusterNodeStrength=null,r.clusterEdgeStrength=null,r.clusterEdgeDistance=null,r.clusterNodeSize=null,r.clusterFociStrength=null,r.linkDistance=50,r.alphaDecay=.028,r.alphaMin=.001,r.alpha=.3,r.collideStrength=1,r.workerEnabled=!1,r.tick=function(){},r.onLayoutEnd=function(){},r.ticking=void 0,t&&r.updateCfg(t),r}return yz(n,e),n.prototype.getDefaultCfg=function(){return{center:[0,0],nodeStrength:null,edgeStrength:null,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10,tick:function(){},onLayoutEnd:function(){},workerEnabled:!1}},n.prototype.init=function(t){var r=this;r.nodes=t.nodes||[];var i=t.edges||[];r.edges=i.map(function(o){var a={},s=["targetNode","sourceNode","startPoint","endPoint"];return Object.keys(o).forEach(function(u){s.indexOf(u)>-1||(a[u]=o[u])}),a}),r.ticking=!1},n.prototype.execute=function(t){var r=this,i=r.nodes,o=r.edges;if(!r.ticking){var a=r.forceSimulation,s=r.alphaMin,u=r.alphaDecay,c=r.alpha;if(a)t&&(r.clustering&&r.clusterForce&&(r.clusterForce.nodes(i),r.clusterForce.links(o)),a.nodes(i),o&&r.edgeForce?r.edgeForce.links(o):o&&!r.edgeForce&&(f=hu.forceLink().id(function(g){return g.id}).links(o),r.edgeStrength&&f.strength(r.edgeStrength),r.linkDistance&&f.distance(r.linkDistance),r.edgeForce=f,a.force("link",f))),r.preventOverlap&&r.overlapProcess(a),a.alpha(c).restart(),this.ticking=!0;else try{var l=hu.forceManyBody();if(r.nodeStrength&&l.strength(r.nodeStrength),a=hu.forceSimulation().nodes(i),r.clustering){var h=(0,Mz.default)();h.centerX(r.center[0]).centerY(r.center[1]).template("force").strength(r.clusterFociStrength),o&&h.links(o),i&&h.nodes(i),h.forceLinkDistance(r.clusterEdgeDistance).forceLinkStrength(r.clusterEdgeStrength).forceCharge(r.clusterNodeStrength).forceNodeSize(r.clusterNodeSize),r.clusterForce=h,a.force("group",h)}if(a.force("center",hu.forceCenter(r.center[0],r.center[1])).force("charge",l).alpha(c).alphaDecay(u).alphaMin(s),r.preventOverlap&&r.overlapProcess(a),o){var f=hu.forceLink().id(function(g){return g.id}).links(o);r.edgeStrength&&f.strength(r.edgeStrength),r.linkDistance&&f.distance(r.linkDistance),r.edgeForce=f,a.force("link",f)}if(r.workerEnabled&&!kz()&&(r.workerEnabled=!1),r.workerEnabled){a.stop();for(var d=function(g){var v=g.alphaMin(),m=g.alphaTarget(),y=g.alpha(),b=Math.log((v-m)/(y-m))/Math.log(1-g.alphaDecay()),x=Math.ceil(b);return x}(a),p=1;p<=d;p++)a.tick(),postMessage({nodes:i,currentTick:p,totalTicks:d,type:Sz.LAYOUT_MESSAGE.TICK},void 0);r.ticking=!1}else a.on("tick",function(){r.tick()}).on("end",function(){r.ticking=!1,r.onLayoutEnd&&r.onLayoutEnd()}),r.ticking=!0;r.forceSimulation=a,r.ticking=!0}catch{r.ticking=!1}}},n.prototype.overlapProcess=function(t){var r,i,o=this,a=o.nodeSize,s=o.nodeSpacing,u=o.collideStrength;if(i=(0,as.isNumber)(s)?function(){return s}:(0,as.isFunction)(s)?s:function(){return 0},a)if((0,as.isFunction)(a))r=function(h){return a(h)+i(h)};else if((0,as.isArray)(a)){var c=(a[0]>a[1]?a[0]:a[1])/2;r=function(h){return c+i(h)}}else if((0,as.isNumber)(a)){var l=a/2;r=function(h){return l+i(h)}}else r=function(){return 10};else r=function(h){return h.size?(0,as.isArray)(h.size)?(h.size[0]>h.size[1]?h.size[0]:h.size[1])/2+i(h):(0,as.isObject)(h.size)?(h.size.width>h.size.height?h.size.width:h.size.height)/2+i(h):h.size/2+i(h):10+i(h)};t.force("collisionForce",hu.forceCollide(r).strength(u))},n.prototype.updateCfg=function(t){var r=this;r.ticking&&(r.forceSimulation.stop(),r.ticking=!1),r.forceSimulation=null,Object.assign(r,t)},n.prototype.destroy=function(){var t=this;t.ticking&&(t.forceSimulation.stop(),t.ticking=!1),t.nodes=null,t.edges=null,t.destroyed=!0},n}(Nn.Base);function kz(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}yd.ForceLayout=_z,function(e){var n=xe&&xe.__createBinding||(Object.create?function(r,i,o,a){a===void 0&&(a=o);var s=Object.getOwnPropertyDescriptor(i,o);s&&!("get"in s?!i.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(r,a,s)}:function(r,i,o,a){a===void 0&&(a=o),r[a]=i[o]}),t=xe&&xe.__exportStar||function(r,i){for(var o in r)o==="default"||Object.prototype.hasOwnProperty.call(i,o)||n(i,r,o)};Object.defineProperty(e,"__esModule",{value:!0}),t(yd,e)}(mm);var ul={},Cz=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(ul,"__esModule",{value:!0}),ul.CircularLayout=void 0;var Az=Nn,eo=_n();function Iz(e,n){var t=e.degree,r=n.degree;return t<r?-1:t>r?1:0}var Tz=function(e){function n(t){var r=e.call(this)||this;return r.radius=null,r.nodeSize=void 0,r.startRadius=null,r.endRadius=null,r.startAngle=0,r.endAngle=2*Math.PI,r.clockwise=!0,r.divisions=1,r.ordering=null,r.angleRatio=1,r.nodes=[],r.edges=[],r.nodeMap={},r.degrees=[],r.width=300,r.height=300,r.updateCfg(t),r}return Cz(n,e),n.prototype.getDefaultCfg=function(){return{radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1}},n.prototype.execute=function(){var t,r=this,i=r.nodes,o=r.edges,a=i.length;if(a!==0){r.width||typeof window>"u"||(r.width=window.innerWidth),r.height||typeof window>"u"||(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);var s=r.center;if(a===1)return i[0].x=s[0],i[0].y=s[1],void(r.onLayoutEnd&&r.onLayoutEnd());var u=r.radius,c=r.startRadius,l=r.endRadius,h=r.divisions,f=r.startAngle,d=r.endAngle,p=r.angleRatio,g=r.ordering,v=r.clockwise,m=r.nodeSpacing,y=r.nodeSize,b=(d-f)/a,x={};i.forEach(function(L,B){x[L.id]=B}),r.nodeMap=x;var w=(0,eo.getDegree)(i.length,x,o);if(r.degrees=w,m){var E=(0,eo.getFuncByUnknownType)(10,m),M=(0,eo.getFuncByUnknownType)(10,y),_=-1/0;i.forEach(function(L){var B=M(L);_<B&&(_=B)});var k=0;i.forEach(function(L,B){k+=B===0?_||10:(E(L)||0)+(_||10)}),u=k/(2*Math.PI)}else u||c||l?!c&&l?c=l:c&&!l&&(l=c):u=r.height>r.width?r.width/2:r.height/2;var S=b*p,C=[];C=g==="topology"?r.topologyOrdering():g==="topology-directed"?r.topologyOrdering(!0):g==="degree"?r.degreeOrdering():i;for(var T=Math.ceil(a/h),A=0;A<a;++A){var D=u;D||c===null||l===null||(D=c+A*(l-c)/(a-1)),D||(D=10+100*A/(a-1));var j=f+A%T*S+2*Math.PI/h*Math.floor(A/T);v||(j=d-A%T*S-2*Math.PI/h*Math.floor(A/T)),C[A].x=s[0]+Math.cos(j)*D,C[A].y=s[1]+Math.sin(j)*D,C[A].weight=w[A].all}return(t=r.onLayoutEnd)===null||t===void 0||t.call(r),{nodes:C,edges:this.edges}}r.onLayoutEnd&&r.onLayoutEnd()},n.prototype.topologyOrdering=function(t){t===void 0&&(t=!1);var r=this,i=r.degrees,o=r.edges,a=r.nodes,s=(0,eo.clone)(a),u=r.nodeMap,c=[s[0]],l=[a[0]],h=[],f=a.length;h[0]=!0,function(p,g,v,m){p.forEach(function(y,b){p[b].children=[],p[b].parent=[]}),m?g.forEach(function(y){var b=(0,eo.getEdgeTerminal)(y,"source"),x=(0,eo.getEdgeTerminal)(y,"target"),w=0;b&&(w=v[b]);var E=0;x&&(E=v[x]);var M=p[w].children,_=p[E].parent;M.push(p[E].id),_.push(p[w].id)}):g.forEach(function(y){var b=(0,eo.getEdgeTerminal)(y,"source"),x=(0,eo.getEdgeTerminal)(y,"target"),w=0;b&&(w=v[b]);var E=0;x&&(E=v[x]);var M=p[w].children,_=p[E].children;M.push(p[E].id),_.push(p[w].id)})}(s,o,u,t);var d=0;return s.forEach(function(p,g){if(g!==0)if(g!==f-1&&i[g].all===i[g+1].all&&!function(w,E,M){for(var _=M.length,k=0;k<_;k++){var S=(0,eo.getEdgeTerminal)(M[k],"source"),C=(0,eo.getEdgeTerminal)(M[k],"target");if(w.id===S&&E.id===C||E.id===S&&w.id===C)return!0}return!1}(c[d],p,o)||h[g]){for(var v=c[d].children,m=!1,y=0;y<v.length;y++){var b=u[v[y]];if(i[b].all===i[g].all&&!h[b]){c.push(s[b]),l.push(a[u[s[b].id]]),h[b]=!0,m=!0;break}}for(var x=0;!m&&(h[x]||(c.push(s[x]),l.push(a[u[s[x].id]]),h[x]=!0,m=!0),++x!==f););}else c.push(p),l.push(a[u[p.id]]),h[g]=!0,d++}),l},n.prototype.degreeOrdering=function(){var t=this.nodes,r=[],i=this.degrees;return t.forEach(function(o,a){o.degree=i[a].all,r.push(o)}),r.sort(Iz),r},n.prototype.getType=function(){return"circular"},n}(Az.Base);ul.CircularLayout=Tz;var fu={},Em={},Mm={},Sm={},_m={},km={};Object.defineProperty(km,"__esModule",{value:!0});var du,Oz=function(e,n){if(e!=="next"&&e!=="prev")return n},sC=function(e){e.prev.next=e.next,e.next.prev=e.prev,delete e.next,delete e.prev},Nz=function(){function e(){var n={};n.prev=n,n.next=n.prev,this.shortcut=n}return e.prototype.dequeue=function(){var n=this.shortcut,t=n.prev;if(t&&t!==n)return sC(t),t},e.prototype.enqueue=function(n){var t=this.shortcut;n.prev&&n.next&&sC(n),n.next=t.next,t.next.prev=n,t.next=n,n.prev=t},e.prototype.toString=function(){for(var n=[],t=this.shortcut,r=t.prev;r!==t;)n.push(JSON.stringify(r,Oz)),r=r==null?void 0:r.prev;return"[".concat(n.join(", "),"]")},e}();function uC(e,n){var t=e.get(n)||0;e.set(n,t+1)}function cC(e,n){var t=e.get(n);t!==void 0&&((t-=1)>0?e.set(n,t):e.delete(n))}function lC(e,n,t,r){var i=String(n),o=String(t);if(!e&&i>o){var a=i;i=o,o=a}return i+du.EDGE_KEY_DELIM+o+du.EDGE_KEY_DELIM+(r===void 0?du.DEFAULT_EDGE_NAME:r)}function hC(e,n,t,r){var i=String(n),o=String(t),a={v:n,w:t};if(!e&&i>o){var s=a.v;a.v=a.w,a.w=s}return r!==void 0&&(a.name=r),a}function Cm(e,n){return lC(e,n.v,n.w,n.name)}function fC(e){return typeof e=="function"}km.default=Nz,function(e){e.DEFAULT_EDGE_NAME="\0",e.GRAPH_NODE="\0",e.EDGE_KEY_DELIM=""}(du||(du={}));var Dz=function(e){return e.nodes().map(function(n){var t={id:n,value:e.node(n),parent:e.parent(n)};return t.value===void 0&&delete t.value,t.parent===void 0&&delete t.parent,t})},Pz=function(e){return e.edges().map(function(n){var t=e.edge(n),r={v:n.v,w:n.w,value:t,name:n.name};return r.name===void 0&&delete r.name,r.value===void 0&&delete r.value,r})};function dC(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,r)}return t}function pC(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?dC(Object(t),!0).forEach(function(r){Lz(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):dC(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function Lz(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Rz(e,n,t){return n&&function(r,i){for(var o=0;o<i.length;o++){var a=i[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(r,a.key,a)}}(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var jz={compound:!1,multigraph:!1,directed:!0},ss=function(){function e(){var n=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(function(i,o){if(!(i instanceof o))throw new TypeError("Cannot call a class as a function")})(this,e),this.directed=!0,this.multigraph=!1,this.compound=!1,this.GRAPH_NODE=du.GRAPH_NODE,this.label=void 0,this.nodeCountNum=0,this.edgeCountNum=0,this.defaultNodeLabelFn=function(){},this.defaultEdgeLabelFn=function(){},this.parentMap=void 0,this.childrenMap=void 0,this.nodesLabelMap=new Map,this.inEdgesMap=new Map,this.outEdgesMap=new Map,this.predecessorsMap=new Map,this.successorsMap=new Map,this.edgesMap=new Map,this.edgesLabelsMap=new Map,this.isDirected=function(){return n.directed},this.isMultigraph=function(){return n.multigraph},this.isCompound=function(){return n.compound},this.setGraph=function(i){return n.label=i,n},this.graph=function(){return n.label},this.setDefaultNodeLabel=function(i){return fC(i)?n.defaultNodeLabelFn=i:n.defaultNodeLabelFn=function(){return i},n},this.nodeCount=function(){return n.nodeCountNum},this.node=function(i){return n.nodesLabelMap.get(i)},this.nodes=function(){return Array.from(n.nodesLabelMap.keys())},this.sources=function(){return n.nodes().filter(function(i){var o;return!(!((o=n.inEdgesMap.get(i))===null||o===void 0)&&o.size)})},this.sinks=function(){return n.nodes().filter(function(i){var o;return!(!((o=n.outEdgesMap.get(i))===null||o===void 0)&&o.size)})},this.setNodes=function(i,o){return i.map(function(a){return n.setNode(a,o)}),n},this.hasNode=function(i){return n.nodesLabelMap.has(i)},this.checkCompound=function(){if(!n.isCompound())throw new Error("Cannot construct parent-children relations in a non-compound graph")},this.parent=function(i){if(n.isCompound()){var o,a=(o=n.parentMap)===null||o===void 0?void 0:o.get(i);if(a!==n.GRAPH_NODE)return a}},this.removeFromParentsChildList=function(i){var o=n.parentMap.get(i);n.childrenMap.get(o).delete(i)},this.setParent=function(i,o){var a,s;n.checkCompound();for(var u=o===void 0?n.GRAPH_NODE:o,c=n.parent(u);c;){if(i===c)throw new Error("Setting "+o+" as parent of "+i+" would create a cycle");c=n.parent(c)}o&&n.setNode(o),n.setNode(i),n.removeFromParentsChildList(i),(a=n.parentMap)===null||a===void 0||a.set(i,u);var l=n.childrenMap.get(u);return l.set(i,!0),(s=n.childrenMap)===null||s===void 0||s.set(u,l),n},this.children=function(i){var o=i===void 0?n.GRAPH_NODE:i;if(n.isCompound()){var a,s=(a=n.childrenMap)===null||a===void 0?void 0:a.get(o);return s?Array.from(s.keys()):void 0}return o===n.GRAPH_NODE?n.nodes():i&&n.hasNode(i)?[]:void 0},this.predecessors=function(i){var o=n.predecessorsMap.get(i);return o?Array.from(o.keys()):void 0},this.successors=function(i){var o=n.successorsMap.get(i);return o?Array.from(o.keys()):void 0},this.neighbors=function(i){var o;if(n.hasNode(i))return Array.from(new Set((o=n.predecessors(i))===null||o===void 0?void 0:o.concat(n.successors(i))))},this.isLeaf=function(i){var o,a;return n.isDirected()?!(!((a=n.successors(i))===null||a===void 0)&&a.length):!(!((o=n.neighbors(i))===null||o===void 0)&&o.length)},this.filterNodes=function(i){var o=n.directed,a=n.multigraph,s=n.compound,u=new e({directed:o,multigraph:a,compound:s});return u.setGraph(n.graph()),n.nodes().forEach(function(c){i(c)&&u.setNode(c,n.node(c))}),n.edges().forEach(function(c){u.hasNode(c.v)&&u.hasNode(c.w)&&u.setEdgeObj(c,n.edge(c))}),s&&u.nodes().forEach(function(c){u.setParent(c,function(l){for(var h=n.parent(l);h!==void 0&&!u.hasNode(h);)h=n.parent(h);return h}(c))}),u},this.setDefaultEdgeLabel=function(i){return fC(i)?n.defaultEdgeLabelFn=i:n.defaultEdgeLabelFn=function(){return i},n},this.edgeCount=function(){return n.edgeCountNum},this.setEdgeObj=function(i,o){return n.setEdge(i.v,i.w,o,i.name)},this.setPath=function(i,o){return i.reduce(function(a,s){return n.setEdge(a,s,o),s}),n},this.edgeFromArgs=function(i,o,a){return n.edge({v:i,w:o,name:a})},this.edge=function(i){return n.edgesLabelsMap.get(Cm(n.isDirected(),i))},this.hasEdge=function(i,o,a){return n.edgesLabelsMap.has(Cm(n.isDirected(),{v:i,w:o,name:a}))},this.removeEdgeObj=function(i){var o=i.v,a=i.w,s=i.name;return n.removeEdge(o,a,s)},this.edges=function(){return Array.from(n.edgesMap.values())},this.inEdges=function(i,o){var a=n.inEdgesMap.get(i);if(a)return Array.from(a.values()).filter(function(s){return!o||s.v===o})},this.outEdges=function(i,o){var a=n.outEdgesMap.get(i);if(a)return Array.from(a.values()).filter(function(s){return!o||s.w===o})},this.nodeEdges=function(i,o){var a;if(n.hasNode(i))return(a=n.inEdges(i,o))===null||a===void 0?void 0:a.concat(n.outEdges(i,o))},this.toJSON=function(){return function(i){var o={options:{directed:i.isDirected(),multigraph:i.isMultigraph(),compound:i.isCompound()},nodes:Dz(i),edges:Pz(i),value:i.graph()};return o.value===void 0&&delete o.value,o}(n)},this.nodeInDegree=function(i){var o=n.inEdgesMap.get(i);return o?o.size:0},this.nodeOutDegree=function(i){var o=n.outEdgesMap.get(i);return o?o.size:0},this.nodeDegree=function(i){return n.nodeInDegree(i)+n.nodeOutDegree(i)},this.source=function(i){return i.v},this.target=function(i){return i.w};var r=pC(pC({},jz),t);this.compound=r.compound,this.directed=r.directed,this.multigraph=r.multigraph,this.compound&&(this.parentMap=new Map,this.childrenMap=new Map)}return Rz(e,[{key:"setNode",value:function(n,t){var r,i=this.nodesLabelMap,o=this.defaultNodeLabelFn,a=this.isCompound,s=this.parentMap,u=this.childrenMap,c=this.inEdgesMap,l=this.outEdgesMap,h=this.predecessorsMap,f=this.successorsMap;return i.has(n)?(t!==void 0&&i.set(n,t),this):(i.set(n,t||o(n)),a()&&(s==null||s.set(n,this.GRAPH_NODE),u==null||u.set(n,new Map),u!=null&&u.has(this.GRAPH_NODE)||u==null||u.set(this.GRAPH_NODE,new Map),u==null||(r=u.get(this.GRAPH_NODE))===null||r===void 0||r.set(n,!0)),[c,l,h,f].forEach(function(d){return d.set(n,new Map)}),this.nodeCountNum+=1,this)}},{key:"removeNode",value:function(n){var t=this;if(this.hasNode(n)){var r,i,o,a=function(p){t.removeEdge(p.v,p.w,p.name)},s=this.inEdgesMap,u=this.outEdgesMap,c=this.predecessorsMap,l=this.successorsMap,h=this.nodesLabelMap;this.isCompound()&&(this.removeFromParentsChildList(n),(r=this.parentMap)===null||r===void 0||r.delete(n),(i=this.children(n))===null||i===void 0||i.forEach(function(p){return t.setParent(p)}),(o=this.childrenMap)===null||o===void 0||o.delete(n));var f=s.get(n),d=u.get(n);Array.from(f.values()).forEach(function(p){return a(p)}),Array.from(d.values()).forEach(function(p){return a(p)}),h.delete(n),s.delete(n),u.delete(n),c.delete(n),l.delete(n),this.nodeCountNum-=1}return this}},{key:"setEdge",value:function(n,t,r,i){var o,a,s=hC(this.isDirected(),n,t,i),u=Cm(this.isDirected(),s),c=s.v,l=s.w;if(this.edgesLabelsMap.has(u))return this.edgesLabelsMap.set(u,r),this;if(i!==void 0&&!this.isMultigraph())throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(c),this.setNode(l),this.edgesLabelsMap.set(u,r||this.defaultEdgeLabelFn(c,l,i)),Object.freeze(s),this.edgesMap.set(u,s);var h=this.predecessorsMap.get(l),f=this.successorsMap.get(c);return uC(h,c),uC(f,l),(o=this.inEdgesMap.get(l))===null||o===void 0||o.set(u,s),(a=this.outEdgesMap.get(c))===null||a===void 0||a.set(u,s),this.edgeCountNum+=1,this}},{key:"removeEdge",value:function(n,t,r){var i=lC(this.isDirected(),n,t,r);if(this.edgesMap.get(i)){var o=hC(this.isDirected(),n,t,r),a=o.v,s=o.w;this.edgesLabelsMap.delete(i),this.edgesMap.delete(i);var u=this.predecessorsMap.get(s),c=this.successorsMap.get(a);cC(u,a),cC(c,s),this.inEdgesMap.get(s).delete(i),this.outEdgesMap.get(a).delete(i),this.edgeCountNum-=1}return this}}]),e}();function Am(e){return Am=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Am(e)}function Bz(e,n,t){return n&&function(r,i){for(var o=0;o<i.length;o++){var a=i[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(r,a.key,a)}}(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function pu(){return pu=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(e,n,t){var r=function(o,a){for(;!Object.prototype.hasOwnProperty.call(o,a)&&(o=Mo(o))!==null;);return o}(e,n);if(r){var i=Object.getOwnPropertyDescriptor(r,n);return i.get?i.get.call(arguments.length<3?e:t):i.value}},pu.apply(this,arguments)}function Im(e,n){return Im=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t},Im(e,n)}function zz(e){var n=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var t,r=Mo(e);if(n){var i=Mo(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return function(o,a){if(a&&(Am(a)==="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}(o)}(this,t)}}function Mo(e){return Mo=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},Mo(e)}ss.fromJSON=function(e){var n=new ss(e.options);return e.value!==void 0&&n.setGraph(e.value),e.nodes.forEach(function(t){n.setNode(t.id,t.value),t.parent&&n.setParent(t.id,t.parent)}),e.edges.forEach(function(t){n.setEdge(t.v,t.w,t.value,t.name)}),n};var Fz=function(){(function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&Im(t,r)})(n,ss);var e=zz(n);function n(){var t;(function(a,s){if(!(a instanceof s))throw new TypeError("Cannot call a class as a function")})(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).eventPool={},t}return Bz(n,[{key:"appendEvent",value:function(t,r){this.eventPool[t]||(this.eventPool[t]=[]),this.eventPool[t].push(r)}},{key:"removeEvent",value:function(t,r){if(this.eventPool[t]){var i=this.eventPool[t].indexOf(r);i>-1&&this.eventPool[t].splice(i,1)}}},{key:"emitEvent",value:function(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];this.eventPool[t]&&this.eventPool[t].forEach(function(a){a.apply(void 0,i)})}},{key:"setNode",value:function(t,r){return pu(Mo(n.prototype),"setNode",this).call(this,t,r),this.emitEvent("nodeAdd",t,r),this}},{key:"removeNode",value:function(t){return pu(Mo(n.prototype),"removeNode",this).call(this,t),this.emitEvent("nodeRemove",t),this}},{key:"setEdge",value:function(t,r,i,o){return pu(Mo(n.prototype),"setEdge",this).call(this,t,r,i,o),this.emitEvent("edgeAdd",t,r,i,o),this}},{key:"removeEdge",value:function(t,r,i){return pu(Mo(n.prototype),"removeEdge",this).call(this,t,r,i),this.emitEvent("edgeRemove",t,r,i),this}}]),n}();function Gz(e,n,t){return Object.defineProperty(e,"prototype",{writable:!1}),e}var gC=Gz(function e(){var n=this;(function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")})(this,e),this.arr=[],this.keyIndice=new Map,this.size=function(){return n.arr.length},this.keys=function(){return n.arr.map(function(t){return t.key})},this.has=function(t){return n.keyIndice.has(t)},this.priority=function(t){var r=n.keyIndice.get(t);if(r!==void 0)return n.arr[r].priority},this.swap=function(t,r){var i=n.arr,o=n.keyIndice,a=[i[t],i[r]],s=a[0],u=a[1];i[t]=u,i[r]=s,o.set(s.key,r),o.set(u.key,t)},this.innerDecrease=function(t){for(var r,i=n.arr,o=i[t].priority,a=t;a!==0;){var s;if(((s=i[r=a>>1])===null||s===void 0?void 0:s.priority)<o)break;n.swap(a,r),a=r}},this.heapify=function(t){var r=n.arr,i=t<<1,o=i+1,a=t;i<r.length&&(a=r[i].priority<r[a].priority?i:a,o<r.length&&(a=r[o].priority<r[a].priority?o:a),a!==t&&(n.swap(t,a),n.heapify(a)))},this.min=function(){if(n.size()===0)throw new Error("Queue underflow");return n.arr[0].key},this.add=function(t,r){var i=n.keyIndice,o=n.arr;if(!i.has(t)){var a=o.length;return i.set(t,a),o.push({key:t,priority:r}),n.innerDecrease(a),!0}return!1},this.removeMin=function(){n.swap(0,n.arr.length-1);var t=n.arr.pop();return n.keyIndice.delete(t.key),n.heapify(0),t.key},this.decrease=function(t,r){if(!n.has(t))throw new Error("There's no key named ".concat(t));var i=n.keyIndice.get(t);if(r>n.arr[i].priority)throw new Error("New priority is greater than current priority.Key: ".concat(t," Old: + ").concat(n.arr[i].priority," New: ").concat(r));n.arr[i].priority=r,n.innerDecrease(i)}}),Uz=function e(n,t,r,i,o,a){i.includes(t)||(i.push(t),r||a.push(t),o(t).forEach(function(s){return e(n,s,r,i,o,a)}),r&&a.push(t))},Tm=function(e,n,t){var r=Array.isArray(n)?n:[n],i=function(s){return e.isDirected()?e.successors(s):e.neighbors(s)},o=[],a=[];return r.forEach(function(s){if(!e.hasNode(s))throw new Error("Graph does not have node: "+s);Uz(e,s,t==="post",a,i,o)}),o};function Xz(e,n){return function(t){if(Array.isArray(t))return t}(e)||function(t,r){var i=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(i!=null){var o,a,s=[],u=!0,c=!1;try{for(i=i.call(t);!(u=(o=i.next()).done)&&(s.push(o.value),!r||s.length!==r);u=!0);}catch(l){c=!0,a=l}finally{try{u||i.return==null||i.return()}finally{if(c)throw a}}return s}}(e,n)||function(t,r){if(t){if(typeof t=="string")return vC(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);if(i==="Object"&&t.constructor&&(i=t.constructor.name),i==="Map"||i==="Set")return Array.from(t);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return vC(t,r)}}(e,n)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function vC(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var Yz=function(){return 1},mC=function(e,n,t,r){return Wz(e,n,t||Yz,r||function(i){return e.outEdges(i)})},Wz=function(e,n,t,r){var i,o,a=new Map,s=new gC,u=function(l){var h=l.v!==i?l.v:l.w,f=a.get(h),d=t(l),p=o.distance+d;if(d<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+l+" Weight: "+d);p<f.distance&&(f.distance=p,f.predecessor=i,s.decrease(h,p))};for(e.nodes().forEach(function(l){var h=l===n?0:Number.POSITIVE_INFINITY;a.set(l,{distance:h}),s.add(l,h)});s.size()>0&&(i=s.removeMin(),!(o=a.get(i))||o.distance!==Number.POSITIVE_INFINITY);)r(i).forEach(u);var c={};return Array.from(a.entries()).forEach(function(l){var h=Xz(l,2),f=h[0],d=h[1];return c[String(f)]=d,c}),c},yC=function(e){var n=0,t=[],r=new Map,i=[];function o(a){var s,u={onStack:!0,lowlink:n,index:n};if(r.set(a,u),n+=1,t.push(a),(s=e.successors(a))===null||s===void 0||s.forEach(function(h){var f;if(r.has(h)){if(!((f=r.get(h))===null||f===void 0)&&f.onStack){var d=r.get(h);u.lowlink=Math.min(u.lowlink,d.index)}}else{o(h);var p=r.get(h);u.lowlink=Math.min(u.lowlink,p.lowlink)}}),u.lowlink===u.index){var c,l=[];do c=t.pop(),r.get(c).onStack=!1,l.push(c);while(a!==c);i.push(l)}}return e.nodes().forEach(function(a){r.has(a)||o(a)}),i};function Om(e){return Om=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Om(e)}function Vz(e){var n=bC();return function(){var t,r=ll(e);if(n){var i=ll(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return function(o,a){if(a&&(Om(a)==="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}(o)}(this,t)}}function Nm(e){var n=typeof Map=="function"?new Map:void 0;return Nm=function(t){if(t===null||!function(i){return Function.toString.call(i).indexOf("[native code]")!==-1}(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(n!==void 0){if(n.has(t))return n.get(t);n.set(t,r)}function r(){return Dm(t,arguments,ll(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),cl(r,t)},Nm(e)}function Dm(e,n,t){return Dm=bC()?Reflect.construct:function(r,i,o){var a=[null];a.push.apply(a,i);var s=new(Function.bind.apply(r,a));return o&&cl(s,o.prototype),s},Dm.apply(null,arguments)}function bC(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cl(e,n){return cl=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t},cl(e,n)}function ll(e){return ll=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},ll(e)}var Pm=function(){(function(r,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(i&&i.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),i&&cl(r,i)})(t,Nm(Error));var e,n=Vz(t);function t(){return function(r,i){if(!(r instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),n.apply(this,arguments)}return e=t,Object.defineProperty(e,"prototype",{writable:!1}),e}();function xC(e){var n=new Set,t=new Set,r=[];if(e.sinks().forEach(function i(o){if(t.has(o))throw new Pm;var a;n.has(o)||(t.add(o),n.add(o),(a=e.predecessors(o))===null||a===void 0||a.forEach(i),t.delete(o),r.push(o))}),n.size!==e.nodeCount())throw new Pm;return r}var Hz=function(){return 1};const qz=Object.freeze(Object.defineProperty({__proto__:null,components:function(e){var n=new Set,t=[];return e.nodes().forEach(function(r){for(var i=[],o=[r];o.length>0;){var a,s,u=o.pop();n.has(u)||(n.add(u),i.push(u),(a=e.successors(u))===null||a===void 0||a.forEach(function(c){return o.push(c)}),(s=e.predecessors(u))===null||s===void 0||s.forEach(function(c){return o.push(c)}))}i.length&&t.push(i)}),t},dfs:Tm,dijkstra:mC,dijkstraAll:function(e,n,t){var r={};return e.nodes().forEach(function(i){return r[String(i)]=mC(e,i,n,t),r}),r},findCycles:function(e){return yC(e).filter(function(n){return n.length>1||n.length===1&&e.hasEdge(n[0],n[0])})},floydWarshall:function(e,n,t){return function(r,i,o){var a={},s=r.nodes();return s.forEach(function(u){var c=String(u);a[c]={},a[c][c]={distance:0},s.forEach(function(l){u!==l&&(a[c][String(l)]={distance:Number.POSITIVE_INFINITY})}),o(u).forEach(function(l){var h=l.v===u?l.w:l.v,f=i(l);a[c][String(h)]={distance:f,predecessor:u}})}),s.forEach(function(u){var c=String(u),l=a[c];s.forEach(function(h){var f=String(h),d=a[f];s.forEach(function(p){var g=String(p),v=d[c],m=l[g],y=d[g],b=v.distance+m.distance;b<y.distance&&(y.distance=b,y.predecessor=m.predecessor)})})}),a}(e,n||Hz,t||function(r){return e.outEdges(r)})},isAcyclic:function(e){try{xC(e)}catch(n){if(n instanceof Pm)return!1;throw n}return!0},postorder:function(e,n){return Tm(e,n,"post")},preorder:function(e,n){return Tm(e,n,"pre")},prim:function(e,n){var t,r=new ss,i=new Map,o=new gC;function a(c){var l=c.v===t?c.w:c.v,h=o.priority(l);if(h!==void 0){var f=n(c);f<h&&(i.set(l,t),o.decrease(l,f))}}if(e.nodeCount()===0)return r;e.nodes().forEach(function(c){o.add(c,Number.POSITIVE_INFINITY),r.setNode(c)}),o.decrease(e.nodes()[0],0);for(var s=!1;o.size()>0;){var u;if(t=o.removeMin(),i.has(t))r.setEdge(t,i.get(t));else{if(s)throw new Error("Input graph is not connected: "+e.graph());s=!0}(u=e.nodeEdges(t))===null||u===void 0||u.forEach(a)}return r},tarjan:yC,topsort:xC},Symbol.toStringTag,{value:"Module"}));var wC=function(e,n){for(var t=e.edges(),r=0;r<t.length;r++){var i=t[r];if(n.hasEdge(i.v,i.w,i.name))return!0}return!1},EC=function(e,n){return e.nodes().filter(function(t){return n.hasNode(t)})},MC=function(e,n){return e.edges().filter(function(t){return n.hasEdge(t.v,t.w,t.name)})},SC=function(e,n){return e.isCompound()===n.isCompound()&&e.isDirected()===n.isDirected()&&e.isMultigraph()===n.isMultigraph()},Sd=function(e,n){return EC(e,n).length===e.nodes().length},Lm=function(e,n){return MC(e,n).length===e.edges().length};function Zz(e,n){return function(t){if(Array.isArray(t))return t}(e)||function(t,r){var i=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(i!=null){var o,a,s=[],u=!0,c=!1;try{for(i=i.call(t);!(u=(o=i.next()).done)&&(s.push(o.value),!r||s.length!==r);u=!0);}catch(l){c=!0,a=l}finally{try{u||i.return==null||i.return()}finally{if(c)throw a}}return s}}(e,n)||function(t,r){if(t){if(typeof t=="string")return _C(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);if(i==="Object"&&t.constructor&&(i=t.constructor.name),i==="Map"||i==="Set")return Array.from(t);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _C(t,r)}}(e,n)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function _C(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function _d(e){if(e.isMultigraph())return!1;for(var n=e.edges(),t=new Map,r=0;r<n.length;r++){var i=n[r];if(i.v===i.w)return!1;var o=Zz([i.v,i.w].sort(),2),a=o[0],s=o[1],u="".concat(a,"-").concat(s);if(t.has(u))return!1;t.set(u,!0)}return!0}const Kz=Object.freeze(Object.defineProperty({__proto__:null,hasSelfLoop:function(e){for(var n=e.edges(),t=0;t<n.length;t++){var r=n[t];if(r.v===r.w)return!0}return!1},isGraph:function(e){return e instanceof ss},isNullGraph:function(e){return e.nodes().length===0},isSimpleGraph:_d},Symbol.toStringTag,{value:"Module"})),$z=Object.freeze(Object.defineProperty({__proto__:null,containAllSameEdges:Lm,containAllSameNodes:Sd,containSameEdges:wC,containSameNodes:function(e,n){for(var t=e.nodes(),r=0;r<t.length;r++){var i=t[r];if(n.hasNode(i))return!0}return!1},getSameEdges:MC,getSameNodes:EC,isGraphComplement:function(e,n){if(!_d(e)||!_d(n)||!Sd(e,n)||wC(e,n))return!1;var t=e.nodeCount();return e.edgeCount()+n.edgeCount()===t*(t-1)/2},isGraphContainsAnother:function(e,n){return Sd(e,n)&&Lm(e,n)},isGraphOptionSame:SC,isGraphSame:function(e,n){return SC(e,n)&&e.nodeCount()===n.nodeCount()&&Sd(e,n)&&e.edgeCount()===n.edgeCount()&&Lm(e,n)}},Symbol.toStringTag,{value:"Module"})),Qz=Object.freeze(Object.defineProperty({__proto__:null,getGraphComplement:function(e){if(!_d(e))return null;for(var n=e.nodeCount(),t=new ss({compound:e.isCompound(),directed:e.isDirected(),multigraph:e.isMultigraph()}),r=e.nodes(),i=0;i<n;i++){var o=r[i];t.setNode(o,e.node(o));for(var a=i+1;a<n;a++){var s=r[a];e.hasEdge(o,s)||t.setEdge(o,s)}}return t}},Symbol.toStringTag,{value:"Module"})),kd=ji(Object.freeze(Object.defineProperty({__proto__:null,Graph:ss,GraphWithEvent:Fz,algorithm:qz,comparision:$z,essence:Kz,generate:Qz},Symbol.toStringTag,{value:"Module"})));var kC=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Jz=xe&&xe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_m,"__esModule",{value:!0});var eF=Jz(km),tF=kd,nF=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return kC(n,e),n}(eF.default),rF=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return kC(n,e),n}(tF.Graph),iF=function(){return 1},oF=function(e,n,t){for(var r,i=[],o=n[n.length-1],a=n[0];e.nodeCount();){for(;r=a.dequeue();)Rm(e,n,t,r);for(;r=o.dequeue();)Rm(e,n,t,r);if(e.nodeCount()){for(var s=n.length-2;s>0;--s)if(r=n[s].dequeue()){i=i.concat(Rm(e,n,t,r,!0));break}}}return i},Rm=function(e,n,t,r,i){var o,a,s=[];return(o=e.inEdges(r.v))===null||o===void 0||o.forEach(function(u){var c=e.edge(u),l=e.node(u.v);i&&s.push({v:u.v,w:u.w,in:0,out:0}),l.out===void 0&&(l.out=0),l.out-=c,jm(n,t,l)}),(a=e.outEdges(r.v))===null||a===void 0||a.forEach(function(u){var c=e.edge(u),l=u.w,h=e.node(l);h.in===void 0&&(h.in=0),h.in-=c,jm(n,t,h)}),e.removeNode(r.v),i?s:void 0},aF=function(e,n){var t=new rF,r=0,i=0;e.nodes().forEach(function(c){t.setNode(c,{v:c,in:0,out:0})}),e.edges().forEach(function(c){var l=t.edge(c)||0,h=(n==null?void 0:n(c))||1,f=l+h;t.setEdge(c.v,c.w,f),i=Math.max(i,t.node(c.v).out+=h),r=Math.max(r,t.node(c.w).in+=h)});for(var o=[],a=i+r+3,s=0;s<a;s++)o.push(new nF);var u=r+1;return t.nodes().forEach(function(c){jm(o,u,t.node(c))}),{buckets:o,zeroIdx:u,graph:t}},jm=function(e,n,t){t.out?t.in?e[t.out-t.in+n].enqueue(t):e[e.length-1].enqueue(t):e[0].enqueue(t)};_m.default=function(e,n){var t;if(e.nodeCount()<=1)return[];var r=aF(e,n||iF);return(t=oF(r.graph,r.buckets,r.zeroIdx).map(function(i){return e.outEdges(i.v,i.w)}))===null||t===void 0?void 0:t.flat()};var sF=xe&&xe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Sm,"__esModule",{value:!0});var uF=sF(_m),cF=function(e){var n=[],t={},r={},i=function(o){var a;r[o]||(r[o]=!0,t[o]=!0,(a=e.outEdges(o))===null||a===void 0||a.forEach(function(s){t[s.w]?n.push(s):i(s.w)}),delete t[o])};return e.nodes().forEach(i),n};Sm.default={run:function(e){var n=e.graph().acyclicer==="greedy"?(0,uF.default)(e,function(t){return function(r){var i;return((i=t.edge(r))===null||i===void 0?void 0:i.weight)||1}}(e)):cF(e);n==null||n.forEach(function(t){var r=e.edge(t);e.removeEdgeObj(t),r.forwardName=t.name,r.reversed=!0,e.setEdge(t.w,t.v,r,"rev-".concat(Math.random()))})},undo:function(e){e.edges().forEach(function(n){var t=e.edge(n);if(t.reversed){e.removeEdgeObj(n);var r=t.forwardName;delete t.reversed,delete t.forwardName,e.setEdge(n.w,n.v,t,r)}})}};var Bm={},Yr={},So={},lF=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(So,"__esModule",{value:!0}),So.Graph=void 0;var hF=function(e){function n(){return e!==null&&e.apply(this,arguments)||this}return lF(n,e),n}(kd.Graph);So.Graph=hF,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.minBy=e.notime=e.time=e.partition=e.maxRank=e.addBorderNode=e.removeEmptyRanks=e.normalizeRanks=e.buildLayerMatrix=e.intersectRect=e.predecessorWeights=e.successorWeights=e.zipObject=e.asNonCompoundGraph=e.simplify=e.addDummyNode=void 0;var n=_n(),t=So;e.addDummyNode=function(r,i,o,a){var s;do s="".concat(a).concat(Math.random());while(r.hasNode(s));return o.dummy=i,r.setNode(s,o),s},e.simplify=function(r){var i=new t.Graph().setGraph(r.graph());return r.nodes().forEach(function(o){i.setNode(o,r.node(o))}),r.edges().forEach(function(o){var a=i.edgeFromArgs(o.v,o.w)||{weight:0,minlen:1},s=r.edge(o);i.setEdge(o.v,o.w,{weight:a.weight+s.weight,minlen:Math.max(a.minlen,s.minlen)})}),i},e.asNonCompoundGraph=function(r){var i=new t.Graph({multigraph:r.isMultigraph()}).setGraph(r.graph());return r.nodes().forEach(function(o){var a;!((a=r.children(o))===null||a===void 0)&&a.length||i.setNode(o,r.node(o))}),r.edges().forEach(function(o){i.setEdgeObj(o,r.edge(o))}),i},e.zipObject=function(r,i){return r==null?void 0:r.reduce(function(o,a,s){return o[a]=i[s],o},{})},e.successorWeights=function(r){var i={};return r.nodes().forEach(function(o){var a,s={};(a=r.outEdges(o))===null||a===void 0||a.forEach(function(u){var c;s[u.w]=(s[u.w]||0)+(((c=r.edge(u))===null||c===void 0?void 0:c.weight)||0)}),i[o]=s}),i},e.predecessorWeights=function(r){var i=r.nodes(),o=i.map(function(a){var s,u={};return(s=r.inEdges(a))===null||s===void 0||s.forEach(function(c){u[c.v]=(u[c.v]||0)+r.edge(c).weight}),u});return(0,e.zipObject)(i,o)},e.intersectRect=function(r,i){var o,a,s=Number(r.x),u=Number(r.y),c=Number(i.x)-s,l=Number(i.y)-u,h=Number(r.width)/2,f=Number(r.height)/2;return c||l?(Math.abs(l)*h>Math.abs(c)*f?(l<0&&(f=-f),o=f*c/l,a=f):(c<0&&(h=-h),o=h,a=h*l/c),{x:s+o,y:u+a}):{x:0,y:0}},e.buildLayerMatrix=function(r){for(var i=[],o=(0,e.maxRank)(r)+1,a=0;a<o;a++)i.push([]);for(r.nodes().forEach(function(s){var u=r.node(s);if(u){var c=u.rank;c!==void 0&&i[c]&&i[c].push(s)}}),a=0;a<o;a++)i[a]=i[a].sort(function(s,u){var c,l,h,f;return h=(c=r.node(s))===null||c===void 0?void 0:c.order,f=(l=r.node(u))===null||l===void 0?void 0:l.order,Number(h)-Number(f)});return i},e.normalizeRanks=function(r){var i=r.nodes().filter(function(a){var s;return((s=r.node(a))===null||s===void 0?void 0:s.rank)!==void 0}).map(function(a){return r.node(a).rank}),o=Math.min.apply(Math,i);r.nodes().forEach(function(a){var s=r.node(a);s.hasOwnProperty("rank")&&o!==1/0&&(s.rank-=o)})},e.removeEmptyRanks=function(r){var i=r.nodes(),o=i.filter(function(f){var d;return((d=r.node(f))===null||d===void 0?void 0:d.rank)!==void 0}).map(function(f){return r.node(f).rank}),a=Math.min.apply(Math,o),s=[];i.forEach(function(f){var d,p=(((d=r.node(f))===null||d===void 0?void 0:d.rank)||0)-a;s[p]||(s[p]=[]),s[p].push(f)});for(var u=0,c=r.graph().nodeRankFactor||0,l=0;l<s.length;l++){var h=s[l];h===void 0?l%c!=0&&(u-=1):u&&(h==null||h.forEach(function(f){var d=r.node(f);d&&(d.rank=d.rank||0,d.rank+=u)}))}},e.addBorderNode=function(r,i,o,a){var s={width:0,height:0};return(0,n.isNumber)(o)&&(0,n.isNumber)(a)&&(s.rank=o,s.order=a),(0,e.addDummyNode)(r,"border",s,i)},e.maxRank=function(r){var i;return r.nodes().forEach(function(o){var a,s=(a=r.node(o))===null||a===void 0?void 0:a.rank;s!==void 0&&(i===void 0||s>i)&&(i=s)}),i||(i=0),i},e.partition=function(r,i){var o={lhs:[],rhs:[]};return r==null||r.forEach(function(a){i(a)?o.lhs.push(a):o.rhs.push(a)}),o},e.time=function(r,i){Date.now();try{return i()}finally{}},e.notime=function(r,i){return i()},e.minBy=function(r,i){return r.reduce(function(o,a){return i(o)>i(a)?a:o})}}(Yr),Object.defineProperty(Bm,"__esModule",{value:!0});var fF=Yr,dF=function(e,n){var t=n.v,r=e.node(t).rank,i=n.w,o=e.node(i).rank,a=n.name,s=e.edge(n),u=s.labelRank;if(o!==r+1){e.removeEdgeObj(n);var c,l,h,f=e.graph();for(h=0,++r;r<o;++h,++r)s.points=[],c=(0,fF.addDummyNode)(e,"edge",l={edgeLabel:s,width:0,height:0,edgeObj:n,rank:r},"_d"),r===u&&(l.width=s.width,l.height=s.height,l.dummy="edge-label",l.labelpos=s.labelpos),e.setEdge(t,c,{weight:s.weight},a),h===0&&(f.dummyChains||(f.dummyChains=[]),f.dummyChains.push(c)),t=c;e.setEdge(t,i,{weight:s.weight},a)}};Bm.default={run:function(e){e.graph().dummyChains=[],e.edges().forEach(function(n){return dF(e,n)})},undo:function(e){var n;(n=e.graph().dummyChains)===null||n===void 0||n.forEach(function(t){var r,i=e.node(t),o=i.edgeLabel;i.edgeObj&&e.setEdgeObj(i.edgeObj,o);for(var a=t;i.dummy;)r=e.successors(a)[0],e.removeNode(a),o.points.push({x:i.x,y:i.y}),i.dummy==="edge-label"&&(o.x=i.x,o.y=i.y,o.width=i.width,o.height=i.height),a=r,i=e.node(a)})}};var zm={},_i={};Object.defineProperty(_i,"__esModule",{value:!0}),_i.slack=_i.longestPathWithLayer=_i.longestPath=void 0;var CC=function(e){var n,t={},r=function(i){var o,a,s=e.node(i);return s?t[i]?s.rank:(t[i]=!0,(o=e.outEdges(i))===null||o===void 0||o.forEach(function(u){var c=r(u.w)-e.edge(u).minlen;c&&(a===void 0||c<a)&&(a=c)}),a||(a=0),s.rank=a,a):0};(n=e.sources())===null||n===void 0||n.forEach(function(i){return r(i)})};_i.longestPath=CC;var AC=function(e){var n,t,r={},i=function(s){var u,c,l=e.node(s);return l?r[s]?l.rank:(r[s]=!0,(u=e.outEdges(s))===null||u===void 0||u.forEach(function(h){var f=i(h.w)-e.edge(h).minlen;f&&(c===void 0||f<c)&&(c=f)}),c||(c=0),(t===void 0||c<t)&&(t=c),l.rank=c,c):0};(n=e.sources())===null||n===void 0||n.forEach(function(s){e.node(s)&&i(s)}),t===void 0&&(t=0);var o={},a=function(s,u){var c,l=e.node(s),h=isNaN(l.layer)?u:l.layer;(l.rank===void 0||l.rank<h)&&(l.rank=h),o[s]||(o[s]=!0,(c=e.outEdges(s))===null||c===void 0||c.map(function(f){a(f.w,h+e.edge(f).minlen)}))};e.nodes().forEach(function(s){var u=e.node(s);u&&(isNaN(u.layer)?u.rank-=t:a(s,u.layer))})};_i.longestPathWithLayer=AC;var IC=function(e,n){return e.node(n.w).rank-e.node(n.v).rank-e.edge(n).minlen};_i.slack=IC,_i.default={longestPath:CC,longestPathWithLayer:AC,slack:IC};var ha={};Object.defineProperty(ha,"__esModule",{value:!0}),ha.feasibleTreeWithLayer=ha.feasibleTree=void 0;var us=_i,pF=Yr,TC=So,OC=function(e){var n,t,r=new TC.Graph({directed:!1}),i=e.nodes()[0],o=e.nodeCount();for(r.setNode(i,{});gF(r,e)<o;)n=DC(r,e),t=r.hasNode(n.v)?(0,us.slack)(e,n):-(0,us.slack)(e,n),PC(r,e,t);return r};ha.feasibleTree=OC;var gF=function(e,n){var t=function(r){n.nodeEdges(r).forEach(function(i){var o=i.v,a=r===o?i.w:o;e.hasNode(a)||(0,us.slack)(n,i)||(e.setNode(a,{}),e.setEdge(r,a,{}),t(a))})};return e.nodes().forEach(t),e.nodeCount()},NC=function(e){var n,t,r=new TC.Graph({directed:!1}),i=e.nodes()[0],o=e.nodes().filter(function(a){return!!e.node(a)}).length;for(r.setNode(i,{});vF(r,e)<o;)n=DC(r,e),t=r.hasNode(n.v)?(0,us.slack)(e,n):-(0,us.slack)(e,n),PC(r,e,t);return r};ha.feasibleTreeWithLayer=NC;var vF=function(e,n){var t=function(r){var i;(i=n.nodeEdges(r))===null||i===void 0||i.forEach(function(o){var a=o.v,s=r===a?o.w:a;e.hasNode(s)||n.node(s).layer===void 0&&(0,us.slack)(n,o)||(e.setNode(s,{}),e.setEdge(r,s,{}),t(s))})};return e.nodes().forEach(t),e.nodeCount()},DC=function(e,n){return(0,pF.minBy)(n.edges(),function(t){return e.hasNode(t.v)!==e.hasNode(t.w)?(0,us.slack)(n,t):1/0})},PC=function(e,n,t){e.nodes().forEach(function(r){n.node(r).rank||(n.node(r).rank=0),n.node(r).rank+=t})};ha.default={feasibleTree:OC,feasibleTreeWithLayer:NC};var LC={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.exchangeEdges=e.enterEdge=e.leaveEdge=e.initLowLimValues=e.calcCutValue=e.initCutValues=void 0;var n=ha,t=_i,r=Yr,i=kd,o=i.algorithm.preorder,a=i.algorithm.postorder;e.initCutValues=function(f,d){var p=a(f,f.nodes());(p=p==null?void 0:p.slice(0,(p==null?void 0:p.length)-1))==null||p.forEach(function(g){s(f,d,g)})};var s=function(f,d,p){var g=f.node(p).parent;f.edgeFromArgs(p,g).cutvalue=(0,e.calcCutValue)(f,d,p)};e.calcCutValue=function(f,d,p){var g,v=f.node(p).parent,m=!0,y=d.edgeFromArgs(p,v),b=0;return y||(m=!1,y=d.edgeFromArgs(v,p)),b=y.weight,(g=d.nodeEdges(p))===null||g===void 0||g.forEach(function(x){var w=x.v===p,E=w?x.w:x.v;if(E!==v){var M=w===m,_=d.edge(x).weight;if(b+=M?_:-_,l(f,p,E)){var k=f.edgeFromArgs(p,E).cutvalue;b+=M?-k:k}}}),b},e.initLowLimValues=function(f,d){d===void 0&&(d=f.nodes()[0]),u(f,{},1,d)};var u=function(f,d,p,g,v){var m,y=p,b=p,x=f.node(g);return d[g]=!0,(m=f.neighbors(g))===null||m===void 0||m.forEach(function(w){d[w]||(b=u(f,d,b,w,g))}),x.low=y,x.lim=b++,v?x.parent=v:delete x.parent,b};e.leaveEdge=function(f){return f.edges().find(function(d){return f.edge(d).cutvalue<0})},e.enterEdge=function(f,d,p){var g=p.v,v=p.w;d.hasEdge(g,v)||(g=p.w,v=p.v);var m=f.node(g),y=f.node(v),b=m,x=!1;m.lim>y.lim&&(b=y,x=!0);var w=d.edges().filter(function(E){return x===h(f,f.node(E.v),b)&&x!==h(f,f.node(E.w),b)});return(0,r.minBy)(w,function(E){return(0,t.slack)(d,E)})},e.exchangeEdges=function(f,d,p,g){var v=p.v,m=p.w;f.removeEdge(v,m),f.setEdge(g.v,g.w,{}),(0,e.initLowLimValues)(f),(0,e.initCutValues)(f,d),c(f,d)};var c=function(f,d){var p=f.nodes().find(function(v){var m;return!(!((m=d.node(v))===null||m===void 0)&&m.parent)}),g=o(f,p);(g=g==null?void 0:g.slice(1))==null||g.forEach(function(v){var m=f.node(v).parent,y=d.edgeFromArgs(v,m),b=!1;y||(y=d.edgeFromArgs(m,v),b=!0),d.node(v).rank=d.node(m).rank+(b?y.minlen:-y.minlen)})},l=function(f,d,p){return f.hasEdge(d,p)},h=function(f,d,p){return p.low<=d.lim&&d.lim<=p.lim};e.default=function(f){var d=(0,r.simplify)(f);(0,t.longestPath)(d);var p,g,v=(0,n.feasibleTree)(d);for((0,e.initLowLimValues)(v),(0,e.initCutValues)(v,d);p=(0,e.leaveEdge)(v);)g=(0,e.enterEdge)(v,d,p),(0,e.exchangeEdges)(v,d,p,g)}})(LC);var mF=xe&&xe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(zm,"__esModule",{value:!0});var RC=_i,yF=ha,bF=mF(LC),xF=RC.longestPath,wF=function(e){(0,RC.longestPathWithLayer)(e),(0,yF.feasibleTreeWithLayer)(e)},EF=function(e){(0,bF.default)(e)};zm.default=function(e){switch(e.graph().ranker){case"network-simplex":EF(e);break;case"tight-tree":default:wF(e);break;case"longest-path":xF(e)}};var Fm={};Object.defineProperty(Fm,"__esModule",{value:!0}),Fm.default=function(e){var n,t=function(r){var i,o={},a=0,s=function(u){var c,l=a;(c=r.children(u))===null||c===void 0||c.forEach(s),o[u]={low:l,lim:a++}};return(i=r.children())===null||i===void 0||i.forEach(s),o}(e);(n=e.graph().dummyChains)===null||n===void 0||n.forEach(function(r){var i,o,a=r,s=e.node(a),u=s.edgeObj;if(u)for(var c=function(g,v,m,y){var b,x,w=[],E=[],M=Math.min(v[m].low,v[y].low),_=Math.max(v[m].lim,v[y].lim);b=m;do b=g.parent(b),w.push(b);while(b&&(v[b].low>M||_>v[b].lim));for(x=b,b=y;b&&b!==x;)E.push(b),b=g.parent(b);return{lca:x,path:w.concat(E.reverse())}}(e,t,u.v,u.w),l=c.path,h=c.lca,f=0,d=l[f],p=!0;a!==u.w;){if(s=e.node(a),p){for(;d!==h&&((i=e.node(d))===null||i===void 0?void 0:i.maxRank)<s.rank;)d=l[++f];d===h&&(p=!1)}if(!p){for(;f<l.length-1&&((o=e.node(l[f+1]))===null||o===void 0?void 0:o.minRank)<=s.rank;)f++;d=l[f]}e.setParent(a,d),a=e.successors(a)[0]}})};var Gm={};Object.defineProperty(Gm,"__esModule",{value:!0});var Um=Yr,jC=function(e,n,t,r,i,o,a){var s=e.children(a);if(s!=null&&s.length){var u=(0,Um.addBorderNode)(e,"_bt"),c=(0,Um.addBorderNode)(e,"_bb"),l=e.node(a);e.setParent(u,a),l.borderTop=u,e.setParent(c,a),l.borderBottom=c,s==null||s.forEach(function(h){jC(e,n,t,r,i,o,h);var f=e.node(h),d=f.borderTop?f.borderTop:h,p=f.borderBottom?f.borderBottom:h,g=f.borderTop?r:2*r,v=d!==p?1:i-o[a]+1;e.setEdge(u,d,{minlen:v,weight:g,nestingEdge:!0}),e.setEdge(p,c,{minlen:v,weight:g,nestingEdge:!0})}),e.parent(a)||e.setEdge(n,u,{weight:0,minlen:i+o[a]})}else a!==n&&e.setEdge(n,a,{weight:0,minlen:t})},MF=function(e){var n,t={},r=function(i,o){var a=e.children(i);a==null||a.forEach(function(s){return r(s,o+1)}),t[i]=o};return(n=e.children())===null||n===void 0||n.forEach(function(i){return r(i,1)}),t},SF=function(e){var n=0;return e.edges().forEach(function(t){n+=e.edge(t).weight}),n};Gm.default={run:function(e){var n,t=(0,Um.addDummyNode)(e,"root",{},"_root"),r=MF(e),i=Math.max.apply(Math,Object.values(r));Math.abs(i)===1/0&&(i=1);var o=i-1,a=2*o+1;e.graph().nestingRoot=t,e.edges().forEach(function(u){e.edge(u).minlen*=a});var s=SF(e)+1;(n=e.children())===null||n===void 0||n.forEach(function(u){jC(e,t,a,s,o,r,u)}),e.graph().nodeRankFactor=a},cleanup:function(e){var n=e.graph();n.nestingRoot&&e.removeNode(n.nestingRoot),delete n.nestingRoot,e.edges().forEach(function(t){e.edge(t).nestingEdge&&e.removeEdgeObj(t)})}};var Xm={};Object.defineProperty(Xm,"__esModule",{value:!0});var _F=Yr,BC=function(e,n,t,r,i,o){var a={rank:o,borderType:n,width:0,height:0},s=i[n][o-1],u=(0,_F.addDummyNode)(e,"border",a,t);i[n][o]=u,e.setParent(u,r),s&&e.setEdge(s,u,{weight:1})};Xm.default=function(e){var n,t=function(r){var i=e.children(r),o=e.node(r);if(i!=null&&i.length&&i.forEach(function(u){return t(u)}),o.hasOwnProperty("minRank")){o.borderLeft=[],o.borderRight=[];for(var a=o.minRank,s=o.maxRank+1;a<s;a+=1)BC(e,"borderLeft","_bl",r,o,a),BC(e,"borderRight","_br",r,o,a)}};(n=e.children())===null||n===void 0||n.forEach(function(r){return t(r)})};var Ym={};Object.defineProperty(Ym,"__esModule",{value:!0});var zC=function(e){e.nodes().forEach(function(n){FC(e.node(n))}),e.edges().forEach(function(n){FC(e.edge(n))})},FC=function(e){var n=e.width;e.width=e.height,e.height=n},kF=function(e){e.nodes().forEach(function(n){Wm(e.node(n))}),e.edges().forEach(function(n){var t,r=e.edge(n);(t=r.points)===null||t===void 0||t.forEach(function(i){return Wm(i)}),r.hasOwnProperty("y")&&Wm(r)})},Wm=function(e){e!=null&&e.y&&(e.y=-e.y)},CF=function(e){e.nodes().forEach(function(n){Vm(e.node(n))}),e.edges().forEach(function(n){var t,r=e.edge(n);(t=r.points)===null||t===void 0||t.forEach(function(i){return Vm(i)}),r.hasOwnProperty("x")&&Vm(r)})},Vm=function(e){var n=e.x;e.x=e.y,e.y=n};Ym.default={adjust:function(e){var n,t=(n=e.graph().rankdir)===null||n===void 0?void 0:n.toLowerCase();t!=="lr"&&t!=="rl"||zC(e)},undo:function(e){var n,t=(n=e.graph().rankdir)===null||n===void 0?void 0:n.toLowerCase();t!=="bt"&&t!=="rl"||kF(e),t!=="lr"&&t!=="rl"||(CF(e),zC(e))}};var Hm={},qm={};function GC(e){return[parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),parseInt(e.substr(5,2),16)]}function Zm(e){var n=Math.round(e).toString(16);return n.length===1?"0".concat(n):n}function UC(e){return"#".concat(Zm(e[0])).concat(Zm(e[1])).concat(Zm(e[2]))}var Tr=function(e){return e!==null&&typeof e!="function"&&isFinite(e.length)},Cd=function(e,n){return!!Tr(e)&&e.indexOf(n)>-1},XC=function(e,n){if(!Tr(e))return e;for(var t=[],r=0;r<e.length;r++){var i=e[r];n(i,r)&&t.push(i)}return t};function ni(e){return typeof e=="function"}function fa(e){return e==null}function Un(e){return Array.isArray(e)}const Ad=function(e){var n=typeof e;return e!==null&&n==="object"||n==="function"};function gu(e,n){if(e){if(Un(e))for(var t=0,r=e.length;t<r&&n(e[t],t)!==!1;t++);else if(Ad(e)){for(var i in e)if(e.hasOwnProperty(i)&&n(e[i],i)===!1)break}}}var YC=Object.keys?function(e){return Object.keys(e)}:function(e){var n=[];return gu(e,function(t,r){ni(e)&&r==="prototype"||n.push(r)}),n};function WC(e,n){var t=YC(n),r=t.length;if(fa(e))return!r;for(var i=0;i<r;i+=1){var o=t[i];if(n[o]!==e[o]||!(o in e))return!1}return!0}var Id=function(e){return typeof e=="object"&&e!==null},AF={}.toString,vu=function(e,n){return AF.call(e)==="[object "+n+"]"},mu=function(e){if(!Id(e)||!vu(e,"Object"))return!1;if(Object.getPrototypeOf(e)===null)return!0;for(var n=e;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n},VC=function(e,n){if(n===void 0&&(n=[]),Un(e))for(var t=0;t<e.length;t+=1)VC(e[t],n);else n.push(e);return n};function HC(e){if(!Array.isArray(e))return-1/0;var n=e.length;if(!n)return-1/0;for(var t=e[0],r=1;r<n;r++)t=Math.max(t,e[r]);return t}const qC=function(e){if(Un(e))return e.reduce(function(n,t){return Math.min(n,t)},e[0])};var ZC=Array.prototype,IF=ZC.splice,TF=ZC.indexOf,OF=Array.prototype.splice,KC=function(e,n){if(!Tr(e))return[];for(var t=e?n.length:0,r=t-1;t--;){var i=void 0,o=n[t];t!==r&&o===i||(i=o,OF.call(e,o,1))}return e},$C=function(e,n,t){if(!Un(e)&&!mu(e))return e;var r=t;return gu(e,function(i,o){r=n(r,i,o)}),r};function da(e){return typeof e=="string"}function QC(e,n){n===void 0&&(n=new Map);var t=[];if(Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var o=e[r];n.has(o)||(t.push(o),n.set(o,!0))}return t}var NF=Object.prototype.hasOwnProperty;function JC(e,n){if(!n||!Un(e))return{};for(var t,r={},i=ni(n)?n:function(s){return s[n]},o=0;o<e.length;o++){var a=e[o];t=i(a),NF.call(r,t)?r[t].push(a):r[t]=[a]}return r}function eA(e,n){if(!n)return{0:e};if(!ni(n)){var t=Un(n)?n:n.replace(/\s+/g,"").split("*");n=function(r){for(var i="_",o=0,a=t.length;o<a;o++)i+=r[t[o]]&&r[t[o]].toString();return i}}return JC(e,n)}var tA={};function _o(e){return typeof e=="number"}var DF=180/Math.PI;const PF=parseInt;var LF=Math.PI/180;const nA=function(e,n){return e.hasOwnProperty(n)};var rA=Object.values?function(e){return Object.values(e)}:function(e){var n=[];return gu(e,function(t,r){ni(e)&&r==="prototype"||n.push(t)}),n};const hl=function(e){return fa(e)?"":e.toString()};var RF={}.toString,iA=function(e){return RF.call(e).replace(/^\[object /,"").replace(/]$/,"")},jF=Object.prototype,oA=function(e){var n=e&&e.constructor;return e===(typeof n=="function"&&n.prototype||jF)};function Km(e,n){for(var t in n)n.hasOwnProperty(t)&&t!=="constructor"&&n[t]!==void 0&&(e[t]=n[t])}function yu(e,n,t,r){return n&&Km(e,n),t&&Km(e,t),r&&Km(e,r),e}var $m=function(e){if(typeof e!="object"||e===null)return e;var n;if(Un(e)){n=[];for(var t=0,r=e.length;t<r;t++)typeof e[t]=="object"&&e[t]!=null?n[t]=$m(e[t]):n[t]=e[t]}else for(var i in n={},e)typeof e[i]=="object"&&e[i]!=null?n[i]=$m(e[i]):n[i]=e[i];return n},Qm=new Map;function aA(e,n,t){return t===void 0&&(t=128),function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=n?n.apply(this,r):r[0];Qm.has(e)||Qm.set(e,function(u){var c,l,h,f=u||1;function d(g,v){++c>f&&(h=l,p(1),++c),l[g]=v}function p(g){c=0,l=Object.create(null),g||(h=Object.create(null))}return p(),{clear:p,has:function(g){return l[g]!==void 0||h[g]!==void 0},get:function(g){var v=l[g];return v!==void 0?v:(v=h[g])!==void 0?(d(g,v),v):void 0},set:function(g,v){l[g]!==void 0?l[g]=v:d(g,v)}}}(t));var a=Qm.get(e);if(a.has(o))return a.get(o);var s=e.apply(this,r);return a.set(o,s),s}}function BF(e,n){if(Object.hasOwn)return Object.hasOwn(e,n);if(e==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(e),n)}function sA(e,n,t,r){for(var i in t=t||0,r=r||5,n)if(BF(n,i)){var o=n[i];o!==null&&mu(o)?(mu(e[i])||(e[i]={}),t<r?sA(e[i],o,t+1,r):e[i]=n[i]):Un(o)?(e[i]=[],e[i]=e[i].concat(o)):o!==void 0&&(e[i]=o)}}var zF=Object.prototype.hasOwnProperty,Td=function(e,n){if(e===n)return!0;if(!e||!n||da(e)||da(n))return!1;if(Tr(e)||Tr(n)){if(e.length!==n.length)return!1;for(var t=!0,r=0;r<e.length&&(t=Td(e[r],n[r]));r++);return t}if(Id(e)||Id(n)){var i=Object.keys(e),o=Object.keys(n);if(i.length!==o.length)return!1;for(t=!0,r=0;r<i.length&&(t=Td(e[i[r]],n[i[r]]));r++);return t}return!1},FF=function(e){return e},GF=Object.prototype.hasOwnProperty,Od={},UF=function(){function e(){this.map={}}return e.prototype.has=function(n){return this.map[n]!==void 0},e.prototype.get=function(n,t){var r=this.map[n];return r===void 0?t:r},e.prototype.set=function(n,t){this.map[n]=t},e.prototype.clear=function(){this.map={}},e.prototype.delete=function(n){delete this.map[n]},e.prototype.size=function(){return Object.keys(this.map).length},e}(),XF=/rgba?\(([\s.,0-9]+)\)/,uA=aA(function(e){if(e[0]==="#"&&e.length===7)return e;var n=function(){var i=document.getElementById("antv-web-colour-picker");return i||((i=document.createElement("i")).id="antv-web-colour-picker",i.title="Web Colour Picker",i.style.display="none",document.body.appendChild(i),i)}();n.style.color=e;var t=document.defaultView.getComputedStyle(n,"").getPropertyValue("color"),r=XF.exec(t)[1].split(/\s*,\s*/).map(function(i){return Number(i)});return t=UC(r)},function(e){return e},256);function Jm(e,n,t,r){return e[r]+(n[r]-e[r])*t}var YF=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,WF=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,VF=/[\d.]+:(#[^\s]+|[^)]+\))/gi;function HF(e,n,t){var r=[0,0,0,0,0,0,0,0,0];return i0(r,t),Xi(e,r,n)}function qF(e,n,t){var r=[0,0,0,0,0,0,0,0,0];return o0(r,t),Xi(e,r,n)}function ZF(e,n,t){var r=[0,0,0,0,0,0,0,0,0];return a0(r,t),Xi(e,r,n)}function KF(e,n,t){return Xi(e,t,n)}function cA(e,n){return e[0]*n[1]-n[0]*e[1]}var lA={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function $F(e,n,t){if(e[t].length>7){e[t].shift();for(var r=e[t],i=t;r.length;)n[t]="A",e.splice(i+=1,0,["C"].concat(r.splice(0,6)));e.splice(t,1)}}var fl={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function hA(e){return Array.isArray(e)&&e.every(function(n){var t=n[0].toLowerCase();return fl[t]===n.length-1&&"achlmqstvz".includes(t)})}function fA(e){return hA(e)&&e.every(function(n){var t=n[0];return t===t.toUpperCase()})}function dA(e){return fA(e)&&e.every(function(n){var t=n[0];return"ACLMQZ".includes(t)})}function pA(e){for(var n=e.pathValue[e.segmentStart],t=n.toLowerCase(),r=e.data;r.length>=fl[t]&&(t==="m"&&r.length>2?(e.segments.push([n].concat(r.splice(0,2))),t="l",n=n==="m"?"l":"L"):e.segments.push([n].concat(r.splice(0,fl[t]))),fl[t]););}function QF(e){var n=e.index,t=e.pathValue,r=t.charCodeAt(n);return r===48?(e.param=0,void(e.index+=1)):r===49?(e.param=1,void(e.index+=1)):void(e.err='[path-util]: invalid Arc flag "'.concat(t[n],'", expecting 0 or 1 at index ').concat(n))}function JF(e){return e>=48&&e<=57||e===43||e===45||e===46}function bu(e){return e>=48&&e<=57}function e8(e){var n,t=e.max,r=e.pathValue,i=e.index,o=i,a=!1,s=!1,u=!1,c=!1;if(o>=t)e.err="[path-util]: Invalid path value at index ".concat(o,', "pathValue" is missing param');else if((n=r.charCodeAt(o))!==43&&n!==45||(o+=1,n=r.charCodeAt(o)),bu(n)||n===46){if(n!==46){if(a=n===48,o+=1,n=r.charCodeAt(o),a&&o<t&&n&&bu(n))return void(e.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(r[i],'" illegal number'));for(;o<t&&bu(r.charCodeAt(o));)o+=1,s=!0;n=r.charCodeAt(o)}if(n===46){for(c=!0,o+=1;bu(r.charCodeAt(o));)o+=1,u=!0;n=r.charCodeAt(o)}if(n===101||n===69){if(c&&!s&&!u)return void(e.err="[path-util]: Invalid path value at index ".concat(o,', "').concat(r[o],'" invalid float exponent'));if(o+=1,(n=r.charCodeAt(o))!==43&&n!==45||(o+=1),!(o<t&&bu(r.charCodeAt(o))))return void(e.err="[path-util]: Invalid path value at index ".concat(o,', "').concat(r[o],'" invalid integer exponent'));for(;o<t&&bu(r.charCodeAt(o));)o+=1}e.index=o,e.param=+e.pathValue.slice(i,o)}else e.err="[path-util]: Invalid path value at index ".concat(o,', "').concat(r[o],'" is not a number')}function Nd(e){for(var n,t=e.pathValue,r=e.max;e.index<r&&((n=t.charCodeAt(e.index))===10||n===13||n===8232||n===8233||n===32||n===9||n===11||n===12||n===160||n>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(n));)e.index+=1}function t8(e){var n=e.max,t=e.pathValue,r=e.index,i=t.charCodeAt(r),o=fl[t[r].toLowerCase()];if(e.segmentStart=r,function(s){switch(32|s){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}(i))if(e.index+=1,Nd(e),e.data=[],o){for(;;){for(var a=o;a>0;a-=1){if((32|i)!=97||a!==3&&a!==4?e8(e):QF(e),e.err.length)return;e.data.push(e.param),Nd(e),e.index<n&&t.charCodeAt(e.index)===44&&(e.index+=1,Nd(e))}if(e.index>=e.max||!JF(t.charCodeAt(e.index)))break}pA(e)}else pA(e);else e.err='[path-util]: Invalid path value "'.concat(t[r],'" is not a path command')}var n8=function(e){this.pathValue=e,this.segments=[],this.max=e.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""};function Dd(e){if(hA(e))return[].concat(e);var n=new n8(e);for(Nd(n);n.index<n.max&&!n.err.length;)t8(n);return n.err?n.err:n.segments}function gA(e){if(fA(e))return[].concat(e);var n=Dd(e),t=0,r=0,i=0,o=0;return n.map(function(a){var s,u=a.slice(1).map(Number),c=a[0],l=c.toUpperCase();if(c==="M")return t=u[0],r=u[1],i=t,o=r,["M",t,r];if(c!==l)switch(l){case"A":s=[l,u[0],u[1],u[2],u[3],u[4],u[5]+t,u[6]+r];break;case"V":s=[l,u[0]+r];break;case"H":s=[l,u[0]+t];break;default:var h=u.map(function(d,p){return d+(p%2?r:t)});s=[l].concat(h)}else s=[l].concat(u);var f=s.length;switch(l){case"Z":t=i,r=o;break;case"H":t=s[1];break;case"V":r=s[1];break;default:t=s[f-2],r=s[f-1],l==="M"&&(i=t,o=r)}return s})}function r8(e,n){var t=e[0],r=n.x1,i=n.y1,o=n.x2,a=n.y2,s=e.slice(1).map(Number),u=e;if("TQ".includes(t)||(n.qx=null,n.qy=null),t==="H")u=["L",e[1],i];else if(t==="V")u=["L",r,e[1]];else if(t==="S"){var c=2*r-o,l=2*i-a;n.x1=c,n.y1=l,u=["C",c,l].concat(s)}else if(t==="T"){var h=2*r-n.qx,f=2*i-n.qy;n.qx=h,n.qy=f,u=["Q",h,f].concat(s)}else if(t==="Q"){var d=s[0],p=s[1];n.qx=d,n.qy=p}return u}function Pd(e){if(dA(e))return[].concat(e);for(var n=gA(e),t=F({},lA),r=0;r<n.length;r+=1){n[r]=r8(n[r],t);var i=n[r],o=i.length;t.x1=+i[o-2],t.y1=+i[o-1],t.x2=+i[o-4]||t.x1,t.y2=+i[o-3]||t.y1}return n}function Ld(e,n,t){return{x:e*Math.cos(t)-n*Math.sin(t),y:e*Math.sin(t)+n*Math.cos(t)}}function ey(e,n,t,r,i,o,a,s,u,c){var l,h,f,d,p,g=e,v=n,m=t,y=r,b=s,x=u,w=120*Math.PI/180,E=Math.PI/180*(+i||0),M=[];if(c)h=c[0],f=c[1],d=c[2],p=c[3];else{g=(l=Ld(g,v,-E)).x,v=l.y;var _=(g-(b=(l=Ld(b,x,-E)).x))/2,k=(v-(x=l.y))/2,S=_*_/(m*m)+k*k/(y*y);S>1&&(m*=S=Math.sqrt(S),y*=S);var C=m*m,T=y*y,A=(o===a?-1:1)*Math.sqrt(Math.abs((C*T-C*k*k-T*_*_)/(C*k*k+T*_*_)));d=A*m*k/y+(g+b)/2,p=A*-y*_/m+(v+x)/2,h=Math.asin(((v-p)/y*Math.pow(10,9)|0)/Math.pow(10,9)),f=Math.asin(((x-p)/y*Math.pow(10,9)|0)/Math.pow(10,9)),h=g<d?Math.PI-h:h,f=b<d?Math.PI-f:f,h<0&&(h=2*Math.PI+h),f<0&&(f=2*Math.PI+f),a&&h>f&&(h-=2*Math.PI),!a&&f>h&&(f-=2*Math.PI)}var D=f-h;if(Math.abs(D)>w){var j=f,L=b,B=x;f=h+w*(a&&f>h?1:-1),M=ey(b=d+m*Math.cos(f),x=p+y*Math.sin(f),m,y,i,0,a,L,B,[f,j,d,p])}D=f-h;var N=Math.cos(h),R=Math.sin(h),P=Math.cos(f),H=Math.sin(f),ne=Math.tan(D/4),Z=4/3*m*ne,q=4/3*y*ne,te=[g,v],we=[g+Z*R,v-q*N],pe=[b+Z*H,x-q*P],Me=[b,x];if(we[0]=2*te[0]-we[0],we[1]=2*te[1]-we[1],c)return we.concat(pe,Me,M);for(var Be=[],dt=0,It=(M=we.concat(pe,Me,M)).length;dt<It;dt+=1)Be[dt]=dt%2?Ld(M[dt-1],M[dt],E).y:Ld(M[dt],M[dt+1],E).x;return Be}function pa(e,n,t){var r=e[0],i=e[1];return[r+(n[0]-r)*t,i+(n[1]-i)*t]}var vA=function(e,n,t,r){return Br(Br([],pa([e,n],[t,r],.5),!0),[t,r,t,r],!1)};function i8(e,n){var t,r,i,o,a,s,u,c,l,h=e[0],f=e.slice(1).map(Number),d=f[0],p=f[1],g=n.x1,v=n.y1,m=n.x,y=n.y;switch("TQ".includes(h)||(n.qx=null,n.qy=null),h){case"M":return n.x=d,n.y=p,e;case"A":return t=[g,v].concat(f),["C"].concat(ey(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]));case"Q":return n.qx=d,n.qy=p,t=[g,v].concat(f),["C"].concat((r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],[(c=1/3)*r+(l=2/3)*o,c*i+l*a,c*s+l*o,c*u+l*a,s,u]));case"L":return["C"].concat(vA(g,v,d,p));case"Z":return g===m&&v===y?["C",g,v,m,y,m,y]:["C"].concat(vA(g,v,m,y))}return e}function mA(e,n){if(n===void 0&&(n=!1),function(d){return dA(d)&&d.every(function(p){var g=p[0];return"MC".includes(g)})}(e)){var t=[].concat(e);return n?[t,[]]:t}for(var r,i,o=Pd(e),a=F({},lA),s=[],u="",c=o.length,l=[],h=0;h<c;h+=1){o[h]&&(u=o[h][0]),s[h]=u;var f=i8(o[h],a);o[h]=f,$F(o,s,h),c=o.length,u==="Z"&&l.push(h),i=(r=o[h]).length,a.x1=+r[i-2],a.y1=+r[i-1],a.x2=+r[i-4]||a.x1,a.y2=+r[i-3]||a.y1}return n?[o,l]:o}function xu(e,n){return Math.sqrt((e[0]-n[0])*(e[0]-n[0])+(e[1]-n[1])*(e[1]-n[1]))}function ty(e,n,t,r,i){var o=xu([e,n],[t,r]),a={x:0,y:0};if(typeof i=="number")if(i<=0)a={x:e,y:n};else if(i>=o)a={x:t,y:r};else{var s=pa([e,n],[t,r],i/o);a={x:s[0],y:s[1]}}return{length:o,point:a,min:{x:Math.min(e,t),y:Math.min(n,r)},max:{x:Math.max(e,t),y:Math.max(n,r)}}}function yA(e,n){var t=e.x,r=e.y,i=n.x,o=n.y,a=t*i+r*o,s=Math.sqrt((Math.pow(t,2)+Math.pow(r,2))*(Math.pow(i,2)+Math.pow(o,2)));return(t*o-r*i<0?-1:1)*Math.acos(a/s)}function o8(e,n,t,r,i,o,a,s,u,c){var l=Math.abs,h=Math.sin,f=Math.cos,d=Math.sqrt,p=Math.PI,g=l(t),v=l(r),m=(i%360+360)%360*(p/180);if(e===s&&n===u)return{x:e,y:n};if(g===0||v===0)return ty(e,n,s,u,c).point;var y=(e-s)/2,b=(n-u)/2,x={x:f(m)*y+h(m)*b,y:-h(m)*y+f(m)*b},w=Math.pow(x.x,2)/Math.pow(g,2)+Math.pow(x.y,2)/Math.pow(v,2);w>1&&(g*=d(w),v*=d(w));var E=(Math.pow(g,2)*Math.pow(v,2)-Math.pow(g,2)*Math.pow(x.y,2)-Math.pow(v,2)*Math.pow(x.x,2))/(Math.pow(g,2)*Math.pow(x.y,2)+Math.pow(v,2)*Math.pow(x.x,2)),M=(o!==a?1:-1)*d(E=E<0?0:E),_=M*(g*x.y/v),k=M*(-v*x.x/g),S=f(m)*_-h(m)*k+(e+s)/2,C=h(m)*_+f(m)*k+(n+u)/2,T={x:(x.x-_)/g,y:(x.y-k)/v},A=yA({x:1,y:0},T),D=yA(T,{x:(-x.x-_)/g,y:(-x.y-k)/v});!a&&D>0?D-=2*p:a&&D<0&&(D+=2*p);var j=A+(D%=2*p)*c,L=g*f(j),B=v*h(j);return{x:f(m)*L-h(m)*B+S,y:h(m)*L+f(m)*B+C}}function a8(e,n,t,r,i,o,a,s,u,c,l){var h,f=l.bbox,d=f===void 0||f,p=l.length,g=p===void 0||p,v=l.sampleSize,m=v===void 0?30:v,y=typeof c=="number",b=e,x=n,w=0,E=[b,x,w],M=[b,x],_={x:0,y:0},k=[{x:b,y:x}];y&&c<=0&&(_={x:b,y:x});for(var S=0;S<=m;S+=1){if(b=(h=o8(e,n,t,r,i,o,a,s,u,S/m)).x,x=h.y,d&&k.push({x:b,y:x}),g&&(w+=xu(M,[b,x])),M=[b,x],y&&w>=c&&c>E[2]){var C=(w-c)/(w-E[2]);_={x:M[0]*(1-C)+E[0]*C,y:M[1]*(1-C)+E[1]*C}}E=[b,x,w]}return y&&c>=w&&(_={x:s,y:u}),{length:w,point:_,min:{x:Math.min.apply(null,k.map(function(T){return T.x})),y:Math.min.apply(null,k.map(function(T){return T.y}))},max:{x:Math.max.apply(null,k.map(function(T){return T.x})),y:Math.max.apply(null,k.map(function(T){return T.y}))}}}function s8(e,n,t,r,i,o,a,s,u){var c=1-u;return{x:Math.pow(c,3)*e+3*Math.pow(c,2)*u*t+3*c*Math.pow(u,2)*i+Math.pow(u,3)*a,y:Math.pow(c,3)*n+3*Math.pow(c,2)*u*r+3*c*Math.pow(u,2)*o+Math.pow(u,3)*s}}function bA(e,n,t,r,i,o,a,s,u,c){var l,h=c.bbox,f=h===void 0||h,d=c.length,p=d===void 0||d,g=c.sampleSize,v=g===void 0?10:g,m=typeof u=="number",y=e,b=n,x=0,w=[y,b,x],E=[y,b],M={x:0,y:0},_=[{x:y,y:b}];m&&u<=0&&(M={x:y,y:b});for(var k=0;k<=v;k+=1){if(y=(l=s8(e,n,t,r,i,o,a,s,k/v)).x,b=l.y,f&&_.push({x:y,y:b}),p&&(x+=xu(E,[y,b])),E=[y,b],m&&x>=u&&u>w[2]){var S=(x-u)/(x-w[2]);M={x:E[0]*(1-S)+w[0]*S,y:E[1]*(1-S)+w[1]*S}}w=[y,b,x]}return m&&u>=x&&(M={x:a,y:s}),{length:x,point:M,min:{x:Math.min.apply(null,_.map(function(C){return C.x})),y:Math.min.apply(null,_.map(function(C){return C.y}))},max:{x:Math.max.apply(null,_.map(function(C){return C.x})),y:Math.max.apply(null,_.map(function(C){return C.y}))}}}function u8(e,n,t,r,i,o,a){var s=1-a;return{x:Math.pow(s,2)*e+2*s*a*t+Math.pow(a,2)*i,y:Math.pow(s,2)*n+2*s*a*r+Math.pow(a,2)*o}}function c8(e,n,t,r,i,o,a,s){var u,c=s.bbox,l=c===void 0||c,h=s.length,f=h===void 0||h,d=s.sampleSize,p=d===void 0?10:d,g=typeof a=="number",v=e,m=n,y=0,b=[v,m,y],x=[v,m],w={x:0,y:0},E=[{x:v,y:m}];g&&a<=0&&(w={x:v,y:m});for(var M=0;M<=p;M+=1){if(v=(u=u8(e,n,t,r,i,o,M/p)).x,m=u.y,l&&E.push({x:v,y:m}),f&&(y+=xu(x,[v,m])),x=[v,m],g&&y>=a&&a>b[2]){var _=(y-a)/(y-b[2]);w={x:x[0]*(1-_)+b[0]*_,y:x[1]*(1-_)+b[1]*_}}b=[v,m,y]}return g&&a>=y&&(w={x:i,y:o}),{length:y,point:w,min:{x:Math.min.apply(null,E.map(function(k){return k.x})),y:Math.min.apply(null,E.map(function(k){return k.y}))},max:{x:Math.max.apply(null,E.map(function(k){return k.x})),y:Math.max.apply(null,E.map(function(k){return k.y}))}}}function Rd(e,n,t){for(var r,i,o,a,s,u,c,l,h,f=Pd(e),d=typeof n=="number",p=[],g=0,v=0,m=0,y=0,b=[],x=[],w=0,E={x:0,y:0},M=E,_=E,k=E,S=0,C=0,T=f.length;C<T;C+=1)p=(c=(l=(h=f[C])[0])==="M")?p:[g,v].concat(h.slice(1)),c?(M=E={x:m=h[1],y:y=h[2]},w=0,d&&n<.001&&(k=E)):l==="L"?(w=(r=ty(p[0],p[1],p[2],p[3],(n||0)-S)).length,E=r.min,M=r.max,_=r.point):l==="A"?(w=(i=a8(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8],(n||0)-S,t||{})).length,E=i.min,M=i.max,_=i.point):l==="C"?(w=(o=bA(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],(n||0)-S,t||{})).length,E=o.min,M=o.max,_=o.point):l==="Q"?(w=(a=c8(p[0],p[1],p[2],p[3],p[4],p[5],(n||0)-S,t||{})).length,E=a.min,M=a.max,_=a.point):l==="Z"&&(w=(s=ty((p=[g,v,m,y])[0],p[1],p[2],p[3],(n||0)-S)).length,E=s.min,M=s.max,_=s.point),d&&S<n&&S+w>=n&&(k=_),x.push(M),b.push(E),S+=w,g=(u=l!=="Z"?h.slice(-2):[m,y])[0],v=u[1];return d&&n>=S&&(k={x:g,y:v}),{length:S,point:k,min:{x:Math.min.apply(null,b.map(function(A){return A.x})),y:Math.min.apply(null,b.map(function(A){return A.y}))},max:{x:Math.max.apply(null,x.map(function(A){return A.x})),y:Math.max.apply(null,x.map(function(A){return A.y}))}}}function dl(e,n){return Rd(e,void 0,F(F({},n),{bbox:!1,length:!0})).length}function xA(e){var n=0,t=0,r=0;return mA(e).map(function(i){var o;if(i[0]==="M")return n=i[1],t=i[2],0;var a=i.slice(1),s=a[0],u=a[1],c=a[2],l=a[3],h=a[4],f=a[5];return r=function(d,p,g,v,m,y,b,x){return 3*((x-p)*(g+m)-(b-d)*(v+y)+v*(d-m)-g*(p-y)+x*(m+d/3)-b*(y+p/3))/20}(n,t,s,u,c,l,h,f),o=i.slice(-2),n=o[0],t=o[1],r}).reduce(function(i,o){return i+o},0)}function jd(e,n,t){return Rd(e,n,F(F({},t),{bbox:!1,length:!0})).point}function l8(e,n){for(var t,r,i,o,a=Dd(e),s=Pd(a),u=dl(a),c=function(x){var w=x.x-n.x,E=x.y-n.y;return w*w+E*E},l=8,h=0,f=0,d=1/0,p=0;p<=u;p+=l)(h=c(t=jd(s,p)))<d&&(r=t,f=p,d=h);l/=2;for(var g=0,v=0,m=0,y=0;l>.5;)m=c(i=jd(s,g=f-l)),y=c(o=jd(s,v=f+l)),g>=0&&m<d?(r=i,f=g,d=m):v<=u&&y<d?(r=o,f=v,d=y):l/=2;var b=function(x,w){var E=Dd(x);if(typeof E=="string")throw TypeError(E);var M=E.slice(),_=dl(M),k=M.length-1,S=0,C=0,T=E[0],A=T.slice(-2),D={x:A[0],y:A[1]};if(k<=0||!w||!Number.isFinite(w))return{segment:T,index:0,length:C,point:D,lengthAtSegment:S};if(w>=_)return C=_-(S=dl(M=E.slice(0,-1))),{segment:E[k],index:k,length:C,lengthAtSegment:S};for(var j=[];k>0;)T=M[k],C=_-(S=dl(M=M.slice(0,-1))),_=S,j.push({segment:T,index:k,length:C,lengthAtSegment:S}),k-=1;return j.find(function(L){return L.lengthAtSegment<=w})}(a,f);return{closest:r,distance:Math.sqrt(d),segment:b}}function wA(e){return e.map(function(n,t,r){var i,o=t&&r[t-1].slice(-2).concat(n.slice(1)),a=t?bA(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],{bbox:!1}).length:0;return i=t?a?function(s,u){u===void 0&&(u=.5);var c=s.slice(0,2),l=s.slice(2,4),h=s.slice(4,6),f=s.slice(6,8),d=pa(c,l,u),p=pa(l,h,u),g=pa(h,f,u),v=pa(d,p,u),m=pa(p,g,u),y=pa(v,m,u);return[["C"].concat(d,v,y),["C"].concat(m,g,f)]}(o):[n,n]:[n],{s:n,ss:i,l:a}})}function ny(e){return Math.abs(e)<1e-6?0:e<0?-1:1}function h8(e,n,t){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])&&Math.min(e[0],n[0])<=t[0]&&t[0]<=Math.max(e[0],n[0])&&Math.min(e[1],n[1])<=t[1]&&t[1]<=Math.max(e[1],n[1])}function ry(e,n,t){var r=!1,i=e.length;if(i<=2)return!1;for(var o=0;o<i;o++){var a=e[o],s=e[(o+1)%i];if(h8(a,s,[n,t]))return!0;ny(a[1]-t)>0!=ny(s[1]-t)>0&&ny(n-(t-a[1])*(a[0]-s[0])/(a[1]-s[1])-a[0])<0&&(r=!r)}return r}var EA=function(e,n,t){return e>=n&&e<=t};function MA(e){for(var n=[],t=e.length,r=0;r<t-1;r++){var i=e[r],o=e[r+1];n.push({from:{x:i[0],y:i[1]},to:{x:o[0],y:o[1]}})}if(n.length>1){var a=e[0],s=e[t-1];n.push({from:{x:s[0],y:s[1]},to:{x:a[0],y:a[1]}})}return n}function f8(e,n){var t=!1;return e.forEach(function(r){if(function(i,o,a,s){var u=a.x-i.x,c=a.y-i.y,l=o.x-i.x,h=o.y-i.y,f=s.x-a.x,d=s.y-a.y,p=l*d-h*f,g=null;if(p*p>.001*(l*l+h*h)*(f*f+d*d)){var v=(u*d-c*f)/p,m=(u*h-c*l)/p;EA(v,0,1)&&EA(m,0,1)&&(g={x:i.x+v*l,y:i.y+v*h})}return g}(r.from,r.to,n.from,n.to))return t=!0,!1}),t}function SA(e){var n=e.map(function(r){return r[0]}),t=e.map(function(r){return r[1]});return{minX:Math.min.apply(null,n),maxX:Math.max.apply(null,n),minY:Math.min.apply(null,t),maxY:Math.max.apply(null,t)}}const d8=Object.freeze(Object.defineProperty({__proto__:null,Cache:UF,angleTo:function(e,n,t){var r=$2(e,n),i=cA(e,n)>=0;return t?i?2*Math.PI-r:r:i?r:2*Math.PI-r},arcToCubic:ey,assign:yu,augment:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var t=e[0],r=1;r<e.length;r++){var i=e[r];ni(i)&&(i=i.prototype),yu(t.prototype,i)}},clamp:function(e,n,t){return e<n?n:e>t?t:e},clearAnimationFrame:function(e){(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout)(e)},clone:$m,clonePath:function(e){return e.map(function(n){return Array.isArray(n)?[].concat(n):n})},contains:Cd,createDOM:function(e){var n=document.createElement("div");n.innerHTML=e;var t=n.childNodes[0];return t&&n.contains(t)&&n.removeChild(t),t},debounce:function(e,n,t){var r;return function(){var i=this,o=arguments,a=t&&!r;clearTimeout(r),r=setTimeout(function(){r=null,t||e.apply(i,o)},n),a&&e.apply(i,o)}},deepMix:function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];for(var r=0;r<n.length;r+=1)sA(e,n[r]);return e},difference:function(e,n){return n===void 0&&(n=[]),XC(e,function(t){return!Cd(n,t)})},direction:cA,distanceSquareRoot:xu,each:gu,endsWith:function(e,n){return!(!Un(e)&&!da(e))&&e[e.length-1]===n},equalizeSegments:function e(n,t,r){var i=wA(n),o=wA(t),a=i.length,s=o.length,u=i.filter(function(m){return m.l}).length,c=o.filter(function(m){return m.l}).length,l=i.filter(function(m){return m.l}).reduce(function(m,y){return m+y.l},0)/u||0,h=o.filter(function(m){return m.l}).reduce(function(m,y){return m+y.l},0)/c||0,f=r||Math.max(a,s),d=[l,h],p=[f-a,f-s],g=0,v=[i,o].map(function(m,y){return m.l===f?m.map(function(b){return b.s}):m.map(function(b,x){return g=x&&p[y]&&b.l>=d[y],p[y]-=g?1:0,g?b.ss:[b.s]}).flat()});return v[0].length===v[1].length?v:e(v[0],v[1],f)},every:function(e,n){for(var t=0;t<e.length;t++)if(!n(e[t],t))return!1;return!0},extend:function(e,n,t,r){ni(n)||(t=n,n=e,e=function(){});var i=Object.create?function(a,s){return Object.create(a,{constructor:{value:s}})}:function(a,s){function u(){}u.prototype=a;var c=new u;return c.constructor=s,c},o=i(n.prototype,e);return e.prototype=yu(o,e.prototype),e.superclass=i(n.prototype,n),yu(o,t),yu(e,r),e},filter:XC,find:function(e,n){if(!Un(e))return null;var t;if(ni(n)&&(t=n),mu(n)&&(t=function(i){return WC(i,n)}),t){for(var r=0;r<e.length;r+=1)if(t(e[r]))return e[r]}return null},findIndex:function(e,n,t){t===void 0&&(t=0);for(var r=t;r<e.length;r++)if(n(e[r],r))return r;return-1},firstValue:function(e,n){for(var t=null,r=0;r<e.length;r++){var i=e[r][n];if(!fa(i)){t=Un(i)?i[0]:i;break}}return t},fixedBase:function(e,n){var t=n.toString(),r=t.indexOf(".");if(r===-1)return Math.round(e);var i=t.substr(r+1).length;return i>20&&(i=20),parseFloat(e.toFixed(i))},flatten:function(e){if(!Un(e))return[];for(var n=[],t=0;t<e.length;t++)n=n.concat(e[t]);return n},flattenDeep:VC,forIn:gu,get:function(e,n,t){for(var r=0,i=da(n)?n.split("."):n;e&&r<i.length;)e=e[i[r++]];return e===void 0||r<i.length?t:e},getDrawDirection:function(e){return xA(e)>=0},getPathArea:xA,getPathBBox:function(e,n){if(!e)return{x:0,y:0,width:0,height:0,x2:0,y2:0,cx:0,cy:0,cz:0};var t=Rd(e,void 0,F(F({},n),{length:!1})),r=t.min,i=r.x,o=r.y,a=t.max,s=a.x,u=a.y,c=s-i,l=u-o;return{width:c,height:l,x:i,y:o,x2:s,y2:u,cx:i+c/2,cy:o+l/2,cz:Math.max(c,l)+Math.min(c,l)/2}},getPathBBoxTotalLength:function(e,n){if(!e)return{length:0,x:0,y:0,width:0,height:0,x2:0,y2:0,cx:0,cy:0,cz:0};var t=Rd(e,void 0,F(F({},n),{bbox:!0,length:!0})),r=t.length,i=t.min,o=i.x,a=i.y,s=t.max,u=s.x,c=s.y,l=u-o,h=c-a;return{length:r,width:l,height:h,x:o,y:a,x2:u,y2:c,cx:o+l/2,cy:a+h/2,cz:Math.max(l,h)+Math.min(l,h)/2}},getPointAtLength:jd,getRange:function(e){var n=e.filter(function(o){return!isNaN(o)});if(!n.length)return{min:0,max:0};if(Un(e[0])){for(var t=[],r=0;r<e.length;r++)t=t.concat(e[r]);n=t}var i=HC(n);return{min:qC(n),max:i}},getRotatedCurve:function(e,n){var t=e.length-1,r=[],i=0,o=function(a){var s=a.length,u=s-1;return a.map(function(c,l){return a.map(function(h,f){var d,p=l+f;return f===0||a[p]&&a[p][0]==="M"?(d=a[p],["M"].concat(d.slice(-2))):(p>=s&&(p-=u),a[p])})})}(e);return o.forEach(function(a,s){e.slice(1).forEach(function(u,c){i+=xu(e[(s+c)%t].slice(-2),n[c%t].slice(-2))}),r[s]=i,i=0}),o[r.indexOf(Math.min.apply(null,r))]},getTotalLength:dl,getType:iA,getWrapBehavior:function(e,n){return e["_wrap_"+n]},gradient:function(e){var n=(typeof e=="string"?e.split("-"):e).map(function(t){return GC(t.indexOf("#")===-1?uA(t):t)});return function(t){return function(r,i){var o=isNaN(Number(i))||i<0?0:i>1?1:Number(i),a=r.length-1,s=Math.floor(a*o),u=a*o-s,c=r[s],l=s===a?c:r[s+1];return UC([Jm(c,l,u,0),Jm(c,l,u,1),Jm(c,l,u,2)])}(n,t)}},group:function(e,n){if(!n)return[e];var t=eA(e,n),r=[];for(var i in t)r.push(t[i]);return r},groupBy:JC,groupToMap:eA,has:nA,hasKey:nA,hasValue:function(e,n){return Cd(rA(e),n)},head:function(e){if(Tr(e))return e[0]},identity:function(e){return e},includes:Cd,indexOf:function(e,n){if(!Tr(e))return-1;var t=Array.prototype.indexOf;if(t)return t.call(e,n);for(var r=-1,i=0;i<e.length;i++)if(e[i]===n){r=i;break}return r},isArguments:function(e){return vu(e,"Arguments")},isArray:Un,isArrayLike:Tr,isBoolean:function(e){return vu(e,"Boolean")},isDate:function(e){return e instanceof Date},isDecimal:function(e){return _o(e)&&e%1!=0},isElement:function(e){return e instanceof Element||e instanceof Document},isEmpty:function(e){if(fa(e))return!0;if(Tr(e))return!e.length;var n=iA(e);if(n==="Map"||n==="Set")return!e.size;if(oA(e))return!Object.keys(e).length;for(var t in e)if(zF.call(e,t))return!1;return!0},isEqual:Td,isEqualWith:function(e,n,t){return ni(t)?!!t(e,n):Td(e,n)},isError:function(e){return vu(e,"Error")},isEven:function(e){return _o(e)&&e%2==0},isFinite:function(e){return _o(e)&&isFinite(e)},isFunction:ni,isInteger:function(e){return _o(e)&&e%1==0},isMatch:WC,isNegative:function(e){return _o(e)&&e<0},isNil:fa,isNull:function(e){return e===null},isNumber:_o,isNumberEqual:function(e,n,t){return t===void 0&&(t=1e-5),e===n||Math.abs(e-n)<t},isObject:Ad,isObjectLike:Id,isOdd:function(e){return _o(e)&&e%2!=0},isPlainObject:mu,isPointInPolygon:ry,isPointInStroke:function(e,n){var t=l8(e,n).distance;return Math.abs(t)<.001},isPolygonsIntersect:function(e,n){if(e.length<2||n.length<2)return!1;var t,r,i=SA(e),o=SA(n);if(t=i,(r=o).minX>t.maxX||r.maxX<t.minX||r.minY>t.maxY||r.maxY<t.minY)return!1;var a=!1;if(n.forEach(function(l){if(ry(e,l[0],l[1]))return a=!0,!1}),a||(e.forEach(function(l){if(ry(n,l[0],l[1]))return a=!0,!1}),a))return!0;var s=MA(e),u=MA(n),c=!1;return u.forEach(function(l){if(f8(s,l))return c=!0,!1}),c},isPositive:function(e){return _o(e)&&e>0},isPrototype:oA,isRegExp:function(e){return vu(e,"RegExp")},isString:da,isType:vu,isUndefined:function(e){return e===void 0},keys:YC,last:function(e){if(Tr(e))return e[e.length-1]},lowerCase:function(e){return hl(e).toLowerCase()},lowerFirst:function(e){var n=hl(e);return n.charAt(0).toLowerCase()+n.substring(1)},map:function(e,n){if(!Tr(e))return e;for(var t=[],r=0;r<e.length;r++){var i=e[r];t.push(n(i,r))}return t},mapValues:function(e,n){n===void 0&&(n=FF);var t={};return Ad(e)&&!fa(e)&&Object.keys(e).forEach(function(r){t[r]=n(e[r],r)}),t},max:HC,maxBy:function(e,n){if(Un(e)){for(var t,r=-1/0,i=0;i<e.length;i++){var o=e[i],a=ni(n)?n(o):o[n];a>r&&(t=o,r=a)}return t}},memoize:aA,min:qC,minBy:function(e,n){if(Un(e)){for(var t,r=1/0,i=0;i<e.length;i++){var o=e[i],a=ni(n)?n(o):o[n];a<r&&(t=o,r=a)}return t}},mix:yu,mod:function(e,n){return(e%n+n)%n},modifyCSS:function(e,n){if(e)return Object.keys(n).forEach(function(t){e.style[t]=n[t]}),e},noop:function(){},normalizePath:Pd,number2color:function(e){var n=tA[e];if(!n){for(var t=e.toString(16),r=t.length;r<6;r++)t="0"+t;n="#"+t,tA[e]=n}return n},omit:function(e,n){return $C(e,function(t,r,i){return n.includes(i)||(t[i]=r),t},{})},parseRadius:function(e){var n=0,t=0,r=0,i=0;return Un(e)?e.length===1?n=t=r=i=e[0]:e.length===2?(n=r=e[0],t=i=e[1]):e.length===3?(n=e[0],t=i=e[1],r=e[2]):(n=e[0],t=e[1],r=e[2],i=e[3]):n=t=r=i=e,{r1:n,r2:t,r3:r,r4:i}},path2Absolute:gA,path2Array:function(e){return Dd(e)},path2Curve:mA,path2String:function(e,n){return n===void 0&&(n="off"),function(t,r){if(r==="off")return[].concat(t);var i=typeof r=="number"&&r>=1?Math.pow(10,r):1;return t.map(function(o){var a=o.slice(1).map(Number).map(function(s){return r?Math.round(s*i)/i:Math.round(s)});return[o[0]].concat(a)})}(e,n).map(function(t){return t[0]+t.slice(1).join(" ")}).join("")},pick:function(e,n){if(e===null||!mu(e))return{};var t={};return gu(n,function(r){GF.call(e,r)&&(t[r]=e[r])}),t},pull:function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];for(var r=0;r<n.length;r++)for(var i=n[r],o=-1;(o=TF.call(e,i))>-1;)IF.call(e,o,1);return e},pullAt:KC,reduce:$C,remove:function(e,n){var t=[];if(!Tr(e))return t;for(var r=-1,i=[],o=e.length;++r<o;){var a=e[r];n(a,r,e)&&(t.push(a),i.push(r))}return KC(e,i),t},requestAnimationFrame:function(e){var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,16)};return n(e)},reverseCurve:function(e){var n=e.slice(1).map(function(t,r,i){return r?i[r-1].slice(-2).concat(t.slice(1)):e[0].slice(1).concat(t.slice(1))}).map(function(t){return t.map(function(r,i){return t[t.length-i-2*(1-i%2)]})}).reverse();return[["M"].concat(n[0].slice(0,2))].concat(n.map(function(t){return["C"].concat(t.slice(2))}))},rgb2arr:GC,set:function(e,n,t){var r=e,i=da(n)?n.split("."):n;return i.forEach(function(o,a){a<i.length-1?(Ad(r[o])||(r[o]=_o(i[a+1])?[]:{}),r=r[o]):r[o]=t}),e},size:function(e){return fa(e)?0:Tr(e)?e.length:Object.keys(e).length},some:function(e,n){for(var t=0;t<e.length;t++)if(n(e[t],t))return!0;return!1},sortBy:function(e,n){var t;if(ni(n))t=function(i,o){return n(i)-n(o)};else{var r=[];da(n)?r.push(n):Un(n)&&(r=n),t=function(i,o){for(var a=0;a<r.length;a+=1){var s=r[a];if(i[s]>o[s])return 1;if(i[s]<o[s])return-1}return 0}}return e.sort(t),e},startsWith:function(e,n){return!(!Un(e)&&!da(e))&&e[0]===n},substitute:function(e,n){return e&&n?e.replace(/\\?\{([^{}]+)\}/g,function(t,r){return t.charAt(0)==="\\"?t.slice(1):n[r]===void 0?"":n[r]}):e},throttle:function(e,n,t){var r,i,o,a,s=0;t||(t={});var u=function(){s=t.leading===!1?0:Date.now(),r=null,a=e.apply(i,o),r||(i=o=null)},c=function(){var l=Date.now();s||t.leading!==!1||(s=l);var h=n-(l-s);return i=this,o=arguments,h<=0||h>n?(r&&(clearTimeout(r),r=null),s=l,a=e.apply(i,o),r||(i=o=null)):r||t.trailing===!1||(r=setTimeout(u,h)),a};return c.cancel=function(){clearTimeout(r),s=0,r=i=o=null},c},toArray:function(e){return Tr(e)?Array.prototype.slice.call(e):[]},toCSSGradient:function(e){if(/^[r,R,L,l]{1}[\s]*\(/.test(e)){var n,t=void 0;if(e[0]==="l"){var r=+(i=YF.exec(e))[1]+90;t=i[2],n="linear-gradient(".concat(r,"deg, ")}else if(e[0]==="r"){var i;n="radial-gradient(",t=(i=WF.exec(e))[4]}var o=t.match(VF);return o.forEach(function(a,s){var u=a.split(":");n+="".concat(u[1]," ").concat(100*Number(u[0]),"%"),s!==o.length-1&&(n+=", ")}),n+=")"}return e},toDegree:function(e){return DF*e},toInteger:PF,toRGB:uA,toRadian:function(e){return LF*e},toString:hl,transform:function(e,n){for(var t=e?[].concat(e):[1,0,0,0,1,0,0,0,1],r=0,i=n.length;r<i;r++){var o=n[r];switch(o[0]){case"t":HF(t,t,[o[1],o[2]]);break;case"s":ZF(t,t,[o[1],o[2]]);break;case"r":qF(t,t,o[1]);break;case"m":KF(t,t,o[1])}}return t},union:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return QC([].concat.apply([],e))},uniq:QC,uniqueId:function(e){return Od[e=e||"g"]?Od[e]+=1:Od[e]=1,e+Od[e]},upperCase:function(e){return hl(e).toUpperCase()},upperFirst:function(e){var n=hl(e);return n.charAt(0).toUpperCase()+n.substring(1)},values:rA,valuesOfKey:function(e,n){for(var t=[],r={},i=0;i<e.length;i++){var o=e[i][n];if(!fa(o)){Un(o)||(o=[o]);for(var a=0;a<o.length;a++){var s=o[a];r[s]||(t.push(s),r[s]=!0)}}}return t},vertical:function(e,n,t){return t?(e[0]=n[1],e[1]=-1*n[0]):(e[0]=-1*n[1],e[1]=n[0]),e},wrapBehavior:function(e,n){if(e["_wrap_"+n])return e["_wrap_"+n];var t=function(r){e[n](r)};return e["_wrap_"+n]=t,t}},Symbol.toStringTag,{value:"Module"})),_A=ji(d8);Object.defineProperty(qm,"__esModule",{value:!0});var p8=_A;qm.default=function(e){for(var n={},t=e.nodes().filter(function(h){var f;return!(!((f=e.children(h))===null||f===void 0)&&f.length)}),r=t.map(function(h){return e.node(h).rank}),i=(0,p8.max)(r),o=[],a=0;a<i+1;a++)o.push([]);var s=function(h){var f;if(!n.hasOwnProperty(h)){n[h]=!0;var d=e.node(h);isNaN(d.rank)||o[d.rank].push(h),(f=e.successors(h))===null||f===void 0||f.forEach(function(p){return s(p)})}},u=t.sort(function(h,f){return e.node(h).rank-e.node(f).rank}),c=u.filter(function(h){return e.node(h).fixorder!==void 0}),l=c.sort(function(h,f){return e.node(h).fixorder-e.node(f).fixorder});return l==null||l.forEach(function(h){isNaN(e.node(h).rank)||o[e.node(h).rank].push(h),n[h]=!0}),u==null||u.forEach(s),o};var iy={};Object.defineProperty(iy,"__esModule",{value:!0});var g8=Yr,v8=function(e,n,t){for(var r=(0,g8.zipObject)(t,t.map(function(l,h){return h})),i=n.map(function(l){var h,f=(h=e.outEdges(l))===null||h===void 0?void 0:h.map(function(d){return{pos:r[d.w]||0,weight:e.edge(d).weight}});return f==null?void 0:f.sort(function(d,p){return d.pos-p.pos})}),o=i.flat().filter(function(l){return l!==void 0}),a=1;a<t.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),c=0;return o==null||o.forEach(function(l){if(l){var h=l.pos+a;u[h]+=l.weight;for(var f=0;h>0;)h%2&&(f+=u[h+1]),u[h=h-1>>1]+=l.weight;c+=l.weight*f}}),c};iy.default=function(e,n){for(var t=0,r=1;r<(n==null?void 0:n.length);r+=1)t+=v8(e,n[r-1],n[r]);return t};var oy={};Object.defineProperty(oy,"__esModule",{value:!0});var m8=So,y8=function(e){for(var n;e.hasNode(n="_root".concat(Math.random())););return n};oy.default=function(e,n,t){var r=y8(e),i=new m8.Graph({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(o){return e.node(o)});return e.nodes().forEach(function(o){var a,s=e.node(o),u=e.parent(o);(s.rank===n||s.minRank<=n&&n<=s.maxRank)&&(i.setNode(o),i.setParent(o,u||r),(a=e[t](o))===null||a===void 0||a.forEach(function(c){var l=c.v===o?c.w:c.v,h=i.edgeFromArgs(l,o),f=h!==void 0?h.weight:0;i.setEdge(l,o,{weight:e.edge(c).weight+f})}),s.hasOwnProperty("minRank")&&i.setNode(o,{borderLeft:s.borderLeft[n],borderRight:s.borderRight[n]}))}),i};var ay={};Object.defineProperty(ay,"__esModule",{value:!0}),ay.default=function(e,n,t){var r,i={};t==null||t.forEach(function(o){for(var a,s,u=e.parent(o);u;){if((a=e.parent(u))?(s=i[a],i[a]=u):(s=r,r=u),s&&s!==u)return void n.setEdge(s,u);u=a}})};var sy={},uy={};Object.defineProperty(uy,"__esModule",{value:!0}),uy.default=function(e,n){return n.map(function(t){var r=e.inEdges(t);if(!(r!=null&&r.length))return{v:t};var i={sum:0,weight:0};return r==null||r.forEach(function(o){var a=e.edge(o),s=e.node(o.v);i.sum+=a.weight*s.order,i.weight+=a.weight}),{v:t,barycenter:i.sum/i.weight,weight:i.weight}})};var cy={};Object.defineProperty(cy,"__esModule",{value:!0});var b8=function(e){for(var n,t,r=[],i=function(){var s=e.pop();r.push(s),(n=s.in.reverse())===null||n===void 0||n.forEach(function(u){return(c=s,function(l){l.merged||(l.barycenter===void 0||c.barycenter===void 0||l.barycenter>=c.barycenter)&&x8(c,l)})(u);var c}),(t=s.out)===null||t===void 0||t.forEach(function(u){return(c=s,function(l){l.in.push(c),--l.indegree==0&&e.push(l)})(u);var c})};e!=null&&e.length;)i();var o=r.filter(function(s){return!s.merged}),a=["vs","i","barycenter","weight"];return o.map(function(s){var u={};return a==null||a.forEach(function(c){s[c]!==void 0&&(u[c]=s[c])}),u})},x8=function(e,n){var t,r=0,i=0;e.weight&&(r+=e.barycenter*e.weight,i+=e.weight),n.weight&&(r+=n.barycenter*n.weight,i+=n.weight),e.vs=(t=n.vs)===null||t===void 0?void 0:t.concat(e.vs),e.barycenter=r/i,e.weight=i,e.i=Math.min(n.i,e.i),n.merged=!0};cy.default=function(e,n){var t,r,i,o={};e==null||e.forEach(function(s,u){o[s.v]={i:u,indegree:0,in:[],out:[],vs:[s.v]};var c=o[s.v];s.barycenter!==void 0&&(c.barycenter=s.barycenter,c.weight=s.weight)}),(t=n.edges())===null||t===void 0||t.forEach(function(s){var u=o[s.v],c=o[s.w];u!==void 0&&c!==void 0&&(c.indegree++,u.out.push(o[s.w]))});var a=(i=(r=Object.values(o)).filter)===null||i===void 0?void 0:i.call(r,function(s){return!s.indegree});return b8(a)};var ly={};Object.defineProperty(ly,"__esModule",{value:!0});var w8=Yr,kA=function(e,n,t){for(var r,i=t;n.length&&(r=n[n.length-1]).i<=i;)n.pop(),e==null||e.push(r.vs),i++;return i},E8=function(e,n){return function(t,r){if(t.fixorder!==void 0&&r.fixorder!==void 0)return t.fixorder-r.fixorder;if(t.barycenter<r.barycenter)return-1;if(t.barycenter>r.barycenter)return 1;if(n&&t.order!==void 0&&r.order!==void 0){if(t.order<r.order)return-1;if(t.order>r.order)return 1}return e?r.i-t.i:t.i-r.i}};ly.default=function(e,n,t,r){var i=(0,w8.partition)(e,function(f){var d=f.hasOwnProperty("fixorder")&&!isNaN(f.fixorder);return r?!d&&f.hasOwnProperty("barycenter"):d||f.hasOwnProperty("barycenter")}),o=i.lhs,a=i.rhs.sort(function(f,d){return-f.i- -d.i}),s=[],u=0,c=0,l=0;o==null||o.sort(E8(!!n,!!t)),l=kA(s,a,l),o==null||o.forEach(function(f){var d;l+=(d=f.vs)===null||d===void 0?void 0:d.length,s.push(f.vs),u+=f.barycenter*f.weight,c+=f.weight,l=kA(s,a,l)});var h={vs:s.flat()};return c&&(h.barycenter=u/c,h.weight=c),h};var hy=xe&&xe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(sy,"__esModule",{value:!0});var M8=hy(uy),S8=hy(cy),_8=hy(ly),CA=function(e,n,t,r,i,o){var a,s,u,c,l=e.children(n),h=e.node(n),f=h?h.borderLeft:void 0,d=h?h.borderRight:void 0,p={};f&&(l=l==null?void 0:l.filter(function(x){return x!==f&&x!==d}));var g=(0,M8.default)(e,l||[]);g==null||g.forEach(function(x){var w;if(!((w=e.children(x.v))===null||w===void 0)&&w.length){var E=CA(e,x.v,t,r,o);p[x.v]=E,E.hasOwnProperty("barycenter")&&C8(x,E)}});var v=(0,S8.default)(g,t);k8(v,p),(a=v.filter(function(x){return x.vs.length>0}))===null||a===void 0||a.forEach(function(x){var w=e.node(x.vs[0]);w&&(x.fixorder=w.fixorder,x.order=w.order)});var m=(0,_8.default)(v,r,i,o);if(f&&(m.vs=[f,m.vs,d].flat(),(s=e.predecessors(f))===null||s===void 0?void 0:s.length)){var y=e.node(((u=e.predecessors(f))===null||u===void 0?void 0:u[0])||""),b=e.node(((c=e.predecessors(d))===null||c===void 0?void 0:c[0])||"");m.hasOwnProperty("barycenter")||(m.barycenter=0,m.weight=0),m.barycenter=(m.barycenter*m.weight+y.order+b.order)/(m.weight+2),m.weight+=2}return m},k8=function(e,n){e==null||e.forEach(function(t){var r,i=(r=t.vs)===null||r===void 0?void 0:r.map(function(o){return n[o]?n[o].vs:o});t.vs=i.flat()})},C8=function(e,n){e.barycenter!==void 0?(e.barycenter=(e.barycenter*e.weight+n.barycenter*n.weight)/(e.weight+n.weight),e.weight+=n.weight):(e.barycenter=n.barycenter,e.weight=n.weight)};sy.default=CA;var pl=xe&&xe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Hm,"__esModule",{value:!0});var AA=pl(qm),IA=pl(iy),A8=pl(oy),I8=pl(ay),T8=pl(sy),TA=_n(),O8=So,fy=Yr,OA=function(e,n,t){return n.map(function(r){return(0,A8.default)(e,r,t)})},NA=function(e,n,t,r){var i=new O8.Graph;e==null||e.forEach(function(o){for(var a,s=o.graph().root,u=(0,T8.default)(o,s,i,n,t,r),c=0;c<((a=u.vs)===null||a===void 0?void 0:a.length);c++){var l=o.node(u.vs[c]);l&&(l.order=c)}(0,I8.default)(o,i,u.vs)})},dy=function(e,n){n==null||n.forEach(function(t){t==null||t.forEach(function(r,i){e.node(r).order=i})})};Hm.default=function(e,n){for(var t=(0,fy.maxRank)(e),r=[],i=[],o=1;o<t+1;o++)r.push(o);for(o=t-1;o>-1;o--)i.push(o);var a=OA(e,r,"inEdges"),s=OA(e,i,"outEdges"),u=(0,AA.default)(e);dy(e,u);for(var c,l=Number.POSITIVE_INFINITY,h=(o=0,0);h<4;++o,++h)NA(o%2?a:s,o%4>=2,!1,n),u=(0,fy.buildLayerMatrix)(e),(f=(0,IA.default)(e,u))<l&&(h=0,c=(0,TA.clone)(u),l=f);for(u=(0,AA.default)(e),dy(e,u),o=0,h=0;h<4;++o,++h){var f;NA(o%2?a:s,o%4>=2,!0,n),u=(0,fy.buildLayerMatrix)(e),(f=(0,IA.default)(e,u))<l&&(h=0,c=(0,TA.clone)(u),l=f)}dy(e,c)};var py={},DA={};(function(e){var n=xe&&xe.__extends||function(){var a=function(s,u){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,l){c.__proto__=l}||function(c,l){for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&(c[h]=l[h])},a(s,u)};return function(s,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");function c(){this.constructor=s}a(s,u),s.prototype=u===null?Object.create(u):(c.prototype=u.prototype,new c)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.width=e.sep=e.positionX=e.balance=e.alignCoordinates=e.findSmallestWidthAlignment=e.buildBlockGraph=e.horizontalCompaction=e.verticalAlignment=e.hasConflict=e.addConflict=e.findOtherInnerSegmentNode=e.findType2Conflicts=e.findType1Conflicts=void 0;var t=_A,r=Yr,i=function(a){function s(){return a!==null&&a.apply(this,arguments)||this}return n(s,a),s}(kd.Graph);e.findType1Conflicts=function(a,s){var u={};return s!=null&&s.length&&s.reduce(function(c,l){var h=0,f=0,d=c.length,p=l==null?void 0:l[(l==null?void 0:l.length)-1];return l==null||l.forEach(function(g,v){var m,y=(0,e.findOtherInnerSegmentNode)(a,g),b=y?a.node(y).order:d;(y||g===p)&&((m=l.slice(f,v+1))===null||m===void 0||m.forEach(function(x){var w;(w=a.predecessors(x))===null||w===void 0||w.forEach(function(E){var M,_=a.node(E),k=_.order;!(k<h||b<k)||_.dummy&&(!((M=a.node(x))===null||M===void 0)&&M.dummy)||(0,e.addConflict)(u,E,x)})}),f=v+1,h=b)}),l}),u},e.findType2Conflicts=function(a,s){var u={};function c(h,f,d,p,g){for(var v,m,y,b=f;b<d;b++)y=h[b],!((v=a.node(y))===null||v===void 0)&&v.dummy&&((m=a.predecessors(y))===null||m===void 0||m.forEach(function(x){var w=a.node(x);w.dummy&&(w.order<p||w.order>g)&&(0,e.addConflict)(u,x,y)}))}function l(h,f){var d=function(p){return JSON.stringify(p.slice(1))}(h);f.get(d)||(c.apply(void 0,h),f.set(d,!0))}return s!=null&&s.length&&s.reduce(function(h,f){var d,p=-1,g=0,v=new Map;return f==null||f.forEach(function(m,y){var b;if(((b=a.node(m))===null||b===void 0?void 0:b.dummy)==="border"){var x=a.predecessors(m)||[];x.length&&(d=a.node(x[0]).order,l([f,g,y,p,d],v),g=y,p=d)}l([f,g,f.length,d,h.length],v)}),f}),u},e.findOtherInnerSegmentNode=function(a,s){var u,c;if(!((u=a.node(s))===null||u===void 0)&&u.dummy)return(c=a.predecessors(s))===null||c===void 0?void 0:c.find(function(l){return a.node(l).dummy})},e.addConflict=function(a,s,u){var c=s,l=u;if(c>l){var h=c;c=l,l=h}var f=a[c];f||(a[c]=f={}),f[l]=!0},e.hasConflict=function(a,s,u){var c=s;return c>u&&(c=u),!!a[c]},e.verticalAlignment=function(a,s,u,c){var l={},h={},f={};return s==null||s.forEach(function(d){d==null||d.forEach(function(p,g){l[p]=p,h[p]=p,f[p]=g})}),s==null||s.forEach(function(d){var p=-1;d==null||d.forEach(function(g){var v=c(g);if(v.length){v=v.sort(function(w,E){return f[w]-f[E]});for(var m=(v.length-1)/2,y=Math.floor(m),b=Math.ceil(m);y<=b;++y){var x=v[y];h[g]===g&&p<f[x]&&!(0,e.hasConflict)(u,g,x)&&(h[x]=g,h[g]=l[g]=l[x],p=f[x])}}})}),{root:l,align:h}},e.horizontalCompaction=function(a,s,u,c,l){var h,f={},d=(0,e.buildBlockGraph)(a,s,u,l),p=l?"borderLeft":"borderRight",g=function(v,m){for(var y=d.nodes(),b=y.pop(),x={};b;)x[b]?v(b):(x[b]=!0,y.push(b),y=y.concat(m(b))),b=y.pop()};return g(function(v){f[v]=(d.inEdges(v)||[]).reduce(function(m,y){return Math.max(m,(f[y.v]||0)+d.edge(y))},0)},d.predecessors.bind(d)),g(function(v){var m=(d.outEdges(v)||[]).reduce(function(b,x){return Math.min(b,(f[x.w]||0)-d.edge(x))},Number.POSITIVE_INFINITY),y=a.node(v);m!==Number.POSITIVE_INFINITY&&y.borderType!==p&&(f[v]=Math.max(f[v],m))},d.successors.bind(d)),(h=Object.values(c))===null||h===void 0||h.forEach(function(v){f[v]=f[u[v]]}),f},e.buildBlockGraph=function(a,s,u,c){var l=new i,h=a.graph(),f=(0,e.sep)(h.nodesep,h.edgesep,c);return s==null||s.forEach(function(d){var p;d==null||d.forEach(function(g){var v=u[g];if(l.setNode(v),p){var m=u[p],y=l.edgeFromArgs(m,v);l.setEdge(m,v,Math.max(f(a,g,p),y||0))}p=g})}),l};function o(a,s){var u=Object.values(s),c=(0,t.min)(u),l=(0,t.max)(u);["u","d"].forEach(function(h){["l","r"].forEach(function(f){var d,p=h+f,g=a[p];if(g!==s){var v=Object.values(g);(d=f==="l"?c-(0,t.min)(v):l-(0,t.max)(v))&&(a[p]={},Object.keys(g).forEach(function(m){a[p][m]=g[m]+d}))}})})}e.findSmallestWidthAlignment=function(a,s){return(0,r.minBy)(Object.values(s),function(u){var c,l=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY;return(c=Object.keys(u))===null||c===void 0||c.forEach(function(f){var d=u[f],p=(0,e.width)(a,f)/2;l=Math.max(d+p,l),h=Math.min(d-p,h)}),l-h})},e.alignCoordinates=o,e.balance=function(a,s){var u={};return Object.keys(a.ul).forEach(function(c){if(s)u[c]=a[s.toLowerCase()][c];else{var l=Object.values(a).map(function(h){return h[c]});u[c]=(l[0]+l[1])/2}}),u},e.positionX=function(a){var s,u=(0,r.buildLayerMatrix)(a),c=Object.assign((0,e.findType1Conflicts)(a,u),(0,e.findType2Conflicts)(a,u)),l={};["u","d"].forEach(function(f){s=f==="u"?u:Object.values(u).reverse(),["l","r"].forEach(function(d){d==="r"&&(s=s.map(function(m){return Object.values(m).reverse()}));var p=(f==="u"?a.predecessors:a.successors).bind(a),g=(0,e.verticalAlignment)(a,s,c,p),v=(0,e.horizontalCompaction)(a,s,g.root,g.align,d==="r");d==="r"&&Object.keys(v).forEach(function(m){v[m]=-v[m]}),l[f+d]=v})});var h=(0,e.findSmallestWidthAlignment)(a,l);return o(l,h),(0,e.balance)(l,a.graph().align)},e.sep=function(a,s,u){return function(c,l,h){var f,d=c.node(l),p=c.node(h),g=0;if(g+=d.width/2,d.hasOwnProperty("labelpos"))switch((d.labelpos||"").toLowerCase()){case"l":f=-d.width/2;break;case"r":f=d.width/2}if(f&&(g+=u?f:-f),f=0,g+=(d.dummy?s:a)/2,g+=(p.dummy?s:a)/2,g+=p.width/2,p.labelpos)switch((p.labelpos||"").toLowerCase()){case"l":f=p.width/2;break;case"r":f=-p.width/2}return f&&(g+=u?f:-f),f=0,g}},e.width=function(a,s){return a.node(s).width||0}})(DA);var PA=xe&&xe.__spreadArray||function(e,n,t){if(t||arguments.length===2)for(var r,i=0,o=n.length;i<o;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))};Object.defineProperty(py,"__esModule",{value:!0});var gy=Yr,cs=DA;py.default=function(e){var n,t=(0,gy.asNonCompoundGraph)(e);(function(i){var o=(0,gy.buildLayerMatrix)(i),a=i.graph().ranksep,s=0;o==null||o.forEach(function(u){var c=u.map(function(h){return i.node(h).height}),l=Math.max.apply(Math,PA(PA([],c,!1),[0],!1));u==null||u.forEach(function(h){i.node(h).y=s+l/2}),s+=l+a})})(t);var r=function(i){var o=(0,gy.buildLayerMatrix)(i),a=Object.assign((0,cs.findType1Conflicts)(i,o),(0,cs.findType2Conflicts)(i,o)),s={},u=[];["u","d"].forEach(function(l){u=l==="u"?o:Object.values(o).reverse(),["l","r"].forEach(function(h){h==="r"&&(u=u.map(function(g){return Object.values(g).reverse()}));var f=(l==="u"?i.predecessors:i.successors).bind(i),d=(0,cs.verticalAlignment)(i,u,a,f),p=(0,cs.horizontalCompaction)(i,u,d.root,d.align,h==="r");h==="r"&&Object.keys(p).forEach(function(g){return p[g]=-p[g]}),s[l+h]=p})});var c=(0,cs.findSmallestWidthAlignment)(i,s);return c&&(0,cs.alignCoordinates)(s,c),(0,cs.balance)(s,i.graph().align)}(t);(n=Object.keys(r))===null||n===void 0||n.forEach(function(i){t.node(i).x=r[i]})};var vy={};Object.defineProperty(vy,"__esModule",{value:!0}),vy.default=function(e,n){for(var t=e.nodes().filter(function(s){var u;return!(!((u=e.children(s))===null||u===void 0)&&u.length)}),r=t.map(function(s){return e.node(s).rank}),i=Math.max.apply(Math,r),o=[],a=0;a<i+1;a++)o[a]=[];n==null||n.forEach(function(s){var u=e.node(s);u&&!(u!=null&&u.dummy)&&(isNaN(u.rank)||(u.fixorder=o[u.rank].length,o[u.rank].push(s)))})};var Bd=xe&&xe.__assign||function(){return Bd=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},Bd.apply(this,arguments)},to=xe&&xe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Mm,"__esModule",{value:!0});var LA=to(Sm),RA=to(Bm),N8=to(zm),no=Yr,D8=to(Fm),jA=to(Gm),P8=to(Xm),BA=to(Ym),L8=to(Hm),R8=to(py),j8=to(vy),B8=So,z8=function(e,n,t){n("    removeSelfEdges",function(){iG(e)}),n("    acyclic",function(){LA.default.run(e)}),n("    nestingGraph.run",function(){jA.default.run(e)}),n("    rank",function(){(0,N8.default)((0,no.asNonCompoundGraph)(e))}),n("    injectEdgeLabelProxies",function(){K8(e)}),n("    removeEmptyRanks",function(){(0,no.removeEmptyRanks)(e)}),n("    nestingGraph.cleanup",function(){jA.default.cleanup(e)}),n("    normalizeRanks",function(){(0,no.normalizeRanks)(e)}),n("    assignRankMinMax",function(){$8(e)}),n("    removeEdgeLabelProxies",function(){Q8(e)}),n("    normalize.run",function(){RA.default.run(e)}),n("    parentDummyChains",function(){(0,D8.default)(e)}),n("    addBorderSegments",function(){(0,P8.default)(e)}),t&&t.keepNodeOrder&&n("    initDataOrder",function(){(0,j8.default)(e,t.nodeOrder)}),n("    order",function(){(0,L8.default)(e,t==null?void 0:t.keepNodeOrder)}),n("    insertSelfEdges",function(){oG(e)}),n("    adjustCoordinateSystem",function(){BA.default.adjust(e)}),n("    position",function(){(0,R8.default)(e)}),n("    positionSelfEdges",function(){aG(e)}),n("    removeBorderNodes",function(){rG(e)}),n("    normalize.undo",function(){RA.default.undo(e)}),n("    fixupEdgeLabelCoords",function(){tG(e)}),n("    undoCoordinateSystem",function(){BA.default.undo(e)}),n("    translateGraph",function(){J8(e)}),n("    assignNodeIntersects",function(){eG(e)}),n("    reversePoints",function(){nG(e)}),n("    acyclic.undo",function(){LA.default.undo(e)})},F8=function(e,n){e.nodes().forEach(function(t){var r=e.node(t),i=n.node(t);i!==void 0?(r.fixorder=i._order,delete i._order):delete r.fixorder})},G8=function(e,n){e.nodes().forEach(function(t){var r,i=e.node(t);if(i){var o=n.node(t);i.x=o.x,i.y=o.y,i._order=o.order,i._rank=o.rank,!((r=n.children(t))===null||r===void 0)&&r.length&&(i.width=o.width,i.height=o.height)}}),e.edges().forEach(function(t){var r=e.edge(t),i=n.edge(t);r.points=i?i.points:[],i&&i.hasOwnProperty("x")&&(r.x=i.x,r.y=i.y)}),e.graph().width=n.graph().width,e.graph().height=n.graph().height},U8=["nodesep","edgesep","ranksep","marginx","marginy"],X8={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},zA=["acyclicer","ranker","rankdir","align"],Y8=["width","height","layer","fixorder"],W8={width:0,height:0},V8=["minlen","weight","width","height","labeloffset"],H8={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},FA=["labelpos"],q8=function(e){var n=new B8.Graph({multigraph:!0,compound:!0}),t=yy(e.graph()),r={};return zA==null||zA.forEach(function(i){t[i]!==void 0&&(r[i]=t[i])}),n.setGraph(Object.assign({},X8,my(t,U8),r)),e.nodes().forEach(function(i){var o=yy(e.node(i)),a=Bd(Bd({},W8),o),s=my(a,Y8);n.setNode(i,s),n.setParent(i,e.parent(i))}),e.edges().forEach(function(i){var o=yy(e.edge(i)),a={};FA==null||FA.forEach(function(s){o[s]!==void 0&&(a[s]=o[s])}),n.setEdgeObj(i,Object.assign({},H8,my(o,V8),a))}),n},Z8=function(e){var n=e.graph();n.ranksep||(n.ranksep=0),n.ranksep/=2,e.nodes().forEach(function(t){var r=e.node(t);isNaN(r.layer)||r.layer||(r.layer=0)}),e.edges().forEach(function(t){var r,i=e.edge(t);i.minlen*=2,((r=i.labelpos)===null||r===void 0?void 0:r.toLowerCase())!=="c"&&(n.rankdir==="TB"||n.rankdir==="BT"?i.width+=i.labeloffset:i.height+=i.labeloffset)})},K8=function(e){e.edges().forEach(function(n){var t=e.edge(n);if(t.width&&t.height){var r=e.node(n.v),i={e:n,rank:(e.node(n.w).rank-r.rank)/2+r.rank};(0,no.addDummyNode)(e,"edge-proxy",i,"_ep")}})},$8=function(e){var n=0;e.nodes().forEach(function(t){var r,i,o=e.node(t);o.borderTop&&(o.minRank=(r=e.node(o.borderTop))===null||r===void 0?void 0:r.rank,o.maxRank=(i=e.node(o.borderBottom))===null||i===void 0?void 0:i.rank,n=Math.max(n,o.maxRank||-1/0))}),e.graph().maxRank=n},Q8=function(e){e.nodes().forEach(function(n){var t=e.node(n);t.dummy==="edge-proxy"&&(e.edge(t.e).labelRank=t.rank,e.removeNode(n))})},J8=function(e){var n,t,r=0,i=0,o=e.graph(),a=o.marginx||0,s=o.marginy||0,u=function(c){if(c){var l=c.x,h=c.y,f=c.width,d=c.height;isNaN(l)||isNaN(f)||(n===void 0&&(n=l-f/2),n=Math.min(n,l-f/2),r=Math.max(r,l+f/2)),isNaN(h)||isNaN(d)||(t===void 0&&(t=h-d/2),t=Math.min(t,h-d/2),i=Math.max(i,h+d/2))}};e.nodes().forEach(function(c){u(e.node(c))}),e.edges().forEach(function(c){var l=e.edge(c);l!=null&&l.hasOwnProperty("x")&&u(l)}),n-=a,t-=s,e.nodes().forEach(function(c){var l=e.node(c);l&&(l.x-=n,l.y-=t)}),e.edges().forEach(function(c){var l,h=e.edge(c);(l=h.points)===null||l===void 0||l.forEach(function(f){f.x-=n,f.y-=t}),h.hasOwnProperty("x")&&(h.x-=n),h.hasOwnProperty("y")&&(h.y-=t)}),o.width=r-n+a,o.height=i-t+s},eG=function(e){e.edges().forEach(function(n){var t,r,i=e.edge(n),o=e.node(n.v),a=e.node(n.w);i.points?(t=i.points[0],r=i.points[i.points.length-1]):(i.points=[],t=a,r=o),i.points.unshift((0,no.intersectRect)(o,t)),i.points.push((0,no.intersectRect)(a,r))})},tG=function(e){e.edges().forEach(function(n){var t=e.edge(n);if(t!=null&&t.hasOwnProperty("x"))switch(t.labelpos!=="l"&&t.labelpos!=="r"||(t.width-=t.labeloffset),t.labelpos){case"l":t.x-=t.width/2+t.labeloffset;break;case"r":t.x+=t.width/2+t.labeloffset}})},nG=function(e){e.edges().forEach(function(n){var t,r=e.edge(n);r.reversed&&((t=r.points)===null||t===void 0||t.reverse())})},rG=function(e){e.nodes().forEach(function(n){var t,r,i;if(!((t=e.children(n))===null||t===void 0)&&t.length){var o=e.node(n),a=e.node(o.borderTop),s=e.node(o.borderBottom),u=e.node(o.borderLeft[((r=o.borderLeft)===null||r===void 0?void 0:r.length)-1]),c=e.node(o.borderRight[((i=o.borderRight)===null||i===void 0?void 0:i.length)-1]);o.width=Math.abs((c==null?void 0:c.x)-(u==null?void 0:u.x))||10,o.height=Math.abs((s==null?void 0:s.y)-(a==null?void 0:a.y))||10,o.x=((u==null?void 0:u.x)||0)+o.width/2,o.y=((a==null?void 0:a.y)||0)+o.height/2}}),e.nodes().forEach(function(n){var t;((t=e.node(n))===null||t===void 0?void 0:t.dummy)==="border"&&e.removeNode(n)})},iG=function(e){e.edges().forEach(function(n){if(n.v===n.w){var t=e.node(n.v);t.selfEdges||(t.selfEdges=[]),t.selfEdges.push({e:n,label:e.edge(n)}),e.removeEdgeObj(n)}})},oG=function(e){var n=(0,no.buildLayerMatrix)(e);n==null||n.forEach(function(t){var r=0;t==null||t.forEach(function(i,o){var a,s=e.node(i);s.order=o+r,(a=s.selfEdges)===null||a===void 0||a.forEach(function(u){(0,no.addDummyNode)(e,"selfedge",{width:u.label.width,height:u.label.height,rank:s.rank,order:o+ ++r,e:u.e,label:u.label},"_se")}),delete s.selfEdges})})},aG=function(e){e.nodes().forEach(function(n){var t=e.node(n);if(t.dummy==="selfedge"){var r=e.node(t.e.v),i=r.x+r.width/2,o=r.y,a=t.x-i,s=r.height/2;e.setEdgeObj(t.e,t.label),e.removeNode(n),t.label.points=[{x:i+2*a/3,y:o-s},{x:i+5*a/6,y:o-s},{y:o,x:i+a},{x:i+5*a/6,y:o+s},{x:i+2*a/3,y:o+s}],t.label.x=t.x,t.label.y=t.y}})},my=function(e,n){var t={};return n==null||n.forEach(function(r){e[r]!==void 0&&(t[r]=+e[r])}),t},yy=function(e){e===void 0&&(e={});var n={};return Object.keys(e).forEach(function(t){n[t.toLowerCase()]=e[t]}),n};Mm.default=function(e,n){var t=n&&n.debugTiming?no.time:no.notime;t("layout",function(){n&&!n.keepNodeOrder&&n.prevGraph&&t("  inheritOrder",function(){F8(e,n.prevGraph)});var r=t("  buildLayoutGraph",function(){return q8(e)});n&&n.edgeLabelSpace===!1||t("  makeSpaceForEdgeLabels",function(){Z8(r)});try{t("  runLayout",function(){z8(r,t,n)})}catch(i){if(i.message==="Not possible to find intersection inside of the rectangle")return;throw i}t("  updateInputGraph",function(){G8(e,r)})})};var sG=xe&&xe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Em,"__esModule",{value:!0});var uG=sG(Mm),GA=Yr;Em.default={layout:uG.default,util:{time:GA.time,notime:GA.notime}};var cG=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),lG=xe&&xe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(fu,"__esModule",{value:!0}),fu.DagreLayout=void 0;var hG=lG(Em),Wr=_n(),UA=So,fG=function(e){function n(t){var r=e.call(this)||this;return r.rankdir="TB",r.nodesep=50,r.ranksep=50,r.controlPoints=!1,r.sortByCombo=!1,r.edgeLabelSpace=!0,r.radial=!1,r.nodes=[],r.edges=[],r.onLayoutEnd=function(){},r.layoutNode=function(i){var o=r.nodes.find(function(a){return a.id===i});return!o||o.layout!==!1},r.updateCfg(t),r}return cG(n,e),n.prototype.getDefaultCfg=function(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1,radial:!1,focusNode:null}},n.prototype.execute=function(){var t,r,i,o,a=this,s=this,u=s.nodes,c=s.nodeSize,l=s.rankdir,h=s.combos,f=s.begin,d=s.radial,p=s.comboEdges,g=p===void 0?[]:p,v=s.vedges,m=v===void 0?[]:v;if(u){var y=s.edges||[],b=new UA.Graph({multigraph:!0,compound:!0});s.nodeMap={};var x={};u.forEach(function(O){s.nodeMap[O.id]=O,O.comboId&&(x[O.comboId]=x[O.comboId]||[],x[O.comboId].push(O.id))});var w,E=[],M={};!((t=s.nodeOrder)===null||t===void 0)&&t.length?(s.nodeOrder.forEach(function(O){M[O]=!0,E.push(s.nodeMap[O])}),u.forEach(function(O){M[O.id]||E.push(O)})):E=u,w=c?(0,Wr.isArray)(c)?function(){return c}:function(){return[c,c]}:function(O){return O.size?(0,Wr.isArray)(O.size)?O.size:(0,Wr.isObject)(O.size)?[O.size.width||40,O.size.height||40]:[O.size,O.size]:[40,40]};var _=(0,Wr.getFunc)(s.ranksep,50,s.ranksepFunc),k=(0,Wr.getFunc)(s.nodesep,50,s.nodesepFunc),S=k,C=_;l!=="LR"&&l!=="RL"||(S=_,C=k),b.setDefaultEdgeLabel(function(){return{}}),b.setGraph(s);var T={};this.sortByCombo&&h&&h.forEach(function(O){if(T[O.id]=O,O.collapsed){var he=w(O),_e=C(O),Ze=S(O),Je=he[0]+2*Ze,qe=he[1]+2*_e;b.setNode(O.id,{width:Je,height:qe})}O.parentId&&(T[O.parentId]||b.setNode(O.parentId,{}),b.setParent(O.id,O.parentId))}),E.filter(function(O){return O.layout!==!1}).forEach(function(O){var he=w(O),_e=C(O),Ze=S(O),Je=he[0]+2*Ze,qe=he[1]+2*_e,vt=O.layer;(0,Wr.isNumber)(vt)?b.setNode(O.id,{width:Je,height:qe,layer:vt}):b.setNode(O.id,{width:Je,height:qe}),a.sortByCombo&&O.comboId&&(T[O.comboId]||(T[O.comboId]={id:O.comboId},b.setNode(O.comboId,{})),b.setParent(O.id,O.comboId))}),y.forEach(function(O){var he=(0,Wr.getEdgeTerminal)(O,"source"),_e=(0,Wr.getEdgeTerminal)(O,"target");a.layoutNode(he)&&a.layoutNode(_e)&&b.setEdge(he,_e,{weight:O.weight||1})}),(r=g==null?void 0:g.concat(m||[]))===null||r===void 0||r.forEach(function(O){var he,_e,Ze=O.source,Je=O.target,qe=!((he=T[Ze])===null||he===void 0)&&he.collapsed?[Ze]:x[Ze]||[Ze],vt=!((_e=T[Je])===null||_e===void 0)&&_e.collapsed?[Je]:x[Je]||[Je];qe.forEach(function(pt){vt.forEach(function(Et){b.setEdge(pt,Et,{weight:O.weight||1})})})});var A=void 0;!((i=s.preset)===null||i===void 0)&&i.nodes&&(A=new UA.Graph({multigraph:!0,compound:!0}),s.preset.nodes.forEach(function(O){A==null||A.setNode(O.id,O)})),hG.default.layout(b,{prevGraph:A,edgeLabelSpace:s.edgeLabelSpace,keepNodeOrder:!!s.nodeOrder,nodeOrder:s.nodeOrder});var D=[0,0];if(f){var j=1/0,L=1/0;b.nodes().forEach(function(O){var he=b.node(O);j>he.x&&(j=he.x),L>he.y&&(L=he.y)}),b.edges().forEach(function(O){var he;(he=b.edge(O).points)===null||he===void 0||he.forEach(function(_e){j>_e.x&&(j=_e.x),L>_e.y&&(L=_e.y)})}),D[0]=f[0]-j,D[1]=f[1]-L}var B=l==="LR"||l==="RL";if(d){var N=this,R=N.focusNode,P=N.ranksep,H=N.getRadialPos,ne=(0,Wr.isString)(R)?R:R==null?void 0:R.id,Z=ne?(o=b.node(ne))===null||o===void 0?void 0:o._rank:0,q=[],te=B?"y":"x",we=B?"height":"width",pe=1/0,Me=-1/0;b.nodes().forEach(function(O){var he=b.node(O);if(s.nodeMap[O]){var _e=k(s.nodeMap[O]);if(Z===0)q[he._rank]||(q[he._rank]={nodes:[],totalWidth:0,maxSize:-1/0}),q[he._rank].nodes.push(O),q[he._rank].totalWidth+=2*_e+he[we],q[he._rank].maxSize<Math.max(he.width,he.height)&&(q[he._rank].maxSize=Math.max(he.width,he.height));else{var Ze=he._rank-Z;if(Ze===0)q[Ze]||(q[Ze]={nodes:[],totalWidth:0,maxSize:-1/0}),q[Ze].nodes.push(O),q[Ze].totalWidth+=2*_e+he[we],q[Ze].maxSize<Math.max(he.width,he.height)&&(q[Ze].maxSize=Math.max(he.width,he.height));else{var Je=Math.abs(Ze);q[Je]||(q[Je]={left:[],right:[],totalWidth:0,maxSize:-1/0}),q[Je].totalWidth+=2*_e+he[we],q[Je].maxSize<Math.max(he.width,he.height)&&(q[Je].maxSize=Math.max(he.width,he.height)),Ze<0?q[Je].left.push(O):q[Je].right.push(O)}}var qe=he[te]-he[we]/2-_e,vt=he[te]+he[we]/2+_e;qe<pe&&(pe=qe),vt>Me&&(Me=vt)}});var Be=P||50,dt={},It=(Me-pe)/.9,at=[.5*(pe+Me-It),.5*(pe+Me+It)],Ue=function(O,he,_e,Ze){_e===void 0&&(_e=-1/0),Ze===void 0&&(Ze=[0,1]);var Je=_e;return O.forEach(function(qe){var vt=b.node(qe);dt[qe]=he;var pt=H(vt[te],at,It,he,Ze),Et=pt.x,Tt=pt.y;if(s.nodeMap[qe]){s.nodeMap[qe].x=Et+D[0],s.nodeMap[qe].y=Tt+D[1],s.nodeMap[qe]._order=vt._order;var Rt=_(s.nodeMap[qe]);Je<Rt&&(Je=Rt)}}),Je},Te=!0;q.forEach(function(O){var he,_e,Ze,Je,qe,vt,pt;if(!((he=O==null?void 0:O.nodes)===null||he===void 0)&&he.length||!((_e=O==null?void 0:O.left)===null||_e===void 0)&&_e.length||!((Ze=O==null?void 0:O.right)===null||Ze===void 0)&&Ze.length){if(Te&&O.nodes.length===1){var Et=O.nodes[0];return s.nodeMap[Et]?(s.nodeMap[Et].x=D[0],s.nodeMap[Et].y=D[1],dt[O.nodes[0]]=0,Be=_(s.nodeMap[Et]),void(Te=!1)):void 0}Be=Math.max(Be,O.totalWidth/(2*Math.PI));var Tt=-1/0;if(Z===0||!((Je=O.nodes)===null||Je===void 0)&&Je.length)Tt=Ue(O.nodes,Be,Tt,[0,1]);else{var Rt=((qe=O.left)===null||qe===void 0?void 0:qe.length)/(((vt=O.left)===null||vt===void 0?void 0:vt.length)+((pt=O.right)===null||pt===void 0?void 0:pt.length));Tt=Ue(O.left,Be,Tt,[0,Rt]),Tt=Ue(O.right,Be,Tt,[Rt+.05,1])}Be+=Tt,Te=!1,O.maxSize}}),b.edges().forEach(function(O){var he,_e,Ze,Je=b.edge(O),qe=y.findIndex(function(ar){var Mr=(0,Wr.getEdgeTerminal)(ar,"source"),hr=(0,Wr.getEdgeTerminal)(ar,"target");return Mr===O.v&&hr===O.w});if(!(qe<=-1)&&s.edgeLabelSpace&&s.controlPoints&&y[qe].type!=="loop"){var vt=te==="x"?"y":"x",pt=(he=Je==null?void 0:Je.points)===null||he===void 0?void 0:he.slice(1,Je.points.length-1),Et=[],Tt=(_e=b.node(O.v))===null||_e===void 0?void 0:_e[vt],Rt=Tt-((Ze=b.node(O.w))===null||Ze===void 0?void 0:Ze[vt]),ln=dt[O.v],xn=ln-dt[O.w];pt==null||pt.forEach(function(ar){var Mr=(ar[vt]-Tt)/Rt*xn+ln,hr=H(ar[te],at,It,Mr);Et.push({x:hr.x+D[0],y:hr.y+D[1]})}),y[qe].controlPoints=Et}})}else{var Xe=new Set,Oe=l==="BT"||l==="RL"?function(O,he){return he-O}:function(O,he){return O-he};b.nodes().forEach(function(O){var he=b.node(O);if(he){var _e=a.nodeMap[O];_e||(_e=h==null?void 0:h.find(function(Ze){return Ze.id===O})),_e&&(_e.x=he.x+D[0],_e.y=he.y+D[1],_e._order=he._order,Xe.add(B?_e.x:_e.y))}});var Se=Array.from(Xe).sort(Oe),We=B?function(O,he){return O.x!==he.x}:function(O,he){return O.y!==he.y},Ve=B?function(O,he,_e){var Ze=Math.max(he.y,_e.y),Je=Math.min(he.y,_e.y);return O.filter(function(qe){return qe.y<=Ze&&qe.y>=Je})}:function(O,he,_e){var Ze=Math.max(he.x,_e.x),Je=Math.min(he.x,_e.x);return O.filter(function(qe){return qe.x<=Ze&&qe.x>=Je})};b.edges().forEach(function(O){var he,_e=b.edge(O),Ze=y.findIndex(function(vt){var pt=(0,Wr.getEdgeTerminal)(vt,"source"),Et=(0,Wr.getEdgeTerminal)(vt,"target");return pt===O.v&&Et===O.w});if(!(Ze<=-1)&&s.edgeLabelSpace&&s.controlPoints&&y[Ze].type!=="loop"){(he=_e==null?void 0:_e.points)===null||he===void 0||he.forEach(function(vt){vt.x+=D[0],vt.y+=D[1]});var Je=s.nodeMap[O.v],qe=s.nodeMap[O.w];y[Ze].controlPoints=dG(_e==null?void 0:_e.points,Je,qe,Se,B,We,Ve)}})}return s.onLayoutEnd&&s.onLayoutEnd(),{nodes:u,edges:y}}},n.prototype.getRadialPos=function(t,r,i,o,a){a===void 0&&(a=[0,1]);var s=(t-r[0])/i,u=2*(s=s*(a[1]-a[0])+a[0])*Math.PI;return{x:Math.cos(u)*o,y:Math.sin(u)*o}},n.prototype.getType=function(){return"dagre"},n}(Nn.Base);fu.DagreLayout=fG;var dG=function(e,n,t,r,i,o,a){var s=(e==null?void 0:e.slice(1,e.length-1))||[];if(n&&t){var u=n.x,c=n.y,l=t.x,h=t.y;if(i&&(u=n.y,c=n.x,l=t.y,h=t.x),h!==c&&u!==l){var f=r.indexOf(c),d=r[f+1];if(d){var p=s[0],g=i?{x:(c+d)/2,y:(p==null?void 0:p.y)||l}:{x:(p==null?void 0:p.x)||l,y:(c+d)/2};p&&!o(p,g)||s.unshift(g)}var v=r.indexOf(h),m=Math.abs(v-f);if(m===1)(s=a(s,n,t)).length||s.push(i?{x:(c+h)/2,y:u}:{x:u,y:(c+h)/2});else if(m>1){var y=r[v-1];if(y){var b=s[s.length-1],x=i?{x:(h+y)/2,y:(b==null?void 0:b.y)||l}:{x:(b==null?void 0:b.x)||u,y:(h+y)/2};b&&!o(b,x)||s.push(x)}}}}return s},gl={};const zd={graph:{meta:{rankDir:"TB",nodeSep:50,rankSep:50,edgeSep:5,align:void 0}},subScene:{meta:{paddingTop:20,paddingBottom:20,paddingLeft:20,paddingRight:20,labelHeight:20}},nodeSize:{meta:{width:100,maxLabelWidth:0,height:20},node:{width:80,height:20,labelOffset:10,maxLabelWidth:40},bridge:{width:5,height:5,radius:2,labelOffset:0}}};function by(e={},n=zd){var t,r,i,o;const a=JSON.parse(JSON.stringify(n)),s=((t=e==null?void 0:e.graph)===null||t===void 0?void 0:t.meta)||{},u=((r=e==null?void 0:e.subScene)===null||r===void 0?void 0:r.meta)||{},c=((i=e==null?void 0:e.nodeSize)===null||i===void 0?void 0:i.meta)||{},l=((o=e==null?void 0:e.nodeSize)===null||o===void 0?void 0:o.node)||{},h=a.nodeSize.bridge;return{graph:{meta:Object.assign(a.graph.meta,s)},subScene:{meta:Object.assign(a.subScene.meta,u)},nodeSize:{meta:Object.assign(a.nodeSize.meta,c),node:Object.assign(a.nodeSize.node,l),bridge:h}}}function XA(e){return`\u25EC${e}\u25EC`}const wu=XA("ROOT"),YA=XA("BRIDGE_GRAPH");var Or,ls,Eu,xy;(function(e){e[e.META=0]="META",e[e.NODE=1]="NODE",e[e.BRIDGE=2]="BRIDGE"})(Or||(Or={})),function(e){e[e.INCLUDE=0]="INCLUDE",e[e.EXCLUDE=1]="EXCLUDE",e[e.UNSPECIFIED=2]="UNSPECIFIED"}(ls||(ls={})),function(e){e[e.META=0]="META",e[e.CORE=1]="CORE",e[e.BRIDGE=2]="BRIDGE"}(Eu||(Eu={})),function(e){e[e.META=0]="META",e[e.OP=1]="OP",e[e.SERIES=2]="SERIES"}(xy||(xy={}));var Fd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wy(e,n){return e(n={exports:{}},n.exports),n.exports}var Mu=function(e,n){return e===n||e!=e&&n!=n},Gd=function(e,n){for(var t=e.length;t--;)if(Mu(e[t][0],n))return t;return-1},pG=Array.prototype.splice;function Su(e){var n=-1,t=e==null?0:e.length;for(this.clear();++n<t;){var r=e[n];this.set(r[0],r[1])}}Su.prototype.clear=function(){this.__data__=[],this.size=0},Su.prototype.delete=function(e){var n=this.__data__,t=Gd(n,e);return!(t<0||(t==n.length-1?n.pop():pG.call(n,t,1),--this.size,0))},Su.prototype.get=function(e){var n=this.__data__,t=Gd(n,e);return t<0?void 0:n[t][1]},Su.prototype.has=function(e){return Gd(this.__data__,e)>-1},Su.prototype.set=function(e,n){var t=this.__data__,r=Gd(t,e);return r<0?(++this.size,t.push([e,n])):t[r][1]=n,this};var WA,Ud=Su,VA=typeof Fd=="object"&&Fd&&Fd.Object===Object&&Fd,gG=typeof self=="object"&&self&&self.Object===Object&&self,ki=VA||gG||Function("return this")(),ri=ki.Symbol,HA=Object.prototype,vG=HA.hasOwnProperty,mG=HA.toString,vl=ri?ri.toStringTag:void 0,yG=Object.prototype.toString,qA=ri?ri.toStringTag:void 0,ga=function(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":qA&&qA in Object(e)?function(n){var t=vG.call(n,vl),r=n[vl];try{n[vl]=void 0;var i=!0}catch{}var o=mG.call(n);return i&&(t?n[vl]=r:delete n[vl]),o}(e):function(n){return yG.call(n)}(e)},Nr=function(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")},ml=function(e){if(!Nr(e))return!1;var n=ga(e);return n=="[object Function]"||n=="[object GeneratorFunction]"||n=="[object AsyncFunction]"||n=="[object Proxy]"},Ey=ki["__core-js_shared__"],ZA=(WA=/[^.]+$/.exec(Ey&&Ey.keys&&Ey.keys.IE_PROTO||""))?"Symbol(src)_1."+WA:"",bG=Function.prototype.toString,hs=function(e){if(e!=null){try{return bG.call(e)}catch{}try{return e+""}catch{}}return""},xG=/^\[object .+?Constructor\]$/,wG=Function.prototype,EG=Object.prototype,MG=wG.toString,SG=EG.hasOwnProperty,_G=RegExp("^"+MG.call(SG).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kG=function(e){return!(!Nr(e)||function(n){return!!ZA&&ZA in n}(e))&&(ml(e)?_G:xG).test(hs(e))},fs=function(e,n){var t=function(r,i){return r==null?void 0:r[i]}(e,n);return kG(t)?t:void 0},yl=fs(ki,"Map"),bl=fs(Object,"create"),CG=Object.prototype.hasOwnProperty,AG=Object.prototype.hasOwnProperty;function _u(e){var n=-1,t=e==null?0:e.length;for(this.clear();++n<t;){var r=e[n];this.set(r[0],r[1])}}_u.prototype.clear=function(){this.__data__=bl?bl(null):{},this.size=0},_u.prototype.delete=function(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n},_u.prototype.get=function(e){var n=this.__data__;if(bl){var t=n[e];return t==="__lodash_hash_undefined__"?void 0:t}return CG.call(n,e)?n[e]:void 0},_u.prototype.has=function(e){var n=this.__data__;return bl?n[e]!==void 0:AG.call(n,e)},_u.prototype.set=function(e,n){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=bl&&n===void 0?"__lodash_hash_undefined__":n,this};var KA=_u,Xd=function(e,n){var t=e.__data__;return function(r){var i=typeof r;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?r!=="__proto__":r===null}(n)?t[typeof n=="string"?"string":"hash"]:t.map};function ku(e){var n=-1,t=e==null?0:e.length;for(this.clear();++n<t;){var r=e[n];this.set(r[0],r[1])}}ku.prototype.clear=function(){this.size=0,this.__data__={hash:new KA,map:new(yl||Ud),string:new KA}},ku.prototype.delete=function(e){var n=Xd(this,e).delete(e);return this.size-=n?1:0,n},ku.prototype.get=function(e){return Xd(this,e).get(e)},ku.prototype.has=function(e){return Xd(this,e).has(e)},ku.prototype.set=function(e,n){var t=Xd(this,e),r=t.size;return t.set(e,n),this.size+=t.size==r?0:1,this};var Yd=ku;function Cu(e){var n=this.__data__=new Ud(e);this.size=n.size}Cu.prototype.clear=function(){this.__data__=new Ud,this.size=0},Cu.prototype.delete=function(e){var n=this.__data__,t=n.delete(e);return this.size=n.size,t},Cu.prototype.get=function(e){return this.__data__.get(e)},Cu.prototype.has=function(e){return this.__data__.has(e)},Cu.prototype.set=function(e,n){var t=this.__data__;if(t instanceof Ud){var r=t.__data__;if(!yl||r.length<199)return r.push([e,n]),this.size=++t.size,this;t=this.__data__=new Yd(r)}return t.set(e,n),this.size=t.size,this};var Au=Cu,My=function(e,n){for(var t=-1,r=e==null?0:e.length;++t<r&&n(e[t],t,e)!==!1;);return e},Wd=function(){try{var e=fs(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Vd=function(e,n,t){n=="__proto__"&&Wd?Wd(e,n,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[n]=t},IG=Object.prototype.hasOwnProperty,Hd=function(e,n,t){var r=e[n];IG.call(e,n)&&Mu(r,t)&&(t!==void 0||n in e)||Vd(e,n,t)},xl=function(e,n,t,r){var i=!t;t||(t={});for(var o=-1,a=n.length;++o<a;){var s=n[o],u=void 0;u===void 0&&(u=e[s]),i?Vd(t,s,u):Hd(t,s,u)}return t},Ci=function(e){return e!=null&&typeof e=="object"},$A=function(e){return Ci(e)&&ga(e)=="[object Arguments]"},QA=Object.prototype,TG=QA.hasOwnProperty,OG=QA.propertyIsEnumerable,Iu=$A(function(){return arguments}())?$A:function(e){return Ci(e)&&TG.call(e,"callee")&&!OG.call(e,"callee")},Dn=Array.isArray,NG=function(){return!1},ds=wy(function(e,n){var t=n&&!n.nodeType&&n,r=t&&e&&!e.nodeType&&e,i=r&&r.exports===t?ki.Buffer:void 0,o=(i?i.isBuffer:void 0)||NG;e.exports=o}),DG=/^(?:0|[1-9]\d*)$/,qd=function(e,n){var t=typeof e;return!!(n=n??9007199254740991)&&(t=="number"||t!="symbol"&&DG.test(e))&&e>-1&&e%1==0&&e<n},Sy=function(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=9007199254740991},yn={};yn["[object Float32Array]"]=yn["[object Float64Array]"]=yn["[object Int8Array]"]=yn["[object Int16Array]"]=yn["[object Int32Array]"]=yn["[object Uint8Array]"]=yn["[object Uint8ClampedArray]"]=yn["[object Uint16Array]"]=yn["[object Uint32Array]"]=!0,yn["[object Arguments]"]=yn["[object Array]"]=yn["[object ArrayBuffer]"]=yn["[object Boolean]"]=yn["[object DataView]"]=yn["[object Date]"]=yn["[object Error]"]=yn["[object Function]"]=yn["[object Map]"]=yn["[object Number]"]=yn["[object Object]"]=yn["[object RegExp]"]=yn["[object Set]"]=yn["[object String]"]=yn["[object WeakMap]"]=!1;var Zd=function(e){return function(n){return e(n)}},Tu=wy(function(e,n){var t=n&&!n.nodeType&&n,r=t&&e&&!e.nodeType&&e,i=r&&r.exports===t&&VA.process,o=function(){try{return r&&r.require&&r.require("util").types||i&&i.binding&&i.binding("util")}catch{}}();e.exports=o}),JA=Tu&&Tu.isTypedArray,wl=JA?Zd(JA):function(e){return Ci(e)&&Sy(e.length)&&!!yn[ga(e)]},PG=Object.prototype.hasOwnProperty,eI=function(e,n){var t=Dn(e),r=!t&&Iu(e),i=!t&&!r&&ds(e),o=!t&&!r&&!i&&wl(e),a=t||r||i||o,s=a?function(l,h){for(var f=-1,d=Array(l);++f<l;)d[f]=h(f);return d}(e.length,String):[],u=s.length;for(var c in e)!n&&!PG.call(e,c)||a&&(c=="length"||i&&(c=="offset"||c=="parent")||o&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||qd(c,u))||s.push(c);return s},LG=Object.prototype,Kd=function(e){var n=e&&e.constructor;return e===(typeof n=="function"&&n.prototype||LG)},tI=function(e,n){return function(t){return e(n(t))}},RG=tI(Object.keys,Object),jG=Object.prototype.hasOwnProperty,_y=function(e){if(!Kd(e))return RG(e);var n=[];for(var t in Object(e))jG.call(e,t)&&t!="constructor"&&n.push(t);return n},ko=function(e){return e!=null&&Sy(e.length)&&!ml(e)},va=function(e){return ko(e)?eI(e):_y(e)},BG=Object.prototype.hasOwnProperty,zG=function(e){if(!Nr(e))return function(i){var o=[];if(i!=null)for(var a in Object(i))o.push(a);return o}(e);var n=Kd(e),t=[];for(var r in e)(r!="constructor"||!n&&BG.call(e,r))&&t.push(r);return t},ps=function(e){return ko(e)?eI(e,!0):zG(e)},nI=wy(function(e,n){var t=n&&!n.nodeType&&n,r=t&&e&&!e.nodeType&&e,i=r&&r.exports===t?ki.Buffer:void 0,o=i?i.allocUnsafe:void 0;e.exports=function(a,s){if(s)return a.slice();var u=a.length,c=o?o(u):new a.constructor(u);return a.copy(c),c}}),rI=function(e,n){var t=-1,r=e.length;for(n||(n=Array(r));++t<r;)n[t]=e[t];return n},iI=function(e,n){for(var t=-1,r=e==null?0:e.length,i=0,o=[];++t<r;){var a=e[t];n(a,t,e)&&(o[i++]=a)}return o},oI=function(){return[]},FG=Object.prototype.propertyIsEnumerable,aI=Object.getOwnPropertySymbols,ky=aI?function(e){return e==null?[]:(e=Object(e),iI(aI(e),function(n){return FG.call(e,n)}))}:oI,Cy=function(e,n){for(var t=-1,r=n.length,i=e.length;++t<r;)e[i+t]=n[t];return e},$d=tI(Object.getPrototypeOf,Object),sI=Object.getOwnPropertySymbols?function(e){for(var n=[];e;)Cy(n,ky(e)),e=$d(e);return n}:oI,uI=function(e,n,t){var r=n(e);return Dn(e)?r:Cy(r,t(e))},Ay=function(e){return uI(e,va,ky)},GG=function(e){return uI(e,ps,sI)},Iy=fs(ki,"DataView"),Ty=fs(ki,"Promise"),Ou=fs(ki,"Set"),Oy=fs(ki,"WeakMap"),UG=hs(Iy),XG=hs(yl),YG=hs(Ty),WG=hs(Ou),VG=hs(Oy),gs=ga;(Iy&&gs(new Iy(new ArrayBuffer(1)))!="[object DataView]"||yl&&gs(new yl)!="[object Map]"||Ty&&gs(Ty.resolve())!="[object Promise]"||Ou&&gs(new Ou)!="[object Set]"||Oy&&gs(new Oy)!="[object WeakMap]")&&(gs=function(e){var n=ga(e),t=n=="[object Object]"?e.constructor:void 0,r=t?hs(t):"";if(r)switch(r){case UG:return"[object DataView]";case XG:return"[object Map]";case YG:return"[object Promise]";case WG:return"[object Set]";case VG:return"[object WeakMap]"}return n});var vs=gs,HG=Object.prototype.hasOwnProperty,Qd=ki.Uint8Array,Ny=function(e){var n=new e.constructor(e.byteLength);return new Qd(n).set(new Qd(e)),n},qG=/\w*$/,cI=ri?ri.prototype:void 0,lI=cI?cI.valueOf:void 0,hI=function(e,n){var t=n?Ny(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)},ZG=function(e,n,t){var r=e.constructor;switch(n){case"[object ArrayBuffer]":return Ny(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return function(i,o){var a=o?Ny(i.buffer):i.buffer;return new i.constructor(a,i.byteOffset,i.byteLength)}(e,t);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return hI(e,t);case"[object Map]":case"[object Set]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return function(i){var o=new i.constructor(i.source,qG.exec(i));return o.lastIndex=i.lastIndex,o}(e);case"[object Symbol]":return function(i){return lI?Object(lI.call(i)):{}}(e)}},fI=Object.create,dI=function(){function e(){}return function(n){if(!Nr(n))return{};if(fI)return fI(n);e.prototype=n;var t=new e;return e.prototype=void 0,t}}(),pI=function(e){return typeof e.constructor!="function"||Kd(e)?{}:dI($d(e))},gI=Tu&&Tu.isMap,KG=gI?Zd(gI):function(e){return Ci(e)&&vs(e)=="[object Map]"},vI=Tu&&Tu.isSet,$G=vI?Zd(vI):function(e){return Ci(e)&&vs(e)=="[object Set]"},vn={};vn["[object Arguments]"]=vn["[object Array]"]=vn["[object ArrayBuffer]"]=vn["[object DataView]"]=vn["[object Boolean]"]=vn["[object Date]"]=vn["[object Float32Array]"]=vn["[object Float64Array]"]=vn["[object Int8Array]"]=vn["[object Int16Array]"]=vn["[object Int32Array]"]=vn["[object Map]"]=vn["[object Number]"]=vn["[object Object]"]=vn["[object RegExp]"]=vn["[object Set]"]=vn["[object String]"]=vn["[object Symbol]"]=vn["[object Uint8Array]"]=vn["[object Uint8ClampedArray]"]=vn["[object Uint16Array]"]=vn["[object Uint32Array]"]=!0,vn["[object Error]"]=vn["[object Function]"]=vn["[object WeakMap]"]=!1;var mI=function e(n,t,r,i,o,a){var s,u=1&t,c=2&t,l=4&t;if(s!==void 0)return s;if(!Nr(n))return n;var h=Dn(n);if(h){if(s=function(v){var m=v.length,y=new v.constructor(m);return m&&typeof v[0]=="string"&&HG.call(v,"index")&&(y.index=v.index,y.input=v.input),y}(n),!u)return rI(n,s)}else{var f=vs(n),d=f=="[object Function]"||f=="[object GeneratorFunction]";if(ds(n))return nI(n,u);if(f=="[object Object]"||f=="[object Arguments]"||d&&!o){if(s=c||d?{}:pI(n),!u)return c?function(v,m){return xl(v,sI(v),m)}(n,function(v,m){return v&&xl(m,ps(m),v)}(s,n)):function(v,m){return xl(v,ky(v),m)}(n,function(v,m){return v&&xl(m,va(m),v)}(s,n))}else{if(!vn[f])return o?n:{};s=ZG(n,f,u)}}a||(a=new Au);var p=a.get(n);if(p)return p;a.set(n,s),$G(n)?n.forEach(function(v){s.add(e(v,t,r,v,n,a))}):KG(n)&&n.forEach(function(v,m){s.set(m,e(v,t,r,m,n,a))});var g=h?void 0:(l?c?GG:Ay:c?ps:va)(n);return My(g||n,function(v,m){g&&(v=n[m=v]),Hd(s,m,e(v,t,r,m,n,a))}),s},Dy=function(e){return function(){return e}},Py=function(e,n,t){for(var r=-1,i=Object(e),o=t(e),a=o.length;a--;){var s=o[++r];if(n(i[s],s,i)===!1)break}return e},Ly=function(e,n){return e&&Py(e,n,va)},Jd=function(e){return function(n,t){if(n==null)return n;if(!ko(n))return e(n,t);for(var r=n.length,i=-1,o=Object(n);++i<r&&t(o[i],i,o)!==!1;);return n}}(Ly),ms=function(e){return e},yI=function(e){return typeof e=="function"?e:ms},bI=function(e,n){return(Dn(e)?My:Jd)(e,yI(n))},xI=bI,QG=function(e,n){var t=[];return Jd(e,function(r,i,o){n(r,i,o)&&t.push(r)}),t};function ep(e){var n=-1,t=e==null?0:e.length;for(this.__data__=new Yd;++n<t;)this.add(e[n])}ep.prototype.add=ep.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},ep.prototype.has=function(e){return this.__data__.has(e)};var wI=ep,JG=function(e,n){for(var t=-1,r=e==null?0:e.length;++t<r;)if(n(e[t],t,e))return!0;return!1},EI=function(e,n){return e.has(n)},MI=function(e,n,t,r,i,o){var a=1&t,s=e.length,u=n.length;if(s!=u&&!(a&&u>s))return!1;var c=o.get(e),l=o.get(n);if(c&&l)return c==n&&l==e;var h=-1,f=!0,d=2&t?new wI:void 0;for(o.set(e,n),o.set(n,e);++h<s;){var p=e[h],g=n[h];if(r)var v=a?r(g,p,h,n,e,o):r(p,g,h,e,n,o);if(v!==void 0){if(v)continue;f=!1;break}if(d){if(!JG(n,function(m,y){if(!EI(d,y)&&(p===m||i(p,m,t,r,o)))return d.push(y)})){f=!1;break}}else if(p!==g&&!i(p,g,t,r,o)){f=!1;break}}return o.delete(e),o.delete(n),f},e9=function(e){var n=-1,t=Array(e.size);return e.forEach(function(r,i){t[++n]=[i,r]}),t},Ry=function(e){var n=-1,t=Array(e.size);return e.forEach(function(r){t[++n]=r}),t},SI=ri?ri.prototype:void 0,jy=SI?SI.valueOf:void 0,t9=function(e,n,t,r,i,o,a){switch(t){case"[object DataView]":if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)return!1;e=e.buffer,n=n.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=n.byteLength||!o(new Qd(e),new Qd(n)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Mu(+e,+n);case"[object Error]":return e.name==n.name&&e.message==n.message;case"[object RegExp]":case"[object String]":return e==n+"";case"[object Map]":var s=e9;case"[object Set]":var u=1&r;if(s||(s=Ry),e.size!=n.size&&!u)return!1;var c=a.get(e);if(c)return c==n;r|=2,a.set(e,n);var l=MI(s(e),s(n),r,i,o,a);return a.delete(e),l;case"[object Symbol]":if(jy)return jy.call(e)==jy.call(n)}return!1},n9=Object.prototype.hasOwnProperty,_I=Object.prototype.hasOwnProperty,r9=function(e,n,t,r,i,o){var a=Dn(e),s=Dn(n),u=a?"[object Array]":vs(e),c=s?"[object Array]":vs(n),l=(u=u=="[object Arguments]"?"[object Object]":u)=="[object Object]",h=(c=c=="[object Arguments]"?"[object Object]":c)=="[object Object]",f=u==c;if(f&&ds(e)){if(!ds(n))return!1;a=!0,l=!1}if(f&&!l)return o||(o=new Au),a||wl(e)?MI(e,n,t,r,i,o):t9(e,n,u,t,r,i,o);if(!(1&t)){var d=l&&_I.call(e,"__wrapped__"),p=h&&_I.call(n,"__wrapped__");if(d||p){var g=d?e.value():e,v=p?n.value():n;return o||(o=new Au),i(g,v,t,r,o)}}return!!f&&(o||(o=new Au),function(m,y,b,x,w,E){var M=1&b,_=Ay(m),k=_.length;if(k!=Ay(y).length&&!M)return!1;for(var S=k;S--;){var C=_[S];if(!(M?C in y:n9.call(y,C)))return!1}var T=E.get(m),A=E.get(y);if(T&&A)return T==y&&A==m;var D=!0;E.set(m,y),E.set(y,m);for(var j=M;++S<k;){var L=m[C=_[S]],B=y[C];if(x)var N=M?x(B,L,C,y,m,E):x(L,B,C,m,y,E);if(!(N===void 0?L===B||w(L,B,b,x,E):N)){D=!1;break}j||(j=C=="constructor")}if(D&&!j){var R=m.constructor,P=y.constructor;R==P||!("constructor"in m)||!("constructor"in y)||typeof R=="function"&&R instanceof R&&typeof P=="function"&&P instanceof P||(D=!1)}return E.delete(m),E.delete(y),D}(e,n,t,r,i,o))},kI=function e(n,t,r,i,o){return n===t||(n==null||t==null||!Ci(n)&&!Ci(t)?n!=n&&t!=t:r9(n,t,r,i,e,o))},CI=function(e){return e==e&&!Nr(e)},AI=function(e,n){return function(t){return t!=null&&t[e]===n&&(n!==void 0||e in Object(t))}},i9=function(e){var n=function(t){for(var r=va(t),i=r.length;i--;){var o=r[i],a=t[o];r[i]=[o,a,CI(a)]}return r}(e);return n.length==1&&n[0][2]?AI(n[0][0],n[0][1]):function(t){return t===e||function(r,i,o,a){var s=o.length,u=s;if(r==null)return!u;for(r=Object(r);s--;){var c=o[s];if(c[2]?c[1]!==r[c[0]]:!(c[0]in r))return!1}for(;++s<u;){var l=(c=o[s])[0],h=r[l],f=c[1];if(c[2]){if(h===void 0&&!(l in r))return!1}else{var d=new Au;if(!kI(f,h,3,a,d))return!1}}return!0}(t,0,n)}},ys=function(e){return typeof e=="symbol"||Ci(e)&&ga(e)=="[object Symbol]"},o9=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a9=/^\w*$/,By=function(e,n){if(Dn(e))return!1;var t=typeof e;return!(t!="number"&&t!="symbol"&&t!="boolean"&&e!=null&&!ys(e))||a9.test(e)||!o9.test(e)||n!=null&&e in Object(n)};function zy(e,n){if(typeof e!="function"||n!=null&&typeof n!="function")throw new TypeError("Expected a function");var t=function(){var r=arguments,i=n?n.apply(this,r):r[0],o=t.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return t.cache=o.set(i,a)||o,a};return t.cache=new(zy.Cache||Yd),t}zy.Cache=Yd;var tp,s9=zy,u9=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,c9=/\\(\\)?/g,l9=function(){var e=s9(function(t){var r=[];return t.charCodeAt(0)===46&&r.push(""),t.replace(u9,function(i,o,a,s){r.push(a?s.replace(c9,"$1"):o||i)}),r},function(t){return n.size===500&&n.clear(),t}),n=e.cache;return e}(),Nu=function(e,n){for(var t=-1,r=e==null?0:e.length,i=Array(r);++t<r;)i[t]=n(e[t],t,e);return i},II=ri?ri.prototype:void 0,TI=II?II.toString:void 0,h9=function e(n){if(typeof n=="string")return n;if(Dn(n))return Nu(n,e)+"";if(ys(n))return TI?TI.call(n):"";var t=n+"";return t=="0"&&1/n==-1/0?"-0":t},OI=function(e){return e==null?"":h9(e)},np=function(e,n){return Dn(e)?e:By(e,n)?[e]:l9(OI(e))},El=function(e){if(typeof e=="string"||ys(e))return e;var n=e+"";return n=="0"&&1/e==-1/0?"-0":n},rp=function(e,n){for(var t=0,r=(n=np(n,e)).length;e!=null&&t<r;)e=e[El(n[t++])];return t&&t==r?e:void 0},f9=function(e,n){return e!=null&&n in Object(e)},NI=function(e,n,t){for(var r=-1,i=(n=np(n,e)).length,o=!1;++r<i;){var a=El(n[r]);if(!(o=e!=null&&t(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=e==null?0:e.length)&&Sy(i)&&qd(a,i)&&(Dn(e)||Iu(e))},DI=function(e,n){return e!=null&&NI(e,n,f9)},d9=function(e,n){return By(e)&&CI(n)?AI(El(e),n):function(t){var r=function(i,o,a){var s=i==null?void 0:rp(i,o);return s===void 0?a:s}(t,e);return r===void 0&&r===n?DI(t,e):kI(n,r,3)}},PI=function(e){return function(n){return n==null?void 0:n[e]}},p9=function(e){return By(e)?PI(El(e)):function(n){return function(t){return rp(t,n)}}(e)},Co=function(e){return typeof e=="function"?e:e==null?ms:typeof e=="object"?Dn(e)?d9(e[0],e[1]):i9(e):p9(e)},LI=function(e,n){return(Dn(e)?iI:QG)(e,Co(n))},g9=Object.prototype.hasOwnProperty,v9=function(e,n){return e!=null&&g9.call(e,n)},RI=function(e,n){return e!=null&&NI(e,n,v9)},m9=Object.prototype.hasOwnProperty,jI=function(e){return e===void 0},BI=function(e,n){var t=-1,r=ko(e)?Array(e.length):[];return Jd(e,function(i,o,a){r[++t]=n(i,o,a)}),r},zI=function(e,n){return(Dn(e)?Nu:BI)(e,Co(n))},y9=function(e,n,t,r){var i=-1,o=e==null?0:e.length;for(r&&o&&(t=e[++i]);++i<o;)t=n(t,e[i],i,e);return t},b9=function(e,n,t,r,i){return i(e,function(o,a,s){t=r?(r=!1,o):n(t,o,a,s)}),t},FI=function(e,n,t){var r=Dn(e)?y9:b9,i=arguments.length<3;return r(e,Co(n),t,i,Jd)},x9=PI("length"),w9=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),Fy="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Gy="\\ud83c[\\udffb-\\udfff]",GI="[^\\ud800-\\udfff]",UI="(?:\\ud83c[\\udde6-\\uddff]){2}",XI="[\\ud800-\\udbff][\\udc00-\\udfff]",YI="(?:"+Fy+"|"+Gy+")?",E9="[\\ufe0e\\ufe0f]?"+YI+"(?:\\u200d(?:"+[GI,UI,XI].join("|")+")[\\ufe0e\\ufe0f]?"+YI+")*",M9="(?:"+[GI+Fy+"?",Fy,UI,XI,"[\\ud800-\\udfff]"].join("|")+")",WI=RegExp(Gy+"(?="+Gy+")|"+M9+E9,"g"),S9=function(e){return function(n){return w9.test(n)}(e)?function(n){for(var t=WI.lastIndex=0;WI.test(n);)++t;return t}(e):x9(e)},VI=ri?ri.isConcatSpreadable:void 0,_9=function(e){return Dn(e)||Iu(e)||!!(VI&&e&&e[VI])},Uy=function(e,n,t,r,i){var o=-1,a=e.length;for(t||(t=_9),i||(i=[]);++o<a;){var s=e[o];t(s)?Cy(i,s):r||(i[i.length]=s)}return i},HI=Math.max,qI=function(e,n,t){return n=HI(n===void 0?e.length-1:n,0),function(){for(var r=arguments,i=-1,o=HI(r.length-n,0),a=Array(o);++i<o;)a[i]=r[n+i];i=-1;for(var s=Array(n+1);++i<n;)s[i]=r[i];return s[n]=t(a),function(u,c,l){switch(l.length){case 0:return u.call(c);case 1:return u.call(c,l[0]);case 2:return u.call(c,l[0],l[1]);case 3:return u.call(c,l[0],l[1],l[2])}return u.apply(c,l)}(e,this,s)}},k9=Wd?function(e,n){return Wd(e,"toString",{configurable:!0,enumerable:!1,value:Dy(n),writable:!0})}:ms,C9=Date.now,ZI=function(e){var n=0,t=0;return function(){var r=C9(),i=16-(r-t);if(t=r,i>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}(k9),ip=function(e,n){return ZI(qI(e,n,ms),e+"")},KI=function(e,n,t,r){for(var i=e.length,o=t+-1;++o<i;)if(n(e[o],o,e))return o;return-1},A9=function(e){return e!=e},I9=function(e,n){return!(e==null||!e.length)&&function(t,r,i){return r==r?function(o,a,s){for(var u=s-1,c=o.length;++u<c;)if(o[u]===a)return u;return-1}(t,r,i):KI(t,A9,i)}(e,n,0)>-1},T9=Ou&&1/Ry(new Ou([,-0]))[1]==1/0?function(e){return new Ou(e)}:function(){},$I=function(e){return Ci(e)&&ko(e)},O9=ip(function(e){return function(n,t,r){var i=-1,o=I9,a=n.length,s=!0,u=[],c=u;if(a>=200){var l=T9(n);if(l)return Ry(l);s=!1,o=EI,c=new wI}else c=u;e:for(;++i<a;){var h=n[i],f=h;if(h=h!==0?h:0,s&&f==f){for(var d=c.length;d--;)if(c[d]===f)continue e;u.push(h)}else o(c,f,r)||(c!==u&&c.push(f),u.push(h))}return u}(Uy(e,0,$I,!0))}),QI=function(e){return e==null?[]:function(n,t){return Nu(t,function(r){return n[r]})}(e,va(e))};try{tp={clone:function(e){return mI(e,4)},constant:Dy,each:xI,filter:LI,has:RI,isArray:Dn,isEmpty:function(e){if(e==null)return!0;if(ko(e)&&(Dn(e)||typeof e=="string"||typeof e.splice=="function"||ds(e)||wl(e)||Iu(e)))return!e.length;var n=vs(e);if(n=="[object Map]"||n=="[object Set]")return!e.size;if(Kd(e))return!_y(e).length;for(var t in e)if(m9.call(e,t))return!1;return!0},isFunction:ml,isUndefined:jI,keys:va,map:zI,reduce:FI,size:function(e){if(e==null)return 0;if(ko(e))return function(t){return typeof t=="string"||!Dn(t)&&Ci(t)&&ga(t)=="[object String]"}(e)?S9(e):e.length;var n=vs(e);return n=="[object Map]"||n=="[object Set]"?e.size:_y(e).length},transform:function(e,n,t){var r=Dn(e),i=r||ds(e)||wl(e);if(n=Co(n),t==null){var o=e&&e.constructor;t=i?r?new o:[]:Nr(e)&&ml(o)?dI($d(e)):{}}return(i?My:Ly)(e,function(a,s,u){return n(t,a,s,u)}),t},union:O9,values:QI}}catch{}tp||(tp=window._);var ft=tp,Xy=on;function on(e){this._isDirected=!ft.has(e,"directed")||e.directed,this._isMultigraph=!!ft.has(e,"multigraph")&&e.multigraph,this._isCompound=!!ft.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=ft.constant(void 0),this._defaultEdgeLabelFn=ft.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function JI(e,n){e[n]?e[n]++:e[n]=1}function eT(e,n){--e[n]||delete e[n]}function Ml(e,n,t,r){var i=""+n,o=""+t;if(!e&&i>o){var a=i;i=o,o=a}return i+""+o+""+(ft.isUndefined(r)?"\0":r)}function Yy(e,n){return Ml(e,n.v,n.w,n.name)}on.prototype._nodeCount=0,on.prototype._edgeCount=0,on.prototype.isDirected=function(){return this._isDirected},on.prototype.isMultigraph=function(){return this._isMultigraph},on.prototype.isCompound=function(){return this._isCompound},on.prototype.setGraph=function(e){return this._label=e,this},on.prototype.graph=function(){return this._label},on.prototype.setDefaultNodeLabel=function(e){return ft.isFunction(e)||(e=ft.constant(e)),this._defaultNodeLabelFn=e,this},on.prototype.nodeCount=function(){return this._nodeCount},on.prototype.nodes=function(){return ft.keys(this._nodes)},on.prototype.sources=function(){var e=this;return ft.filter(this.nodes(),function(n){return ft.isEmpty(e._in[n])})},on.prototype.sinks=function(){var e=this;return ft.filter(this.nodes(),function(n){return ft.isEmpty(e._out[n])})},on.prototype.setNodes=function(e,n){var t=arguments,r=this;return ft.each(e,function(i){t.length>1?r.setNode(i,n):r.setNode(i)}),this},on.prototype.setNode=function(e,n){return ft.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=n),this):(this._nodes[e]=arguments.length>1?n:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]="\0",this._children[e]={},this._children["\0"][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},on.prototype.node=function(e){return this._nodes[e]},on.prototype.hasNode=function(e){return ft.has(this._nodes,e)},on.prototype.removeNode=function(e){var n=this;if(ft.has(this._nodes,e)){var t=function(r){n.removeEdge(n._edgeObjs[r])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],ft.each(this.children(e),function(r){n.setParent(r)}),delete this._children[e]),ft.each(ft.keys(this._in[e]),t),delete this._in[e],delete this._preds[e],ft.each(ft.keys(this._out[e]),t),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},on.prototype.setParent=function(e,n){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(ft.isUndefined(n))n="\0";else{for(var t=n+="";!ft.isUndefined(t);t=this.parent(t))if(t===e)throw new Error("Setting "+n+" as parent of "+e+" would create a cycle");this.setNode(n)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=n,this._children[n][e]=!0,this},on.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},on.prototype.parent=function(e){if(this._isCompound){var n=this._parent[e];if(n!=="\0")return n}},on.prototype.children=function(e){if(ft.isUndefined(e)&&(e="\0"),this._isCompound){var n=this._children[e];if(n)return ft.keys(n)}else{if(e==="\0")return this.nodes();if(this.hasNode(e))return[]}},on.prototype.predecessors=function(e){var n=this._preds[e];if(n)return ft.keys(n)},on.prototype.successors=function(e){var n=this._sucs[e];if(n)return ft.keys(n)},on.prototype.neighbors=function(e){var n=this.predecessors(e);if(n)return ft.union(n,this.successors(e))},on.prototype.isLeaf=function(e){return(this.isDirected()?this.successors(e):this.neighbors(e)).length===0},on.prototype.filterNodes=function(e){var n=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});n.setGraph(this.graph());var t=this;ft.each(this._nodes,function(o,a){e(a)&&n.setNode(a,o)}),ft.each(this._edgeObjs,function(o){n.hasNode(o.v)&&n.hasNode(o.w)&&n.setEdge(o,t.edge(o))});var r={};function i(o){var a=t.parent(o);return a===void 0||n.hasNode(a)?(r[o]=a,a):a in r?r[a]:i(a)}return this._isCompound&&ft.each(n.nodes(),function(o){n.setParent(o,i(o))}),n},on.prototype.setDefaultEdgeLabel=function(e){return ft.isFunction(e)||(e=ft.constant(e)),this._defaultEdgeLabelFn=e,this},on.prototype.edgeCount=function(){return this._edgeCount},on.prototype.edges=function(){return ft.values(this._edgeObjs)},on.prototype.setPath=function(e,n){var t=this,r=arguments;return ft.reduce(e,function(i,o){return r.length>1?t.setEdge(i,o,n):t.setEdge(i,o),o}),this},on.prototype.setEdge=function(){var e,n,t,r,i=!1,o=arguments[0];typeof o=="object"&&o!==null&&"v"in o?(e=o.v,n=o.w,t=o.name,arguments.length===2&&(r=arguments[1],i=!0)):(e=o,n=arguments[1],t=arguments[3],arguments.length>2&&(r=arguments[2],i=!0)),e=""+e,n=""+n,ft.isUndefined(t)||(t=""+t);var a=Ml(this._isDirected,e,n,t);if(ft.has(this._edgeLabels,a))return i&&(this._edgeLabels[a]=r),this;if(!ft.isUndefined(t)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(n),this._edgeLabels[a]=i?r:this._defaultEdgeLabelFn(e,n,t);var s=function(u,c,l,h){var f=""+c,d=""+l;if(!u&&f>d){var p=f;f=d,d=p}var g={v:f,w:d};return h&&(g.name=h),g}(this._isDirected,e,n,t);return e=s.v,n=s.w,Object.freeze(s),this._edgeObjs[a]=s,JI(this._preds[n],e),JI(this._sucs[e],n),this._in[n][a]=s,this._out[e][a]=s,this._edgeCount++,this},on.prototype.edge=function(e,n,t){var r=arguments.length===1?Yy(this._isDirected,arguments[0]):Ml(this._isDirected,e,n,t);return this._edgeLabels[r]},on.prototype.hasEdge=function(e,n,t){var r=arguments.length===1?Yy(this._isDirected,arguments[0]):Ml(this._isDirected,e,n,t);return ft.has(this._edgeLabels,r)},on.prototype.removeEdge=function(e,n,t){var r=arguments.length===1?Yy(this._isDirected,arguments[0]):Ml(this._isDirected,e,n,t),i=this._edgeObjs[r];return i&&(e=i.v,n=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],eT(this._preds[n],e),eT(this._sucs[e],n),delete this._in[n][r],delete this._out[e][r],this._edgeCount--),this},on.prototype.inEdges=function(e,n){var t=this._in[e];if(t){var r=ft.values(t);return n?ft.filter(r,function(i){return i.v===n}):r}},on.prototype.outEdges=function(e,n){var t=this._out[e];if(t){var r=ft.values(t);return n?ft.filter(r,function(i){return i.w===n}):r}},on.prototype.nodeEdges=function(e,n){var t=this.inEdges(e,n);if(t)return t.concat(this.outEdges(e,n))};var tT={Graph:Xy,version:"2.1.8"},N9={write:function(e){var n={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:D9(e),edges:P9(e)};return ft.isUndefined(e.graph())||(n.value=ft.clone(e.graph())),n},read:function(e){var n=new Xy(e.options).setGraph(e.value);return ft.each(e.nodes,function(t){n.setNode(t.v,t.value),t.parent&&n.setParent(t.v,t.parent)}),ft.each(e.edges,function(t){n.setEdge({v:t.v,w:t.w,name:t.name},t.value)}),n}};function D9(e){return ft.map(e.nodes(),function(n){var t=e.node(n),r=e.parent(n),i={v:n};return ft.isUndefined(t)||(i.value=t),ft.isUndefined(r)||(i.parent=r),i})}function P9(e){return ft.map(e.edges(),function(n){var t=e.edge(n),r={v:n.v,w:n.w};return ft.isUndefined(n.name)||(r.name=n.name),ft.isUndefined(t)||(r.value=t),r})}var nT=ii;function ii(){this._arr=[],this._keyIndices={}}ii.prototype.size=function(){return this._arr.length},ii.prototype.keys=function(){return this._arr.map(function(e){return e.key})},ii.prototype.has=function(e){return ft.has(this._keyIndices,e)},ii.prototype.priority=function(e){var n=this._keyIndices[e];if(n!==void 0)return this._arr[n].priority},ii.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},ii.prototype.add=function(e,n){var t=this._keyIndices;if(e=String(e),!ft.has(t,e)){var r=this._arr,i=r.length;return t[e]=i,r.push({key:e,priority:n}),this._decrease(i),!0}return!1},ii.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},ii.prototype.decrease=function(e,n){var t=this._keyIndices[e];if(n>this._arr[t].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[t].priority+" New: "+n);this._arr[t].priority=n,this._decrease(t)},ii.prototype._heapify=function(e){var n=this._arr,t=2*e,r=t+1,i=e;t<n.length&&(i=n[t].priority<n[i].priority?t:i,r<n.length&&(i=n[r].priority<n[i].priority?r:i),i!==e&&(this._swap(e,i),this._heapify(i)))},ii.prototype._decrease=function(e){for(var n,t=this._arr,r=t[e].priority;e!==0&&!(t[n=e>>1].priority<r);)this._swap(e,n),e=n},ii.prototype._swap=function(e,n){var t=this._arr,r=this._keyIndices,i=t[e],o=t[n];t[e]=o,t[n]=i,r[o.key]=e,r[i.key]=n};var rT=function(e,n,t,r){return function(i,o,a,s){var u,c,l={},h=new nT,f=function(d){var p=d.v!==u?d.v:d.w,g=l[p],v=a(d),m=c.distance+v;if(v<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+d+" Weight: "+v);m<g.distance&&(g.distance=m,g.predecessor=u,h.decrease(p,m))};for(i.nodes().forEach(function(d){var p=d===o?0:Number.POSITIVE_INFINITY;l[d]={distance:p},h.add(d,p)});h.size()>0&&(u=h.removeMin(),(c=l[u]).distance!==Number.POSITIVE_INFINITY);)s(u).forEach(f);return l}(e,String(n),t||L9,r||function(i){return e.outEdges(i)})},L9=ft.constant(1),iT=function(e){var n=0,t=[],r={},i=[];function o(a){var s=r[a]={onStack:!0,lowlink:n,index:n++};if(t.push(a),e.successors(a).forEach(function(l){ft.has(r,l)?r[l].onStack&&(s.lowlink=Math.min(s.lowlink,r[l].index)):(o(l),s.lowlink=Math.min(s.lowlink,r[l].lowlink))}),s.lowlink===s.index){var u,c=[];do u=t.pop(),r[u].onStack=!1,c.push(u);while(a!==u);i.push(c)}}return e.nodes().forEach(function(a){ft.has(r,a)||o(a)}),i},R9=ft.constant(1),Wy=oT;function oT(e){var n={},t={},r=[];if(ft.each(e.sinks(),function i(o){if(ft.has(t,o))throw new op;ft.has(n,o)||(t[o]=!0,n[o]=!0,ft.each(e.predecessors(o),i),delete t[o],r.push(o))}),ft.size(n)!==e.nodeCount())throw new op;return r}function op(){}oT.CycleException=op,op.prototype=new Error;var aT=function(e,n,t){ft.isArray(n)||(n=[n]);var r=(e.isDirected()?e.successors:e.neighbors).bind(e),i=[],o={};return ft.each(n,function(a){if(!e.hasNode(a))throw new Error("Graph does not have node: "+a);sT(e,a,t==="post",o,r,i)}),i};function sT(e,n,t,r,i,o){ft.has(r,n)||(r[n]=!0,t||o.push(n),ft.each(i(n),function(a){sT(e,a,t,r,i,o)}),t&&o.push(n))}var ap,j9={Graph:tT.Graph,json:N9,alg:{components:function(e){var n,t={},r=[];function i(o){ft.has(t,o)||(t[o]=!0,n.push(o),ft.each(e.successors(o),i),ft.each(e.predecessors(o),i))}return ft.each(e.nodes(),function(o){n=[],i(o),n.length&&r.push(n)}),r},dijkstra:rT,dijkstraAll:function(e,n,t){return ft.transform(e.nodes(),function(r,i){r[i]=rT(e,i,n,t)},{})},findCycles:function(e){return ft.filter(iT(e),function(n){return n.length>1||n.length===1&&e.hasEdge(n[0],n[0])})},floydWarshall:function(e,n,t){return function(r,i,o){var a={},s=r.nodes();return s.forEach(function(u){a[u]={},a[u][u]={distance:0},s.forEach(function(c){u!==c&&(a[u][c]={distance:Number.POSITIVE_INFINITY})}),o(u).forEach(function(c){var l=c.v===u?c.w:c.v,h=i(c);a[u][l]={distance:h,predecessor:u}})}),s.forEach(function(u){var c=a[u];s.forEach(function(l){var h=a[l];s.forEach(function(f){var d=h[u],p=c[f],g=h[f],v=d.distance+p.distance;v<g.distance&&(g.distance=v,g.predecessor=p.predecessor)})})}),a}(e,n||R9,t||function(r){return e.outEdges(r)})},isAcyclic:function(e){try{Wy(e)}catch(n){if(n instanceof Wy.CycleException)return!1;throw n}return!0},postorder:function(e,n){return aT(e,n,"post")},preorder:function(e,n){return aT(e,n,"pre")},prim:function(e,n){var t,r=new Xy,i={},o=new nT;function a(u){var c=u.v===t?u.w:u.v,l=o.priority(c);if(l!==void 0){var h=n(u);h<l&&(i[c]=t,o.decrease(c,h))}}if(e.nodeCount()===0)return r;ft.each(e.nodes(),function(u){o.add(u,Number.POSITIVE_INFINITY),r.setNode(u)}),o.decrease(e.nodes()[0],0);for(var s=!1;o.size()>0;){if(t=o.removeMin(),ft.has(i,t))r.setEdge(t,i[t]);else{if(s)throw new Error("Input graph is not connected: "+e);s=!0}e.nodeEdges(t).forEach(a)}return r},tarjan:iT,topsort:Wy},version:tT.version};try{ap=j9}catch{}ap||(ap=window.graphlib);var sp,Ai=ap,Sl=function(e,n,t){if(!Nr(t))return!1;var r=typeof n;return!!(r=="number"?ko(t)&&qd(n,t.length):r=="string"&&n in t)&&Mu(t[n],e)},uT=Object.prototype,B9=uT.hasOwnProperty,z9=ip(function(e,n){e=Object(e);var t=-1,r=n.length,i=r>2?n[2]:void 0;for(i&&Sl(n[0],n[1],i)&&(r=1);++t<r;)for(var o=n[t],a=ps(o),s=-1,u=a.length;++s<u;){var c=a[s],l=e[c];(l===void 0||Mu(l,uT[c])&&!B9.call(e,c))&&(e[c]=o[c])}return e}),F9=/^\s+|\s+$/g,G9=/^[-+]0x[0-9a-f]+$/i,U9=/^0b[01]+$/i,X9=/^0o[0-7]+$/i,Y9=parseInt,up=function(e){return e?(e=function(n){if(typeof n=="number")return n;if(ys(n))return NaN;if(Nr(n)){var t=typeof n.valueOf=="function"?n.valueOf():n;n=Nr(t)?t+"":t}if(typeof n!="string")return n===0?n:+n;n=n.replace(F9,"");var r=U9.test(n);return r||X9.test(n)?Y9(n.slice(2),r?2:8):G9.test(n)?NaN:+n}(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:e===0?e:0},W9=Math.max,V9=function(e){return function(n,t,r){var i=Object(n);if(!ko(n)){var o=Co(t);n=va(n),t=function(s){return o(i[s],s,i)}}var a=e(n,t,r);return a>-1?i[o?n[a]:a]:void 0}}(function(e,n,t){var r=e==null?0:e.length;if(!r)return-1;var i=t==null?0:function(o){var a=up(o),s=a%1;return a==a?s?a-s:a:0}(t);return i<0&&(i=W9(r+i,0)),KI(e,Co(n),i)}),cT=function(e){return e!=null&&e.length?Uy(e):[]},Vy=function(e,n,t){for(var r=-1,i=e.length;++r<i;){var o=e[r],a=n(o);if(a!=null&&(s===void 0?a==a&&!ys(a):t(a,s)))var s=a,u=o}return u},H9=function(e,n){return e>n},Hy=function(e,n,t){(t!==void 0&&!Mu(e[n],t)||t===void 0&&!(n in e))&&Vd(e,n,t)},q9=Function.prototype,Z9=Object.prototype,lT=q9.toString,K9=Z9.hasOwnProperty,$9=lT.call(Object),hT=function(e,n){if((n!=="constructor"||typeof e[n]!="function")&&n!="__proto__")return e[n]},Q9=function(e,n,t,r,i,o,a){var s=hT(e,t),u=hT(n,t),c=a.get(u);if(c)Hy(e,t,c);else{var l=void 0,h=l===void 0;if(h){var f=Dn(u),d=!f&&ds(u),p=!f&&!d&&wl(u);l=u,f||d||p?Dn(s)?l=s:$I(s)?l=rI(s):d?(h=!1,l=nI(u,!0)):p?(h=!1,l=hI(u,!0)):l=[]:function(g){if(!Ci(g)||ga(g)!="[object Object]")return!1;var v=$d(g);if(v===null)return!0;var m=K9.call(v,"constructor")&&v.constructor;return typeof m=="function"&&m instanceof m&&lT.call(m)==$9}(u)||Iu(u)?(l=s,Iu(s)?l=function(g){return xl(g,ps(g))}(s):Nr(s)&&!ml(s)||(l=pI(u))):h=!1}h&&(a.set(u,l),i(l,u,r,o,a),a.delete(u)),Hy(e,t,l)}},J9=function e(n,t,r,i,o){n!==t&&Py(t,function(a,s){if(o||(o=new Au),Nr(a))Q9(n,t,s,r,e,i,o);else{var u=void 0;u===void 0&&(u=a),Hy(n,s,u)}},ps)},e7=function(e){return ip(function(n,t){var r=-1,i=t.length,o=i>1?t[i-1]:void 0,a=i>2?t[2]:void 0;for(o=e.length>3&&typeof o=="function"?(i--,o):void 0,a&&Sl(t[0],t[1],a)&&(o=i<3?void 0:o,i=1),n=Object(n);++r<i;){var s=t[r];s&&e(n,s,r)}return n})}(function(e,n,t){J9(e,n,t)}),fT=function(e,n){return e<n},t7=function(e,n,t,r){if(!Nr(e))return e;for(var i=-1,o=(n=np(n,e)).length,a=o-1,s=e;s!=null&&++i<o;){var u=El(n[i]),c=t;if(u==="__proto__"||u==="constructor"||u==="prototype")return e;if(i!=a){var l=s[u];(c=void 0)==void 0&&(c=Nr(l)?l:qd(n[i+1])?[]:{})}Hd(s,u,c),s=s[u]}return e},n7=function(e,n){return function(t,r,i){for(var o=-1,a=r.length,s={};++o<a;){var u=r[o],c=rp(t,u);i(c,u)&&t7(s,np(u,t),c)}return s}(e,n,function(t,r){return DI(e,r)})},r7=function(e){return ZI(qI(e,void 0,cT),e+"")}(function(e,n){return e==null?{}:n7(e,n)}),i7=Math.ceil,o7=Math.max,a7=function(e,n,t){return t&&typeof t!="number"&&Sl(e,n,t)&&(n=t=void 0),e=up(e),n===void 0?(n=e,e=0):n=up(n),function(r,i,o){for(var a=-1,s=o7(i7((i-r)/(o||1)),0),u=Array(s);s--;)u[++a]=r,r+=o;return u}(e,n,t=t===void 0?e<n?1:-1:up(t))},s7=function(e,n){if(e!==n){var t=e!==void 0,r=e===null,i=e==e,o=ys(e),a=n!==void 0,s=n===null,u=n==n,c=ys(n);if(!s&&!c&&!o&&e>n||o&&a&&u&&!s&&!c||r&&a&&u||!t&&u||!i)return 1;if(!r&&!o&&!c&&e<n||c&&t&&i&&!r&&!o||s&&t&&i||!a&&i||!u)return-1}return 0},u7=function(e,n,t){n=n.length?Nu(n,function(o){return Dn(o)?function(a){return rp(a,o.length===1?o[0]:o)}:o}):[ms];var r=-1;n=Nu(n,Zd(Co));var i=BI(e,function(o,a,s){return{criteria:Nu(n,function(u){return u(o)}),index:++r,value:o}});return function(o,a){var s=o.length;for(o.sort(a);s--;)o[s]=o[s].value;return o}(i,function(o,a){return function(s,u,c){for(var l=-1,h=s.criteria,f=u.criteria,d=h.length,p=c.length;++l<d;){var g=s7(h[l],f[l]);if(g)return l>=p?g:g*(c[l]=="desc"?-1:1)}return s.index-u.index}(o,a,t)})},c7=ip(function(e,n){if(e==null)return[];var t=n.length;return t>1&&Sl(e,n[0],n[1])?n=[]:t>2&&Sl(n[0],n[1],n[2])&&(n=[n[0]]),u7(e,Uy(n),[])}),l7=0;try{sp={cloneDeep:function(e){return mI(e,5)},constant:Dy,defaults:z9,each:xI,filter:LI,find:V9,flatten:cT,forEach:bI,forIn:function(e,n){return e==null?e:Py(e,yI(n),ps)},has:RI,isUndefined:jI,last:function(e){var n=e==null?0:e.length;return n?e[n-1]:void 0},map:zI,mapValues:function(e,n){var t={};return n=Co(n),Ly(e,function(r,i,o){Vd(t,i,n(r,i,o))}),t},max:function(e){return e&&e.length?Vy(e,ms,H9):void 0},merge:e7,min:function(e){return e&&e.length?Vy(e,ms,fT):void 0},minBy:function(e,n){return e&&e.length?Vy(e,Co(n),fT):void 0},now:function(){return ki.Date.now()},pick:r7,range:a7,reduce:FI,sortBy:c7,uniqueId:function(e){var n=++l7;return OI(e)+n},values:QI,zipObject:function(e,n){return function(t,r,i){for(var o=-1,a=t.length,s=r.length,u={};++o<a;){var c=o<s?r[o]:void 0;i(u,t[o],c)}return u}(e||[],n||[],Hd)}}}catch{}sp||(sp=window._);var J=sp,h7=cp;function cp(){var e={};e._next=e._prev=e,this._sentinel=e}function dT(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function f7(e,n){if(e!=="_next"&&e!=="_prev")return n}cp.prototype.dequeue=function(){var e=this._sentinel,n=e._prev;if(n!==e)return dT(n),n},cp.prototype.enqueue=function(e){var n=this._sentinel;e._prev&&e._next&&dT(e),e._next=n._next,n._next._prev=e,n._next=e,e._prev=n},cp.prototype.toString=function(){for(var e=[],n=this._sentinel,t=n._prev;t!==n;)e.push(JSON.stringify(t,f7)),t=t._prev;return"["+e.join(", ")+"]"};var d7=Ai.Graph,p7=J.constant(1);function qy(e,n,t,r,i){var o=i?[]:void 0;return J.forEach(e.inEdges(r.v),function(a){var s=e.edge(a),u=e.node(a.v);i&&o.push({v:a.v,w:a.w}),u.out-=s,Zy(n,t,u)}),J.forEach(e.outEdges(r.v),function(a){var s=e.edge(a),u=a.w,c=e.node(u);c.in-=s,Zy(n,t,c)}),e.removeNode(r.v),o}function Zy(e,n,t){t.out?t.in?e[t.out-t.in+n].enqueue(t):e[e.length-1].enqueue(t):e[0].enqueue(t)}var g7=function(e){var n=e.graph().acyclicer==="greedy"?function(t,r){if(t.nodeCount()<=1)return[];var i=function(a,s){var u=new d7,c=0,l=0;J.forEach(a.nodes(),function(d){u.setNode(d,{v:d,in:0,out:0})}),J.forEach(a.edges(),function(d){var p=u.edge(d.v,d.w)||0,g=s(d),v=p+g;u.setEdge(d.v,d.w,v),l=Math.max(l,u.node(d.v).out+=g),c=Math.max(c,u.node(d.w).in+=g)});var h=J.range(l+c+3).map(function(){return new h7}),f=c+1;return J.forEach(u.nodes(),function(d){Zy(h,f,u.node(d))}),{graph:u,buckets:h,zeroIdx:f}}(t,r||p7),o=function(a,s,u){for(var c,l=[],h=s[s.length-1],f=s[0];a.nodeCount();){for(;c=f.dequeue();)qy(a,s,u,c);for(;c=h.dequeue();)qy(a,s,u,c);if(a.nodeCount()){for(var d=s.length-2;d>0;--d)if(c=s[d].dequeue()){l=l.concat(qy(a,s,u,c,!0));break}}}return l}(i.graph,i.buckets,i.zeroIdx);return J.flatten(J.map(o,function(a){return t.outEdges(a.v,a.w)}),!0)}(e,function(t){return function(r){return t.edge(r).weight}}(e)):function(t){var r=[],i={},o={};return J.forEach(t.nodes(),function a(s){J.has(o,s)||(o[s]=!0,i[s]=!0,J.forEach(t.outEdges(s),function(u){J.has(i,u.w)?r.push(u):a(u.w)}),delete i[s])}),r}(e);J.forEach(n,function(t){var r=e.edge(t);e.removeEdge(t),r.forwardName=t.name,r.reversed=!0,e.setEdge(t.w,t.v,r,J.uniqueId("rev"))})},v7=function(e){J.forEach(e.edges(),function(n){var t=e.edge(n);if(t.reversed){e.removeEdge(n);var r=t.forwardName;delete t.reversed,delete t.forwardName,e.setEdge(n.w,n.v,t,r)}})},pT=Ai.Graph,Er={addDummyNode:gT,simplify:function(e){var n=new pT().setGraph(e.graph());return J.forEach(e.nodes(),function(t){n.setNode(t,e.node(t))}),J.forEach(e.edges(),function(t){var r=n.edge(t.v,t.w)||{weight:0,minlen:1},i=e.edge(t);n.setEdge(t.v,t.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),n},asNonCompoundGraph:function(e){var n=new pT({multigraph:e.isMultigraph()}).setGraph(e.graph());return J.forEach(e.nodes(),function(t){e.children(t).length||n.setNode(t,e.node(t))}),J.forEach(e.edges(),function(t){n.setEdge(t,e.edge(t))}),n},successorWeights:function(e){var n=J.map(e.nodes(),function(t){var r={};return J.forEach(e.outEdges(t),function(i){r[i.w]=(r[i.w]||0)+e.edge(i).weight}),r});return J.zipObject(e.nodes(),n)},predecessorWeights:function(e){var n=J.map(e.nodes(),function(t){var r={};return J.forEach(e.inEdges(t),function(i){r[i.v]=(r[i.v]||0)+e.edge(i).weight}),r});return J.zipObject(e.nodes(),n)},intersectRect:function(e,n){var t,r,i=e.x,o=e.y,a=n.x-i,s=n.y-o,u=e.width/2,c=e.height/2;if(!a&&!s)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(s)*u>Math.abs(a)*c?(s<0&&(c=-c),t=c*a/s,r=c):(a<0&&(u=-u),t=u,r=u*s/a),{x:i+t,y:o+r}},buildLayerMatrix:function(e){var n=J.map(J.range(vT(e)+1),function(){return[]});return J.forEach(e.nodes(),function(t){var r=e.node(t),i=r.rank;J.isUndefined(i)||(n[i][r.order]=t)}),n},normalizeRanks:function(e){var n=J.min(J.map(e.nodes(),function(t){return e.node(t).rank}));J.forEach(e.nodes(),function(t){var r=e.node(t);J.has(r,"rank")&&(r.rank-=n)})},removeEmptyRanks:function(e){var n=J.min(J.map(e.nodes(),function(o){return e.node(o).rank})),t=[];J.forEach(e.nodes(),function(o){var a=e.node(o).rank-n;t[a]||(t[a]=[]),t[a].push(o)});var r=0,i=e.graph().nodeRankFactor;J.forEach(t,function(o,a){J.isUndefined(o)&&a%i!=0?--r:r&&J.forEach(o,function(s){e.node(s).rank+=r})})},addBorderNode:function(e,n,t,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=t,i.order=r),gT(e,"border",i,n)},maxRank:vT,partition:function(e,n){var t={lhs:[],rhs:[]};return J.forEach(e,function(r){n(r)?t.lhs.push(r):t.rhs.push(r)}),t},time:function(e,n){J.now();try{return n()}finally{}},notime:function(e,n){return n()}};function gT(e,n,t,r){var i;do i=J.uniqueId(r);while(e.hasNode(i));return t.dummy=n,e.setNode(i,t),i}function vT(e){return J.max(J.map(e.nodes(),function(n){var t=e.node(n).rank;if(!J.isUndefined(t))return t}))}var m7=function(e){e.graph().dummyChains=[],J.forEach(e.edges(),function(n){(function(t,r){var i,o,a,s=r.v,u=t.node(s).rank,c=r.w,l=t.node(c).rank,h=r.name,f=t.edge(r),d=f.labelRank;if(l!==u+1){for(t.removeEdge(r),a=0,++u;u<l;++a,++u)f.points=[],o={width:0,height:0,edgeLabel:f,edgeObj:r,rank:u},i=Er.addDummyNode(t,"edge",o,"_d"),u===d&&(o.width=f.width,o.height=f.height,o.dummy="edge-label",o.labelpos=f.labelpos),t.setEdge(s,i,{weight:f.weight},h),a===0&&t.graph().dummyChains.push(i),s=i;t.setEdge(s,c,{weight:f.weight},h)}})(e,n)})},y7=function(e){J.forEach(e.graph().dummyChains,function(n){var t,r=e.node(n),i=r.edgeLabel;for(e.setEdge(r.edgeObj,i);r.dummy;)t=e.successors(n)[0],e.removeNode(n),i.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),n=t,r=e.node(n)})},mT=function(e){var n={};J.forEach(e.sources(),function t(r){var i=e.node(r);if(J.has(n,r))return i.rank;n[r]=!0;var o=J.min(J.map(e.outEdges(r),function(a){return t(a.w)-e.edge(a).minlen}));return o!==Number.POSITIVE_INFINITY&&o!=null||(o=0),i.rank=o})},yT=function(e,n){return e.node(n.w).rank-e.node(n.v).rank-e.edge(n).minlen},b7=Ai.Graph,lp=yT,bT=function(e){var n,t,r=new b7({directed:!1}),i=e.nodes()[0],o=e.nodeCount();for(r.setNode(i,{});x7(r,e)<o;)n=w7(r,e),t=r.hasNode(n.v)?lp(e,n):-lp(e,n),E7(r,e,t);return r};function x7(e,n){return J.forEach(e.nodes(),function t(r){J.forEach(n.nodeEdges(r),function(i){var o=i.v,a=r===o?i.w:o;e.hasNode(a)||lp(n,i)||(e.setNode(a,{}),e.setEdge(r,a,{}),t(a))})}),e.nodeCount()}function w7(e,n){return J.minBy(n.edges(),function(t){if(e.hasNode(t.v)!==e.hasNode(t.w))return lp(n,t)})}function E7(e,n,t){J.forEach(e.nodes(),function(r){n.node(r).rank+=t})}var M7=yT,S7=mT,_7=Ai.alg.preorder,k7=Ai.alg.postorder,C7=Er.simplify,A7=bs;function bs(e){e=C7(e),S7(e);var n,t=bT(e);for($y(t),Ky(t,e);n=ET(t);)ST(t,e,n,MT(t,e,n))}function Ky(e,n){var t=k7(e,e.nodes());t=t.slice(0,t.length-1),J.forEach(t,function(r){(function(i,o,a){var s=i.node(a).parent;i.edge(a,s).cutvalue=xT(i,o,a)})(e,n,r)})}function xT(e,n,t){var r=e.node(t).parent,i=!0,o=n.edge(t,r),a=0;return o||(i=!1,o=n.edge(r,t)),a=o.weight,J.forEach(n.nodeEdges(t),function(s){var u,c,l=s.v===t,h=l?s.w:s.v;if(h!==r){var f=l===i,d=n.edge(s).weight;if(a+=f?d:-d,u=t,c=h,e.hasEdge(u,c)){var p=e.edge(t,h).cutvalue;a+=f?-p:p}}}),a}function $y(e,n){arguments.length<2&&(n=e.nodes()[0]),wT(e,{},1,n)}function wT(e,n,t,r,i){var o=t,a=e.node(r);return n[r]=!0,J.forEach(e.neighbors(r),function(s){J.has(n,s)||(t=wT(e,n,t,s,r))}),a.low=o,a.lim=t++,i?a.parent=i:delete a.parent,t}function ET(e){return J.find(e.edges(),function(n){return e.edge(n).cutvalue<0})}function MT(e,n,t){var r=t.v,i=t.w;n.hasEdge(r,i)||(r=t.w,i=t.v);var o=e.node(r),a=e.node(i),s=o,u=!1;o.lim>a.lim&&(s=a,u=!0);var c=J.filter(n.edges(),function(l){return u===_T(e,e.node(l.v),s)&&u!==_T(e,e.node(l.w),s)});return J.minBy(c,function(l){return M7(n,l)})}function ST(e,n,t,r){var i=t.v,o=t.w;e.removeEdge(i,o),e.setEdge(r.v,r.w,{}),$y(e),Ky(e,n),function(a,s){var u=J.find(a.nodes(),function(l){return!s.node(l).parent}),c=_7(a,u);c=c.slice(1),J.forEach(c,function(l){var h=a.node(l).parent,f=s.edge(l,h),d=!1;f||(f=s.edge(h,l),d=!0),s.node(l).rank=s.node(h).rank+(d?f.minlen:-f.minlen)})}(e,n)}function _T(e,n,t){return t.low<=n.lim&&n.lim<=t.lim}bs.initLowLimValues=$y,bs.initCutValues=Ky,bs.calcCutValue=xT,bs.leaveEdge=ET,bs.enterEdge=MT,bs.exchangeEdges=ST;var kT=mT,I7=kT;function T7(e){A7(e)}var O7=function(e){var n=Er.addDummyNode(e,"root",{},"_root"),t=function(a){var s={};function u(c,l){var h=a.children(c);h&&h.length&&J.forEach(h,function(f){u(f,l+1)}),s[c]=l}return J.forEach(a.children(),function(c){u(c,1)}),s}(e),r=J.max(J.values(t))-1,i=2*r+1;e.graph().nestingRoot=n,J.forEach(e.edges(),function(a){e.edge(a).minlen*=i});var o=function(a){return J.reduce(a.edges(),function(s,u){return s+a.edge(u).weight},0)}(e)+1;J.forEach(e.children(),function(a){CT(e,n,i,o,r,t,a)}),e.graph().nodeRankFactor=i},N7=function(e){var n=e.graph();e.removeNode(n.nestingRoot),delete n.nestingRoot,J.forEach(e.edges(),function(t){e.edge(t).nestingEdge&&e.removeEdge(t)})};function CT(e,n,t,r,i,o,a){var s=e.children(a);if(s.length){var u=Er.addBorderNode(e,"_bt"),c=Er.addBorderNode(e,"_bb"),l=e.node(a);e.setParent(u,a),l.borderTop=u,e.setParent(c,a),l.borderBottom=c,J.forEach(s,function(h){CT(e,n,t,r,i,o,h);var f=e.node(h),d=f.borderTop?f.borderTop:h,p=f.borderBottom?f.borderBottom:h,g=f.borderTop?r:2*r,v=d!==p?1:i-o[a]+1;e.setEdge(u,d,{weight:g,minlen:v,nestingEdge:!0}),e.setEdge(p,c,{weight:g,minlen:v,nestingEdge:!0})}),e.parent(a)||e.setEdge(n,u,{weight:0,minlen:i+o[a]})}else a!==n&&e.setEdge(n,a,{weight:0,minlen:t})}function AT(e,n,t,r,i,o){var a={width:0,height:0,rank:o,borderType:n},s=i[n][o-1],u=Er.addDummyNode(e,"border",a,t);i[n][o]=u,e.setParent(u,r),s&&e.setEdge(s,u,{weight:1})}var D7=function(e){var n=e.graph().rankdir.toLowerCase();n!=="lr"&&n!=="rl"||IT(e)},P7=function(e){var n=e.graph().rankdir.toLowerCase();n!=="bt"&&n!=="rl"||function(t){J.forEach(t.nodes(),function(r){Qy(t.node(r))}),J.forEach(t.edges(),function(r){var i=t.edge(r);J.forEach(i.points,Qy),J.has(i,"y")&&Qy(i)})}(e),n!=="lr"&&n!=="rl"||(function(t){J.forEach(t.nodes(),function(r){Jy(t.node(r))}),J.forEach(t.edges(),function(r){var i=t.edge(r);J.forEach(i.points,Jy),J.has(i,"x")&&Jy(i)})}(e),IT(e))};function IT(e){J.forEach(e.nodes(),function(n){TT(e.node(n))}),J.forEach(e.edges(),function(n){TT(e.edge(n))})}function TT(e){var n=e.width;e.width=e.height,e.height=n}function Qy(e){e.y=-e.y}function Jy(e){var n=e.x;e.x=e.y,e.y=n}var L7=function(e,n){for(var t=0,r=1;r<n.length;++r)t+=R7(e,n[r-1],n[r]);return t};function R7(e,n,t){for(var r=J.zipObject(t,J.map(t,function(c,l){return l})),i=J.flatten(J.map(n,function(c){return J.sortBy(J.map(e.outEdges(c),function(l){return{pos:r[l.w],weight:e.edge(l).weight}}),"pos")}),!0),o=1;o<t.length;)o<<=1;var a=2*o-1;o-=1;var s=J.map(new Array(a),function(){return 0}),u=0;return J.forEach(i.forEach(function(c){var l=c.pos+o;s[l]+=c.weight;for(var h=0;l>0;)l%2&&(h+=s[l+1]),s[l=l-1>>1]+=c.weight;u+=c.weight*h})),u}function OT(e,n,t){for(var r;n.length&&(r=J.last(n)).i<=t;)n.pop(),e.push(r.vs),t++;return t}var j7=function e(n,t,r,i){var o=n.children(t),a=n.node(t),s=a?a.borderLeft:void 0,u=a?a.borderRight:void 0,c={};s&&(o=J.filter(o,function(g){return g!==s&&g!==u}));var l=function(g,v){return J.map(v,function(m){var y=g.inEdges(m);if(y.length){var b=J.reduce(y,function(x,w){var E=g.edge(w),M=g.node(w.v);return{sum:x.sum+E.weight*M.order,weight:x.weight+E.weight}},{sum:0,weight:0});return{v:m,barycenter:b.sum/b.weight,weight:b.weight}}return{v:m}})}(n,o);J.forEach(l,function(g){if(n.children(g.v).length){var v=e(n,g.v,r,i);c[g.v]=v,J.has(v,"barycenter")&&(m=g,y=v,J.isUndefined(m.barycenter)?(m.barycenter=y.barycenter,m.weight=y.weight):(m.barycenter=(m.barycenter*m.weight+y.barycenter*y.weight)/(m.weight+y.weight),m.weight+=y.weight))}var m,y});var h=function(g,v){var m={};return J.forEach(g,function(y,b){var x=m[y.v]={indegree:0,in:[],out:[],vs:[y.v],i:b};J.isUndefined(y.barycenter)||(x.barycenter=y.barycenter,x.weight=y.weight)}),J.forEach(v.edges(),function(y){var b=m[y.v],x=m[y.w];J.isUndefined(b)||J.isUndefined(x)||(x.indegree++,b.out.push(m[y.w]))}),function(y){var b=[];function x(M){return function(_){_.merged||(J.isUndefined(_.barycenter)||J.isUndefined(M.barycenter)||_.barycenter>=M.barycenter)&&function(k,S){var C=0,T=0;k.weight&&(C+=k.barycenter*k.weight,T+=k.weight),S.weight&&(C+=S.barycenter*S.weight,T+=S.weight),k.vs=S.vs.concat(k.vs),k.barycenter=C/T,k.weight=T,k.i=Math.min(S.i,k.i),S.merged=!0}(M,_)}}function w(M){return function(_){_.in.push(M),--_.indegree==0&&y.push(_)}}for(;y.length;){var E=y.pop();b.push(E),J.forEach(E.in.reverse(),x(E)),J.forEach(E.out,w(E))}return J.map(J.filter(b,function(M){return!M.merged}),function(M){return J.pick(M,["vs","i","barycenter","weight"])})}(J.filter(m,function(y){return!y.indegree}))}(l,r);(function(g,v){J.forEach(g,function(m){m.vs=J.flatten(m.vs.map(function(y){return v[y]?v[y].vs:y}),!0)})})(h,c);var f=function(g,v){var m,y=Er.partition(g,function(S){return J.has(S,"barycenter")}),b=y.lhs,x=J.sortBy(y.rhs,function(S){return-S.i}),w=[],E=0,M=0,_=0;b.sort((m=!!v,function(S,C){return S.barycenter<C.barycenter?-1:S.barycenter>C.barycenter?1:m?C.i-S.i:S.i-C.i})),_=OT(w,x,_),J.forEach(b,function(S){_+=S.vs.length,w.push(S.vs),E+=S.barycenter*S.weight,M+=S.weight,_=OT(w,x,_)});var k={vs:J.flatten(w,!0)};return M&&(k.barycenter=E/M,k.weight=M),k}(h,i);if(s&&(f.vs=J.flatten([s,f.vs,u],!0),n.predecessors(s).length)){var d=n.node(n.predecessors(s)[0]),p=n.node(n.predecessors(u)[0]);J.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+d.order+p.order)/(f.weight+2),f.weight+=2}return f},B7=Ai.Graph,z7=Ai.Graph,F7=function(e){var n=Er.maxRank(e),t=NT(e,J.range(1,n+1),"inEdges"),r=NT(e,J.range(n-1,-1,-1),"outEdges"),i=function(l){var h={},f=J.filter(l.nodes(),function(v){return!l.children(v).length}),d=J.max(J.map(f,function(v){return l.node(v).rank})),p=J.map(J.range(d+1),function(){return[]}),g=J.sortBy(f,function(v){return l.node(v).rank});return J.forEach(g,function v(m){if(!J.has(h,m)){h[m]=!0;var y=l.node(m);p[y.rank].push(m),J.forEach(l.successors(m),v)}}),p}(e);DT(e,i);for(var o,a=Number.POSITIVE_INFINITY,s=0,u=0;u<4;++s,++u){G7(s%2?t:r,s%4>=2),i=Er.buildLayerMatrix(e);var c=L7(e,i);c<a&&(u=0,o=J.cloneDeep(i),a=c)}DT(e,o)};function NT(e,n,t){return J.map(n,function(r){return function(i,o,a){var s=function(c){for(var l;c.hasNode(l=J.uniqueId("_root")););return l}(i),u=new B7({compound:!0}).setGraph({root:s}).setDefaultNodeLabel(function(c){return i.node(c)});return J.forEach(i.nodes(),function(c){var l=i.node(c),h=i.parent(c);(l.rank===o||l.minRank<=o&&o<=l.maxRank)&&(u.setNode(c),u.setParent(c,h||s),J.forEach(i[a](c),function(f){var d=f.v===c?f.w:f.v,p=u.edge(d,c),g=J.isUndefined(p)?0:p.weight;u.setEdge(d,c,{weight:i.edge(f).weight+g})}),J.has(l,"minRank")&&u.setNode(c,{borderLeft:l.borderLeft[o],borderRight:l.borderRight[o]}))}),u}(e,r,t)})}function G7(e,n){var t=new z7;J.forEach(e,function(r){var i=r.graph().root,o=j7(r,i,t,n);J.forEach(o.vs,function(a,s){r.node(a).order=s}),function(a,s,u){var c,l={};J.forEach(u,function(h){for(var f,d,p=a.parent(h);p;){if((f=a.parent(p))?(d=l[f],l[f]=p):(d=c,c=p),d&&d!==p)return void s.setEdge(d,p);p=f}})}(r,t,o.vs)})}function DT(e,n){J.forEach(n,function(t){J.forEach(t,function(r,i){e.node(r).order=i})})}var U7=Ai.Graph;function PT(e,n,t){if(n>t){var r=n;n=t,t=r}var i=e[n];i||(e[n]=i={}),i[t]=!0}function X7(e,n,t){if(n>t){var r=n;n=t,t=r}return J.has(e[n],t)}var Y7=function(e){var n,t=Er.buildLayerMatrix(e),r=J.merge(function(a,s){var u={};return J.reduce(s,function(c,l){var h=0,f=0,d=c.length,p=J.last(l);return J.forEach(l,function(g,v){var m=function(b,x){if(b.node(x).dummy)return J.find(b.predecessors(x),function(w){return b.node(w).dummy})}(a,g),y=m?a.node(m).order:d;(m||g===p)&&(J.forEach(l.slice(f,v+1),function(b){J.forEach(a.predecessors(b),function(x){var w=a.node(x),E=w.order;!(E<h||y<E)||w.dummy&&a.node(b).dummy||PT(u,x,b)})}),f=v+1,h=y)}),l}),u}(e,t),function(a,s){var u={};function c(l,h,f,d,p){var g;J.forEach(J.range(h,f),function(v){g=l[v],a.node(g).dummy&&J.forEach(a.predecessors(g),function(m){var y=a.node(m);y.dummy&&(y.order<d||y.order>p)&&PT(u,m,g)})})}return J.reduce(s,function(l,h){var f,d=-1,p=0;return J.forEach(h,function(g,v){if(a.node(g).dummy==="border"){var m=a.predecessors(g);m.length&&(f=a.node(m[0]).order,c(h,p,v,d,f),p=v,d=f)}c(h,p,h.length,f,l.length)}),h}),u}(e,t)),i={};J.forEach(["u","d"],function(a){n=a==="u"?t:J.values(t).reverse(),J.forEach(["l","r"],function(s){s==="r"&&(n=J.map(n,function(h){return J.values(h).reverse()}));var u=(a==="u"?e.predecessors:e.successors).bind(e),c=function(h,f,d,p){var g={},v={},m={};return J.forEach(f,function(y){J.forEach(y,function(b,x){g[b]=b,v[b]=b,m[b]=x})}),J.forEach(f,function(y){var b=-1;J.forEach(y,function(x){var w=p(x);if(w.length)for(var E=((w=J.sortBy(w,function(S){return m[S]})).length-1)/2,M=Math.floor(E),_=Math.ceil(E);M<=_;++M){var k=w[M];v[x]===x&&b<m[k]&&!X7(d,x,k)&&(v[k]=x,v[x]=g[x]=g[k],b=m[k])}})}),{root:g,align:v}}(0,n,r,u),l=function(h,f,d,p,g){var v={},m=function(x,w,E,M){var _=new U7,k=x.graph(),S=function(C,T,A){return function(D,j,L){var B,N=D.node(j),R=D.node(L),P=0;if(P+=N.width/2,J.has(N,"labelpos"))switch(N.labelpos.toLowerCase()){case"l":B=-N.width/2;break;case"r":B=N.width/2}if(B&&(P+=A?B:-B),B=0,P+=(N.dummy?T:C)/2,P+=(R.dummy?T:C)/2,P+=R.width/2,J.has(R,"labelpos"))switch(R.labelpos.toLowerCase()){case"l":B=R.width/2;break;case"r":B=-R.width/2}return B&&(P+=A?B:-B),B=0,P}}(k.nodesep,k.edgesep,M);return J.forEach(w,function(C){var T;J.forEach(C,function(A){var D=E[A];if(_.setNode(D),T){var j=E[T],L=_.edge(j,D);_.setEdge(j,D,Math.max(S(x,A,T),L||0))}T=A})}),_}(h,f,d,g),y=g?"borderLeft":"borderRight";function b(x,w){for(var E=m.nodes(),M=E.pop(),_={};M;)_[M]?x(M):(_[M]=!0,E.push(M),E=E.concat(w(M))),M=E.pop()}return b(function(x){v[x]=m.inEdges(x).reduce(function(w,E){return Math.max(w,v[E.v]+m.edge(E))},0)},m.predecessors.bind(m)),b(function(x){var w=m.outEdges(x).reduce(function(M,_){return Math.min(M,v[_.w]-m.edge(_))},Number.POSITIVE_INFINITY),E=h.node(x);w!==Number.POSITIVE_INFINITY&&E.borderType!==y&&(v[x]=Math.max(v[x],w))},m.successors.bind(m)),J.forEach(p,function(x){v[x]=v[d[x]]}),v}(e,n,c.root,c.align,s==="r");s==="r"&&(l=J.mapValues(l,function(h){return-h})),i[a+s]=l})});var o=function(a,s){return J.minBy(J.values(s),function(u){var c=Number.NEGATIVE_INFINITY,l=Number.POSITIVE_INFINITY;return J.forIn(u,function(h,f){var d=function(p,g){return p.node(g).width}(a,f)/2;c=Math.max(h+d,c),l=Math.min(h-d,l)}),c-l})}(e,i);return function(a,s){var u=J.values(s),c=J.min(u),l=J.max(u);J.forEach(["u","d"],function(h){J.forEach(["l","r"],function(f){var d,p=h+f,g=a[p];if(g!==s){var v=J.values(g);(d=f==="l"?c-J.min(v):l-J.max(v))&&(a[p]=J.mapValues(g,function(m){return m+d}))}})})}(i,o),function(a,s){return J.mapValues(a.ul,function(u,c){if(s)return a[s.toLowerCase()][c];var l=J.sortBy(J.map(a,c));return(l[1]+l[2])/2})}(i,e.graph().align)},W7=Er.normalizeRanks,V7=Er.removeEmptyRanks,ma=Er,H7=Ai.Graph,q7=["nodesep","edgesep","ranksep","marginx","marginy"],Z7={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},K7=["acyclicer","ranker","rankdir","align"],$7=["width","height"],Q7={width:0,height:0},J7=["minlen","weight","width","height","labeloffset"],eU={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},tU=["labelpos"];function e1(e,n){return J.mapValues(J.pick(e,n),Number)}function t1(e){var n={};return J.forEach(e,function(t,r){n[r.toLowerCase()]=t}),n}Ai.Graph;var LT={graphlib:Ai,layout:function(e,n){var t=n&&n.debugTiming?ma.time:ma.notime;t("layout",function(){var r=t("  buildLayoutGraph",function(){return function(i){var o=new H7({multigraph:!0,compound:!0}),a=t1(i.graph());return o.setGraph(J.merge({},Z7,e1(a,q7),J.pick(a,K7))),J.forEach(i.nodes(),function(s){var u=t1(i.node(s));o.setNode(s,J.defaults(e1(u,$7),Q7)),o.setParent(s,i.parent(s))}),J.forEach(i.edges(),function(s){var u=t1(i.edge(s));o.setEdge(s,J.merge({},eU,e1(u,J7),J.pick(u,tU)))}),o}(e)});t("  runLayout",function(){(function(i,o){o("    makeSpaceForEdgeLabels",function(){(function(a){var s=a.graph();s.ranksep/=2,J.forEach(a.edges(),function(u){var c=a.edge(u);c.minlen*=2,c.labelpos.toLowerCase()!=="c"&&(s.rankdir==="TB"||s.rankdir==="BT"?c.width+=c.labeloffset:c.height+=c.labeloffset)})})(i)}),o("    removeSelfEdges",function(){(function(a){J.forEach(a.edges(),function(s){if(s.v===s.w){var u=a.node(s.v);u.selfEdges||(u.selfEdges=[]),u.selfEdges.push({e:s,label:a.edge(s)}),a.removeEdge(s)}})})(i)}),o("    acyclic",function(){g7(i)}),o("    nestingGraph.run",function(){O7(i)}),o("    rank",function(){(function(a){switch(a.graph().ranker){case"network-simplex":default:T7(a);break;case"tight-tree":(function(s){kT(s),bT(s)})(a);break;case"longest-path":I7(a)}})(ma.asNonCompoundGraph(i))}),o("    injectEdgeLabelProxies",function(){(function(a){J.forEach(a.edges(),function(s){var u=a.edge(s);if(u.width&&u.height){var c=a.node(s.v),l={rank:(a.node(s.w).rank-c.rank)/2+c.rank,e:s};ma.addDummyNode(a,"edge-proxy",l,"_ep")}})})(i)}),o("    removeEmptyRanks",function(){V7(i)}),o("    nestingGraph.cleanup",function(){N7(i)}),o("    normalizeRanks",function(){W7(i)}),o("    assignRankMinMax",function(){(function(a){var s=0;J.forEach(a.nodes(),function(u){var c=a.node(u);c.borderTop&&(c.minRank=a.node(c.borderTop).rank,c.maxRank=a.node(c.borderBottom).rank,s=J.max(s,c.maxRank))}),a.graph().maxRank=s})(i)}),o("    removeEdgeLabelProxies",function(){(function(a){J.forEach(a.nodes(),function(s){var u=a.node(s);u.dummy==="edge-proxy"&&(a.edge(u.e).labelRank=u.rank,a.removeNode(s))})})(i)}),o("    normalize.run",function(){m7(i)}),o("    parentDummyChains",function(){(function(a){var s=function(u){var c={},l=0;return J.forEach(u.children(),function h(f){var d=l;J.forEach(u.children(f),h),c[f]={low:d,lim:l++}}),c}(a);J.forEach(a.graph().dummyChains,function(u){for(var c=a.node(u),l=c.edgeObj,h=function(m,y,b,x){var w,E,M=[],_=[],k=Math.min(y[b].low,y[x].low),S=Math.max(y[b].lim,y[x].lim);w=b;do w=m.parent(w),M.push(w);while(w&&(y[w].low>k||S>y[w].lim));for(E=w,w=x;(w=m.parent(w))!==E;)_.push(w);return{path:M.concat(_.reverse()),lca:E}}(a,s,l.v,l.w),f=h.path,d=h.lca,p=0,g=f[p],v=!0;u!==l.w;){if(c=a.node(u),v){for(;(g=f[p])!==d&&a.node(g).maxRank<c.rank;)p++;g===d&&(v=!1)}if(!v){for(;p<f.length-1&&a.node(g=f[p+1]).minRank<=c.rank;)p++;g=f[p]}a.setParent(u,g),u=a.successors(u)[0]}})})(i)}),o("    addBorderSegments",function(){(function(a){J.forEach(a.children(),function s(u){var c=a.children(u),l=a.node(u);if(c.length&&J.forEach(c,s),J.has(l,"minRank")){l.borderLeft=[],l.borderRight=[];for(var h=l.minRank,f=l.maxRank+1;h<f;++h)AT(a,"borderLeft","_bl",u,l,h),AT(a,"borderRight","_br",u,l,h)}})})(i)}),o("    order",function(){F7(i)}),o("    insertSelfEdges",function(){(function(a){var s=ma.buildLayerMatrix(a);J.forEach(s,function(u){var c=0;J.forEach(u,function(l,h){var f=a.node(l);f.order=h+c,J.forEach(f.selfEdges,function(d){ma.addDummyNode(a,"selfedge",{width:d.label.width,height:d.label.height,rank:f.rank,order:h+ ++c,e:d.e,label:d.label},"_se")}),delete f.selfEdges})})})(i)}),o("    adjustCoordinateSystem",function(){D7(i)}),o("    position",function(){(function(a){(function(s){var u=Er.buildLayerMatrix(s),c=s.graph().ranksep,l=0;J.forEach(u,function(h){var f=J.max(J.map(h,function(d){return s.node(d).height}));J.forEach(h,function(d){s.node(d).y=l+f/2}),l+=f+c})})(a=Er.asNonCompoundGraph(a)),J.forEach(Y7(a),function(s,u){a.node(u).x=s})})(i)}),o("    positionSelfEdges",function(){(function(a){J.forEach(a.nodes(),function(s){var u=a.node(s);if(u.dummy==="selfedge"){var c=a.node(u.e.v),l=c.x+c.width/2,h=c.y,f=u.x-l,d=c.height/2;a.setEdge(u.e,u.label),a.removeNode(s),u.label.points=[{x:l+2*f/3,y:h-d},{x:l+5*f/6,y:h-d},{x:l+f,y:h},{x:l+5*f/6,y:h+d},{x:l+2*f/3,y:h+d}],u.label.x=u.x,u.label.y=u.y}})})(i)}),o("    removeBorderNodes",function(){(function(a){J.forEach(a.nodes(),function(s){if(a.children(s).length){var u=a.node(s),c=a.node(u.borderTop),l=a.node(u.borderBottom),h=a.node(J.last(u.borderLeft)),f=a.node(J.last(u.borderRight));u.width=Math.abs(f.x-h.x),u.height=Math.abs(l.y-c.y),u.x=h.x+u.width/2,u.y=c.y+u.height/2}}),J.forEach(a.nodes(),function(s){a.node(s).dummy==="border"&&a.removeNode(s)})})(i)}),o("    normalize.undo",function(){y7(i)}),o("    fixupEdgeLabelCoords",function(){(function(a){J.forEach(a.edges(),function(s){var u=a.edge(s);if(J.has(u,"x"))switch(u.labelpos!=="l"&&u.labelpos!=="r"||(u.width-=u.labeloffset),u.labelpos){case"l":u.x-=u.width/2+u.labeloffset;break;case"r":u.x+=u.width/2+u.labeloffset}})})(i)}),o("    undoCoordinateSystem",function(){P7(i)}),o("    translateGraph",function(){(function(a){var s=Number.POSITIVE_INFINITY,u=0,c=Number.POSITIVE_INFINITY,l=0,h=a.graph(),f=h.marginx||0,d=h.marginy||0;function p(g){var v=g.x,m=g.y,y=g.width,b=g.height;s=Math.min(s,v-y/2),u=Math.max(u,v+y/2),c=Math.min(c,m-b/2),l=Math.max(l,m+b/2)}J.forEach(a.nodes(),function(g){p(a.node(g))}),J.forEach(a.edges(),function(g){var v=a.edge(g);J.has(v,"x")&&p(v)}),s-=f,c-=d,J.forEach(a.nodes(),function(g){var v=a.node(g);v.x-=s,v.y-=c}),J.forEach(a.edges(),function(g){var v=a.edge(g);J.forEach(v.points,function(m){m.x-=s,m.y-=c}),J.has(v,"x")&&(v.x-=s),J.has(v,"y")&&(v.y-=c)}),h.width=u-s+f,h.height=l-c+d})(i)}),o("    assignNodeIntersects",function(){(function(a){J.forEach(a.edges(),function(s){var u,c,l=a.edge(s),h=a.node(s.v),f=a.node(s.w);l.points?(u=l.points[0],c=l.points[l.points.length-1]):(l.points=[],u=f,c=h),l.points.unshift(ma.intersectRect(h,u)),l.points.push(ma.intersectRect(f,c))})})(i)}),o("    reversePoints",function(){(function(a){J.forEach(a.edges(),function(s){var u=a.edge(s);u.reversed&&u.points.reverse()})})(i)}),o("    acyclic.undo",function(){v7(i)})})(r,t)}),t("  updateInputGraph",function(){(function(i,o){J.forEach(i.nodes(),function(a){var s=i.node(a),u=o.node(a);s&&(s.x=u.x,s.y=u.y,o.children(a).length&&(s.width=u.width,s.height=u.height))}),J.forEach(i.edges(),function(a){var s=i.edge(a),u=o.edge(a);s.points=u.points,J.has(u,"x")&&(s.x=u.x,s.y=u.y)}),i.graph().width=o.graph().width,i.graph().height=o.graph().height})(e,r)})})}},nU=LT.graphlib,rU=LT.layout;class iU{constructor(n){this.cardinality=1,this.include=ls.UNSPECIFIED,this.isGroupNode=!1,this.parentNode=null,this.type=Or.NODE,this.name=n.name,this.attr=n.attr||{},this.inputs=n.inputs,this.path=n.path||[],this.width=n.width,this.height=n.height}}class oU{constructor(){this.nodes={},this.edges=[],this.nodes={},this.edges=[]}}class aU{constructor(n,t={}){this.attr=null,this.bridgeGraph=null,this.cardinality=0,this.depth=1,this.include=ls.UNSPECIFIED,this.isGroupNode=!0,this.parentNode=null,this.type=Or.META,this.path=[],this.name=n,this.metaGraph=n1(n,Eu.META,t)}getFirstChild(){return this.metaGraph.node(this.metaGraph.nodes()[0])}getChildren(){return this.metaGraph.nodes().map(n=>this.metaGraph.node(n))}leaves(){let n,t=[],r=[this];for(;r.length;){let i=r.shift();i.isGroupNode?(n=i.metaGraph,n.nodes().forEach(o=>r.push(n.node(o)))):t.push(i.name)}return t}}class sU{constructor(n,t){this.v=n,this.w=t,this.baseEdgeList=[],this.inbound=null,this.name=null}addBaseEdge(n,t){this.baseEdgeList.push(n)}}function RT(e,n={}){return new aU(e,n)}function jT(e,n){return new sU(e,n)}function n1(e,n,t){const r=t||{},i=new nU.Graph(r);return i.setGraph({name:e,rankdir:r.rankdir,type:n,align:r.align}),i}class uU{constructor(n={}){this.graphOptions=n,this.index={},this.graphOptions.compound=!0,this.root=RT(wu,this.graphOptions),this.index[wu]=this.root}getNodeMap(){return this.index}node(n){return this.index[n]}setNode(n,t){this.index[n]=t}getBridgeGraph(n){const t=this.index[n];if(!t)throw Error("Could not find node in hierarchy: "+n);if(!("metaGraph"in t))return null;const r=t;if(r.bridgeGraph)return r.bridgeGraph;const i=n1(YA,Eu.BRIDGE,this.graphOptions);if(r.bridgeGraph=i,!t.parentNode||!("metaGraph"in t.parentNode))return i;const o=t.parentNode;return[o.metaGraph,this.getBridgeGraph(o.name)].forEach(a=>{a.edges().filter(s=>s.v===n||s.w===n).forEach(s=>{const u=s.w===n;a.edge(s).baseEdgeList.forEach(c=>{const[l,h]=u?[c.w,s.v]:[c.v,s.w],f=this.getChildName(n,l),d={v:u?h:f,w:u?f:h};let p=i.edge(d);p||(p=jT(d.v,d.w),p.inbound=u,i.setEdge(d.v,d.w,p)),p.addBaseEdge(c,this)})})}),i}getChildName(n,t){let r=this.index[t];for(;r;){if(r.parentNode&&r.parentNode.name===n)return r.name;r=r.parentNode}throw Error("Could not find immediate child for descendant: "+t)}getPredecessors(n){const t=this.index[n];if(!t)throw Error("Could not find node with name: "+n);return this.getOneWayEdges(t,!0)}getSuccessors(n){const t=this.index[n];if(!t)throw Error("Could not find node with name: "+n);return this.getOneWayEdges(t,!1)}getOneWayEdges(n,t){const r=[];if(!n.parentNode||!n.parentNode.isGroupNode)return r;const i=n.parentNode,o=i.metaGraph,a=this.getBridgeGraph(i.name);return BT(o,n,t,r),BT(a,n,t,r),r}}function BT(e,n,t,r){(t?e.inEdges(n.name):e.outEdges(n.name)).forEach(i=>{const o=e.edge(i);r.push(o)})}class cU{constructor(n){this.hierarchy=n,this.index={},this.hasSubHierarchy={},this.root=new FT(this.hierarchy.root,this.hierarchy.graphOptions),this.index[n.root.name]=this.root,this.buildSubHierarchy(n.root.name),this.root.expanded=!0}getRenderInfoNodes(){return Object.values(this.index)}getSubHierarchy(){return this.hasSubHierarchy}buildSubHierarchy(n){if(n in this.hasSubHierarchy)return;this.hasSubHierarchy[n]=!0;const t=this.index[n];if(t.node.type!==Or.META)return;const r=t,i=r.node.metaGraph,o=r.coreGraph;i.nodes().forEach(l=>{const h=this.getOrCreateRenderNodeByName(l);o.setNode(l,h)}),i.edges().forEach(l=>{const h=i.edge(l),f=new zT(h);o.setEdge(l.v,l.w,f)});const a=r.node.parentNode;if(!a)return;const s=this.getRenderNodeByName(a.name),u=(l,...h)=>h.concat([l?"IN":"OUT"]).join("~~"),c=this.hierarchy.getBridgeGraph(n);c.edges().forEach(l=>{const h=c.edge(l),f=!!i.node(l.w),[d,p]=f?[l.w,l.v]:[l.v,l.w],g=w=>{const E=f?{v:w,w:n}:{v:n,w};return s.coreGraph.edge(E)};let v=g(p);v||(v=g(u(f,p,a.name)));const m=u(f,n),y=u(f,p,n);let b=o.node(y);if(!b){let w=o.node(m);if(!w){const M={name:m,type:Or.BRIDGE,isGroupNode:!1,cardinality:0,parentNode:null,include:ls.UNSPECIFIED,inbound:f,attr:{}};w=new hp(M),this.index[m]=w,o.setNode(m,w)}const E={name:y,type:Or.BRIDGE,isGroupNode:!1,cardinality:1,parentNode:null,include:ls.UNSPECIFIED,inbound:f,attr:{}};b=new hp(E),this.index[y]=b,o.setNode(y,b),o.setParent(y,m),w.node.cardinality++}const x=new zT(h);x.adjoiningMetaEdge=v,f?o.setEdge(y,d,x):o.setEdge(d,y,x)})}getOrCreateRenderNodeByName(n){if(!n)return null;if(n in this.index)return this.index[n];const t=this.getNodeByName(n);return t?(this.index[n]=t.isGroupNode?new FT(t,this.hierarchy.graphOptions):new hp(t),this.index[n]):null}getRenderNodeByName(n){return this.index[n]}getNodeByName(n){return this.hierarchy.node(n)}}class hp{constructor(n){this.node=n,this.expanded=!1,this.x=0,this.y=0,this.coreBox={width:0,height:0},this.outboxWidth=0,this.labelOffset=0,this.radius=0,this.labelHeight=0,this.paddingTop=0,this.paddingLeft=0,this.paddingRight=0,this.paddingBottom=0,this.width=n.width||0,this.height=n.height||0,this.displayName=n.name,this.attr=n.attr}}class zT{constructor(n){this.metaEdge=n,this.adjoiningMetaEdge=null,this.weight=1,this.points=[]}}class FT extends hp{constructor(n,t){super(n);const r=n.metaGraph.graph();t.compound=!0,this.coreGraph=n1(r.name,Eu.CORE,t)}}function GT(e,n){e.node.isGroupNode&&function(t,r){const i=by(r);t.coreGraph.nodes().map(o=>t.coreGraph.node(o)).forEach(o=>{var a,s,u,c,l,h;const{height:f,width:d}=o;switch(o.node.type){case Or.NODE:Object.assign(o,i.nodeSize.node),o.height=f||i.nodeSize.node.height,o.width=d||i.nodeSize.node.width;break;case Or.BRIDGE:Object.assign(o,i.nodeSize.bridge);break;case Or.META:o.expanded?GT(o,r):(Object.assign(o,i.nodeSize.meta),o.height=i.nodeSize.meta.height,o.width=i.nodeSize.meta.width);break;default:throw Error("Unrecognized node type: "+o.node.type)}if(!o.expanded){const p=o.attr;(function(g,v=!1){if(g.coreBox.width=g.width,g.coreBox.height=g.height,!v){const m=`${g.displayName}`.length,y=3;g.width=Math.max(g.coreBox.width,m*y)}})(o,r&&(o.node.type===0&&!!(!((s=(a=r==null?void 0:r.nodeSize)===null||a===void 0?void 0:a.meta)===null||s===void 0)&&s.width)||o.node.type===1&&(!!(!((c=(u=r==null?void 0:r.nodeSize)===null||u===void 0?void 0:u.node)===null||c===void 0)&&c.width)||!!p.width)||o.node.type===2&&!!(!((h=(l=r==null?void 0:r.nodeSize)===null||l===void 0?void 0:l.bridge)===null||h===void 0)&&h.width)))}})}(e,n),e.node.type===Or.META&&function(t,r){const i=by(r),o=i.subScene.meta;Object.assign(t,o);const{nodeSep:a,rankSep:s,edgeSep:u,align:c}=i.graph.meta,l={nodesep:a,ranksep:s,edgesep:u,align:c};Object.assign(t.coreBox,function(d,p){const{ranksep:g,nodesep:v,edgesep:m,align:y}=p;Object.assign(d.graph(),{ranksep:g,nodesep:v,edgesep:m,align:y});const b=[];if(d.nodes().forEach(_=>{d.node(_).node.type!==Or.BRIDGE&&b.push(_)}),!b.length)return{width:0,height:0};rU(d);let x=1/0,w=1/0,E=-1/0,M=-1/0;return b.forEach(_=>{const k=d.node(_),S=.5*k.width,C=k.x-S,T=k.x+S;x=C<x?C:x,E=T>E?T:E;const A=.5*k.height,D=k.y-A,j=k.y+A;w=D<w?D:w,M=j>M?j:M}),d.edges().forEach(_=>{const k=d.edge(_),S=d.node(k.metaEdge.v),C=d.node(k.metaEdge.w);if(k.points.length===3&&function(D){let j=UT(D[0],D[1]);for(let L=1;L<D.length-1;L++){const B=UT(D[L],D[L+1]);if(Math.abs(B-j)>1)return!1;j=B}return!0}(k.points)){if(S!=null){const D=S.expanded?S.x:r1(S);k.points[0].x=D}if(C!=null){const D=C.expanded?C.x:r1(C);k.points[2].x=D}k.points=[k.points[0],k.points[1]]}const T=k.points[k.points.length-2];C!=null&&(k.points[k.points.length-1]=XT(T,C));const A=k.points[1];S!=null&&(k.points[0]=XT(A,S)),k.points.forEach(D=>{x=D.x<x?D.x:x,E=D.x>E?D.x:E,w=D.y<w?D.y:w,M=D.y>M?D.y:M})}),d.nodes().forEach(_=>{const k=d.node(_);k.x-=x,k.y-=w}),d.edges().forEach(_=>{d.edge(_).points.forEach(k=>{k.x-=x,k.y-=w})}),{width:E-x,height:M-w}}(t.coreGraph,l));let h=0;t.coreGraph.nodeCount()>0&&h++;const f=h<=1?0:h;t.coreBox.width+=f+f,t.coreBox.height=o.labelHeight+t.coreBox.height,t.width=t.coreBox.width+o.paddingLeft+o.paddingRight,t.height=t.paddingTop+t.coreBox.height+t.paddingBottom}(e,n)}function UT(e,n){const t=n.x-e.x,r=n.y-e.y;return 180*Math.atan(r/t)/Math.PI}function r1(e){return e.expanded?e.x:e.x-e.width/2+0+e.coreBox.width/2}function XT(e,n){const t=n.expanded?n.x:r1(n),r=n.y,i=e.x-t,o=e.y-r;let a,s,u=n.expanded?n.width:n.coreBox.width,c=n.expanded?n.height:n.coreBox.height;return Math.abs(o)*u/2>Math.abs(i)*c/2?(o<0&&(c=-c),a=o===0?0:c/2*i/o,s=c/2):(i<0&&(u=-u),a=u/2,s=i===0?0:u/2*o/i),{x:t+a,y:r+s}}function YT(e){const n=e.coreGraph.nodes().map(r=>e.coreGraph.node(r));return Object.assign(Object.assign({},WT(e)),{expanded:e.expanded,nodes:e.expanded?(t=n,t.map(r=>r.node.type===Or.META?YT(r):WT(r))):[],edges:e.expanded?lU(e):[]});var t}function WT(e){return{id:e.node.name,name:e.node.name,type:e.node.type,cardinality:e.node.cardinality,attr:e.attr,parentNodeName:e.node.parentNode?e.node.parentNode.name:null,coreBox:Object.assign({},e.coreBox),x:e.x,y:e.y,width:e.width,height:e.height,radius:e.radius,labelHeight:e.labelHeight,labelOffset:e.labelOffset,outboxWidth:e.outboxWidth,paddingLeft:e.paddingLeft,paddingTop:e.paddingTop,paddingRight:e.paddingRight,paddingBottom:e.paddingBottom,path:e.node.path}}function lU(e){return e.coreGraph.edges().map(n=>({renderInfoEdge:e.coreGraph.edge(n),edge:n})).filter(({renderInfoEdge:n})=>n.metaEdge).map(({edge:n,renderInfoEdge:t})=>{const r=function(i,o){const a=o.points.map(s=>Object.assign({},s));if(o.adjoiningMetaEdge){const s=o.adjoiningMetaEdge.points,u=o.metaEdge.inbound,c=u?s[s.length-1]:s[0],l=a[u?0:a.length-1],h=i.x-i.width/2,f=i.y-i.height/2,d=c.x-h,p=c.y-f,g=-i.paddingLeft,v=-(i.paddingTop+i.labelHeight);l.x=d+g,l.y=p+v}return a}(e,t);return{adjoiningEdge:t.adjoiningMetaEdge?{w:t.adjoiningMetaEdge.metaEdge.w,v:t.adjoiningMetaEdge.metaEdge.v}:null,inbound:t.metaEdge.inbound,w:n.w,v:n.v,points:r,weight:t.weight,baseEdgeList:t.metaEdge.baseEdgeList,parentNodeName:e.node.name}})}const hU=Object.freeze(Object.defineProperty({__proto__:null,BRIDGE_GRAPH_NAME:YA,get GraphType(){return Eu},get HierarchyNodeType(){return xy},get InclusionType(){return ls},LAYOUT_CONFIG:zd,get NodeType(){return Or},ROOT_NAME:wu,buildGraph:function(e,n,t){var r,i,o,a;const s=e.nodes.filter((h,f,d)=>d.findIndex(p=>p.id===h.id)!==f).map(h=>h.id);if(s.length)throw new Error(`Duplicated ids found: ${s.join(", ")}`);const u=function(h){const f={nodes:[]},d=h.compound,p=Object.keys(d||{}),g=new Map,v=(y,b=[])=>{if(g.has(y))return g.get(y);for(let x=0;x<p.length;x++){let w=p[x];if(d&&d[w].indexOf(y)!==-1)return b.unshift(w),v(w,b)}return b.length===0&&g.set(y,b),b},m=y=>h.edges.filter(b=>b.w===y).map(b=>({name:b.v}));return h.nodes.forEach(y=>{const b=y.id,x=[...v(b),b];let w=m(b);f.nodes.push({name:b,path:x,inputs:w,width:y.width,height:y.height,attr:Object.assign({},y)})}),f}(e),c=function(h,f){const d=(g,v)=>{for(let m of v.values())if(m.includes(g))return!0;return!1},p=(g,v=[])=>{if(Object.keys(g).length===0)return[...new Set(v)];const m=new Map(Object.keys(g).map(b=>[b,g[b]])),y={};for(let[b,x]of m)d(b,m)?y[b]=x:v=v.concat(b,x);return p(y,v)};return p(h).filter(g=>f.includes(g))}(e.compound||{},(n==null?void 0:n.expanded)||[]),l=function(h,f){return function(d){return new cU(d)}(function(d,p){const{rankDirection:g,align:v}=p,m=new uU({rankdir:g,align:v});return function(y,b){Object.keys(b.nodes).forEach(x=>{const w=b.nodes[x],E=w.path;let M=y.root;M.depth=Math.max(E.length,M.depth);for(let _=0;_<E.length&&(M.depth=Math.max(M.depth,E.length-_),M.cardinality+=w.cardinality,_!==E.length-1);_++){const k=E[_];let S=y.node(k);S||(S=RT(k,y.graphOptions),S.path=w.path.slice(0,_+1),S.parentNode=M,y.setNode(k,S),M.metaGraph.setNode(k,S)),M=S}y.setNode(w.name,w),w.parentNode=M,M.metaGraph.setNode(w.name,w)})}(m,d),function(y,b){const x=y.getNodeMap();let w=[],E=[];const M=(_,k)=>{let S=0;for(;_;)k[S++]=_.name,_=_.parentNode;return S-1};b.edges.forEach(_=>{w=[],E=[];let k=M(b.nodes[_.v],w),S=M(b.nodes[_.w],E);for(;w[k]===E[S];)if(k--,S--,k<0||S<0)throw Error("No difference found between ancestor paths.");const C=x[w[k+1]],T=w[k],A=E[S];let D=C.metaGraph.edge(T,A);D||(D=jT(T,A),C.metaGraph.setEdge(T,A,D)),D.addBaseEdge(_,y)})}(m,d),m}(function(d){const p=new oU;return d.nodes.map(g=>new iU(g)).forEach(g=>{p.nodes[g.name]=g,g.inputs.forEach(v=>{(function(m,y,b){b.name!==y.name&&m.edges.push(Object.assign(Object.assign({},b.attr),{v:b.name,w:y.name}))})(p,g,v)})}),p}(h),f))}(u,{rankDirection:((i=(r=t==null?void 0:t.graph)===null||r===void 0?void 0:r.meta)===null||i===void 0?void 0:i.rankDir)||(n==null?void 0:n.rankDirection)||zd.graph.meta.rankDir,align:((a=(o=t==null?void 0:t.graph)===null||o===void 0?void 0:o.meta)===null||a===void 0?void 0:a.align)||zd.graph.meta.align});return function(h,f){f.forEach(d=>{const p=h.getRenderInfoNodes().find(m=>m.displayName===d);let g=p&&p.node&&p.node.name||"";const v=h.getRenderNodeByName(g);if(!v)throw new Error(`No nodes found: ${g}`);v.expanded=!0,h.buildSubHierarchy(g)})}(l,c),GT(l.root,t),YT(l.root)},flatGraph:function(e,n=!1){const t=JSON.parse(JSON.stringify(e)),r={nodes:[t],edges:[...t.edges]};return t.nodes.forEach(function i(o){(o.type===0||o.type===1)&&r.nodes.push(o),o.type===0&&(r.edges=r.edges.concat(o.edges)),Array.isArray(o.nodes)&&o.nodes.forEach(i)}),n&&r.nodes.forEach(i=>{const o=r.nodes.find(a=>a.id===i.parentNodeName);if(o){const a=o.x-o.width/2+o.paddingLeft,s=o.y-o.height/2+o.labelHeight+o.paddingTop;o.id!==wu&&(i.x+=a,i.y+=s),i.type===0&&i.edges.forEach(u=>{u.points.forEach(c=>{c.x+=i.x-i.width/2+i.paddingLeft,c.y+=i.y-i.height/2+i.labelHeight+i.paddingTop})})}}),r},getEdges:function(e,n,t,r){var i,o;let a=[];const s=((i=t.find(h=>h.id===e))===null||i===void 0?void 0:i.path)||[],u=((o=t.find(h=>h.id===n))===null||o===void 0?void 0:o.path)||[],c=[wu,...s].slice(0,s.length).reverse(),l=[wu,...u].slice(0,u.length);return c.forEach(h=>{const f=t.find(d=>d.id===h);a=a.concat(f.edges.filter(d=>d.baseEdgeList.some(p=>p.v===((r==null?void 0:r.v)||e)&&p.w===((r==null?void 0:r.w)||n))))}),l.filter(h=>!c.includes(h)).forEach(h=>{const f=t.find(d=>d.id===h);a=a.concat(f.edges.filter(d=>d.baseEdgeList.some(p=>p.v===((r==null?void 0:r.v)||e)&&p.w===((r==null?void 0:r.w)||n))))}),a},mergeConfig:by},Symbol.toStringTag,{value:"Module"})),fU=ji(hU);var dU=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ii=xe&&xe.__assign||function(){return Ii=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},Ii.apply(this,arguments)},Du=xe&&xe.__spreadArray||function(e,n,t){if(t||arguments.length===2)for(var r,i=0,o=n.length;i<o;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))};Object.defineProperty(gl,"__esModule",{value:!0}),gl.DagreCompoundLayout=void 0;var pU=Nn,oi=fU,fp=_n(),gU=function(e){function n(t){var r=e.call(this)||this;return r.rankdir="TB",r.nodesep=50,r.edgesep=5,r.ranksep=50,r.controlPoints=!0,r.anchorPoint=!0,r.nodes=[],r.edges=[],r.combos=[],r.onLayoutEnd=function(){},r.updateCfg(t),r}return dU(n,e),n.prototype.getDefaultCfg=function(){return{rankdir:"TB",align:void 0,begin:void 0,nodeSize:void 0,nodesep:50,ranksep:50,controlPoints:!0,anchorPoint:!0}},n.prototype.init=function(t){var r=t.hiddenNodes||[],i=t.hiddenEdges||[],o=t.hiddenCombos||[];this.nodes=this.getDataByOrder((t.nodes||[]).concat(r)),this.edges=this.getDataByOrder((t.edges||[]).concat(i)),this.combos=(t.combos||[]).concat(o.map(function(a){return Ii(Ii({},a),{collapsed:!0})}))},n.prototype.execute=function(){var t=this,r=t.nodes,i=t.edges;if(r){var o=t.getLayoutConfig(),a=o.graphDef,s=o.graphOption,u=o.graphSettings,c=(0,oi.buildGraph)(a,s,u),l=(0,oi.flatGraph)(c,!0);return this.updatePosition(l),t.onLayoutEnd&&t.onLayoutEnd(),{nodes:r,edges:i}}},n.prototype.getNodePath=function(t){var r=this.nodes,i=this.combos,o=r.find(function(s){return s.id===t}),a=function(s,u){u===void 0&&(u=[]);var c=i.find(function(l){return l.id===s});return c?(u.unshift(s),c.parentId?a(c.parentId,u):u):u};return o&&o.comboId?a(o.comboId,[t]):[t]},n.prototype.getLayoutConfig=function(){var t,r,i,o,a=this,s=a.nodes,u=a.edges,c=a.combos,l=a.nodeSize,h=a.rankdir,f=a.align,d=a.edgesep,p=a.nodesep,g=a.ranksep,v=a.settings,m=(c||[]).reduce(function(j,L){var B=s.filter(function(R){return R.comboId===L.id}).map(function(R){return R.id}),N=(c||[]).filter(function(R){return R.parentId===L.id}).map(function(R){return R.id});return(B.length||N.length)&&(j[L.id]=Du(Du([],B,!0),N,!0)),j},{});o=l?(0,fp.isArray)(l)?function(){return l}:function(){return[l,l]}:function(j){return j&&j.size?(0,fp.isArray)(j.size)?j.size:(0,fp.isObject)(j.size)?[j.size.width||40,j.size.height||40]:[j.size,j.size]:[40,40]};var y=function(j){return j&&j.size?(0,fp.isArray)(j.size)?j.size:[j.size,j.size]:[80,40]}(c==null?void 0:c[0]),b=y[0],x=y[1],w=(r=(t=a.graphSettings)===null||t===void 0?void 0:t.subScene)===null||r===void 0?void 0:r.meta,E=((i=c.find(function(j){return!j.collapsed}))===null||i===void 0?void 0:i.padding)||[20,20,20,20],M=E[0],_=E[1],k=E[2],S=E[3],C={compound:m,nodes:Du([],(s||[]).map(function(j){var L=o(j),B=L[0],N=L[1];return Ii(Ii({},j),{width:B,height:N})}),!0),edges:Du([],(u||[]).map(function(j){return Ii(Ii({},j),{v:j.source,w:j.target})}),!0)},T={expanded:(c||[]).filter(function(j){return!j.collapsed}).map(function(j){return j.id})},A={graph:{meta:{align:f,rankDir:h,nodeSep:p,edgeSep:d,rankSep:g}},subScene:{meta:{paddingTop:M||(w==null?void 0:w.paddingTop)||20,paddingRight:_||(w==null?void 0:w.paddingRight)||20,paddingBottom:k||(w==null?void 0:w.paddingBottom)||20,paddingLeft:S||(w==null?void 0:w.paddingLeft)||20,labelHeight:0}},nodeSize:{meta:{width:b,height:x}}},D=(0,oi.mergeConfig)(v,Ii({},(0,oi.mergeConfig)(A,oi.LAYOUT_CONFIG)));return a.graphSettings=D,{graphDef:C,graphOption:T,graphSettings:D}},n.prototype.updatePosition=function(t){var r=t.nodes,i=t.edges;this.updateNodePosition(r,i),this.updateEdgePosition(r,i)},n.prototype.getBegin=function(t,r){var i=this.begin,o=[0,0];if(i){var a=1/0,s=1/0;t.forEach(function(u){a>u.x&&(a=u.x),s>u.y&&(s=u.y)}),r.forEach(function(u){u.points.forEach(function(c){a>c.x&&(a=c.x),s>c.y&&(s=c.y)})}),o[0]=i[0]-a,o[1]=i[1]-s}return o},n.prototype.updateNodePosition=function(t,r){var i=this,o=i.combos,a=i.nodes,s=i.edges,u=i.anchorPoint,c=i.graphSettings,l=this.getBegin(t,r);t.forEach(function(h){var f,d=h.x,p=h.y,g=h.id,v=h.type,m=h.coreBox;if(v===oi.HierarchyNodeType.META&&g!==oi.ROOT_NAME){var y=o.findIndex(function(M){return M.id===g}),b=(f=c==null?void 0:c.subScene)===null||f===void 0?void 0:f.meta;o[y].offsetX=d+l[0],o[y].offsetY=p+l[1],o[y].fixSize=[m.width,m.height],o[y].fixCollapseSize=[m.width,m.height],h.expanded?o[y].padding=[b==null?void 0:b.paddingTop,b==null?void 0:b.paddingRight,b==null?void 0:b.paddingBottom,b==null?void 0:b.paddingLeft]:o[y].padding=[0,0,0,0]}else if(v===oi.HierarchyNodeType.OP&&(y=a.findIndex(function(M){return M.id===g}),a[y].x=d+l[0],a[y].y=p+l[1],u)){var x=[],w=r.filter(function(M){return M.v===g}),E=r.filter(function(M){return M.w===g});w.length>0&&w.forEach(function(M){var _=M.points[0],k=(_.x-d)/h.width+.5,S=(_.y-p)/h.height+.5;x.push([k,S]),M.baseEdgeList.forEach(function(C){var T=s.find(function(A){return A.source===C.v&&A.target===C.w});T&&(T.sourceAnchor=x.length-1)})}),E.length>0&&E.forEach(function(M){var _=M.points[M.points.length-1],k=(_.x-d)/h.width+.5,S=(_.y-p)/h.height+.5;x.push([k,S]),M.baseEdgeList.forEach(function(C){var T=s.find(function(A){return A.source===C.v&&A.target===C.w});T&&(T.targetAnchor=x.length-1)})}),a[y].anchorPoints=x.length>0?x:a[y].anchorPoints||[]}})},n.prototype.updateEdgePosition=function(t,r){var i=this,o=i.combos,a=i.edges,s=i.controlPoints,u=this.getBegin(t,r);s&&(o.forEach(function(c){c.inEdges=[],c.outEdges=[]}),a.forEach(function(c){var l,h,f,d,p=t.find(function(M){return M.id===c.source}),g=t.find(function(M){return M.id===c.target}),v=[],m=[];if(p&&g)m=(0,oi.getEdges)(p==null?void 0:p.id,g==null?void 0:g.id,t);else if(!p||!g){var y=i.getNodePath(c.source),b=i.getNodePath(c.target),x=y.reverse().slice(p?0:1).find(function(M){return t.find(function(_){return _.id===M})}),w=b.reverse().slice(g?0:1).find(function(M){return t.find(function(_){return _.id===M})});p=t.find(function(M){return M.id===x}),g=t.find(function(M){return M.id===w}),m=(0,oi.getEdges)(p==null?void 0:p.id,g==null?void 0:g.id,t,{v:c.source,w:c.target})}if(v=m.reduce(function(M,_){return Du(Du([],M,!0),_.points.map(function(k){return Ii(Ii({},k),{x:k.x+u[0],y:k.y+u[1]})}),!0)},[]),v=v.slice(1,-1),c.controlPoints=v,(g==null?void 0:g.type)===oi.NodeType.META){var E=o.findIndex(function(M){return M.id===(g==null?void 0:g.id)});if(!o[E]||!((l=o[E].inEdges)===null||l===void 0)&&l.some(function(M){return M.source===p.id&&M.target===g.id}))return;(h=o[E].inEdges)===null||h===void 0||h.push({source:p.id,target:g.id,controlPoints:v})}if((p==null?void 0:p.type)===oi.NodeType.META){if(E=o.findIndex(function(M){return M.id===(p==null?void 0:p.id)}),!o[E]||!((f=o[E].outEdges)===null||f===void 0)&&f.some(function(M){return M.source===p.id&&M.target===g.id}))return;(d=o[E].outEdges)===null||d===void 0||d.push({source:p.id,target:g.id,controlPoints:v})}}))},n.prototype.getType=function(){return"dagreCompound"},n.prototype.getDataByOrder=function(t){return t.every(function(r){return r.layoutOrder!==void 0})||t.forEach(function(r,i){r.layoutOrder=i}),t.sort(function(r,i){return r.layoutOrder-i.layoutOrder})},n}(pU.Base);gl.DagreCompoundLayout=gU;var i1={},dp={},o1={};const vU=Object.prototype.toString;function pp(e){const n=vU.call(e);return n.endsWith("Array]")&&!n.includes("Big")}function VT(e){var n,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!pp(e))throw new TypeError("input must be an array");if(e.length===0)throw new TypeError("input must not be empty");if(t.output!==void 0){if(!pp(t.output))throw new TypeError("output option must be an array if specified");n=t.output}else n=new Array(e.length);var r=function(h){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!pp(h))throw new TypeError("input must be an array");if(h.length===0)throw new TypeError("input must not be empty");var d=f.fromIndex,p=d===void 0?0:d,g=f.toIndex,v=g===void 0?h.length:g;if(p<0||p>=h.length||!Number.isInteger(p))throw new Error("fromIndex must be a positive integer smaller than length");if(v<=p||v>h.length||!Number.isInteger(v))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var m=h[p],y=p+1;y<v;y++)h[y]<m&&(m=h[y]);return m}(e),i=function(h){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!pp(h))throw new TypeError("input must be an array");if(h.length===0)throw new TypeError("input must not be empty");var d=f.fromIndex,p=d===void 0?0:d,g=f.toIndex,v=g===void 0?h.length:g;if(p<0||p>=h.length||!Number.isInteger(p))throw new Error("fromIndex must be a positive integer smaller than length");if(v<=p||v>h.length||!Number.isInteger(v))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var m=h[p],y=p+1;y<v;y++)h[y]>m&&(m=h[y]);return m}(e);if(r===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=t.min,a=o===void 0?t.autoMinMax?r:0:o,s=t.max,u=s===void 0?t.autoMinMax?i:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var c=(u-a)/(i-r),l=0;l<e.length;l++)n[l]=(e[l]-r)*c+a;return n}const gp=" ".repeat(2),HT=" ".repeat(4);function qT(e,n={}){const{maxRows:t=15,maxColumns:r=10,maxNumSize:i=8}=n;return`${e.constructor.name} {
${gp}[
${HT}${function(o,a,s,u){const{rows:c,columns:l}=o,h=Math.min(c,a),f=Math.min(l,s),d=[];for(let p=0;p<h;p++){let g=[];for(let v=0;v<f;v++)g.push(mU(o.get(p,v),u));d.push(`${g.join(" ")}`)}return f!==l&&(d[d.length-1]+=` ... ${l-s} more columns`),h!==c&&d.push(`... ${c-a} more rows`),d.join(`
${HT}`)}(e,t,r,i)}
${gp}]
${gp}rows: ${e.rows}
${gp}columns: ${e.columns}
}`}function mU(e,n){const t=String(e);if(t.length<=n)return t.padEnd(n," ");const r=e.toPrecision(n-2);if(r.length<=n)return r;const i=e.toExponential(n-2),o=i.indexOf("e"),a=i.slice(o);return i.slice(0,n-a.length)+a}function ai(e,n,t){let r=t?e.rows:e.rows-1;if(n<0||n>r)throw new RangeError("Row index out of range")}function si(e,n,t){let r=t?e.columns:e.columns-1;if(n<0||n>r)throw new RangeError("Column index out of range")}function Pu(e,n){if(n.to1DArray&&(n=n.to1DArray()),n.length!==e.columns)throw new RangeError("vector size must be the same as the number of columns");return n}function Lu(e,n){if(n.to1DArray&&(n=n.to1DArray()),n.length!==e.rows)throw new RangeError("vector size must be the same as the number of rows");return n}function ZT(e,n,t){return{row:KT(e,n),column:$T(e,t)}}function KT(e,n){if(typeof n!="object")throw new TypeError("unexpected type for row indices");if(n.some(r=>r<0||r>=e.rows))throw new RangeError("row indices are out of range");return Array.isArray(n)||(n=Array.from(n)),n}function $T(e,n){if(typeof n!="object")throw new TypeError("unexpected type for column indices");if(n.some(r=>r<0||r>=e.columns))throw new RangeError("column indices are out of range");return Array.isArray(n)||(n=Array.from(n)),n}function a1(e,n,t,r,i){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(mp("startRow",n),mp("endRow",t),mp("startColumn",r),mp("endColumn",i),n>t||r>i||n<0||n>=e.rows||t<0||t>=e.rows||r<0||r>=e.columns||i<0||i>=e.columns)throw new RangeError("Submatrix indices are out of range")}function vp(e,n=0){let t=[];for(let r=0;r<e;r++)t.push(n);return t}function mp(e,n){if(typeof n!="number")throw new TypeError(`${e} must be a number`)}class Qt{static from1DArray(n,t,r){if(n*t!==r.length)throw new RangeError("data length does not match given dimensions");let i=new wt(n,t);for(let o=0;o<n;o++)for(let a=0;a<t;a++)i.set(o,a,r[o*t+a]);return i}static rowVector(n){let t=new wt(1,n.length);for(let r=0;r<n.length;r++)t.set(0,r,n[r]);return t}static columnVector(n){let t=new wt(n.length,1);for(let r=0;r<n.length;r++)t.set(r,0,n[r]);return t}static zeros(n,t){return new wt(n,t)}static ones(n,t){return new wt(n,t).fill(1)}static rand(n,t,r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{random:i=Math.random}=r;let o=new wt(n,t);for(let a=0;a<n;a++)for(let s=0;s<t;s++)o.set(a,s,i());return o}static randInt(n,t,r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{min:i=0,max:o=1e3,random:a=Math.random}=r;if(!Number.isInteger(i))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(i>=o)throw new RangeError("min must be smaller than max");let s=o-i,u=new wt(n,t);for(let c=0;c<n;c++)for(let l=0;l<t;l++){let h=i+Math.round(a()*s);u.set(c,l,h)}return u}static eye(n,t,r){t===void 0&&(t=n),r===void 0&&(r=1);let i=Math.min(n,t),o=this.zeros(n,t);for(let a=0;a<i;a++)o.set(a,a,r);return o}static diag(n,t,r){let i=n.length;t===void 0&&(t=i),r===void 0&&(r=t);let o=Math.min(i,t,r),a=this.zeros(t,r);for(let s=0;s<o;s++)a.set(s,s,n[s]);return a}static min(n,t){n=this.checkMatrix(n),t=this.checkMatrix(t);let r=n.rows,i=n.columns,o=new wt(r,i);for(let a=0;a<r;a++)for(let s=0;s<i;s++)o.set(a,s,Math.min(n.get(a,s),t.get(a,s)));return o}static max(n,t){n=this.checkMatrix(n),t=this.checkMatrix(t);let r=n.rows,i=n.columns,o=new this(r,i);for(let a=0;a<r;a++)for(let s=0;s<i;s++)o.set(a,s,Math.max(n.get(a,s),t.get(a,s)));return o}static checkMatrix(n){return Qt.isMatrix(n)?n:new wt(n)}static isMatrix(n){return n!=null&&n.klass==="Matrix"}get size(){return this.rows*this.columns}apply(n){if(typeof n!="function")throw new TypeError("callback must be a function");for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)n.call(this,t,r);return this}to1DArray(){let n=[];for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)n.push(this.get(t,r));return n}to2DArray(){let n=[];for(let t=0;t<this.rows;t++){n.push([]);for(let r=0;r<this.columns;r++)n[t].push(this.get(t,r))}return n}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(let n=0;n<this.rows;n++)for(let t=0;t<=n;t++)if(this.get(n,t)!==this.get(t,n))return!1;return!0}return!1}isEchelonForm(){let n=0,t=0,r=-1,i=!0,o=!1;for(;n<this.rows&&i;){for(t=0,o=!1;t<this.columns&&o===!1;)this.get(n,t)===0?t++:this.get(n,t)===1&&t>r?(o=!0,r=t):(i=!1,o=!0);n++}return i}isReducedEchelonForm(){let n=0,t=0,r=-1,i=!0,o=!1;for(;n<this.rows&&i;){for(t=0,o=!1;t<this.columns&&o===!1;)this.get(n,t)===0?t++:this.get(n,t)===1&&t>r?(o=!0,r=t):(i=!1,o=!0);for(let a=t+1;a<this.rows;a++)this.get(n,a)!==0&&(i=!1);n++}return i}echelonForm(){let n=this.clone(),t=0,r=0;for(;t<n.rows&&r<n.columns;){let i=t;for(let o=t;o<n.rows;o++)n.get(o,r)>n.get(i,r)&&(i=o);if(n.get(i,r)===0)r++;else{n.swapRows(t,i);let o=n.get(t,r);for(let a=r;a<n.columns;a++)n.set(t,a,n.get(t,a)/o);for(let a=t+1;a<n.rows;a++){let s=n.get(a,r)/n.get(t,r);n.set(a,r,0);for(let u=r+1;u<n.columns;u++)n.set(a,u,n.get(a,u)-n.get(t,u)*s)}t++,r++}}return n}reducedEchelonForm(){let n=this.echelonForm(),t=n.columns,r=n.rows,i=r-1;for(;i>=0;)if(n.maxRow(i)===0)i--;else{let o=0,a=!1;for(;o<r&&a===!1;)n.get(i,o)===1?a=!0:o++;for(let s=0;s<i;s++){let u=n.get(s,o);for(let c=o;c<t;c++){let l=n.get(s,c)-u*n.get(i,c);n.set(s,c,l)}}i--}return n}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(n={}){if(typeof n!="object")throw new TypeError("options must be an object");const{rows:t=1,columns:r=1}=n;if(!Number.isInteger(t)||t<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let i=new wt(this.rows*t,this.columns*r);for(let o=0;o<t;o++)for(let a=0;a<r;a++)i.setSubMatrix(this,this.rows*o,this.columns*a);return i}fill(n){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,n);return this}neg(){return this.mulS(-1)}getRow(n){ai(this,n);let t=[];for(let r=0;r<this.columns;r++)t.push(this.get(n,r));return t}getRowVector(n){return wt.rowVector(this.getRow(n))}setRow(n,t){ai(this,n),t=Pu(this,t);for(let r=0;r<this.columns;r++)this.set(n,r,t[r]);return this}swapRows(n,t){ai(this,n),ai(this,t);for(let r=0;r<this.columns;r++){let i=this.get(n,r);this.set(n,r,this.get(t,r)),this.set(t,r,i)}return this}getColumn(n){si(this,n);let t=[];for(let r=0;r<this.rows;r++)t.push(this.get(r,n));return t}getColumnVector(n){return wt.columnVector(this.getColumn(n))}setColumn(n,t){si(this,n),t=Lu(this,t);for(let r=0;r<this.rows;r++)this.set(r,n,t[r]);return this}swapColumns(n,t){si(this,n),si(this,t);for(let r=0;r<this.rows;r++){let i=this.get(r,n);this.set(r,n,this.get(r,t)),this.set(r,t,i)}return this}addRowVector(n){n=Pu(this,n);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)+n[r]);return this}subRowVector(n){n=Pu(this,n);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)-n[r]);return this}mulRowVector(n){n=Pu(this,n);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*n[r]);return this}divRowVector(n){n=Pu(this,n);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)/n[r]);return this}addColumnVector(n){n=Lu(this,n);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)+n[t]);return this}subColumnVector(n){n=Lu(this,n);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)-n[t]);return this}mulColumnVector(n){n=Lu(this,n);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*n[t]);return this}divColumnVector(n){n=Lu(this,n);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)/n[t]);return this}mulRow(n,t){ai(this,n);for(let r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)*t);return this}mulColumn(n,t){si(this,n);for(let r=0;r<this.rows;r++)this.set(r,n,this.get(r,n)*t);return this}max(){let n=this.get(0,0);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.get(t,r)>n&&(n=this.get(t,r));return n}maxIndex(){let n=this.get(0,0),t=[0,0];for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)>n&&(n=this.get(r,i),t[0]=r,t[1]=i);return t}min(){let n=this.get(0,0);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.get(t,r)<n&&(n=this.get(t,r));return n}minIndex(){let n=this.get(0,0),t=[0,0];for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)<n&&(n=this.get(r,i),t[0]=r,t[1]=i);return t}maxRow(n){ai(this,n);let t=this.get(n,0);for(let r=1;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r));return t}maxRowIndex(n){ai(this,n);let t=this.get(n,0),r=[n,0];for(let i=1;i<this.columns;i++)this.get(n,i)>t&&(t=this.get(n,i),r[1]=i);return r}minRow(n){ai(this,n);let t=this.get(n,0);for(let r=1;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r));return t}minRowIndex(n){ai(this,n);let t=this.get(n,0),r=[n,0];for(let i=1;i<this.columns;i++)this.get(n,i)<t&&(t=this.get(n,i),r[1]=i);return r}maxColumn(n){si(this,n);let t=this.get(0,n);for(let r=1;r<this.rows;r++)this.get(r,n)>t&&(t=this.get(r,n));return t}maxColumnIndex(n){si(this,n);let t=this.get(0,n),r=[0,n];for(let i=1;i<this.rows;i++)this.get(i,n)>t&&(t=this.get(i,n),r[0]=i);return r}minColumn(n){si(this,n);let t=this.get(0,n);for(let r=1;r<this.rows;r++)this.get(r,n)<t&&(t=this.get(r,n));return t}minColumnIndex(n){si(this,n);let t=this.get(0,n),r=[0,n];for(let i=1;i<this.rows;i++)this.get(i,n)<t&&(t=this.get(i,n),r[0]=i);return r}diag(){let n=Math.min(this.rows,this.columns),t=[];for(let r=0;r<n;r++)t.push(this.get(r,r));return t}norm(n="frobenius"){let t=0;if(n==="max")return this.max();if(n==="frobenius"){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)t+=this.get(r,i)*this.get(r,i);return Math.sqrt(t)}throw new RangeError(`unknown norm type: ${n}`)}cumulativeSum(){let n=0;for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)n+=this.get(t,r),this.set(t,r,n);return this}dot(n){Qt.isMatrix(n)&&(n=n.to1DArray());let t=this.to1DArray();if(t.length!==n.length)throw new RangeError("vectors do not have the same size");let r=0;for(let i=0;i<t.length;i++)r+=t[i]*n[i];return r}mmul(n){n=wt.checkMatrix(n);let t=this.rows,r=this.columns,i=n.columns,o=new wt(t,i),a=new Float64Array(r);for(let s=0;s<i;s++){for(let u=0;u<r;u++)a[u]=n.get(u,s);for(let u=0;u<t;u++){let c=0;for(let l=0;l<r;l++)c+=this.get(u,l)*a[l];o.set(u,s,c)}}return o}strassen2x2(n){n=wt.checkMatrix(n);let t=new wt(2,2);const r=this.get(0,0),i=n.get(0,0),o=this.get(0,1),a=n.get(0,1),s=this.get(1,0),u=n.get(1,0),c=this.get(1,1),l=n.get(1,1),h=(r+c)*(i+l),f=(s+c)*i,d=r*(a-l),p=c*(u-i),g=(r+o)*l,v=h+p-g+(o-c)*(u+l),m=d+g,y=f+p,b=h-f+d+(s-r)*(i+a);return t.set(0,0,v),t.set(0,1,m),t.set(1,0,y),t.set(1,1,b),t}strassen3x3(n){n=wt.checkMatrix(n);let t=new wt(3,3);const r=this.get(0,0),i=this.get(0,1),o=this.get(0,2),a=this.get(1,0),s=this.get(1,1),u=this.get(1,2),c=this.get(2,0),l=this.get(2,1),h=this.get(2,2),f=n.get(0,0),d=n.get(0,1),p=n.get(0,2),g=n.get(1,0),v=n.get(1,1),m=n.get(1,2),y=n.get(2,0),b=n.get(2,1),x=n.get(2,2),w=(r-a)*(-d+v),E=(-r+a+s)*(f-d+v),M=(a+s)*(-f+d),_=r*f,k=(-r+c+l)*(f-p+m),S=(-r+c)*(p-m),C=(c+l)*(-f+p),T=(-o+l+h)*(v+y-b),A=(o-h)*(v-b),D=o*y,j=(l+h)*(-y+b),L=(-o+s+u)*(m+y-x),B=(o-u)*(m-x),N=(s+u)*(-y+x),R=_+D+i*g,P=(r+i+o-a-s-l-h)*v+E+M+_+T+D+j,H=_+k+C+(r+i+o-s-u-c-l)*m+D+L+N,ne=w+s*(-f+d+g-v-m-y+x)+E+_+D+L+B,Z=w+E+M+_+u*b,q=D+L+B+N+a*p,te=_+k+S+l*(-f+p+g-v-m-y+b)+T+A+D,we=T+A+D+j+c*d,pe=_+k+S+C+h*x;return t.set(0,0,R),t.set(0,1,P),t.set(0,2,H),t.set(1,0,ne),t.set(1,1,Z),t.set(1,2,q),t.set(2,0,te),t.set(2,1,we),t.set(2,2,pe),t}mmulStrassen(n){n=wt.checkMatrix(n);let t=this.clone(),r=t.rows,i=t.columns,o=n.rows,a=n.columns;function s(l,h,f){let d=l.rows,p=l.columns;if(d===h&&p===f)return l;{let g=Qt.zeros(h,f);return g=g.setSubMatrix(l,0,0),g}}let u=Math.max(r,o),c=Math.max(i,a);return t=s(t,u,c),function l(h,f,d,p){if(d<=512||p<=512)return h.mmul(f);d%2==1&&p%2==1?(h=s(h,d+1,p+1),f=s(f,d+1,p+1)):d%2==1?(h=s(h,d+1,p),f=s(f,d+1,p)):p%2==1&&(h=s(h,d,p+1),f=s(f,d,p+1));let g=parseInt(h.rows/2,10),v=parseInt(h.columns/2,10),m=h.subMatrix(0,g-1,0,v-1),y=f.subMatrix(0,g-1,0,v-1),b=h.subMatrix(0,g-1,v,h.columns-1),x=f.subMatrix(0,g-1,v,f.columns-1),w=h.subMatrix(g,h.rows-1,0,v-1),E=f.subMatrix(g,f.rows-1,0,v-1),M=h.subMatrix(g,h.rows-1,v,h.columns-1),_=f.subMatrix(g,f.rows-1,v,f.columns-1),k=l(Qt.add(m,M),Qt.add(y,_),g,v),S=l(Qt.add(w,M),y,g,v),C=l(m,Qt.sub(x,_),g,v),T=l(M,Qt.sub(E,y),g,v),A=l(Qt.add(m,b),_,g,v),D=l(Qt.sub(w,m),Qt.add(y,x),g,v),j=l(Qt.sub(b,M),Qt.add(E,_),g,v),L=Qt.add(k,T);L.sub(A),L.add(j);let B=Qt.add(C,A),N=Qt.add(S,T),R=Qt.sub(k,S);R.add(C),R.add(D);let P=Qt.zeros(2*L.rows,2*L.columns);return P=P.setSubMatrix(L,0,0),P=P.setSubMatrix(B,L.rows,0),P=P.setSubMatrix(N,0,L.columns),P=P.setSubMatrix(R,L.rows,L.columns),P.subMatrix(0,d-1,0,p-1)}(t,n=s(n,u,c),u,c)}scaleRows(n={}){if(typeof n!="object")throw new TypeError("options must be an object");const{min:t=0,max:r=1}=n;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(t>=r)throw new RangeError("min must be smaller than max");let i=new wt(this.rows,this.columns);for(let o=0;o<this.rows;o++){const a=this.getRow(o);VT(a,{min:t,max:r,output:a}),i.setRow(o,a)}return i}scaleColumns(n={}){if(typeof n!="object")throw new TypeError("options must be an object");const{min:t=0,max:r=1}=n;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(t>=r)throw new RangeError("min must be smaller than max");let i=new wt(this.rows,this.columns);for(let o=0;o<this.columns;o++){const a=this.getColumn(o);VT(a,{min:t,max:r,output:a}),i.setColumn(o,a)}return i}flipRows(){const n=Math.ceil(this.columns/2);for(let t=0;t<this.rows;t++)for(let r=0;r<n;r++){let i=this.get(t,r),o=this.get(t,this.columns-1-r);this.set(t,r,o),this.set(t,this.columns-1-r,i)}return this}flipColumns(){const n=Math.ceil(this.rows/2);for(let t=0;t<this.columns;t++)for(let r=0;r<n;r++){let i=this.get(r,t),o=this.get(this.rows-1-r,t);this.set(r,t,o),this.set(this.rows-1-r,t,i)}return this}kroneckerProduct(n){n=wt.checkMatrix(n);let t=this.rows,r=this.columns,i=n.rows,o=n.columns,a=new wt(t*i,r*o);for(let s=0;s<t;s++)for(let u=0;u<r;u++)for(let c=0;c<i;c++)for(let l=0;l<o;l++)a.set(i*s+c,o*u+l,this.get(s,u)*n.get(c,l));return a}transpose(){let n=new wt(this.columns,this.rows);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)n.set(r,t,this.get(t,r));return n}sortRows(n=QT){for(let t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(n));return this}sortColumns(n=QT){for(let t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(n));return this}subMatrix(n,t,r,i){a1(this,n,t,r,i);let o=new wt(t-n+1,i-r+1);for(let a=n;a<=t;a++)for(let s=r;s<=i;s++)o.set(a-n,s-r,this.get(a,s));return o}subMatrixRow(n,t,r){if(t===void 0&&(t=0),r===void 0&&(r=this.columns-1),t>r||t<0||t>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let i=new wt(n.length,r-t+1);for(let o=0;o<n.length;o++)for(let a=t;a<=r;a++){if(n[o]<0||n[o]>=this.rows)throw new RangeError(`Row index out of range: ${n[o]}`);i.set(o,a-t,this.get(n[o],a))}return i}subMatrixColumn(n,t,r){if(t===void 0&&(t=0),r===void 0&&(r=this.rows-1),t>r||t<0||t>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let i=new wt(r-t+1,n.length);for(let o=0;o<n.length;o++)for(let a=t;a<=r;a++){if(n[o]<0||n[o]>=this.columns)throw new RangeError(`Column index out of range: ${n[o]}`);i.set(a-t,o,this.get(a,n[o]))}return i}setSubMatrix(n,t,r){a1(this,t,t+(n=wt.checkMatrix(n)).rows-1,r,r+n.columns-1);for(let i=0;i<n.rows;i++)for(let o=0;o<n.columns;o++)this.set(t+i,r+o,n.get(i,o));return this}selection(n,t){let r=ZT(this,n,t),i=new wt(n.length,t.length);for(let o=0;o<r.row.length;o++){let a=r.row[o];for(let s=0;s<r.column.length;s++){let u=r.column[s];i.set(o,s,this.get(a,u))}}return i}trace(){let n=Math.min(this.rows,this.columns),t=0;for(let r=0;r<n;r++)t+=this.get(r,r);return t}clone(){let n=new wt(this.rows,this.columns);for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)n.set(t,r,this.get(t,r));return n}sum(n){switch(n){case"row":return function(t){let r=vp(t.rows);for(let i=0;i<t.rows;++i)for(let o=0;o<t.columns;++o)r[i]+=t.get(i,o);return r}(this);case"column":return function(t){let r=vp(t.columns);for(let i=0;i<t.rows;++i)for(let o=0;o<t.columns;++o)r[o]+=t.get(i,o);return r}(this);case void 0:return function(t){let r=0;for(let i=0;i<t.rows;i++)for(let o=0;o<t.columns;o++)r+=t.get(i,o);return r}(this);default:throw new Error(`invalid option: ${n}`)}}product(n){switch(n){case"row":return function(t){let r=vp(t.rows,1);for(let i=0;i<t.rows;++i)for(let o=0;o<t.columns;++o)r[i]*=t.get(i,o);return r}(this);case"column":return function(t){let r=vp(t.columns,1);for(let i=0;i<t.rows;++i)for(let o=0;o<t.columns;++o)r[o]*=t.get(i,o);return r}(this);case void 0:return function(t){let r=1;for(let i=0;i<t.rows;i++)for(let o=0;o<t.columns;o++)r*=t.get(i,o);return r}(this);default:throw new Error(`invalid option: ${n}`)}}mean(n){const t=this.sum(n);switch(n){case"row":for(let r=0;r<this.rows;r++)t[r]/=this.columns;return t;case"column":for(let r=0;r<this.columns;r++)t[r]/=this.rows;return t;case void 0:return t/this.size;default:throw new Error(`invalid option: ${n}`)}}variance(n,t={}){if(typeof n=="object"&&(t=n,n=void 0),typeof t!="object")throw new TypeError("options must be an object");const{unbiased:r=!0,mean:i=this.mean(n)}=t;if(typeof r!="boolean")throw new TypeError("unbiased must be a boolean");switch(n){case"row":if(!Array.isArray(i))throw new TypeError("mean must be an array");return function(o,a,s){const u=o.rows,c=o.columns,l=[];for(let h=0;h<u;h++){let f=0,d=0,p=0;for(let g=0;g<c;g++)p=o.get(h,g)-s[h],f+=p,d+=p*p;a?l.push((d-f*f/c)/(c-1)):l.push((d-f*f/c)/c)}return l}(this,r,i);case"column":if(!Array.isArray(i))throw new TypeError("mean must be an array");return function(o,a,s){const u=o.rows,c=o.columns,l=[];for(let h=0;h<c;h++){let f=0,d=0,p=0;for(let g=0;g<u;g++)p=o.get(g,h)-s[h],f+=p,d+=p*p;a?l.push((d-f*f/u)/(u-1)):l.push((d-f*f/u)/u)}return l}(this,r,i);case void 0:if(typeof i!="number")throw new TypeError("mean must be a number");return function(o,a,s){const u=o.rows,c=o.columns,l=u*c;let h=0,f=0,d=0;for(let p=0;p<u;p++)for(let g=0;g<c;g++)d=o.get(p,g)-s,h+=d,f+=d*d;return a?(f-h*h/l)/(l-1):(f-h*h/l)/l}(this,r,i);default:throw new Error(`invalid option: ${n}`)}}standardDeviation(n,t){typeof n=="object"&&(t=n,n=void 0);const r=this.variance(n,t);if(n===void 0)return Math.sqrt(r);for(let i=0;i<r.length;i++)r[i]=Math.sqrt(r[i]);return r}center(n,t={}){if(typeof n=="object"&&(t=n,n=void 0),typeof t!="object")throw new TypeError("options must be an object");const{center:r=this.mean(n)}=t;switch(n){case"row":if(!Array.isArray(r))throw new TypeError("center must be an array");return function(i,o){for(let a=0;a<i.rows;a++)for(let s=0;s<i.columns;s++)i.set(a,s,i.get(a,s)-o[a])}(this,r),this;case"column":if(!Array.isArray(r))throw new TypeError("center must be an array");return function(i,o){for(let a=0;a<i.rows;a++)for(let s=0;s<i.columns;s++)i.set(a,s,i.get(a,s)-o[s])}(this,r),this;case void 0:if(typeof r!="number")throw new TypeError("center must be a number");return function(i,o){for(let a=0;a<i.rows;a++)for(let s=0;s<i.columns;s++)i.set(a,s,i.get(a,s)-o)}(this,r),this;default:throw new Error(`invalid option: ${n}`)}}scale(n,t={}){if(typeof n=="object"&&(t=n,n=void 0),typeof t!="object")throw new TypeError("options must be an object");let r=t.scale;switch(n){case"row":if(r===void 0)r=function(i){const o=[];for(let a=0;a<i.rows;a++){let s=0;for(let u=0;u<i.columns;u++)s+=Math.pow(i.get(a,u),2)/(i.columns-1);o.push(Math.sqrt(s))}return o}(this);else if(!Array.isArray(r))throw new TypeError("scale must be an array");return function(i,o){for(let a=0;a<i.rows;a++)for(let s=0;s<i.columns;s++)i.set(a,s,i.get(a,s)/o[a])}(this,r),this;case"column":if(r===void 0)r=function(i){const o=[];for(let a=0;a<i.columns;a++){let s=0;for(let u=0;u<i.rows;u++)s+=Math.pow(i.get(u,a),2)/(i.rows-1);o.push(Math.sqrt(s))}return o}(this);else if(!Array.isArray(r))throw new TypeError("scale must be an array");return function(i,o){for(let a=0;a<i.rows;a++)for(let s=0;s<i.columns;s++)i.set(a,s,i.get(a,s)/o[s])}(this,r),this;case void 0:if(r===void 0)r=function(i){const o=i.size-1;let a=0;for(let s=0;s<i.columns;s++)for(let u=0;u<i.rows;u++)a+=Math.pow(i.get(u,s),2)/o;return Math.sqrt(a)}(this);else if(typeof r!="number")throw new TypeError("scale must be a number");return function(i,o){for(let a=0;a<i.rows;a++)for(let s=0;s<i.columns;s++)i.set(a,s,i.get(a,s)/o)}(this,r),this;default:throw new Error(`invalid option: ${n}`)}}toString(n){return qT(this,n)}}function QT(e,n){return e-n}Qt.prototype.klass="Matrix",typeof Symbol<"u"&&(Qt.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return qT(this)}),Qt.random=Qt.rand,Qt.randomInt=Qt.randInt,Qt.diagonal=Qt.diag,Qt.prototype.diagonal=Qt.prototype.diag,Qt.identity=Qt.eye,Qt.prototype.negate=Qt.prototype.neg,Qt.prototype.tensorProduct=Qt.prototype.kroneckerProduct;class wt extends Qt{constructor(n,t){if(super(),wt.isMatrix(n))return n.clone();if(Number.isInteger(n)&&n>0){if(this.data=[],!(Number.isInteger(t)&&t>0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<n;r++)this.data.push(new Float64Array(t))}else{if(!Array.isArray(n))throw new TypeError("First argument must be a positive number or an array");{const r=n;if(n=r.length,typeof(t=r[0].length)!="number"||t===0)throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let i=0;i<n;i++){if(r[i].length!==t)throw new RangeError("Inconsistent array dimensions");this.data.push(Float64Array.from(r[i]))}}}return this.rows=n,this.columns=t,this}set(n,t,r){return this.data[n][t]=r,this}get(n,t){return this.data[n][t]}removeRow(n){if(ai(this,n),this.rows===1)throw new RangeError("A matrix cannot have less than one row");return this.data.splice(n,1),this.rows-=1,this}addRow(n,t){return t===void 0&&(t=n,n=this.rows),ai(this,n,!0),t=Float64Array.from(Pu(this,t)),this.data.splice(n,0,t),this.rows+=1,this}removeColumn(n){if(si(this,n),this.columns===1)throw new RangeError("A matrix cannot have less than one column");for(let t=0;t<this.rows;t++){const r=new Float64Array(this.columns-1);for(let i=0;i<n;i++)r[i]=this.data[t][i];for(let i=n+1;i<this.columns;i++)r[i-1]=this.data[t][i];this.data[t]=r}return this.columns-=1,this}addColumn(n,t){t===void 0&&(t=n,n=this.columns),si(this,n,!0),t=Lu(this,t);for(let r=0;r<this.rows;r++){const i=new Float64Array(this.columns+1);let o=0;for(;o<n;o++)i[o]=this.data[r][o];for(i[o++]=t[r];o<this.columns+1;o++)i[o]=this.data[r][o-1];this.data[r]=i}return this.columns+=1,this}}(function(e,n){e.prototype.add=function(t){return typeof t=="number"?this.addS(t):this.addM(t)},e.prototype.addS=function(t){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)+t);return this},e.prototype.addM=function(t){if(t=n.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)+t.get(r,i));return this},e.add=function(t,r){return new n(t).add(r)},e.prototype.sub=function(t){return typeof t=="number"?this.subS(t):this.subM(t)},e.prototype.subS=function(t){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)-t);return this},e.prototype.subM=function(t){if(t=n.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)-t.get(r,i));return this},e.sub=function(t,r){return new n(t).sub(r)},e.prototype.subtract=e.prototype.sub,e.prototype.subtractS=e.prototype.subS,e.prototype.subtractM=e.prototype.subM,e.subtract=e.sub,e.prototype.mul=function(t){return typeof t=="number"?this.mulS(t):this.mulM(t)},e.prototype.mulS=function(t){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)*t);return this},e.prototype.mulM=function(t){if(t=n.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)*t.get(r,i));return this},e.mul=function(t,r){return new n(t).mul(r)},e.prototype.multiply=e.prototype.mul,e.prototype.multiplyS=e.prototype.mulS,e.prototype.multiplyM=e.prototype.mulM,e.multiply=e.mul,e.prototype.div=function(t){return typeof t=="number"?this.divS(t):this.divM(t)},e.prototype.divS=function(t){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)/t);return this},e.prototype.divM=function(t){if(t=n.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)/t.get(r,i));return this},e.div=function(t,r){return new n(t).div(r)},e.prototype.divide=e.prototype.div,e.prototype.divideS=e.prototype.divS,e.prototype.divideM=e.prototype.divM,e.divide=e.div,e.prototype.mod=function(t){return typeof t=="number"?this.modS(t):this.modM(t)},e.prototype.modS=function(t){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)%t);return this},e.prototype.modM=function(t){if(t=n.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)%t.get(r,i));return this},e.mod=function(t,r){return new n(t).mod(r)},e.prototype.modulus=e.prototype.mod,e.prototype.modulusS=e.prototype.modS,e.prototype.modulusM=e.prototype.modM,e.modulus=e.mod,e.prototype.and=function(t){return typeof t=="number"?this.andS(t):this.andM(t)},e.prototype.andS=function(t){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)&t);return this},e.prototype.andM=function(t){if(t=n.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)&t.get(r,i));return this},e.and=function(t,r){return new n(t).and(r)},e.prototype.or=function(t){return typeof t=="number"?this.orS(t):this.orM(t)},e.prototype.orS=function(t){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)|t);return this},e.prototype.orM=function(t){if(t=n.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)|t.get(r,i));return this},e.or=function(t,r){return new n(t).or(r)},e.prototype.xor=function(t){return typeof t=="number"?this.xorS(t):this.xorM(t)},e.prototype.xorS=function(t){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)^t);return this},e.prototype.xorM=function(t){if(t=n.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)^t.get(r,i));return this},e.xor=function(t,r){return new n(t).xor(r)},e.prototype.leftShift=function(t){return typeof t=="number"?this.leftShiftS(t):this.leftShiftM(t)},e.prototype.leftShiftS=function(t){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)<<t);return this},e.prototype.leftShiftM=function(t){if(t=n.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)<<t.get(r,i));return this},e.leftShift=function(t,r){return new n(t).leftShift(r)},e.prototype.signPropagatingRightShift=function(t){return typeof t=="number"?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},e.prototype.signPropagatingRightShiftS=function(t){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)>>t);return this},e.prototype.signPropagatingRightShiftM=function(t){if(t=n.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)>>t.get(r,i));return this},e.signPropagatingRightShift=function(t,r){return new n(t).signPropagatingRightShift(r)},e.prototype.rightShift=function(t){return typeof t=="number"?this.rightShiftS(t):this.rightShiftM(t)},e.prototype.rightShiftS=function(t){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)>>>t);return this},e.prototype.rightShiftM=function(t){if(t=n.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)>>>t.get(r,i));return this},e.rightShift=function(t,r){return new n(t).rightShift(r)},e.prototype.zeroFillRightShift=e.prototype.rightShift,e.prototype.zeroFillRightShiftS=e.prototype.rightShiftS,e.prototype.zeroFillRightShiftM=e.prototype.rightShiftM,e.zeroFillRightShift=e.rightShift,e.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,~this.get(t,r));return this},e.not=function(t){return new n(t).not()},e.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.abs(this.get(t,r)));return this},e.abs=function(t){return new n(t).abs()},e.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.acos(this.get(t,r)));return this},e.acos=function(t){return new n(t).acos()},e.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.acosh(this.get(t,r)));return this},e.acosh=function(t){return new n(t).acosh()},e.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.asin(this.get(t,r)));return this},e.asin=function(t){return new n(t).asin()},e.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.asinh(this.get(t,r)));return this},e.asinh=function(t){return new n(t).asinh()},e.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.atan(this.get(t,r)));return this},e.atan=function(t){return new n(t).atan()},e.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.atanh(this.get(t,r)));return this},e.atanh=function(t){return new n(t).atanh()},e.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.cbrt(this.get(t,r)));return this},e.cbrt=function(t){return new n(t).cbrt()},e.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.ceil(this.get(t,r)));return this},e.ceil=function(t){return new n(t).ceil()},e.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.clz32(this.get(t,r)));return this},e.clz32=function(t){return new n(t).clz32()},e.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.cos(this.get(t,r)));return this},e.cos=function(t){return new n(t).cos()},e.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.cosh(this.get(t,r)));return this},e.cosh=function(t){return new n(t).cosh()},e.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.exp(this.get(t,r)));return this},e.exp=function(t){return new n(t).exp()},e.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.expm1(this.get(t,r)));return this},e.expm1=function(t){return new n(t).expm1()},e.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.floor(this.get(t,r)));return this},e.floor=function(t){return new n(t).floor()},e.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.fround(this.get(t,r)));return this},e.fround=function(t){return new n(t).fround()},e.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log(this.get(t,r)));return this},e.log=function(t){return new n(t).log()},e.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log1p(this.get(t,r)));return this},e.log1p=function(t){return new n(t).log1p()},e.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log10(this.get(t,r)));return this},e.log10=function(t){return new n(t).log10()},e.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.log2(this.get(t,r)));return this},e.log2=function(t){return new n(t).log2()},e.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.round(this.get(t,r)));return this},e.round=function(t){return new n(t).round()},e.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sign(this.get(t,r)));return this},e.sign=function(t){return new n(t).sign()},e.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sin(this.get(t,r)));return this},e.sin=function(t){return new n(t).sin()},e.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sinh(this.get(t,r)));return this},e.sinh=function(t){return new n(t).sinh()},e.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.sqrt(this.get(t,r)));return this},e.sqrt=function(t){return new n(t).sqrt()},e.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.tan(this.get(t,r)));return this},e.tan=function(t){return new n(t).tan()},e.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.tanh(this.get(t,r)));return this},e.tanh=function(t){return new n(t).tanh()},e.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)this.set(t,r,Math.trunc(this.get(t,r)));return this},e.trunc=function(t){return new n(t).trunc()},e.pow=function(t,r){return new n(t).pow(r)},e.prototype.pow=function(t){return typeof t=="number"?this.powS(t):this.powM(t)},e.prototype.powS=function(t){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.pow(this.get(r,i),t));return this},e.prototype.powM=function(t){if(t=n.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.pow(this.get(r,i),t.get(r,i)));return this}})(Qt,wt);class Ao extends Qt{constructor(n,t,r){super(),this.matrix=n,this.rows=t,this.columns=r}}class yp extends Ao{constructor(n,t,r){let i=ZT(n,t,r);super(n,i.row.length,i.column.length),this.rowIndices=i.row,this.columnIndices=i.column}set(n,t,r){return this.matrix.set(this.rowIndices[n],this.columnIndices[t],r),this}get(n,t){return this.matrix.get(this.rowIndices[n],this.columnIndices[t])}}class JT extends Qt{constructor(n,t={}){const{rows:r=1}=t;if(n.length%r!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=n.length/r,this.data=n}set(n,t,r){let i=this._calculateIndex(n,t);return this.data[i]=r,this}get(n,t){let r=this._calculateIndex(n,t);return this.data[r]}_calculateIndex(n,t){return n*this.columns+t}}class Vr extends Qt{constructor(n){super(),this.data=n,this.rows=n.length,this.columns=n[0].length}set(n,t,r){return this.data[n][t]=r,this}get(n,t){return this.data[n][t]}}class bp{constructor(n){let t,r,i,o,a,s,u,c,l,h=(n=Vr.checkMatrix(n)).clone(),f=h.rows,d=h.columns,p=new Float64Array(f),g=1;for(t=0;t<f;t++)p[t]=t;for(c=new Float64Array(f),r=0;r<d;r++){for(t=0;t<f;t++)c[t]=h.get(t,r);for(t=0;t<f;t++){for(l=Math.min(t,r),a=0,i=0;i<l;i++)a+=h.get(t,i)*c[i];c[t]-=a,h.set(t,r,c[t])}for(o=r,t=r+1;t<f;t++)Math.abs(c[t])>Math.abs(c[o])&&(o=t);if(o!==r){for(i=0;i<d;i++)s=h.get(o,i),h.set(o,i,h.get(r,i)),h.set(r,i,s);u=p[o],p[o]=p[r],p[r]=u,g=-g}if(r<f&&h.get(r,r)!==0)for(t=r+1;t<f;t++)h.set(t,r,h.get(t,r)/h.get(r,r))}this.LU=h,this.pivotVector=p,this.pivotSign=g}isSingular(){let n=this.LU,t=n.columns;for(let r=0;r<t;r++)if(n.get(r,r)===0)return!0;return!1}solve(n){n=wt.checkMatrix(n);let t=this.LU;if(t.rows!==n.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r,i,o,a=n.columns,s=n.subMatrixRow(this.pivotVector,0,a-1),u=t.columns;for(o=0;o<u;o++)for(r=o+1;r<u;r++)for(i=0;i<a;i++)s.set(r,i,s.get(r,i)-s.get(o,i)*t.get(r,o));for(o=u-1;o>=0;o--){for(i=0;i<a;i++)s.set(o,i,s.get(o,i)/t.get(o,o));for(r=0;r<o;r++)for(i=0;i<a;i++)s.set(r,i,s.get(r,i)-s.get(o,i)*t.get(r,o))}return s}get determinant(){let n=this.LU;if(!n.isSquare())throw new Error("Matrix must be square");let t=this.pivotSign,r=n.columns;for(let i=0;i<r;i++)t*=n.get(i,i);return t}get lowerTriangularMatrix(){let n=this.LU,t=n.rows,r=n.columns,i=new wt(t,r);for(let o=0;o<t;o++)for(let a=0;a<r;a++)o>a?i.set(o,a,n.get(o,a)):o===a?i.set(o,a,1):i.set(o,a,0);return i}get upperTriangularMatrix(){let n=this.LU,t=n.rows,r=n.columns,i=new wt(t,r);for(let o=0;o<t;o++)for(let a=0;a<r;a++)o<=a?i.set(o,a,n.get(o,a)):i.set(o,a,0);return i}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function Io(e,n){let t=0;return Math.abs(e)>Math.abs(n)?(t=n/e,Math.abs(e)*Math.sqrt(1+t*t)):n!==0?(t=e/n,Math.abs(n)*Math.sqrt(1+t*t)):0}class s1{constructor(n){let t,r,i,o,a=(n=Vr.checkMatrix(n)).clone(),s=n.rows,u=n.columns,c=new Float64Array(u);for(i=0;i<u;i++){let l=0;for(t=i;t<s;t++)l=Io(l,a.get(t,i));if(l!==0){for(a.get(i,i)<0&&(l=-l),t=i;t<s;t++)a.set(t,i,a.get(t,i)/l);for(a.set(i,i,a.get(i,i)+1),r=i+1;r<u;r++){for(o=0,t=i;t<s;t++)o+=a.get(t,i)*a.get(t,r);for(o=-o/a.get(i,i),t=i;t<s;t++)a.set(t,r,a.get(t,r)+o*a.get(t,i))}}c[i]=-l}this.QR=a,this.Rdiag=c}solve(n){n=wt.checkMatrix(n);let t=this.QR,r=t.rows;if(n.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let i,o,a,s,u=n.columns,c=n.clone(),l=t.columns;for(a=0;a<l;a++)for(o=0;o<u;o++){for(s=0,i=a;i<r;i++)s+=t.get(i,a)*c.get(i,o);for(s=-s/t.get(a,a),i=a;i<r;i++)c.set(i,o,c.get(i,o)+s*t.get(i,a))}for(a=l-1;a>=0;a--){for(o=0;o<u;o++)c.set(a,o,c.get(a,o)/this.Rdiag[a]);for(i=0;i<a;i++)for(o=0;o<u;o++)c.set(i,o,c.get(i,o)-c.get(a,o)*t.get(i,a))}return c.subMatrix(0,l-1,0,u-1)}isFullRank(){let n=this.QR.columns;for(let t=0;t<n;t++)if(this.Rdiag[t]===0)return!1;return!0}get upperTriangularMatrix(){let n,t,r=this.QR,i=r.columns,o=new wt(i,i);for(n=0;n<i;n++)for(t=0;t<i;t++)n<t?o.set(n,t,r.get(n,t)):n===t?o.set(n,t,this.Rdiag[n]):o.set(n,t,0);return o}get orthogonalMatrix(){let n,t,r,i,o=this.QR,a=o.rows,s=o.columns,u=new wt(a,s);for(r=s-1;r>=0;r--){for(n=0;n<a;n++)u.set(n,r,0);for(u.set(r,r,1),t=r;t<s;t++)if(o.get(r,r)!==0){for(i=0,n=r;n<a;n++)i+=o.get(n,r)*u.get(n,t);for(i=-i/o.get(r,r),n=r;n<a;n++)u.set(n,t,u.get(n,t)+i*o.get(n,r))}}return u}}class Ru{constructor(n,t={}){let r=(n=Vr.checkMatrix(n)).rows,i=n.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:a=!0,autoTranspose:s=!1}=t;let u,c=!!o,l=!!a,h=!1;if(r<i)if(s){u=n.transpose(),r=u.rows,i=u.columns,h=!0;let S=c;c=l,l=S}else u=n.clone();else u=n.clone();let f=Math.min(r,i),d=Math.min(r+1,i),p=new Float64Array(d),g=new wt(r,f),v=new wt(i,i),m=new Float64Array(i),y=new Float64Array(r),b=new Float64Array(d);for(let S=0;S<d;S++)b[S]=S;let x=Math.min(r-1,i),w=Math.max(0,Math.min(i-2,r)),E=Math.max(x,w);for(let S=0;S<E;S++){if(S<x){p[S]=0;for(let C=S;C<r;C++)p[S]=Io(p[S],u.get(C,S));if(p[S]!==0){u.get(S,S)<0&&(p[S]=-p[S]);for(let C=S;C<r;C++)u.set(C,S,u.get(C,S)/p[S]);u.set(S,S,u.get(S,S)+1)}p[S]=-p[S]}for(let C=S+1;C<i;C++){if(S<x&&p[S]!==0){let T=0;for(let A=S;A<r;A++)T+=u.get(A,S)*u.get(A,C);T=-T/u.get(S,S);for(let A=S;A<r;A++)u.set(A,C,u.get(A,C)+T*u.get(A,S))}m[C]=u.get(S,C)}if(c&&S<x)for(let C=S;C<r;C++)g.set(C,S,u.get(C,S));if(S<w){m[S]=0;for(let C=S+1;C<i;C++)m[S]=Io(m[S],m[C]);if(m[S]!==0){m[S+1]<0&&(m[S]=0-m[S]);for(let C=S+1;C<i;C++)m[C]/=m[S];m[S+1]+=1}if(m[S]=-m[S],S+1<r&&m[S]!==0){for(let C=S+1;C<r;C++)y[C]=0;for(let C=S+1;C<r;C++)for(let T=S+1;T<i;T++)y[C]+=m[T]*u.get(C,T);for(let C=S+1;C<i;C++){let T=-m[C]/m[S+1];for(let A=S+1;A<r;A++)u.set(A,C,u.get(A,C)+T*y[A])}}if(l)for(let C=S+1;C<i;C++)v.set(C,S,m[C])}}let M=Math.min(i,r+1);if(x<i&&(p[x]=u.get(x,x)),r<M&&(p[M-1]=0),w+1<M&&(m[w]=u.get(w,M-1)),m[M-1]=0,c){for(let S=x;S<f;S++){for(let C=0;C<r;C++)g.set(C,S,0);g.set(S,S,1)}for(let S=x-1;S>=0;S--)if(p[S]!==0){for(let C=S+1;C<f;C++){let T=0;for(let A=S;A<r;A++)T+=g.get(A,S)*g.get(A,C);T=-T/g.get(S,S);for(let A=S;A<r;A++)g.set(A,C,g.get(A,C)+T*g.get(A,S))}for(let C=S;C<r;C++)g.set(C,S,-g.get(C,S));g.set(S,S,1+g.get(S,S));for(let C=0;C<S-1;C++)g.set(C,S,0)}else{for(let C=0;C<r;C++)g.set(C,S,0);g.set(S,S,1)}}if(l)for(let S=i-1;S>=0;S--){if(S<w&&m[S]!==0)for(let C=S+1;C<i;C++){let T=0;for(let A=S+1;A<i;A++)T+=v.get(A,S)*v.get(A,C);T=-T/v.get(S+1,S);for(let A=S+1;A<i;A++)v.set(A,C,v.get(A,C)+T*v.get(A,S))}for(let C=0;C<i;C++)v.set(C,S,0);v.set(S,S,1)}let _=M-1,k=Number.EPSILON;for(;M>0;){let S,C;for(S=M-2;S>=-1&&S!==-1;S--){const T=Number.MIN_VALUE+k*Math.abs(p[S]+Math.abs(p[S+1]));if(Math.abs(m[S])<=T||Number.isNaN(m[S])){m[S]=0;break}}if(S===M-2)C=4;else{let T;for(T=M-1;T>=S&&T!==S;T--){let A=(T!==M?Math.abs(m[T]):0)+(T!==S+1?Math.abs(m[T-1]):0);if(Math.abs(p[T])<=k*A){p[T]=0;break}}T===S?C=3:T===M-1?C=1:(C=2,S=T)}switch(S++,C){case 1:{let T=m[M-2];m[M-2]=0;for(let A=M-2;A>=S;A--){let D=Io(p[A],T),j=p[A]/D,L=T/D;if(p[A]=D,A!==S&&(T=-L*m[A-1],m[A-1]=j*m[A-1]),l)for(let B=0;B<i;B++)D=j*v.get(B,A)+L*v.get(B,M-1),v.set(B,M-1,-L*v.get(B,A)+j*v.get(B,M-1)),v.set(B,A,D)}break}case 2:{let T=m[S-1];m[S-1]=0;for(let A=S;A<M;A++){let D=Io(p[A],T),j=p[A]/D,L=T/D;if(p[A]=D,T=-L*m[A],m[A]=j*m[A],c)for(let B=0;B<r;B++)D=j*g.get(B,A)+L*g.get(B,S-1),g.set(B,S-1,-L*g.get(B,A)+j*g.get(B,S-1)),g.set(B,A,D)}break}case 3:{const T=Math.max(Math.abs(p[M-1]),Math.abs(p[M-2]),Math.abs(m[M-2]),Math.abs(p[S]),Math.abs(m[S])),A=p[M-1]/T,D=p[M-2]/T,j=m[M-2]/T,L=p[S]/T,B=m[S]/T,N=((D+A)*(D-A)+j*j)/2,R=A*j*(A*j);let P=0;N===0&&R===0||(P=N<0?0-Math.sqrt(N*N+R):Math.sqrt(N*N+R),P=R/(N+P));let H=(L+A)*(L-A)+P,ne=L*B;for(let Z=S;Z<M-1;Z++){let q=Io(H,ne);q===0&&(q=Number.MIN_VALUE);let te=H/q,we=ne/q;if(Z!==S&&(m[Z-1]=q),H=te*p[Z]+we*m[Z],m[Z]=te*m[Z]-we*p[Z],ne=we*p[Z+1],p[Z+1]=te*p[Z+1],l)for(let pe=0;pe<i;pe++)q=te*v.get(pe,Z)+we*v.get(pe,Z+1),v.set(pe,Z+1,-we*v.get(pe,Z)+te*v.get(pe,Z+1)),v.set(pe,Z,q);if(q=Io(H,ne),q===0&&(q=Number.MIN_VALUE),te=H/q,we=ne/q,p[Z]=q,H=te*m[Z]+we*p[Z+1],p[Z+1]=-we*m[Z]+te*p[Z+1],ne=we*m[Z+1],m[Z+1]=te*m[Z+1],c&&Z<r-1)for(let pe=0;pe<r;pe++)q=te*g.get(pe,Z)+we*g.get(pe,Z+1),g.set(pe,Z+1,-we*g.get(pe,Z)+te*g.get(pe,Z+1)),g.set(pe,Z,q)}m[M-2]=H;break}case 4:if(p[S]<=0&&(p[S]=p[S]<0?-p[S]:0,l))for(let T=0;T<=_;T++)v.set(T,S,-v.get(T,S));for(;S<_&&!(p[S]>=p[S+1]);){let T=p[S];if(p[S]=p[S+1],p[S+1]=T,l&&S<i-1)for(let A=0;A<i;A++)T=v.get(A,S+1),v.set(A,S+1,v.get(A,S)),v.set(A,S,T);if(c&&S<r-1)for(let A=0;A<r;A++)T=g.get(A,S+1),g.set(A,S+1,g.get(A,S)),g.set(A,S,T);S++}M--}}if(h){let S=v;v=g,g=S}this.m=r,this.n=i,this.s=p,this.U=g,this.V=v}solve(n){let t=n,r=this.threshold,i=this.s.length,o=wt.zeros(i,i);for(let f=0;f<i;f++)Math.abs(this.s[f])<=r?o.set(f,f,0):o.set(f,f,1/this.s[f]);let a=this.U,s=this.rightSingularVectors,u=s.mmul(o),c=s.rows,l=a.rows,h=wt.zeros(c,l);for(let f=0;f<c;f++)for(let d=0;d<l;d++){let p=0;for(let g=0;g<i;g++)p+=u.get(f,g)*a.get(d,g);h.set(f,d,p)}return h.mmul(t)}solveForDiagonal(n){return this.solve(wt.diag(n))}inverse(){let n=this.V,t=this.threshold,r=n.rows,i=n.columns,o=new wt(r,this.s.length);for(let l=0;l<r;l++)for(let h=0;h<i;h++)Math.abs(this.s[h])>t&&o.set(l,h,n.get(l,h)/this.s[h]);let a=this.U,s=a.rows,u=a.columns,c=new wt(r,s);for(let l=0;l<r;l++)for(let h=0;h<s;h++){let f=0;for(let d=0;d<u;d++)f+=o.get(l,d)*a.get(h,d);c.set(l,h,f)}return c}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let n=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,t=0,r=this.s;for(let i=0,o=r.length;i<o;i++)r[i]>n&&t++;return t}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return wt.diag(this.s)}}function e3(e,n,t=!1){return e=Vr.checkMatrix(e),n=Vr.checkMatrix(n),t?new Ru(e).solve(n):e.isSquare()?new bp(e).solve(n):new s1(e).solve(n)}function yU(e,n){let t=[];for(let r=0;r<e;r++)r!==n&&t.push(r);return t}function bU(e,n,t,r=1e-9,i=1e-9){if(e>i)return new Array(n.rows+1).fill(0);{let o=n.addRow(t,[0]);for(let a=0;a<o.rows;a++)Math.abs(o.get(a,0))<r&&o.set(a,0,0);return o.to1DArray()}}class t3{constructor(n,t={}){const{assumeSymmetric:r=!1}=t;if(!(n=Vr.checkMatrix(n)).isSquare())throw new Error("Matrix is not a square matrix");let i,o,a=n.columns,s=new wt(a,a),u=new Float64Array(a),c=new Float64Array(a),l=n,h=!1;if(h=!!r||n.isSymmetric(),h){for(i=0;i<a;i++)for(o=0;o<a;o++)s.set(i,o,l.get(i,o));(function(f,d,p,g){let v,m,y,b,x,w,E,M;for(x=0;x<f;x++)p[x]=g.get(f-1,x);for(b=f-1;b>0;b--){for(M=0,y=0,w=0;w<b;w++)M+=Math.abs(p[w]);if(M===0)for(d[b]=p[b-1],x=0;x<b;x++)p[x]=g.get(b-1,x),g.set(b,x,0),g.set(x,b,0);else{for(w=0;w<b;w++)p[w]/=M,y+=p[w]*p[w];for(v=p[b-1],m=Math.sqrt(y),v>0&&(m=-m),d[b]=M*m,y-=v*m,p[b-1]=v-m,x=0;x<b;x++)d[x]=0;for(x=0;x<b;x++){for(v=p[x],g.set(x,b,v),m=d[x]+g.get(x,x)*v,w=x+1;w<=b-1;w++)m+=g.get(w,x)*p[w],d[w]+=g.get(w,x)*v;d[x]=m}for(v=0,x=0;x<b;x++)d[x]/=y,v+=d[x]*p[x];for(E=v/(y+y),x=0;x<b;x++)d[x]-=E*p[x];for(x=0;x<b;x++){for(v=p[x],m=d[x],w=x;w<=b-1;w++)g.set(w,x,g.get(w,x)-(v*d[w]+m*p[w]));p[x]=g.get(b-1,x),g.set(b,x,0)}}p[b]=y}for(b=0;b<f-1;b++){if(g.set(f-1,b,g.get(b,b)),g.set(b,b,1),y=p[b+1],y!==0){for(w=0;w<=b;w++)p[w]=g.get(w,b+1)/y;for(x=0;x<=b;x++){for(m=0,w=0;w<=b;w++)m+=g.get(w,b+1)*g.get(w,x);for(w=0;w<=b;w++)g.set(w,x,g.get(w,x)-m*p[w])}}for(w=0;w<=b;w++)g.set(w,b+1,0)}for(x=0;x<f;x++)p[x]=g.get(f-1,x),g.set(f-1,x,0);g.set(f-1,f-1,1),d[0]=0})(a,c,u,s),function(f,d,p,g){let v,m,y,b,x,w,E,M,_,k,S,C,T,A,D,j;for(y=1;y<f;y++)d[y-1]=d[y];d[f-1]=0;let L=0,B=0,N=Number.EPSILON;for(w=0;w<f;w++){for(B=Math.max(B,Math.abs(p[w])+Math.abs(d[w])),E=w;E<f&&!(Math.abs(d[E])<=N*B);)E++;if(E>w)do{for(v=p[w],M=(p[w+1]-v)/(2*d[w]),_=Io(M,1),M<0&&(_=-_),p[w]=d[w]/(M+_),p[w+1]=d[w]*(M+_),k=p[w+1],m=v-p[w],y=w+2;y<f;y++)p[y]-=m;for(L+=m,M=p[E],S=1,C=S,T=S,A=d[w+1],D=0,j=0,y=E-1;y>=w;y--)for(T=C,C=S,j=D,v=S*d[y],m=S*M,_=Io(M,d[y]),d[y+1]=D*_,D=d[y]/_,S=M/_,M=S*p[y]-D*v,p[y+1]=m+D*(S*v+D*p[y]),x=0;x<f;x++)m=g.get(x,y+1),g.set(x,y+1,D*g.get(x,y)+S*m),g.set(x,y,S*g.get(x,y)-D*m);M=-D*j*T*A*d[w]/k,d[w]=D*M,p[w]=S*M}while(Math.abs(d[w])>N*B);p[w]=p[w]+L,d[w]=0}for(y=0;y<f-1;y++){for(x=y,M=p[y],b=y+1;b<f;b++)p[b]<M&&(x=b,M=p[b]);if(x!==y)for(p[x]=p[y],p[y]=M,b=0;b<f;b++)M=g.get(b,y),g.set(b,y,g.get(b,x)),g.set(b,x,M)}}(a,c,u,s)}else{let f=new wt(a,a),d=new Float64Array(a);for(o=0;o<a;o++)for(i=0;i<a;i++)f.set(i,o,l.get(i,o));(function(p,g,v,m){let y,b,x,w,E,M,_,k=0,S=p-1;for(M=k+1;M<=S-1;M++){for(_=0,w=M;w<=S;w++)_+=Math.abs(g.get(w,M-1));if(_!==0){for(x=0,w=S;w>=M;w--)v[w]=g.get(w,M-1)/_,x+=v[w]*v[w];for(b=Math.sqrt(x),v[M]>0&&(b=-b),x-=v[M]*b,v[M]=v[M]-b,E=M;E<p;E++){for(y=0,w=S;w>=M;w--)y+=v[w]*g.get(w,E);for(y/=x,w=M;w<=S;w++)g.set(w,E,g.get(w,E)-y*v[w])}for(w=0;w<=S;w++){for(y=0,E=S;E>=M;E--)y+=v[E]*g.get(w,E);for(y/=x,E=M;E<=S;E++)g.set(w,E,g.get(w,E)-y*v[E])}v[M]=_*v[M],g.set(M,M-1,_*b)}}for(w=0;w<p;w++)for(E=0;E<p;E++)m.set(w,E,w===E?1:0);for(M=S-1;M>=k+1;M--)if(g.get(M,M-1)!==0){for(w=M+1;w<=S;w++)v[w]=g.get(w,M-1);for(E=M;E<=S;E++){for(b=0,w=M;w<=S;w++)b+=v[w]*m.get(w,E);for(b=b/v[M]/g.get(M,M-1),w=M;w<=S;w++)m.set(w,E,m.get(w,E)+b*v[w])}}})(a,f,d,s),function(p,g,v,m,y){let b,x,w,E,M,_,k,S,C,T,A,D,j,L,B,N=p-1,R=0,P=p-1,H=Number.EPSILON,ne=0,Z=0,q=0,te=0,we=0,pe=0,Me=0,Be=0;for(b=0;b<p;b++)for((b<R||b>P)&&(v[b]=y.get(b,b),g[b]=0),x=Math.max(b-1,0);x<p;x++)Z+=Math.abs(y.get(b,x));for(;N>=R;){for(E=N;E>R&&(pe=Math.abs(y.get(E-1,E-1))+Math.abs(y.get(E,E)),pe===0&&(pe=Z),!(Math.abs(y.get(E,E-1))<H*pe));)E--;if(E===N)y.set(N,N,y.get(N,N)+ne),v[N]=y.get(N,N),g[N]=0,N--,Be=0;else if(E===N-1){if(k=y.get(N,N-1)*y.get(N-1,N),q=(y.get(N-1,N-1)-y.get(N,N))/2,te=q*q+k,Me=Math.sqrt(Math.abs(te)),y.set(N,N,y.get(N,N)+ne),y.set(N-1,N-1,y.get(N-1,N-1)+ne),S=y.get(N,N),te>=0){for(Me=q>=0?q+Me:q-Me,v[N-1]=S+Me,v[N]=v[N-1],Me!==0&&(v[N]=S-k/Me),g[N-1]=0,g[N]=0,S=y.get(N,N-1),pe=Math.abs(S)+Math.abs(Me),q=S/pe,te=Me/pe,we=Math.sqrt(q*q+te*te),q/=we,te/=we,x=N-1;x<p;x++)Me=y.get(N-1,x),y.set(N-1,x,te*Me+q*y.get(N,x)),y.set(N,x,te*y.get(N,x)-q*Me);for(b=0;b<=N;b++)Me=y.get(b,N-1),y.set(b,N-1,te*Me+q*y.get(b,N)),y.set(b,N,te*y.get(b,N)-q*Me);for(b=R;b<=P;b++)Me=m.get(b,N-1),m.set(b,N-1,te*Me+q*m.get(b,N)),m.set(b,N,te*m.get(b,N)-q*Me)}else v[N-1]=S+q,v[N]=S+q,g[N-1]=Me,g[N]=-Me;N-=2,Be=0}else{if(S=y.get(N,N),C=0,k=0,E<N&&(C=y.get(N-1,N-1),k=y.get(N,N-1)*y.get(N-1,N)),Be===10){for(ne+=S,b=R;b<=N;b++)y.set(b,b,y.get(b,b)-S);pe=Math.abs(y.get(N,N-1))+Math.abs(y.get(N-1,N-2)),S=C=.75*pe,k=-.4375*pe*pe}if(Be===30&&(pe=(C-S)/2,pe=pe*pe+k,pe>0)){for(pe=Math.sqrt(pe),C<S&&(pe=-pe),pe=S-k/((C-S)/2+pe),b=R;b<=N;b++)y.set(b,b,y.get(b,b)-pe);ne+=pe,S=C=k=.964}for(Be+=1,M=N-2;M>=E&&(Me=y.get(M,M),we=S-Me,pe=C-Me,q=(we*pe-k)/y.get(M+1,M)+y.get(M,M+1),te=y.get(M+1,M+1)-Me-we-pe,we=y.get(M+2,M+1),pe=Math.abs(q)+Math.abs(te)+Math.abs(we),q/=pe,te/=pe,we/=pe,M!==E)&&!(Math.abs(y.get(M,M-1))*(Math.abs(te)+Math.abs(we))<H*(Math.abs(q)*(Math.abs(y.get(M-1,M-1))+Math.abs(Me)+Math.abs(y.get(M+1,M+1)))));)M--;for(b=M+2;b<=N;b++)y.set(b,b-2,0),b>M+2&&y.set(b,b-3,0);for(w=M;w<=N-1&&(L=w!==N-1,w!==M&&(q=y.get(w,w-1),te=y.get(w+1,w-1),we=L?y.get(w+2,w-1):0,S=Math.abs(q)+Math.abs(te)+Math.abs(we),S!==0&&(q/=S,te/=S,we/=S)),S!==0);w++)if(pe=Math.sqrt(q*q+te*te+we*we),q<0&&(pe=-pe),pe!==0){for(w!==M?y.set(w,w-1,-pe*S):E!==M&&y.set(w,w-1,-y.get(w,w-1)),q+=pe,S=q/pe,C=te/pe,Me=we/pe,te/=q,we/=q,x=w;x<p;x++)q=y.get(w,x)+te*y.get(w+1,x),L&&(q+=we*y.get(w+2,x),y.set(w+2,x,y.get(w+2,x)-q*Me)),y.set(w,x,y.get(w,x)-q*S),y.set(w+1,x,y.get(w+1,x)-q*C);for(b=0;b<=Math.min(N,w+3);b++)q=S*y.get(b,w)+C*y.get(b,w+1),L&&(q+=Me*y.get(b,w+2),y.set(b,w+2,y.get(b,w+2)-q*we)),y.set(b,w,y.get(b,w)-q),y.set(b,w+1,y.get(b,w+1)-q*te);for(b=R;b<=P;b++)q=S*m.get(b,w)+C*m.get(b,w+1),L&&(q+=Me*m.get(b,w+2),m.set(b,w+2,m.get(b,w+2)-q*we)),m.set(b,w,m.get(b,w)-q),m.set(b,w+1,m.get(b,w+1)-q*te)}}}if(Z!==0){for(N=p-1;N>=0;N--)if(q=v[N],te=g[N],te===0)for(E=N,y.set(N,N,1),b=N-1;b>=0;b--){for(k=y.get(b,b)-q,we=0,x=E;x<=N;x++)we+=y.get(b,x)*y.get(x,N);if(g[b]<0)Me=k,pe=we;else if(E=b,g[b]===0?y.set(b,N,k!==0?-we/k:-we/(H*Z)):(S=y.get(b,b+1),C=y.get(b+1,b),te=(v[b]-q)*(v[b]-q)+g[b]*g[b],_=(S*pe-Me*we)/te,y.set(b,N,_),y.set(b+1,N,Math.abs(S)>Math.abs(Me)?(-we-k*_)/S:(-pe-C*_)/Me)),_=Math.abs(y.get(b,N)),H*_*_>1)for(x=b;x<=N;x++)y.set(x,N,y.get(x,N)/_)}else if(te<0)for(E=N-1,Math.abs(y.get(N,N-1))>Math.abs(y.get(N-1,N))?(y.set(N-1,N-1,te/y.get(N,N-1)),y.set(N-1,N,-(y.get(N,N)-q)/y.get(N,N-1))):(B=xp(0,-y.get(N-1,N),y.get(N-1,N-1)-q,te),y.set(N-1,N-1,B[0]),y.set(N-1,N,B[1])),y.set(N,N-1,0),y.set(N,N,1),b=N-2;b>=0;b--){for(T=0,A=0,x=E;x<=N;x++)T+=y.get(b,x)*y.get(x,N-1),A+=y.get(b,x)*y.get(x,N);if(k=y.get(b,b)-q,g[b]<0)Me=k,we=T,pe=A;else if(E=b,g[b]===0?(B=xp(-T,-A,k,te),y.set(b,N-1,B[0]),y.set(b,N,B[1])):(S=y.get(b,b+1),C=y.get(b+1,b),D=(v[b]-q)*(v[b]-q)+g[b]*g[b]-te*te,j=2*(v[b]-q)*te,D===0&&j===0&&(D=H*Z*(Math.abs(k)+Math.abs(te)+Math.abs(S)+Math.abs(C)+Math.abs(Me))),B=xp(S*we-Me*T+te*A,S*pe-Me*A-te*T,D,j),y.set(b,N-1,B[0]),y.set(b,N,B[1]),Math.abs(S)>Math.abs(Me)+Math.abs(te)?(y.set(b+1,N-1,(-T-k*y.get(b,N-1)+te*y.get(b,N))/S),y.set(b+1,N,(-A-k*y.get(b,N)-te*y.get(b,N-1))/S)):(B=xp(-we-C*y.get(b,N-1),-pe-C*y.get(b,N),Me,te),y.set(b+1,N-1,B[0]),y.set(b+1,N,B[1]))),_=Math.max(Math.abs(y.get(b,N-1)),Math.abs(y.get(b,N))),H*_*_>1)for(x=b;x<=N;x++)y.set(x,N-1,y.get(x,N-1)/_),y.set(x,N,y.get(x,N)/_)}for(b=0;b<p;b++)if(b<R||b>P)for(x=b;x<p;x++)m.set(b,x,y.get(b,x));for(x=p-1;x>=R;x--)for(b=R;b<=P;b++){for(Me=0,w=R;w<=Math.min(x,P);w++)Me+=m.get(b,w)*y.get(w,x);m.set(b,x,Me)}}}(a,c,u,s,f)}this.n=a,this.e=c,this.d=u,this.V=s}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let n,t,r=this.n,i=this.e,o=this.d,a=new wt(r,r);for(n=0;n<r;n++){for(t=0;t<r;t++)a.set(n,t,0);a.set(n,n,o[n]),i[n]>0?a.set(n,n+1,i[n]):i[n]<0&&a.set(n,n-1,i[n])}return a}}function xp(e,n,t,r){let i,o;return Math.abs(t)>Math.abs(r)?(i=r/t,o=t+i*r,[(e+i*n)/o,(n-i*e)/o]):(i=t/r,o=r+i*t,[(i*e+n)/o,(i*n-e)/o])}class n3{constructor(n){if(!(n=Vr.checkMatrix(n)).isSymmetric())throw new Error("Matrix is not symmetric");let t,r,i,o=n,a=o.rows,s=new wt(a,a),u=!0;for(r=0;r<a;r++){let c=0;for(i=0;i<r;i++){let l=0;for(t=0;t<i;t++)l+=s.get(i,t)*s.get(r,t);l=(o.get(r,i)-l)/s.get(i,i),s.set(r,i,l),c+=l*l}for(c=o.get(r,r)-c,u&=c>0,s.set(r,r,Math.sqrt(Math.max(c,0))),i=r+1;i<a;i++)s.set(r,i,0)}this.L=s,this.positiveDefinite=!!u}isPositiveDefinite(){return this.positiveDefinite}solve(n){n=Vr.checkMatrix(n);let t=this.L,r=t.rows;if(n.rows!==r)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");let i,o,a,s=n.columns,u=n.clone();for(a=0;a<r;a++)for(o=0;o<s;o++){for(i=0;i<a;i++)u.set(a,o,u.get(a,o)-u.get(i,o)*t.get(a,i));u.set(a,o,u.get(a,o)/t.get(a,a))}for(a=r-1;a>=0;a--)for(o=0;o<s;o++){for(i=a+1;i<r;i++)u.set(a,o,u.get(a,o)-u.get(i,o)*t.get(i,a));u.set(a,o,u.get(a,o)/t.get(a,a))}return u}get lowerTriangularMatrix(){return this.L}}class r3{constructor(n,t={}){n=Vr.checkMatrix(n);let{Y:r}=t;const{scaleScores:i=!1,maxIterations:o=1e3,terminationCriteria:a=1e-10}=t;let s;if(r){if(r=Array.isArray(r)&&typeof r[0]=="number"?wt.columnVector(r):Vr.checkMatrix(r),!r.isColumnVector()||r.rows!==n.rows)throw new Error("Y must be a column vector of length X.rows");s=r}else s=n.getColumnVector(0);let u,c,l,h,f=1;for(let d=0;d<o&&f>a;d++)l=n.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0)),l=l.div(l.norm()),u=n.mmul(l).div(l.transpose().mmul(l).get(0,0)),d>0&&(f=u.clone().sub(h).pow(2).sum()),h=u.clone(),r?(c=r.transpose().mmul(u).div(u.transpose().mmul(u).get(0,0)),c=c.div(c.norm()),s=r.mmul(c).div(c.transpose().mmul(c).get(0,0))):s=u;if(r){let d=n.transpose().mmul(u).div(u.transpose().mmul(u).get(0,0));d=d.div(d.norm());let p=n.clone().sub(u.clone().mmul(d.transpose())),g=s.transpose().mmul(u).div(u.transpose().mmul(u).get(0,0)),v=r.clone().sub(u.clone().mulS(g.get(0,0)).mmul(c.transpose()));this.t=u,this.p=d.transpose(),this.w=l.transpose(),this.q=c,this.u=s,this.s=u.transpose().mmul(u),this.xResidual=p,this.yResidual=v,this.betas=g}else this.w=l.transpose(),this.s=u.transpose().mmul(u).sqrt(),this.t=i?u.clone().div(this.s.get(0,0)):u,this.xResidual=n.sub(u.mmul(l.transpose()))}}const xU=Object.freeze(Object.defineProperty({__proto__:null,AbstractMatrix:Qt,CHO:n3,CholeskyDecomposition:n3,EVD:t3,EigenvalueDecomposition:t3,LU:bp,LuDecomposition:bp,Matrix:wt,MatrixColumnSelectionView:class extends Ao{constructor(e,n){n=$T(e,n),super(e,e.rows,n.length),this.columnIndices=n}set(e,n,t){return this.matrix.set(e,this.columnIndices[n],t),this}get(e,n){return this.matrix.get(e,this.columnIndices[n])}},MatrixColumnView:class extends Ao{constructor(e,n){si(e,n),super(e,e.rows,1),this.column=n}set(e,n,t){return this.matrix.set(e,this.column,t),this}get(e){return this.matrix.get(e,this.column)}},MatrixFlipColumnView:class extends Ao{constructor(e){super(e,e.rows,e.columns)}set(e,n,t){return this.matrix.set(e,this.columns-n-1,t),this}get(e,n){return this.matrix.get(e,this.columns-n-1)}},MatrixFlipRowView:class extends Ao{constructor(e){super(e,e.rows,e.columns)}set(e,n,t){return this.matrix.set(this.rows-e-1,n,t),this}get(e,n){return this.matrix.get(this.rows-e-1,n)}},MatrixRowSelectionView:class extends Ao{constructor(e,n){super(e,(n=KT(e,n)).length,e.columns),this.rowIndices=n}set(e,n,t){return this.matrix.set(this.rowIndices[e],n,t),this}get(e,n){return this.matrix.get(this.rowIndices[e],n)}},MatrixRowView:class extends Ao{constructor(e,n){ai(e,n),super(e,1,e.columns),this.row=n}set(e,n,t){return this.matrix.set(this.row,n,t),this}get(e,n){return this.matrix.get(this.row,n)}},MatrixSelectionView:yp,MatrixSubView:class extends Ao{constructor(e,n,t,r,i){a1(e,n,t,r,i),super(e,t-n+1,i-r+1),this.startRow=n,this.startColumn=r}set(e,n,t){return this.matrix.set(this.startRow+e,this.startColumn+n,t),this}get(e,n){return this.matrix.get(this.startRow+e,this.startColumn+n)}},MatrixTransposeView:class extends Ao{constructor(e){super(e,e.columns,e.rows)}set(e,n,t){return this.matrix.set(n,e,t),this}get(e,n){return this.matrix.get(n,e)}},NIPALS:r3,Nipals:r3,QR:s1,QrDecomposition:s1,SVD:Ru,SingularValueDecomposition:Ru,WrapperMatrix1D:JT,WrapperMatrix2D:Vr,correlation:function(e,n=e,t={}){e=new wt(e);let r=!1;if(typeof n!="object"||wt.isMatrix(n)||Array.isArray(n)?n=new wt(n):(t=n,n=e,r=!0),e.rows!==n.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:i=!0,scale:o=!0}=t;i&&(e.center("column"),r||n.center("column")),o&&(e.scale("column"),r||n.scale("column"));const a=e.standardDeviation("column",{unbiased:!0}),s=r?a:n.standardDeviation("column",{unbiased:!0}),u=e.transpose().mmul(n);for(let c=0;c<u.rows;c++)for(let l=0;l<u.columns;l++)u.set(c,l,u.get(c,l)*(1/(a[c]*s[l]))*(1/(e.rows-1)));return u},covariance:function(e,n=e,t={}){e=new wt(e);let r=!1;if(typeof n!="object"||wt.isMatrix(n)||Array.isArray(n)?n=new wt(n):(t=n,n=e,r=!0),e.rows!==n.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:i=!0}=t;i&&(e=e.center("column"),r||(n=n.center("column")));const o=e.transpose().mmul(n);for(let a=0;a<o.rows;a++)for(let s=0;s<o.columns;s++)o.set(a,s,o.get(a,s)*(1/(e.rows-1)));return o},default:wt,determinant:function e(n){if((n=wt.checkMatrix(n)).isSquare()){let t,r,i,o;if(n.columns===2)return t=n.get(0,0),r=n.get(0,1),i=n.get(1,0),o=n.get(1,1),t*o-r*i;if(n.columns===3){let a,s,u;return a=new yp(n,[1,2],[1,2]),s=new yp(n,[1,2],[0,2]),u=new yp(n,[1,2],[0,1]),t=n.get(0,0),r=n.get(0,1),i=n.get(0,2),t*e(a)-r*e(s)+i*e(u)}return new bp(n).determinant}throw Error("determinant can only be calculated for a square matrix")},inverse:function(e,n=!1){return e=Vr.checkMatrix(e),n?new Ru(e).inverse():e3(e,wt.eye(e.rows))},linearDependencies:function(e,n={}){const{thresholdValue:t=1e-9,thresholdError:r=1e-9}=n;let i=(e=wt.checkMatrix(e)).rows,o=new wt(i,i);for(let a=0;a<i;a++){let s=wt.columnVector(e.getRow(a)),u=e.subMatrixRow(yU(i,a)).transpose(),c=new Ru(u).solve(s),l=wt.sub(s,u.mmul(c)).abs().max();o.setRow(a,bU(l,c,a,t,r))}return o},pseudoInverse:function(e,n=Number.EPSILON){e=wt.checkMatrix(e);let t=new Ru(e,{autoTranspose:!0}),r=t.leftSingularVectors,i=t.rightSingularVectors,o=t.diagonal;for(let a=0;a<o.length;a++)Math.abs(o[a])>n?o[a]=1/o[a]:o[a]=0;return i.mmul(wt.diag(o).mmul(r.transpose()))},solve:e3,wrap:function(e,n){if(Array.isArray(e))return e[0]&&Array.isArray(e[0])?new Vr(e):new JT(e,n);throw new Error("the argument is not an array")}},Symbol.toStringTag,{value:"Module"})),i3=ji(xU);Object.defineProperty(o1,"__esModule",{value:!0});var _l=i3,wU=function(){function e(n){this.distances=n.distances,this.dimension=n.dimension||2,this.linkDistance=n.linkDistance}return e.prototype.layout=function(){var n=this,t=n.dimension,r=n.distances,i=n.linkDistance;try{var o=_l.Matrix.mul(_l.Matrix.pow(r,2),-.5),a=o.mean("row"),s=o.mean("column"),u=o.mean();o.add(u).subRowVector(a).subColumnVector(s);var c=new _l.SingularValueDecomposition(o),l=_l.Matrix.sqrt(c.diagonalMatrix).diagonal();return c.leftSingularVectors.toJSON().map(function(g){return _l.Matrix.mul([g],[l]).toJSON()[0].splice(0,t)})}catch{for(var h=[],f=0;f<r.length;f++){var d=Math.random()*i,p=Math.random()*i;h.push([d,p])}return h}},e}();o1.default=wU;var u1={};Object.defineProperty(u1,"__esModule",{value:!0});var EU=function(){function e(n){this.disp=[],this.positions=n.positions,this.adjMatrix=n.adjMatrix,this.focusID=n.focusID,this.radii=n.radii,this.iterations=n.iterations||10,this.height=n.height||10,this.width=n.width||10,this.speed=n.speed||100,this.gravity=n.gravity||10,this.nodeSizeFunc=n.nodeSizeFunc,this.k=n.k||5,this.strictRadial=n.strictRadial,this.nodes=n.nodes}return e.prototype.layout=function(){var n=this,t=n.positions,r=[],i=n.iterations,o=n.width/10;n.maxDisplace=o,n.disp=r;for(var a=0;a<i;a++)t.forEach(function(s,u){r[u]={x:0,y:0}}),n.getRepulsion(),n.updatePositions();return t},e.prototype.getRepulsion=function(){var n=this,t=n.positions,r=n.nodes,i=n.disp,o=n.k,a=n.radii||[];t.forEach(function(s,u){i[u]={x:0,y:0},t.forEach(function(c,l){if(u!==l&&a[u]===a[l]){var h=s[0]-c[0],f=s[1]-c[1],d=Math.sqrt(h*h+f*f);if(d===0){d=1;var p=u>l?1:-1;h=.01*p,f=.01*p}if(d<n.nodeSizeFunc(r[u])/2+n.nodeSizeFunc(r[l])/2){var g=o*o/d;i[u].x+=h/d*g,i[u].y+=f/d*g}}})})},e.prototype.updatePositions=function(){var n=this,t=n.positions,r=n.disp,i=n.speed,o=n.strictRadial,a=n.focusID,s=n.maxDisplace||n.width/10;o&&r.forEach(function(c,l){var h=t[l][0]-t[a][0],f=t[l][1]-t[a][1],d=Math.sqrt(h*h+f*f),p=f/d,g=-h/d,v=Math.sqrt(c.x*c.x+c.y*c.y),m=Math.acos((p*c.x+g*c.y)/v);m>Math.PI/2&&(m-=Math.PI/2,p*=-1,g*=-1);var y=Math.cos(m)*v;c.x=p*y,c.y=g*y});var u=n.radii;t.forEach(function(c,l){if(l!==a){var h=Math.sqrt(r[l].x*r[l].x+r[l].y*r[l].y);if(h>0&&l!==a){var f=Math.min(s*(i/800),h);if(c[0]+=r[l].x/h*f,c[1]+=r[l].y/h*f,o){var d=c[0]-t[a][0],p=c[1]-t[a][1],g=Math.sqrt(d*d+p*p);d=d/g*u[l],p=p/g*u[l],c[0]=t[a][0]+d,c[1]=t[a][1]+p}}}})},e}();u1.default=EU;var MU=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),o3=xe&&xe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(dp,"__esModule",{value:!0}),dp.RadialLayout=void 0;var ui=_n(),SU=Nn,_U=o3(o1),kU=o3(u1);function a3(e,n){return Math.sqrt((e[0]-n[0])*(e[0]-n[0])+(e[1]-n[1])*(e[1]-n[1]))}var CU=function(e){function n(t){var r=e.call(this)||this;return r.maxIteration=1e3,r.focusNode=null,r.unitRadius=null,r.linkDistance=50,r.preventOverlap=!1,r.strictRadial=!0,r.maxPreventOverlapIteration=200,r.sortStrength=10,r.nodes=[],r.edges=[],r.updateCfg(t),r}return MU(n,e),n.prototype.getDefaultCfg=function(){return{maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,strictRadial:!0,maxPreventOverlapIteration:200,sortBy:void 0,sortStrength:10}},n.prototype.execute=function(){var t=this,r=t.nodes,i=t.edges||[];if(r&&r.length!==0){t.width||typeof window>"u"||(t.width=window.innerWidth),t.height||typeof window>"u"||(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]);var o=t.center;if(r.length===1)return r[0].x=o[0],r[0].y=o[1],void(t.onLayoutEnd&&t.onLayoutEnd());var a=t.linkDistance,s=null;if((0,ui.isString)(t.focusNode)){for(var u=!1,c=0;c<r.length;c++)r[c].id===t.focusNode&&(s=r[c],t.focusNode=s,u=!0,c=r.length);u||(s=null)}else s=t.focusNode;s||(s=r[0],t.focusNode=s);var l=function(B,N){var R=-1;return B.forEach(function(P,H){P.id===N&&(R=H)}),R}(r,s.id);l<0&&(l=0),t.focusIndex=l;var h=(0,ui.getAdjMatrix)({nodes:r,edges:i},!1),f=(0,ui.floydWarshall)(h),d=t.maxToFocus(f,l);t.handleInfinity(f,l,d+1),t.distances=f;var p=f[l],g=t.width||500,v=t.height||500,m=g-o[0]>o[0]?o[0]:g-o[0],y=v-o[1]>o[1]?o[1]:v-o[1];m===0&&(m=g/2),y===0&&(y=v/2);var b=y>m?m:y,x=Math.max.apply(Math,p),w=[];p.forEach(function(B,N){t.unitRadius||(t.unitRadius=b/x),w[N]=B*t.unitRadius}),t.radii=w;var E=t.eIdealDisMatrix();t.eIdealDistances=E;var M=function(B){for(var N=B.length,R=B[0].length,P=[],H=0;H<N;H++){for(var ne=[],Z=0;Z<R;Z++)B[H][Z]!==0?ne.push(1/(B[H][Z]*B[H][Z])):ne.push(0);P.push(ne)}return P}(E);t.weights=M;var _=new _U.default({linkDistance:a,distances:E}).layout();_.forEach(function(B){(0,ui.isNaN)(B[0])&&(B[0]=Math.random()*a),(0,ui.isNaN)(B[1])&&(B[1]=Math.random()*a)}),t.positions=_,_.forEach(function(B,N){r[N].x=B[0]+o[0],r[N].y=B[1]+o[1]}),_.forEach(function(B){B[0]-=_[l][0],B[1]-=_[l][1]}),t.run();var k,S=t.preventOverlap,C=t.nodeSize,T=t.strictRadial;if(S){var A,D=t.nodeSpacing;A=(0,ui.isNumber)(D)?function(){return D}:(0,ui.isFunction)(D)?D:function(){return 0},k=C?(0,ui.isArray)(C)?function(B){return(C[0]>C[1]?C[0]:C[1])+A(B)}:function(B){return C+A(B)}:function(B){return B.size?(0,ui.isArray)(B.size)?(B.size[0]>B.size[1]?B.size[0]:B.size[1])+A(B):(0,ui.isObject)(B.size)?(B.size.width>B.size.height?B.size.width:B.size.height)+A(B):B.size+A(B):10+A(B)};var j={nodes:r,nodeSizeFunc:k,adjMatrix:h,positions:_,radii:w,height:v,width:g,strictRadial:T,focusID:l,iterations:t.maxPreventOverlapIteration||200,k:_.length/4.5},L=new kU.default(j);_=L.layout()}return _.forEach(function(B,N){r[N].x=B[0]+o[0],r[N].y=B[1]+o[1]}),t.onLayoutEnd&&t.onLayoutEnd(),{nodes:r,edges:i}}t.onLayoutEnd&&t.onLayoutEnd()},n.prototype.run=function(){for(var t=this,r=t.maxIteration,i=t.positions||[],o=t.weights||[],a=t.eIdealDistances||[],s=t.radii||[],u=0;u<=r;u++){var c=u/r;t.oneIteration(c,i,s,a,o)}},n.prototype.oneIteration=function(t,r,i,o,a){var s=1-t,u=this.focusIndex;r.forEach(function(c,l){var h=a3(c,[0,0]),f=h===0?0:1/h;if(l!==u){var d=0,p=0,g=0;r.forEach(function(m,y){if(l!==y){var b=a3(c,m),x=b===0?0:1/b,w=o[y][l];g+=a[l][y],d+=a[l][y]*(m[0]+w*(c[0]-m[0])*x),p+=a[l][y]*(m[1]+w*(c[1]-m[1])*x)}});var v=i[l]===0?0:1/i[l];g*=s,g+=t*v*v,d*=s,d+=t*v*c[0]*f,c[0]=d/g,p*=s,p+=t*v*c[1]*f,c[1]=p/g}})},n.prototype.eIdealDisMatrix=function(){var t=this,r=t.nodes;if(!r)return[];var i=t.distances,o=t.linkDistance,a=t.radii||[],s=t.unitRadius||50,u=[];return i&&i.forEach(function(c,l){var h=[];c.forEach(function(f,d){if(l===d)h.push(0);else if(a[l]===a[d])if(t.sortBy==="data")h.push(f*(Math.abs(l-d)*t.sortStrength)/(a[l]/s));else if(t.sortBy){var p=r[l][t.sortBy]||0,g=r[d][t.sortBy]||0;(0,ui.isString)(p)&&(p=p.charCodeAt(0)),(0,ui.isString)(g)&&(g=g.charCodeAt(0)),h.push(f*(Math.abs(p-g)*t.sortStrength)/(a[l]/s))}else h.push(f*o/(a[l]/s));else{var v=(o+s)/2;h.push(f*v)}}),u.push(h)}),u},n.prototype.handleInfinity=function(t,r,i){for(var o=t.length,a=0;a<o;a++)if(t[r][a]===1/0){t[r][a]=i,t[a][r]=i;for(var s=0;s<o;s++)t[a][s]!==1/0&&t[r][s]===1/0&&(t[r][s]=i+t[a][s],t[s][r]=i+t[a][s])}for(a=0;a<o;a++)if(a!==r){for(s=0;s<o;s++)if(t[a][s]===1/0){var u=Math.abs(t[r][a]-t[r][s]);u=u===0?1:u,t[a][s]=u}}},n.prototype.maxToFocus=function(t,r){for(var i=0,o=0;o<t[r].length;o++)t[r][o]!==1/0&&(i=t[r][o]>i?t[r][o]:i);return i},n.prototype.getType=function(){return"radial"},n}(SU.Base);dp.RadialLayout=CU,function(e){var n=xe&&xe.__createBinding||(Object.create?function(r,i,o,a){a===void 0&&(a=o);var s=Object.getOwnPropertyDescriptor(i,o);s&&!("get"in s?!i.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(r,a,s)}:function(r,i,o,a){a===void 0&&(a=o),r[a]=i[o]}),t=xe&&xe.__exportStar||function(r,i){for(var o in r)o==="default"||Object.prototype.hasOwnProperty.call(i,o)||n(i,r,o)};Object.defineProperty(e,"__esModule",{value:!0}),t(dp,e)}(i1);var kl={},AU=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(kl,"__esModule",{value:!0}),kl.ConcentricLayout=void 0;var ro=_n(),IU=function(e){function n(t){var r=e.call(this)||this;return r.nodeSize=30,r.minNodeSpacing=10,r.nodeSpacing=10,r.preventOverlap=!1,r.equidistant=!1,r.startAngle=1.5*Math.PI,r.clockwise=!0,r.sortBy="degree",r.nodes=[],r.edges=[],r.width=300,r.height=300,r.onLayoutEnd=function(){},r.updateCfg(t),r}return AU(n,e),n.prototype.getDefaultCfg=function(){return{nodeSize:30,minNodeSpacing:10,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"}},n.prototype.execute=function(){var t,r,i=this,o=i.nodes,a=i.edges,s=o.length;if(s!==0){i.width||typeof window>"u"||(i.width=window.innerWidth),i.height||typeof window>"u"||(i.height=window.innerHeight),i.center||(i.center=[i.width/2,i.height/2]);var u=i.center;if(s===1)return o[0].x=u[0],o[0].y=u[1],void((r=i.onLayoutEnd)===null||r===void 0||r.call(i));var c,l=i.nodeSize,h=i.nodeSpacing,f=[],d=0;c=(0,ro.isArray)(l)?Math.max(l[0],l[1]):l,(0,ro.isArray)(h)?d=Math.max(h[0],h[1]):(0,ro.isNumber)(h)&&(d=h),o.forEach(function(C){f.push(C);var T=c;(0,ro.isArray)(C.size)?T=Math.max(C.size[0],C.size[1]):(0,ro.isNumber)(C.size)?T=C.size:(0,ro.isObject)(C.size)&&(T=Math.max(C.size.width,C.size.height)),c=Math.max(c,T),(0,ro.isFunction)(h)&&(d=Math.max(h(C),d))}),i.clockwise=i.counterclockwise!==void 0?!i.counterclockwise:i.clockwise;var p={},g={};if(f.forEach(function(C,T){p[C.id]=C,g[C.id]=T}),!(i.sortBy!=="degree"&&(0,ro.isString)(i.sortBy)&&f[0][i.sortBy]!==void 0||(i.sortBy="degree",(0,ro.isNumber)(o[0].degree)))){var v=(0,ro.getDegree)(o.length,g,a);f.forEach(function(C,T){C.degree=v[T].all})}f.sort(function(C,T){return T[i.sortBy]-C[i.sortBy]}),i.maxValueNode=f[0],i.maxLevelDiff=i.maxLevelDiff||i.maxValueNode[i.sortBy]/4;var m=[[]],y=m[0];f.forEach(function(C){if(y.length>0){var T=Math.abs(y[0][i.sortBy]-C[i.sortBy]);i.maxLevelDiff&&T>=i.maxLevelDiff&&(y=[],m.push(y))}y.push(C)});var b=c+(d||i.minNodeSpacing);if(!i.preventOverlap){var x=m.length>0&&m[0].length>1,w=(Math.min(i.width,i.height)/2-b)/(m.length+(x?1:0));b=Math.min(b,w)}var E=0;if(m.forEach(function(C){var T=i.sweep;T===void 0&&(T=2*Math.PI-2*Math.PI/C.length);var A=C.dTheta=T/Math.max(1,C.length-1);if(C.length>1&&i.preventOverlap){var D=Math.cos(A)-Math.cos(0),j=Math.sin(A)-Math.sin(0),L=Math.sqrt(b*b/(D*D+j*j));E=Math.max(L,E)}C.r=E,E+=b}),i.equidistant){for(var M=0,_=0,k=0;k<m.length;k++){var S=m[k].r-_;M=Math.max(M,S)}_=0,m.forEach(function(C,T){T===0&&(_=C.r),C.r=_,_+=M})}return m.forEach(function(C){var T=C.dTheta,A=C.r;C.forEach(function(D,j){var L=i.startAngle+(i.clockwise?1:-1)*T*j;D.x=u[0]+A*Math.cos(L),D.y=u[1]+A*Math.sin(L)})}),i.onLayoutEnd&&i.onLayoutEnd(),{nodes:o,edges:a}}(t=i.onLayoutEnd)===null||t===void 0||t.call(i)},n.prototype.getType=function(){return"concentric"},n}(Nn.Base);kl.ConcentricLayout=IU;var Cl={},TU=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(Cl,"__esModule",{value:!0}),Cl.MDSLayout=void 0;var Al=i3,c1=_n(),OU=function(e){function n(t){var r=e.call(this)||this;return r.center=[0,0],r.linkDistance=50,r.nodes=[],r.edges=[],r.onLayoutEnd=function(){},r.updateCfg(t),r}return TU(n,e),n.prototype.getDefaultCfg=function(){return{center:[0,0],linkDistance:50}},n.prototype.execute=function(){var t=this,r=t.nodes,i=t.edges,o=i===void 0?[]:i,a=t.center;if(r&&r.length!==0){if(r.length===1)return r[0].x=a[0],r[0].y=a[1],void(t.onLayoutEnd&&t.onLayoutEnd());var s=t.linkDistance,u=(0,c1.getAdjMatrix)({nodes:r,edges:o},!1),c=(0,c1.floydWarshall)(u);t.handleInfinity(c);var l=(0,c1.scaleMatrix)(c,s);t.scaledDistances=l;var h=t.runMDS();return t.positions=h,h.forEach(function(f,d){r[d].x=f[0]+a[0],r[d].y=f[1]+a[1]}),t.onLayoutEnd&&t.onLayoutEnd(),{nodes:r,edges:o}}t.onLayoutEnd&&t.onLayoutEnd()},n.prototype.runMDS=function(){var t=this.scaledDistances,r=Al.Matrix.mul(Al.Matrix.pow(t,2),-.5),i=r.mean("row"),o=r.mean("column"),a=r.mean();r.add(a).subRowVector(i).subColumnVector(o);var s=new Al.SingularValueDecomposition(r),u=Al.Matrix.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map(function(c){return Al.Matrix.mul([c],[u]).toJSON()[0].splice(0,2)})},n.prototype.handleInfinity=function(t){var r=-999999;t.forEach(function(i){i.forEach(function(o){o!==1/0&&r<o&&(r=o)})}),t.forEach(function(i,o){i.forEach(function(a,s){a===1/0&&(t[o][s]=r)})})},n.prototype.getType=function(){return"mds"},n}(Nn.Base);Cl.MDSLayout=OU;var Il={},NU=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(Il,"__esModule",{value:!0}),Il.FruchtermanLayout=void 0;var DU=Nn,Pn=_n(),PU=function(e){function n(t){var r=e.call(this)||this;return r.maxIteration=1e3,r.workerEnabled=!1,r.gravity=10,r.speed=5,r.clustering=!1,r.clusterGravity=10,r.nodes=[],r.edges=[],r.width=300,r.height=300,r.nodeMap={},r.nodeIdxMap={},r.onLayoutEnd=function(){},r.tick=function(){},r.animate=!0,r.updateCfg(t),r}return NU(n,e),n.prototype.getDefaultCfg=function(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10,animate:!0}},n.prototype.execute=function(){var t,r,i=this,o=this,a=o.nodes;if(o.timeInterval!==void 0&&typeof window<"u"&&window.clearInterval(o.timeInterval),a&&a.length!==0){o.width||typeof window>"u"||(o.width=window.innerWidth),o.height||typeof window>"u"||(o.height=window.innerHeight),o.center||(o.center=[o.width/2,o.height/2]);var s=o.center;if(a.length===1)return a[0].x=s[0],a[0].y=s[1],void((r=o.onLayoutEnd)===null||r===void 0||r.call(o));var u={},c={};return a.forEach(function(l,h){(0,Pn.isNumber)(l.x)||(l.x=Math.random()*i.width),(0,Pn.isNumber)(l.y)||(l.y=Math.random()*i.height),u[l.id]=l,c[l.id]=h}),o.nodeMap=u,o.nodeIdxMap=c,o.run()}(t=o.onLayoutEnd)===null||t===void 0||t.call(o)},n.prototype.run=function(){var t,r=this,i=r.nodes;if(i){var o=r.edges,a=r.maxIteration,s=r.workerEnabled,u=r.clustering,c=r.animate,l={};if(u&&i.forEach(function(d){l[d.cluster]===void 0&&(l[d.cluster]={name:d.cluster,cx:0,cy:0,count:0})}),s||!c){for(var h=0;h<a;h++)r.runOneStep(l);(t=r.onLayoutEnd)===null||t===void 0||t.call(r)}else{if(typeof window>"u")return;var f=0;this.timeInterval=window.setInterval(function(){var d;r.runOneStep(l),++f>=a&&((d=r.onLayoutEnd)===null||d===void 0||d.call(r),window.clearInterval(r.timeInterval))},0)}return{nodes:i,edges:o}}},n.prototype.runOneStep=function(t){var r,i=this,o=i.nodes;if(o){var a=i.edges,s=i.center,u=i.gravity,c=i.speed,l=i.clustering,h=i.height*i.width,f=Math.sqrt(h)/10,d=h/(o.length+1),p=Math.sqrt(d),g=[];if(o.forEach(function(y,b){g[b]={x:0,y:0}}),i.applyCalculate(o,a,g,p,d),l){for(var v in t)t[v].cx=0,t[v].cy=0,t[v].count=0;for(var v in o.forEach(function(b){var x=t[b.cluster];(0,Pn.isNumber)(b.x)&&(x.cx+=b.x),(0,Pn.isNumber)(b.y)&&(x.cy+=b.y),x.count++}),t)t[v].cx/=t[v].count,t[v].cy/=t[v].count;var m=i.clusterGravity||u;o.forEach(function(y,b){if((0,Pn.isNumber)(y.x)&&(0,Pn.isNumber)(y.y)){var x=t[y.cluster],w=Math.sqrt((y.x-x.cx)*(y.x-x.cx)+(y.y-x.cy)*(y.y-x.cy)),E=p*m;g[b].x-=E*(y.x-x.cx)/w,g[b].y-=E*(y.y-x.cy)/w}})}o.forEach(function(y,b){if((0,Pn.isNumber)(y.x)&&(0,Pn.isNumber)(y.y)){var x=.01*p*u;g[b].x-=x*(y.x-s[0]),g[b].y-=x*(y.y-s[1])}}),o.forEach(function(y,b){if((0,Pn.isNumber)(y.fx)&&(0,Pn.isNumber)(y.fy))return y.x=y.fx,void(y.y=y.fy);if((0,Pn.isNumber)(y.x)&&(0,Pn.isNumber)(y.y)){var x=Math.sqrt(g[b].x*g[b].x+g[b].y*g[b].y);if(x>0){var w=Math.min(f*(c/800),x);y.x+=g[b].x/x*w,y.y+=g[b].y/x*w}}}),(r=i.tick)===null||r===void 0||r.call(i)}},n.prototype.applyCalculate=function(t,r,i,o,a){this.calRepulsive(t,i,a),r&&this.calAttractive(r,i,o)},n.prototype.calRepulsive=function(t,r,i){t.forEach(function(o,a){r[a]={x:0,y:0},t.forEach(function(s,u){if(a!==u&&(0,Pn.isNumber)(o.x)&&(0,Pn.isNumber)(s.x)&&(0,Pn.isNumber)(o.y)&&(0,Pn.isNumber)(s.y)){var c=o.x-s.x,l=o.y-s.y,h=c*c+l*l;if(h===0){h=1;var f=a>u?1:-1;c=.01*f,l=.01*f}var d=i/h;r[a].x+=c*d,r[a].y+=l*d}})})},n.prototype.calAttractive=function(t,r,i){var o=this;t.forEach(function(a){var s=(0,Pn.getEdgeTerminal)(a,"source"),u=(0,Pn.getEdgeTerminal)(a,"target");if(s&&u){var c=o.nodeIdxMap[s],l=o.nodeIdxMap[u];if(c!==l){var h=o.nodeMap[s],f=o.nodeMap[u];if((0,Pn.isNumber)(f.x)&&(0,Pn.isNumber)(h.x)&&(0,Pn.isNumber)(f.y)&&(0,Pn.isNumber)(h.y)){var d=f.x-h.x,p=f.y-h.y,g=Math.sqrt(d*d+p*p),v=g*g/i;r[l].x-=d/g*v,r[l].y-=p/g*v,r[c].x+=d/g*v,r[c].y+=p/g*v}}}})},n.prototype.stop=function(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval)},n.prototype.destroy=function(){var t=this;t.stop(),t.tick=null,t.nodes=null,t.edges=null,t.destroyed=!0},n.prototype.getType=function(){return"fruchterman"},n}(DU.Base);Il.FruchtermanLayout=PU;var Tl={};function s3(e,n,t,r,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void t(c)}s.done?n(u):Promise.resolve(u).then(r,i)}function ya(e){return function(){var n=this,t=arguments;return new Promise(function(r,i){var o=e.apply(n,t);function a(u){s3(o,r,i,a,s,"next",u)}function s(u){s3(o,r,i,a,s,"throw",u)}a(void 0)})}}function ju(e){return ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ju(e)}function u3(e){var n=function(t,r){if(ju(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var o=i.call(t,r);if(ju(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}(e,"string");return ju(n)=="symbol"?n:n+""}function ot(e,n,t){return(n=u3(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Ti(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function c3(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u3(r.key),r)}}function Oi(e,n,t){return n&&c3(e.prototype,n),t&&c3(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var l3=typeof xe=="object"&&xe&&xe.Object===Object&&xe,LU=l3,RU=typeof self=="object"&&self&&self.Object===Object&&self,l1=(LU||RU||Function("return this")()).Symbol,h3=l1,f3=Object.prototype,jU=f3.hasOwnProperty,BU=f3.toString,Ol=h3?h3.toStringTag:void 0,zU=function(e){var n=jU.call(e,Ol),t=e[Ol];try{e[Ol]=void 0;var r=!0}catch{}var i=BU.call(e);return r&&(n?e[Ol]=t:delete e[Ol]),i},FU=Object.prototype.toString,GU=zU,UU=function(e){return FU.call(e)},d3=l1?l1.toStringTag:void 0,h1=function(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":d3&&d3 in Object(e)?GU(e):UU(e)},f1=function(e){return e!=null&&typeof e=="object"},XU=h1,YU=function(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=9007199254740991},WU=f1,bn={};bn["[object Float32Array]"]=bn["[object Float64Array]"]=bn["[object Int8Array]"]=bn["[object Int16Array]"]=bn["[object Int32Array]"]=bn["[object Uint8Array]"]=bn["[object Uint8ClampedArray]"]=bn["[object Uint16Array]"]=bn["[object Uint32Array]"]=!0,bn["[object Arguments]"]=bn["[object Array]"]=bn["[object ArrayBuffer]"]=bn["[object Boolean]"]=bn["[object DataView]"]=bn["[object Date]"]=bn["[object Error]"]=bn["[object Function]"]=bn["[object Map]"]=bn["[object Number]"]=bn["[object Object]"]=bn["[object RegExp]"]=bn["[object Set]"]=bn["[object String]"]=bn["[object WeakMap]"]=!1;var VU=function(e){return WU(e)&&YU(e.length)&&!!bn[XU(e)]},HU=function(e){return function(n){return e(n)}},d1={exports:{}};(function(e,n){var t=l3,r=n&&!n.nodeType&&n,i=r&&e&&!e.nodeType&&e,o=i&&i.exports===r&&t.process,a=function(){try{var s=i&&i.require&&i.require("util").types;return s||o&&o.binding&&o.binding("util")}catch{}}();e.exports=a})(d1,d1.exports);var p3=d1.exports,qU=VU,ZU=HU,g3=p3&&p3.isTypedArray;const wp=Bi(g3?ZU(g3):qU);var KU=h1,$U=f1;const QU=Bi(function(e){return typeof e=="number"||$U(e)&&KU(e)=="[object Number]"}),JU=Bi(Array.isArray);var v3={exports:{}},m3={exports:{}};(function(e){function n(t){return e.exports=n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(m3);var eX=m3.exports;(function(e){var n=eX.default;function t(){e.exports=t=function(){return i},e.exports.__esModule=!0,e.exports.default=e.exports;var r,i={},o=Object.prototype,a=o.hasOwnProperty,s=Object.defineProperty||function(R,P,H){R[P]=H.value},u=typeof Symbol=="function"?Symbol:{},c=u.iterator||"@@iterator",l=u.asyncIterator||"@@asyncIterator",h=u.toStringTag||"@@toStringTag";function f(R,P,H){return Object.defineProperty(R,P,{value:H,enumerable:!0,configurable:!0,writable:!0}),R[P]}try{f({},"")}catch{f=function(P,H,ne){return P[H]=ne}}function d(R,P,H,ne){var Z=P&&P.prototype instanceof x?P:x,q=Object.create(Z.prototype),te=new B(ne||[]);return s(q,"_invoke",{value:A(R,H,te)}),q}function p(R,P,H){try{return{type:"normal",arg:R.call(P,H)}}catch(ne){return{type:"throw",arg:ne}}}i.wrap=d;var g="suspendedStart",v="suspendedYield",m="executing",y="completed",b={};function x(){}function w(){}function E(){}var M={};f(M,c,function(){return this});var _=Object.getPrototypeOf,k=_&&_(_(N([])));k&&k!==o&&a.call(k,c)&&(M=k);var S=E.prototype=x.prototype=Object.create(M);function C(R){["next","throw","return"].forEach(function(P){f(R,P,function(H){return this._invoke(P,H)})})}function T(R,P){function H(Z,q,te,we){var pe=p(R[Z],R,q);if(pe.type!=="throw"){var Me=pe.arg,Be=Me.value;return Be&&n(Be)=="object"&&a.call(Be,"__await")?P.resolve(Be.__await).then(function(dt){H("next",dt,te,we)},function(dt){H("throw",dt,te,we)}):P.resolve(Be).then(function(dt){Me.value=dt,te(Me)},function(dt){return H("throw",dt,te,we)})}we(pe.arg)}var ne;s(this,"_invoke",{value:function(Z,q){function te(){return new P(function(we,pe){H(Z,q,we,pe)})}return ne=ne?ne.then(te,te):te()}})}function A(R,P,H){var ne=g;return function(Z,q){if(ne===m)throw Error("Generator is already running");if(ne===y){if(Z==="throw")throw q;return{value:r,done:!0}}for(H.method=Z,H.arg=q;;){var te=H.delegate;if(te){var we=D(te,H);if(we){if(we===b)continue;return we}}if(H.method==="next")H.sent=H._sent=H.arg;else if(H.method==="throw"){if(ne===g)throw ne=y,H.arg;H.dispatchException(H.arg)}else H.method==="return"&&H.abrupt("return",H.arg);ne=m;var pe=p(R,P,H);if(pe.type==="normal"){if(ne=H.done?y:v,pe.arg===b)continue;return{value:pe.arg,done:H.done}}pe.type==="throw"&&(ne=y,H.method="throw",H.arg=pe.arg)}}}function D(R,P){var H=P.method,ne=R.iterator[H];if(ne===r)return P.delegate=null,H==="throw"&&R.iterator.return&&(P.method="return",P.arg=r,D(R,P),P.method==="throw")||H!=="return"&&(P.method="throw",P.arg=new TypeError("The iterator does not provide a '"+H+"' method")),b;var Z=p(ne,R.iterator,P.arg);if(Z.type==="throw")return P.method="throw",P.arg=Z.arg,P.delegate=null,b;var q=Z.arg;return q?q.done?(P[R.resultName]=q.value,P.next=R.nextLoc,P.method!=="return"&&(P.method="next",P.arg=r),P.delegate=null,b):q:(P.method="throw",P.arg=new TypeError("iterator result is not an object"),P.delegate=null,b)}function j(R){var P={tryLoc:R[0]};1 in R&&(P.catchLoc=R[1]),2 in R&&(P.finallyLoc=R[2],P.afterLoc=R[3]),this.tryEntries.push(P)}function L(R){var P=R.completion||{};P.type="normal",delete P.arg,R.completion=P}function B(R){this.tryEntries=[{tryLoc:"root"}],R.forEach(j,this),this.reset(!0)}function N(R){if(R||R===""){var P=R[c];if(P)return P.call(R);if(typeof R.next=="function")return R;if(!isNaN(R.length)){var H=-1,ne=function Z(){for(;++H<R.length;)if(a.call(R,H))return Z.value=R[H],Z.done=!1,Z;return Z.value=r,Z.done=!0,Z};return ne.next=ne}}throw new TypeError(n(R)+" is not iterable")}return w.prototype=E,s(S,"constructor",{value:E,configurable:!0}),s(E,"constructor",{value:w,configurable:!0}),w.displayName=f(E,h,"GeneratorFunction"),i.isGeneratorFunction=function(R){var P=typeof R=="function"&&R.constructor;return!!P&&(P===w||(P.displayName||P.name)==="GeneratorFunction")},i.mark=function(R){return Object.setPrototypeOf?Object.setPrototypeOf(R,E):(R.__proto__=E,f(R,h,"GeneratorFunction")),R.prototype=Object.create(S),R},i.awrap=function(R){return{__await:R}},C(T.prototype),f(T.prototype,l,function(){return this}),i.AsyncIterator=T,i.async=function(R,P,H,ne,Z){Z===void 0&&(Z=Promise);var q=new T(d(R,P,H,ne),Z);return i.isGeneratorFunction(P)?q:q.next().then(function(te){return te.done?te.value:q.next()})},C(S),f(S,h,"Generator"),f(S,c,function(){return this}),f(S,"toString",function(){return"[object Generator]"}),i.keys=function(R){var P=Object(R),H=[];for(var ne in P)H.push(ne);return H.reverse(),function Z(){for(;H.length;){var q=H.pop();if(q in P)return Z.value=q,Z.done=!1,Z}return Z.done=!0,Z}},i.values=N,B.prototype={constructor:B,reset:function(R){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(L),!R)for(var P in this)P.charAt(0)==="t"&&a.call(this,P)&&!isNaN(+P.slice(1))&&(this[P]=r)},stop:function(){this.done=!0;var R=this.tryEntries[0].completion;if(R.type==="throw")throw R.arg;return this.rval},dispatchException:function(R){if(this.done)throw R;var P=this;function H(pe,Me){return q.type="throw",q.arg=R,P.next=pe,Me&&(P.method="next",P.arg=r),!!Me}for(var ne=this.tryEntries.length-1;ne>=0;--ne){var Z=this.tryEntries[ne],q=Z.completion;if(Z.tryLoc==="root")return H("end");if(Z.tryLoc<=this.prev){var te=a.call(Z,"catchLoc"),we=a.call(Z,"finallyLoc");if(te&&we){if(this.prev<Z.catchLoc)return H(Z.catchLoc,!0);if(this.prev<Z.finallyLoc)return H(Z.finallyLoc)}else if(te){if(this.prev<Z.catchLoc)return H(Z.catchLoc,!0)}else{if(!we)throw Error("try statement without catch or finally");if(this.prev<Z.finallyLoc)return H(Z.finallyLoc)}}}},abrupt:function(R,P){for(var H=this.tryEntries.length-1;H>=0;--H){var ne=this.tryEntries[H];if(ne.tryLoc<=this.prev&&a.call(ne,"finallyLoc")&&this.prev<ne.finallyLoc){var Z=ne;break}}Z&&(R==="break"||R==="continue")&&Z.tryLoc<=P&&P<=Z.finallyLoc&&(Z=null);var q=Z?Z.completion:{};return q.type=R,q.arg=P,Z?(this.method="next",this.next=Z.finallyLoc,b):this.complete(q)},complete:function(R,P){if(R.type==="throw")throw R.arg;return R.type==="break"||R.type==="continue"?this.next=R.arg:R.type==="return"?(this.rval=this.arg=R.arg,this.method="return",this.next="end"):R.type==="normal"&&P&&(this.next=P),b},finish:function(R){for(var P=this.tryEntries.length-1;P>=0;--P){var H=this.tryEntries[P];if(H.finallyLoc===R)return this.complete(H.completion,H.afterLoc),L(H),b}},catch:function(R){for(var P=this.tryEntries.length-1;P>=0;--P){var H=this.tryEntries[P];if(H.tryLoc===R){var ne=H.completion;if(ne.type==="throw"){var Z=ne.arg;L(H)}return Z}}throw Error("illegal catch attempt")},delegateYield:function(R,P,H){return this.delegate={iterator:N(R),resultName:P,nextLoc:H},this.method==="next"&&(this.arg=r),b}},i}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(v3);var Ep=(0,v3.exports)(),tX=Ep;try{regeneratorRuntime=Ep}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=Ep:Function("r","regeneratorRuntime = r")(Ep)}const mr=Bi(tX);var De,nX=1;function y3(){return nX++}(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.COPY_SRC=1]="COPY_SRC",e[e.COPY_DST=2]="COPY_DST",e[e.SAMPLED=4]="SAMPLED",e[e.STORAGE=8]="STORAGE",e[e.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(De||(De={}));var Nl,b3,Bu,Dl,rX=function(){function e(){Ti(this,e),this.config=void 0}return Oi(e,[{key:"get",value:function(){return this.config}},{key:"set",value:function(n){this.config=n}}]),e}();(function(e){e.Void="Void",e.Boolean="Boolean",e.Float="Float",e.Uint32="Uint32",e.Int32="Int32",e.Vector="Vector",e.Vector2Float="vec2<f32>",e.Vector3Float="vec3<f32>",e.Vector4Float="vec4<f32>",e.Vector2Boolean="vec2<bool>",e.Vector3Boolean="vec3<bool>",e.Vector4Boolean="vec4<bool>",e.Vector2Uint="vec2<u32>",e.Vector3Uint="vec3<u32>",e.Vector4Uint="vec4<u32>",e.Vector2Int="vec2<i32>",e.Vector3Int="vec3<i32>",e.Vector4Int="vec4<i32>",e.Matrix="Matrix",e.Matrix3x3Float="mat3x3<f32>",e.Matrix4x4Float="mat4x4<i32>",e.Struct="Struct",e.FloatArray="Float[]",e.Vector4FloatArray="vec4<f32>[]"})(Nl||(Nl={})),function(e){e.Program="Program",e.Identifier="Identifier",e.VariableDeclaration="VariableDeclaration",e.BlockStatement="BlockStatement",e.ReturnStatement="ReturnStatement",e.FunctionDeclaration="FunctionDeclaration",e.VariableDeclarator="VariableDeclarator",e.AssignmentExpression="AssignmentExpression",e.LogicalExpression="LogicalExpression",e.BinaryExpression="BinaryExpression",e.ArrayExpression="ArrayExpression",e.UnaryExpression="UnaryExpression",e.UpdateExpression="UpdateExpression",e.FunctionExpression="FunctionExpression",e.MemberExpression="MemberExpression",e.ConditionalExpression="ConditionalExpression",e.ExpressionStatement="ExpressionStatement",e.CallExpression="CallExpression",e.NumThreadStatement="NumThreadStatement",e.StorageStatement="StorageStatement",e.DoWhileStatement="DoWhileStatement",e.WhileStatement="WhileStatement",e.ForStatement="ForStatement",e.BreakStatement="BreakStatement",e.ContinueStatement="ContinueStatement",e.IfStatement="IfStatement",e.ImportedFunctionStatement="ImportedFunctionStatement"}(b3||(b3={})),function(e){e.Input="Input",e.Output="Output",e.Uniform="Uniform",e.Workgroup="Workgroup",e.UniformConstant="UniformConstant",e.Image="Image",e.StorageBuffer="StorageBuffer",e.Private="Private",e.Function="Function"}(Bu||(Bu={})),function(e){e.GLSL100="GLSL100",e.GLSL450="GLSL450",e.WGSL="WGSL"}(Dl||(Dl={}));function iX(){if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function x3(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,r)}return t}function w3(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?x3(Object(t),!0).forEach(function(r){ot(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):x3(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var E3=function(){function e(i,o){Ti(this,e),this.engine=i,this.configService=o,this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}var n,t,r;return Oi(e,[{key:"init",value:function(){var i=this.configService.get(),o=i.canvas,a=i.engineOptions;this.initPromise=this.engine.init(w3({canvas:o||iX(),antialiasing:!1},a))}},{key:"setBundle",value:function(i){this.compiledBundle=JSON.parse(JSON.stringify(i))}},{key:"setDispatch",value:function(i){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=i),this}},{key:"setMaxIteration",value:function(i){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=i),this}},{key:"setBinding",value:function(i,o){var a=this;if(typeof i=="string"){var s=QU(o)||wp(o)||JU(o);if(this.compiledBundle&&this.compiledBundle.context){var u=this.compiledBundle.context.defines.find(function(l){return l.name===i});if(u)return u.value=o,this;var c=this.compiledBundle.context.uniforms.find(function(l){return l.name===i});c&&(s?(c.data=o,c.isReferer=!1,c.storageClass===Bu.Uniform?this.model&&this.model.updateUniform(i,o):this.model&&this.model.updateBuffer(i,o)):(c.isReferer=!0,c.data=o))}}else Object.keys(i).forEach(function(l){a.setBinding(l,i[l])});return this}},{key:"execute",value:(r=ya(mr.mark(function i(){var o,a,s=this,u=arguments;return mr.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(o=u.length>0&&u[0]!==void 0?u[0]:1,!this.dirty){c.next=6;break}return this.compiledBundle.context&&(o>1?this.compiledBundle.context.maxIteration=o:this.compiledBundle.context.maxIteration++),c.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter(function(l){return l.isReferer}).forEach(function(l){var h=l.data,f=l.name;s.model.confirmInput(h.model,f)}),a=0;a<o;a++)this.model.run();return this.engine.endFrame(),c.abrupt("return",this);case 12:case"end":return c.stop()}},i,this)})),function(){return r.apply(this,arguments)})},{key:"getOutput",value:(t=ya(mr.mark(function i(){return mr.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.model.readData());case 1:case"end":return o.stop()}},i,this)})),function(){return t.apply(this,arguments)})},{key:"compile",value:(n=ya(mr.mark(function i(){var o,a,s;return mr.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.initPromise;case 2:return o=w3({},this.compiledBundle.context),a=this.engine.supportWebGPU?this.engine.useWGSL?Dl.WGSL:Dl.GLSL450:Dl.GLSL100,s=this.compiledBundle.shaders[a],o.defines.filter(function(c){return c.runtime}).forEach(function(c){var l="".concat("__DefineValuePlaceholder__").concat(c.name);s=s.replace(l,"".concat(c.value))}),o.shader=s,o.uniforms.forEach(function(c){if(!c.data&&c.storageClass===Bu.StorageBuffer){var l=1;c.type===Nl.FloatArray?l=1:c.type===Nl.Vector4FloatArray&&(l=4),c.data=new Float32Array(o.output.length*l).fill(0)}}),this.compiledBundle.context=o,u.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=u.sent;case 12:case"end":return u.stop()}},i,this)})),function(){return n.apply(this,arguments)})}]),e}(),M3={exports:{}};M3.exports=function(){var e=function(I){return I instanceof Uint8Array||I instanceof Uint16Array||I instanceof Uint32Array||I instanceof Int8Array||I instanceof Int16Array||I instanceof Int32Array||I instanceof Float32Array||I instanceof Float64Array||I instanceof Uint8ClampedArray},n=function(I,U){for(var K=Object.keys(U),fe=0;fe<K.length;++fe)I[K[fe]]=U[K[fe]];return I},t=`
`;function r(I){return typeof atob<"u"?atob(I):"base64:"+I}function i(I){throw new Error("(regl) "+I)}function o(I,U){I||i(U)}function a(I){return I?": "+I:""}function s(I,U,K){I in U||i("unknown parameter ("+I+")"+a(K)+". possible values: "+Object.keys(U).join())}function u(I,U){e(I)||i("invalid parameter type"+a(U)+". must be a typed array")}function c(I,U){switch(U){case"number":return typeof I=="number";case"object":return typeof I=="object";case"string":return typeof I=="string";case"boolean":return typeof I=="boolean";case"function":return typeof I=="function";case"undefined":return I===void 0;case"symbol":return typeof I=="symbol"}}function l(I,U,K){c(I,U)||i("invalid parameter type"+a(K)+". expected "+U+", got "+typeof I)}function h(I,U){I>=0&&(0|I)===I||i("invalid parameter type, ("+I+")"+a(U)+". must be a nonnegative integer")}function f(I,U,K){U.indexOf(I)<0&&i("invalid value"+a(K)+". must be one of: "+U)}var d=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function p(I){Object.keys(I).forEach(function(U){d.indexOf(U)<0&&i('invalid regl constructor argument "'+U+'". must be one of '+d)})}function g(I,U){for(I+="";I.length<U;)I=" "+I;return I}function v(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function m(I,U){this.number=I,this.line=U,this.errors=[]}function y(I,U,K){this.file=I,this.line=U,this.message=K}function b(){var I=new Error,U=(I.stack||I).toString(),K=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(U);if(K)return K[1];var fe=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(U);return fe?fe[1]:"unknown"}function x(){var I=new Error,U=(I.stack||I).toString(),K=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(U);if(K)return K[1];var fe=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(U);return fe?fe[1]:"unknown"}function w(I,U){var K=I.split(`
`),fe=1,be=0,se={unknown:new v,0:new v};se.unknown.name=se[0].name=U||b(),se.unknown.lines.push(new m(0,""));for(var ve=0;ve<K.length;++ve){var Pe=K[ve],Fe=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Pe);if(Fe)switch(Fe[1]){case"line":var je=/(\d+)(\s+\d+)?/.exec(Fe[2]);je&&(fe=0|je[1],je[2]&&((be=0|je[2])in se||(se[be]=new v)));break;case"define":var Le=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Fe[2]);Le&&(se[be].name=Le[1]?r(Le[2]):Le[2])}se[be].lines.push(new m(fe++,Pe))}return Object.keys(se).forEach(function(Ye){var et=se[Ye];et.lines.forEach(function(Ne){et.index[Ne.number]=Ne})}),se}function E(I){var U=[];return I.split(`
`).forEach(function(K){if(!(K.length<5)){var fe=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(K);fe?U.push(new y(0|fe[1],0|fe[2],fe[3].trim())):K.length>0&&U.push(new y("unknown",0,K))}}),U}function M(I,U){U.forEach(function(K){var fe=I[K.file];if(fe){var be=fe.index[K.line];if(be)return be.errors.push(K),void(fe.hasErrors=!0)}I.unknown.hasErrors=!0,I.unknown.lines[0].errors.push(K)})}function _(I,U,K,fe,be){if(!I.getShaderParameter(U,I.COMPILE_STATUS)){var se=I.getShaderInfoLog(U),ve=fe===I.FRAGMENT_SHADER?"fragment":"vertex";j(K,"string",ve+" shader source must be a string",be);var Pe=w(K,be),Fe=E(se);M(Pe,Fe),Object.keys(Pe).forEach(function(je){var Le=Pe[je];if(Le.hasErrors){var Ye=[""],et=[""];Ne("file number "+je+": "+Le.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Le.lines.forEach(function(Qe){if(Qe.errors.length>0){Ne(g(Qe.number,4)+"|  ","background-color:yellow; font-weight:bold"),Ne(Qe.line+t,"color:red; background-color:yellow; font-weight:bold");var oe=0;Qe.errors.forEach(function(me){var ze=me.message,rt=/^\s*'(.*)'\s*:\s*(.*)$/.exec(ze);if(rt){var Ae=rt[1];ze=rt[2],Ae==="assign"&&(Ae="="),oe=Math.max(Qe.line.indexOf(Ae,oe),0)}else oe=0;Ne(g("| ",6)),Ne(g("^^^",oe+3)+t,"font-weight:bold"),Ne(g("| ",6)),Ne(ze+t,"font-weight:bold")}),Ne(g("| ",6)+t)}else Ne(g(Qe.number,4)+"|  "),Ne(Qe.line+t,"color:red")}),typeof document>"u"||window.chrome||(et[0]=Ye.join("%c"))}function Ne(Qe,oe){Ye.push(Qe),et.push(oe||"")}}),o.raise("Error compiling "+ve+" shader, "+Pe[0].name)}}function k(I,U,K,fe,be){if(!I.getProgramParameter(U,I.LINK_STATUS)){I.getProgramInfoLog(U);var se=w(K,be),ve='Error linking program with vertex shader, "'+w(fe,be)[0].name+'", and fragment shader "'+se[0].name+'"';o.raise(ve)}}function S(I){I._commandRef=b()}function C(I,U,K,fe){function be(Fe){return Fe?fe.id(Fe):0}function se(Fe,je){Object.keys(je).forEach(function(Le){Fe[fe.id(Le)]=!0})}S(I),I._fragId=be(I.static.frag),I._vertId=be(I.static.vert);var ve=I._uniformSet={};se(ve,U.static),se(ve,U.dynamic);var Pe=I._attributeSet={};se(Pe,K.static),se(Pe,K.dynamic),I._hasCount="count"in I.static||"count"in I.dynamic||"elements"in I.static||"elements"in I.dynamic}function T(I,U){var K=x();i(I+" in command "+(U||b())+(K==="unknown"?"":" called from "+K))}function A(I,U,K){I||T(U,K||b())}function D(I,U,K,fe){I in U||T("unknown parameter ("+I+")"+a(K)+". possible values: "+Object.keys(U).join(),fe||b())}function j(I,U,K,fe){c(I,U)||T("invalid parameter type"+a(K)+". expected "+U+", got "+typeof I,fe||b())}function L(I){I()}function B(I,U,K){I.texture?f(I.texture._texture.internalformat,U,"unsupported texture format for attachment"):f(I.renderbuffer._renderbuffer.format,K,"unsupported renderbuffer format for attachment")}var N=33071,R=9728,P=9984,H=9985,ne=9986,Z=9987,q=5121,te=5122,we=5123,pe=5124,Me=5125,Be=5126,dt=32819,It=32820,at=33635,Ue=34042,Te=36193,Xe={};function Oe(I,U){return I===It||I===dt||I===at?2:I===Ue?4:Xe[I]*U}function Se(I){return!(I&I-1||!I)}function We(I,U,K){var fe,be=U.width,se=U.height,ve=U.channels;o(be>0&&be<=K.maxTextureSize&&se>0&&se<=K.maxTextureSize,"invalid texture shape"),I.wrapS===N&&I.wrapT===N||o(Se(be)&&Se(se),"incompatible wrap mode for texture, both width and height must be power of 2"),U.mipmask===1?be!==1&&se!==1&&o(I.minFilter!==P&&I.minFilter!==ne&&I.minFilter!==H&&I.minFilter!==Z,"min filter requires mipmap"):(o(Se(be)&&Se(se),"texture must be a square power of 2 to support mipmapping"),o(U.mipmask===(be<<1)-1,"missing or incomplete mipmap data")),U.type===Be&&(K.extensions.indexOf("oes_texture_float_linear")<0&&o(I.minFilter===R&&I.magFilter===R,"filter not supported, must enable oes_texture_float_linear"),o(!I.genMipmaps,"mipmap generation not supported with float textures"));var Pe=U.images;for(fe=0;fe<16;++fe)if(Pe[fe]){var Fe=be>>fe,je=se>>fe;o(U.mipmask&1<<fe,"missing mipmap data");var Le=Pe[fe];if(o(Le.width===Fe&&Le.height===je,"invalid shape for mip images"),o(Le.format===U.format&&Le.internalformat===U.internalformat&&Le.type===U.type,"incompatible type for mip image"),!Le.compressed)if(Le.data){var Ye=Math.ceil(Oe(Le.type,ve)*Fe/Le.unpackAlignment)*Le.unpackAlignment;o(Le.data.byteLength===Ye*je,"invalid data for image, buffer size is inconsistent with image format")}else Le.element||Le.copy}else I.genMipmaps||o(!(U.mipmask&1<<fe),"extra mipmap data");U.compressed&&o(!I.genMipmaps,"mipmap generation for compressed images not supported")}function Ve(I,U,K,fe){var be=I.width,se=I.height,ve=I.channels;o(be>0&&be<=fe.maxTextureSize&&se>0&&se<=fe.maxTextureSize,"invalid texture shape"),o(be===se,"cube map must be square"),o(U.wrapS===N&&U.wrapT===N,"wrap mode not supported by cube map");for(var Pe=0;Pe<K.length;++Pe){var Fe=K[Pe];o(Fe.width===be&&Fe.height===se,"inconsistent cube map face shape"),U.genMipmaps&&(o(!Fe.compressed,"can not generate mipmap for compressed textures"),o(Fe.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var je=Fe.images,Le=0;Le<16;++Le){var Ye=je[Le];if(Ye){var et=be>>Le,Ne=se>>Le;o(Fe.mipmask&1<<Le,"missing mipmap data"),o(Ye.width===et&&Ye.height===Ne,"invalid shape for mip images"),o(Ye.format===I.format&&Ye.internalformat===I.internalformat&&Ye.type===I.type,"incompatible type for mip image"),Ye.compressed||(Ye.data?o(Ye.data.byteLength===et*Ne*Math.max(Oe(Ye.type,ve),Ye.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Ye.element||Ye.copy)}}}}Xe[5120]=Xe[q]=1,Xe[te]=Xe[we]=Xe[Te]=Xe[at]=Xe[dt]=Xe[It]=2,Xe[pe]=Xe[Me]=Xe[Be]=Xe[Ue]=4;var O=n(o,{optional:L,raise:i,commandRaise:T,command:A,parameter:s,commandParameter:D,constructor:p,type:l,commandType:j,isTypedArray:u,nni:h,oneOf:f,shaderError:_,linkError:k,callSite:x,saveCommandRef:S,saveDrawInfo:C,framebufferFormat:B,guessCommand:b,texture2D:We,textureCube:Ve}),he=0,_e=0,Ze=5,Je=6;function qe(I,U){this.id=he++,this.type=I,this.data=U}function vt(I){return I.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function pt(I){if(I.length===0)return[];var U=I.charAt(0),K=I.charAt(I.length-1);if(I.length>1&&U===K&&(U==='"'||U==="'"))return['"'+vt(I.substr(1,I.length-2))+'"'];var fe=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(I);if(fe)return pt(I.substr(0,fe.index)).concat(pt(fe[1])).concat(pt(I.substr(fe.index+fe[0].length)));var be=I.split(".");if(be.length===1)return['"'+vt(I)+'"'];for(var se=[],ve=0;ve<be.length;++ve)se=se.concat(pt(be[ve]));return se}function Et(I){return"["+pt(I).join("][")+"]"}function Tt(I,U){return new qe(I,Et(U+""))}function Rt(I){return typeof I=="function"&&!I._reglType||I instanceof qe}function ln(I,U){return typeof I=="function"?new qe(_e,I):typeof I=="number"||typeof I=="boolean"?new qe(Ze,I):Array.isArray(I)?new qe(Je,I.map((K,fe)=>ln(K,U+"["+fe+"]"))):I instanceof qe?I:void O(!1,"invalid option type in uniform "+U)}var xn={DynamicVariable:qe,define:Tt,isDynamic:Rt,unbox:ln,accessor:Et},ar={next:typeof requestAnimationFrame=="function"?function(I){return requestAnimationFrame(I)}:function(I){return setTimeout(I,16)},cancel:typeof cancelAnimationFrame=="function"?function(I){return cancelAnimationFrame(I)}:clearTimeout},Mr=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function hr(){var I={"":0},U=[""];return{id:function(K){var fe=I[K];return fe||(fe=I[K]=U.length,U.push(K),fe)},str:function(K){return U[K]}}}function Di(I,U,K){var fe,be=document.createElement("canvas");function se(){var Pe=window.innerWidth,Fe=window.innerHeight;if(I!==document.body){var je=I.getBoundingClientRect();Pe=je.right-je.left,Fe=je.bottom-je.top}be.width=K*Pe,be.height=K*Fe,n(be.style,{width:Pe+"px",height:Fe+"px"})}function ve(){fe?fe.disconnect():window.removeEventListener("resize",se),I.removeChild(be)}return n(be.style,{border:0,margin:0,padding:0,top:0,left:0}),I.appendChild(be),I===document.body&&(be.style.position="absolute",n(I.style,{margin:0,padding:0})),I!==document.body&&typeof ResizeObserver=="function"?(fe=new ResizeObserver(function(){setTimeout(se)})).observe(I):window.addEventListener("resize",se,!1),se(),{canvas:be,onDestroy:ve}}function ks(I,U){function K(fe){try{return I.getContext(fe,U)}catch{return null}}return K("webgl")||K("experimental-webgl")||K("webgl-experimental")}function Vu(I){return typeof I.nodeName=="string"&&typeof I.appendChild=="function"&&typeof I.getBoundingClientRect=="function"}function Fo(I){return typeof I.drawArrays=="function"||typeof I.drawElements=="function"}function sr(I){return typeof I=="string"?I.split():(O(Array.isArray(I),"invalid extension array"),I)}function ur(I){return typeof I=="string"?(O(typeof document<"u","not supported outside of DOM"),document.querySelector(I)):I}function sn(I){var U,K,fe,be,se=I||{},ve={},Pe=[],Fe=[],je=typeof window>"u"?1:window.devicePixelRatio,Le=!1,Ye=function(Qe){Qe&&O.raise(Qe)},et=function(){};if(typeof se=="string"?(O(typeof document<"u","selector queries only supported in DOM enviroments"),U=document.querySelector(se),O(U,"invalid query string for element")):typeof se=="object"?Vu(se)?U=se:Fo(se)?fe=(be=se).canvas:(O.constructor(se),"gl"in se?be=se.gl:"canvas"in se?fe=ur(se.canvas):"container"in se&&(K=ur(se.container)),"attributes"in se&&(ve=se.attributes,O.type(ve,"object","invalid context attributes")),"extensions"in se&&(Pe=sr(se.extensions)),"optionalExtensions"in se&&(Fe=sr(se.optionalExtensions)),"onDone"in se&&(O.type(se.onDone,"function","invalid or missing onDone callback"),Ye=se.onDone),"profile"in se&&(Le=!!se.profile),"pixelRatio"in se&&(je=+se.pixelRatio,O(je>0,"invalid pixel ratio"))):O.raise("invalid arguments to regl"),U&&(U.nodeName.toLowerCase()==="canvas"?fe=U:K=U),!be){if(!fe){O(typeof document<"u","must manually specify webgl context outside of DOM environments");var Ne=Di(K||document.body,Ye,je);if(!Ne)return null;fe=Ne.canvas,et=Ne.onDestroy}ve.premultipliedAlpha===void 0&&(ve.premultipliedAlpha=!0),be=ks(fe,ve)}return be?{gl:be,canvas:fe,container:K,extensions:Pe,optionalExtensions:Fe,pixelRatio:je,profile:Le,onDone:Ye,onDestroy:et}:(et(),Ye("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Dt(I,U){var K={};function fe(ve){O.type(ve,"string","extension name must be string");var Pe,Fe=ve.toLowerCase();try{Pe=K[Fe]=I.getExtension(Fe)}catch{}return!!Pe}for(var be=0;be<U.extensions.length;++be){var se=U.extensions[be];if(!fe(se))return U.onDestroy(),U.onDone('"'+se+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return U.optionalExtensions.forEach(fe),{extensions:K,restore:function(){Object.keys(K).forEach(function(ve){if(K[ve]&&!fe(ve))throw new Error("(regl): error restoring extension "+ve)})}}}function zt(I,U){for(var K=Array(I),fe=0;fe<I;++fe)K[fe]=U(fe);return K}var hn=5120,cr=5121,Ta=5122,Go=5123,Uo=5124,Oa=5125,Na=5126;function rh(I){for(var U=16;U<=1<<28;U*=16)if(I<=U)return U;return 0}function ob(I){var U,K;return U=(I>65535)<<4,U|=K=((I>>>=U)>255)<<3,U|=K=((I>>>=K)>15)<<2,(U|=K=((I>>>=K)>3)<<1)|(I>>>=K)>>1}function ab(){var I=zt(8,function(){return[]});function U(se){var ve=rh(se),Pe=I[ob(ve)>>2];return Pe.length>0?Pe.pop():new ArrayBuffer(ve)}function K(se){I[ob(se.byteLength)>>2].push(se)}function fe(se,ve){var Pe=null;switch(se){case hn:Pe=new Int8Array(U(ve),0,ve);break;case cr:Pe=new Uint8Array(U(ve),0,ve);break;case Ta:Pe=new Int16Array(U(2*ve),0,ve);break;case Go:Pe=new Uint16Array(U(2*ve),0,ve);break;case Uo:Pe=new Int32Array(U(4*ve),0,ve);break;case Oa:Pe=new Uint32Array(U(4*ve),0,ve);break;case Na:Pe=new Float32Array(U(4*ve),0,ve);break;default:return null}return Pe.length!==ve?Pe.subarray(0,ve):Pe}function be(se){K(se.buffer)}return{alloc:U,free:K,allocType:fe,freeType:be}}var kn=ab();kn.zero=ab();var z5=3408,F5=3410,G5=3411,U5=3412,X5=3413,Y5=3414,W5=3415,V5=33901,H5=33902,q5=3379,Z5=3386,K5=34921,$5=36347,Q5=36348,J5=35661,eN=35660,tN=34930,nN=36349,rN=34076,iN=34024,oN=7936,aN=7937,sN=7938,uN=35724,cN=34047,lN=36063,hN=34852,ih=3553,sb=34067,fN=34069,dN=33984,Hu=6408,$p=5126,ub=5121,Qp=36160,pN=36053,gN=36064,vN=16384,mN=function(I,U){var K=1;U.ext_texture_filter_anisotropic&&(K=I.getParameter(cN));var fe=1,be=1;U.webgl_draw_buffers&&(fe=I.getParameter(hN),be=I.getParameter(lN));var se=!!U.oes_texture_float;if(se){var ve=I.createTexture();I.bindTexture(ih,ve),I.texImage2D(ih,0,Hu,1,1,0,Hu,$p,null);var Pe=I.createFramebuffer();if(I.bindFramebuffer(Qp,Pe),I.framebufferTexture2D(Qp,gN,ih,ve,0),I.bindTexture(ih,null),I.checkFramebufferStatus(Qp)!==pN)se=!1;else{I.viewport(0,0,1,1),I.clearColor(1,0,0,1),I.clear(vN);var Fe=kn.allocType($p,4);I.readPixels(0,0,1,1,Hu,$p,Fe),I.getError()?se=!1:(I.deleteFramebuffer(Pe),I.deleteTexture(ve),se=Fe[0]===1),kn.freeType(Fe)}}var je=!0;if(typeof navigator>"u"||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var Le=I.createTexture(),Ye=kn.allocType(ub,36);I.activeTexture(dN),I.bindTexture(sb,Le),I.texImage2D(fN,0,Hu,3,3,0,Hu,ub,Ye),kn.freeType(Ye),I.bindTexture(sb,null),I.deleteTexture(Le),je=!I.getError()}return{colorBits:[I.getParameter(F5),I.getParameter(G5),I.getParameter(U5),I.getParameter(X5)],depthBits:I.getParameter(Y5),stencilBits:I.getParameter(W5),subpixelBits:I.getParameter(z5),extensions:Object.keys(U).filter(function(et){return!!U[et]}),maxAnisotropic:K,maxDrawbuffers:fe,maxColorAttachments:be,pointSizeDims:I.getParameter(V5),lineWidthDims:I.getParameter(H5),maxViewportDims:I.getParameter(Z5),maxCombinedTextureUnits:I.getParameter(J5),maxCubeMapSize:I.getParameter(rN),maxRenderbufferSize:I.getParameter(iN),maxTextureUnits:I.getParameter(tN),maxTextureSize:I.getParameter(q5),maxAttributes:I.getParameter(K5),maxVertexUniforms:I.getParameter($5),maxVertexTextureUnits:I.getParameter(eN),maxVaryingVectors:I.getParameter(Q5),maxFragmentUniforms:I.getParameter(nN),glsl:I.getParameter(uN),renderer:I.getParameter(aN),vendor:I.getParameter(oN),version:I.getParameter(sN),readFloat:se,npotTextureCube:je}};function hi(I){return!!I&&typeof I=="object"&&Array.isArray(I.shape)&&Array.isArray(I.stride)&&typeof I.offset=="number"&&I.shape.length===I.stride.length&&(Array.isArray(I.data)||e(I.data))}var Pr=function(I){return Object.keys(I).map(function(U){return I[U]})},oh={shape:wN,flatten:xN};function yN(I,U,K){for(var fe=0;fe<U;++fe)K[fe]=I[fe]}function bN(I,U,K,fe){for(var be=0,se=0;se<U;++se)for(var ve=I[se],Pe=0;Pe<K;++Pe)fe[be++]=ve[Pe]}function cb(I,U,K,fe,be,se){for(var ve=se,Pe=0;Pe<U;++Pe)for(var Fe=I[Pe],je=0;je<K;++je)for(var Le=Fe[je],Ye=0;Ye<fe;++Ye)be[ve++]=Le[Ye]}function lb(I,U,K,fe,be){for(var se=1,ve=K+1;ve<U.length;++ve)se*=U[ve];var Pe=U[K];if(U.length-K==4){var Fe=U[K+1],je=U[K+2],Le=U[K+3];for(ve=0;ve<Pe;++ve)cb(I[ve],Fe,je,Le,fe,be),be+=se}else for(ve=0;ve<Pe;++ve)lb(I[ve],U,K+1,fe,be),be+=se}function xN(I,U,K,fe){var be=1;if(U.length)for(var se=0;se<U.length;++se)be*=U[se];else be=0;var ve=fe||kn.allocType(K,be);switch(U.length){case 0:break;case 1:yN(I,U[0],ve);break;case 2:bN(I,U[0],U[1],ve);break;case 3:cb(I,U[0],U[1],U[2],ve,0);break;default:lb(I,U,0,ve,0)}return ve}function wN(I){for(var U=[],K=I;K.length;K=K[0])U.push(K.length);return U}var Jp={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Da={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},ah={dynamic:35048,stream:35040,static:35044},eg=oh.flatten,hb=oh.shape,fb=35044,EN=35040,tg=5121,ng=5126,Xo=[];function sh(I){return 0|Jp[Object.prototype.toString.call(I)]}function db(I,U){for(var K=0;K<U.length;++K)I[K]=U[K]}function pb(I,U,K,fe,be,se,ve){for(var Pe=0,Fe=0;Fe<K;++Fe)for(var je=0;je<fe;++je)I[Pe++]=U[be*Fe+se*je+ve]}function MN(I,U,K,fe){var be=0,se={};function ve(oe){this.id=be++,this.buffer=I.createBuffer(),this.type=oe,this.usage=fb,this.byteLength=0,this.dimension=1,this.dtype=tg,this.persistentData=null,K.profile&&(this.stats={size:0})}ve.prototype.bind=function(){I.bindBuffer(this.type,this.buffer)},ve.prototype.destroy=function(){et(this)};var Pe=[];function Fe(oe,me){var ze=Pe.pop();return ze||(ze=new ve(oe)),ze.bind(),Ye(ze,me,EN,0,1,!1),ze}function je(oe){Pe.push(oe)}function Le(oe,me,ze){oe.byteLength=me.byteLength,I.bufferData(oe.type,me,ze)}function Ye(oe,me,ze,rt,Ae,st){var Ie,Ke;if(oe.usage=ze,Array.isArray(me)){if(oe.dtype=rt||ng,me.length>0)if(Array.isArray(me[0])){Ie=hb(me);for(var Ce=1,He=1;He<Ie.length;++He)Ce*=Ie[He];oe.dimension=Ce,Le(oe,Ke=eg(me,Ie,oe.dtype),ze),st?oe.persistentData=Ke:kn.freeType(Ke)}else if(typeof me[0]=="number"){oe.dimension=Ae;var mt=kn.allocType(oe.dtype,me.length);db(mt,me),Le(oe,mt,ze),st?oe.persistentData=mt:kn.freeType(mt)}else e(me[0])?(oe.dimension=me[0].length,oe.dtype=rt||sh(me[0])||ng,Le(oe,Ke=eg(me,[me.length,me[0].length],oe.dtype),ze),st?oe.persistentData=Ke:kn.freeType(Ke)):O.raise("invalid buffer data")}else if(e(me))oe.dtype=rt||sh(me),oe.dimension=Ae,Le(oe,me,ze),st&&(oe.persistentData=new Uint8Array(new Uint8Array(me.buffer)));else if(hi(me)){Ie=me.shape;var jt=me.stride,$e=me.offset,tt=0,Ge=0,nt=0,Ft=0;Ie.length===1?(tt=Ie[0],Ge=1,nt=jt[0],Ft=0):Ie.length===2?(tt=Ie[0],Ge=Ie[1],nt=jt[0],Ft=jt[1]):O.raise("invalid shape"),oe.dtype=rt||sh(me.data)||ng,oe.dimension=Ge;var lt=kn.allocType(oe.dtype,tt*Ge);pb(lt,me.data,tt,Ge,nt,Ft,$e),Le(oe,lt,ze),st?oe.persistentData=lt:kn.freeType(lt)}else me instanceof ArrayBuffer?(oe.dtype=tg,oe.dimension=Ae,Le(oe,me,ze),st&&(oe.persistentData=new Uint8Array(new Uint8Array(me)))):O.raise("invalid buffer data")}function et(oe){U.bufferCount--,fe(oe);var me=oe.buffer;O(me,"buffer must not be deleted already"),I.deleteBuffer(me),oe.buffer=null,delete se[oe.id]}function Ne(oe,me,ze,rt){U.bufferCount++;var Ae=new ve(me);function st(Ce){var He=fb,mt=null,jt=0,$e=0,tt=1;return Array.isArray(Ce)||e(Ce)||hi(Ce)||Ce instanceof ArrayBuffer?mt=Ce:typeof Ce=="number"?jt=0|Ce:Ce&&(O.type(Ce,"object","buffer arguments must be an object, a number or an array"),"data"in Ce&&(O(mt===null||Array.isArray(mt)||e(mt)||hi(mt),"invalid data for buffer"),mt=Ce.data),"usage"in Ce&&(O.parameter(Ce.usage,ah,"invalid buffer usage"),He=ah[Ce.usage]),"type"in Ce&&(O.parameter(Ce.type,Da,"invalid buffer type"),$e=Da[Ce.type]),"dimension"in Ce&&(O.type(Ce.dimension,"number","invalid dimension"),tt=0|Ce.dimension),"length"in Ce&&(O.nni(jt,"buffer length must be a nonnegative integer"),jt=0|Ce.length)),Ae.bind(),mt?Ye(Ae,mt,He,$e,tt,rt):(jt&&I.bufferData(Ae.type,jt,He),Ae.dtype=$e||tg,Ae.usage=He,Ae.dimension=tt,Ae.byteLength=jt),K.profile&&(Ae.stats.size=Ae.byteLength*Xo[Ae.dtype]),st}function Ie(Ce,He){O(He+Ce.byteLength<=Ae.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Ce.byteLength+" starting from offset "+He+" to a buffer of size "+Ae.byteLength),I.bufferSubData(Ae.type,He,Ce)}function Ke(Ce,He){var mt,jt=0|(He||0);if(Ae.bind(),e(Ce)||Ce instanceof ArrayBuffer)Ie(Ce,jt);else if(Array.isArray(Ce)){if(Ce.length>0)if(typeof Ce[0]=="number"){var $e=kn.allocType(Ae.dtype,Ce.length);db($e,Ce),Ie($e,jt),kn.freeType($e)}else if(Array.isArray(Ce[0])||e(Ce[0])){mt=hb(Ce);var tt=eg(Ce,mt,Ae.dtype);Ie(tt,jt),kn.freeType(tt)}else O.raise("invalid buffer data")}else if(hi(Ce)){mt=Ce.shape;var Ge=Ce.stride,nt=0,Ft=0,lt=0,Xt=0;mt.length===1?(nt=mt[0],Ft=1,lt=Ge[0],Xt=0):mt.length===2?(nt=mt[0],Ft=mt[1],lt=Ge[0],Xt=Ge[1]):O.raise("invalid shape");var Bt=Array.isArray(Ce.data)?Ae.dtype:sh(Ce.data),Lt=kn.allocType(Bt,nt*Ft);pb(Lt,Ce.data,nt,Ft,lt,Xt,Ce.offset),Ie(Lt,jt),kn.freeType(Lt)}else O.raise("invalid data for buffer subdata");return st}return se[Ae.id]=Ae,ze||st(oe),st._reglType="buffer",st._buffer=Ae,st.subdata=Ke,K.profile&&(st.stats=Ae.stats),st.destroy=function(){et(Ae)},st}function Qe(){Pr(se).forEach(function(oe){oe.buffer=I.createBuffer(),I.bindBuffer(oe.type,oe.buffer),I.bufferData(oe.type,oe.persistentData||oe.byteLength,oe.usage)})}return K.profile&&(U.getTotalBufferSize=function(){var oe=0;return Object.keys(se).forEach(function(me){oe+=se[me].stats.size}),oe}),{create:Ne,createStream:Fe,destroyStream:je,clear:function(){Pr(se).forEach(et),Pe.forEach(et)},getBuffer:function(oe){return oe&&oe._buffer instanceof ve?oe._buffer:null},restore:Qe,_initBuffer:Ye}}Xo[5120]=1,Xo[5122]=2,Xo[5124]=4,Xo[5121]=1,Xo[5123]=2,Xo[5125]=4,Xo[5126]=4;var SN=1,Cs={points:0,point:0,lines:1,line:SN,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},_N=0,kN=1,qu=4,CN=5120,As=5121,gb=5122,Is=5123,vb=5124,Pa=5125,rg=34963,AN=35040,IN=35044;function TN(I,U,K,fe){var be={},se=0,ve={uint8:As,uint16:Is};function Pe(Qe){this.id=se++,be[this.id]=this,this.buffer=Qe,this.primType=qu,this.vertCount=0,this.type=0}U.oes_element_index_uint&&(ve.uint32=Pa),Pe.prototype.bind=function(){this.buffer.bind()};var Fe=[];function je(Qe){var oe=Fe.pop();return oe||(oe=new Pe(K.create(null,rg,!0,!1)._buffer)),Ye(oe,Qe,AN,-1,-1,0,0),oe}function Le(Qe){Fe.push(Qe)}function Ye(Qe,oe,me,ze,rt,Ae,st){var Ie;if(Qe.buffer.bind(),oe){var Ke=st;st||e(oe)&&(!hi(oe)||e(oe.data))||(Ke=U.oes_element_index_uint?Pa:Is),K._initBuffer(Qe.buffer,oe,me,Ke,3)}else I.bufferData(rg,Ae,me),Qe.buffer.dtype=Ie||As,Qe.buffer.usage=me,Qe.buffer.dimension=3,Qe.buffer.byteLength=Ae;if(Ie=st,!st){switch(Qe.buffer.dtype){case As:case CN:Ie=As;break;case Is:case gb:Ie=Is;break;case Pa:case vb:Ie=Pa;break;default:O.raise("unsupported type for element array")}Qe.buffer.dtype=Ie}Qe.type=Ie,O(Ie!==Pa||!!U.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Ce=rt;Ce<0&&(Ce=Qe.buffer.byteLength,Ie===Is?Ce>>=1:Ie===Pa&&(Ce>>=2)),Qe.vertCount=Ce;var He=ze;if(ze<0){He=qu;var mt=Qe.buffer.dimension;mt===1&&(He=_N),mt===2&&(He=kN),mt===3&&(He=qu)}Qe.primType=He}function et(Qe){fe.elementsCount--,O(Qe.buffer!==null,"must not double destroy elements"),delete be[Qe.id],Qe.buffer.destroy(),Qe.buffer=null}function Ne(Qe,oe){var me=K.create(null,rg,!0),ze=new Pe(me._buffer);function rt(Ae){if(Ae)if(typeof Ae=="number")me(Ae),ze.primType=qu,ze.vertCount=0|Ae,ze.type=As;else{var st=null,Ie=IN,Ke=-1,Ce=-1,He=0,mt=0;Array.isArray(Ae)||e(Ae)||hi(Ae)?st=Ae:(O.type(Ae,"object","invalid arguments for elements"),"data"in Ae&&(st=Ae.data,O(Array.isArray(st)||e(st)||hi(st),"invalid data for element buffer")),"usage"in Ae&&(O.parameter(Ae.usage,ah,"invalid element buffer usage"),Ie=ah[Ae.usage]),"primitive"in Ae&&(O.parameter(Ae.primitive,Cs,"invalid element buffer primitive"),Ke=Cs[Ae.primitive]),"count"in Ae&&(O(typeof Ae.count=="number"&&Ae.count>=0,"invalid vertex count for elements"),Ce=0|Ae.count),"type"in Ae&&(O.parameter(Ae.type,ve,"invalid buffer type"),mt=ve[Ae.type]),"length"in Ae?He=0|Ae.length:(He=Ce,mt===Is||mt===gb?He*=2:mt!==Pa&&mt!==vb||(He*=4))),Ye(ze,st,Ie,Ke,Ce,He,mt)}else me(),ze.primType=qu,ze.vertCount=0,ze.type=As;return rt}return fe.elementsCount++,rt(Qe),rt._reglType="elements",rt._elements=ze,rt.subdata=function(Ae,st){return me.subdata(Ae,st),rt},rt.destroy=function(){et(ze)},rt}return{create:Ne,createStream:je,destroyStream:Le,getElements:function(Qe){return typeof Qe=="function"&&Qe._elements instanceof Pe?Qe._elements:null},clear:function(){Pr(be).forEach(et)}}}var mb=new Float32Array(1),ON=new Uint32Array(mb.buffer),NN=5123;function yb(I){for(var U=kn.allocType(NN,I.length),K=0;K<I.length;++K)if(isNaN(I[K]))U[K]=65535;else if(I[K]===1/0)U[K]=31744;else if(I[K]===-1/0)U[K]=64512;else{mb[0]=I[K];var fe=ON[0],be=fe>>>31<<15,se=(fe<<1>>>24)-127,ve=fe>>13&1023;if(se<-24)U[K]=be;else if(se<-14){var Pe=-14-se;U[K]=be+(ve+1024>>Pe)}else U[K]=se>15?be+31744:be+(se+15<<10)+ve}return U}function Bn(I){return Array.isArray(I)||e(I)}var bb=function(I){return!(I&I-1||!I)},DN=34467,Pi=3553,ig=34067,uh=34069,La=6408,og=6406,ch=6407,Zu=6409,lh=6410,xb=32854,ag=32855,wb=36194,PN=32819,LN=32820,RN=33635,jN=34042,sg=6402,hh=34041,ug=35904,cg=35906,Ts=36193,lg=33776,hg=33777,fg=33778,dg=33779,Eb=35986,Mb=35987,Sb=34798,_b=35840,kb=35841,Cb=35842,Ab=35843,Ib=36196,Os=5121,pg=5123,gg=5125,Ku=5126,BN=10242,zN=10243,FN=10497,vg=33071,GN=33648,UN=10240,XN=10241,mg=9728,YN=9729,yg=9984,Tb=9985,Ob=9986,bg=9987,WN=33170,fh=4352,VN=4353,HN=4354,qN=34046,ZN=3317,KN=37440,$N=37441,QN=37443,Nb=37444,$u=33984,JN=[yg,Ob,Tb,bg],dh=[0,Zu,lh,ch,La],Kr={};function Ns(I){return"[object "+I+"]"}Kr[Zu]=Kr[og]=Kr[sg]=1,Kr[hh]=Kr[lh]=2,Kr[ch]=Kr[ug]=3,Kr[La]=Kr[cg]=4;var Db=Ns("HTMLCanvasElement"),Pb=Ns("OffscreenCanvas"),Lb=Ns("CanvasRenderingContext2D"),Rb=Ns("ImageBitmap"),jb=Ns("HTMLImageElement"),Bb=Ns("HTMLVideoElement"),eD=Object.keys(Jp).concat([Db,Pb,Lb,Rb,jb,Bb]),Ds=[];Ds[Os]=1,Ds[Ku]=4,Ds[Ts]=2,Ds[pg]=2,Ds[gg]=4;var $n=[];function zb(I){return Array.isArray(I)&&(I.length===0||typeof I[0]=="number")}function Fb(I){return!!Array.isArray(I)&&!(I.length===0||!Bn(I[0]))}function Ra(I){return Object.prototype.toString.call(I)}function Gb(I){return Ra(I)===Db}function Ub(I){return Ra(I)===Pb}function tD(I){return Ra(I)===Lb}function nD(I){return Ra(I)===Rb}function rD(I){return Ra(I)===jb}function iD(I){return Ra(I)===Bb}function xg(I){if(!I)return!1;var U=Ra(I);return eD.indexOf(U)>=0||zb(I)||Fb(I)||hi(I)}function Xb(I){return 0|Jp[Object.prototype.toString.call(I)]}function oD(I,U){var K=U.length;switch(I.type){case Os:case pg:case gg:case Ku:var fe=kn.allocType(I.type,K);fe.set(U),I.data=fe;break;case Ts:I.data=yb(U);break;default:O.raise("unsupported texture type, must specify a typed array")}}function Yb(I,U){return kn.allocType(I.type===Ts?Ku:I.type,U)}function Wb(I,U){I.type===Ts?(I.data=yb(U),kn.freeType(U)):I.data=U}function aD(I,U,K,fe,be,se){for(var ve=I.width,Pe=I.height,Fe=I.channels,je=Yb(I,ve*Pe*Fe),Le=0,Ye=0;Ye<Pe;++Ye)for(var et=0;et<ve;++et)for(var Ne=0;Ne<Fe;++Ne)je[Le++]=U[K*et+fe*Ye+be*Ne+se];Wb(I,je)}function ph(I,U,K,fe,be,se){var ve;if(ve=$n[I]!==void 0?$n[I]:Kr[I]*Ds[U],se&&(ve*=6),be){for(var Pe=0,Fe=K;Fe>=1;)Pe+=ve*Fe*Fe,Fe/=2;return Pe}return ve*K*fe}function sD(I,U,K,fe,be,se,ve){var Pe={"don't care":fh,"dont care":fh,nice:HN,fast:VN},Fe={repeat:FN,clamp:vg,mirror:GN},je={nearest:mg,linear:YN},Le=n({mipmap:bg,"nearest mipmap nearest":yg,"linear mipmap nearest":Tb,"nearest mipmap linear":Ob,"linear mipmap linear":bg},je),Ye={none:0,browser:Nb},et={uint8:Os,rgba4:PN,rgb565:RN,"rgb5 a1":LN},Ne={alpha:og,luminance:Zu,"luminance alpha":lh,rgb:ch,rgba:La,rgba4:xb,"rgb5 a1":ag,rgb565:wb},Qe={};U.ext_srgb&&(Ne.srgb=ug,Ne.srgba=cg),U.oes_texture_float&&(et.float32=et.float=Ku),U.oes_texture_half_float&&(et.float16=et["half float"]=Ts),U.webgl_depth_texture&&(n(Ne,{depth:sg,"depth stencil":hh}),n(et,{uint16:pg,uint32:gg,"depth stencil":jN})),U.webgl_compressed_texture_s3tc&&n(Qe,{"rgb s3tc dxt1":lg,"rgba s3tc dxt1":hg,"rgba s3tc dxt3":fg,"rgba s3tc dxt5":dg}),U.webgl_compressed_texture_atc&&n(Qe,{"rgb atc":Eb,"rgba atc explicit alpha":Mb,"rgba atc interpolated alpha":Sb}),U.webgl_compressed_texture_pvrtc&&n(Qe,{"rgb pvrtc 4bppv1":_b,"rgb pvrtc 2bppv1":kb,"rgba pvrtc 4bppv1":Cb,"rgba pvrtc 2bppv1":Ab}),U.webgl_compressed_texture_etc1&&(Qe["rgb etc1"]=Ib);var oe=Array.prototype.slice.call(I.getParameter(DN));Object.keys(Qe).forEach(function(W){var de=Qe[W];oe.indexOf(de)>=0&&(Ne[W]=de)});var me=Object.keys(Ne);K.textureFormats=me;var ze=[];Object.keys(Ne).forEach(function(W){var de=Ne[W];ze[de]=W});var rt=[];Object.keys(et).forEach(function(W){var de=et[W];rt[de]=W});var Ae=[];Object.keys(je).forEach(function(W){var de=je[W];Ae[de]=W});var st=[];Object.keys(Le).forEach(function(W){var de=Le[W];st[de]=W});var Ie=[];Object.keys(Fe).forEach(function(W){var de=Fe[W];Ie[de]=W});var Ke=me.reduce(function(W,de){var le=Ne[de];return le===Zu||le===og||le===Zu||le===lh||le===sg||le===hh||U.ext_srgb&&(le===ug||le===cg)?W[le]=le:le===ag||de.indexOf("rgba")>=0?W[le]=La:W[le]=ch,W},{});function Ce(){this.internalformat=La,this.format=La,this.type=Os,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Nb,this.width=0,this.height=0,this.channels=0}function He(W,de){W.internalformat=de.internalformat,W.format=de.format,W.type=de.type,W.compressed=de.compressed,W.premultiplyAlpha=de.premultiplyAlpha,W.flipY=de.flipY,W.unpackAlignment=de.unpackAlignment,W.colorSpace=de.colorSpace,W.width=de.width,W.height=de.height,W.channels=de.channels}function mt(W,de){if(typeof de=="object"&&de){if("premultiplyAlpha"in de&&(O.type(de.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),W.premultiplyAlpha=de.premultiplyAlpha),"flipY"in de&&(O.type(de.flipY,"boolean","invalid texture flip"),W.flipY=de.flipY),"alignment"in de&&(O.oneOf(de.alignment,[1,2,4,8],"invalid texture unpack alignment"),W.unpackAlignment=de.alignment),"colorSpace"in de&&(O.parameter(de.colorSpace,Ye,"invalid colorSpace"),W.colorSpace=Ye[de.colorSpace]),"type"in de){var le=de.type;O(U.oes_texture_float||!(le==="float"||le==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),O(U.oes_texture_half_float||!(le==="half float"||le==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),O(U.webgl_depth_texture||!(le==="uint16"||le==="uint32"||le==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),O.parameter(le,et,"invalid texture type"),W.type=et[le]}var ut=W.width,Yt=W.height,X=W.channels,z=!1;"shape"in de?(O(Array.isArray(de.shape)&&de.shape.length>=2,"shape must be an array"),ut=de.shape[0],Yt=de.shape[1],de.shape.length===3&&(X=de.shape[2],O(X>0&&X<=4,"invalid number of channels"),z=!0),O(ut>=0&&ut<=K.maxTextureSize,"invalid width"),O(Yt>=0&&Yt<=K.maxTextureSize,"invalid height")):("radius"in de&&(ut=Yt=de.radius,O(ut>=0&&ut<=K.maxTextureSize,"invalid radius")),"width"in de&&(ut=de.width,O(ut>=0&&ut<=K.maxTextureSize,"invalid width")),"height"in de&&(Yt=de.height,O(Yt>=0&&Yt<=K.maxTextureSize,"invalid height")),"channels"in de&&(X=de.channels,O(X>0&&X<=4,"invalid number of channels"),z=!0)),W.width=0|ut,W.height=0|Yt,W.channels=0|X;var Q=!1;if("format"in de){var re=de.format;O(U.webgl_depth_texture||!(re==="depth"||re==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),O.parameter(re,Ne,"invalid texture format");var ue=W.internalformat=Ne[re];W.format=Ke[ue],re in et&&("type"in de||(W.type=et[re])),re in Qe&&(W.compressed=!0),Q=!0}!z&&Q?W.channels=Kr[W.format]:z&&!Q?W.channels!==dh[W.format]&&(W.format=W.internalformat=dh[W.channels]):Q&&z&&O(W.channels===Kr[W.format],"number of channels inconsistent with specified format")}}function jt(W){I.pixelStorei(KN,W.flipY),I.pixelStorei($N,W.premultiplyAlpha),I.pixelStorei(QN,W.colorSpace),I.pixelStorei(ZN,W.unpackAlignment)}function $e(){Ce.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function tt(W,de){var le=null;if(xg(de)?le=de:de&&(O.type(de,"object","invalid pixel data type"),mt(W,de),"x"in de&&(W.xOffset=0|de.x),"y"in de&&(W.yOffset=0|de.y),xg(de.data)&&(le=de.data)),O(!W.compressed||le instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),de.copy){O(!le,"can not specify copy and data field for the same texture");var ut=be.viewportWidth,Yt=be.viewportHeight;W.width=W.width||ut-W.xOffset,W.height=W.height||Yt-W.yOffset,W.needsCopy=!0,O(W.xOffset>=0&&W.xOffset<ut&&W.yOffset>=0&&W.yOffset<Yt&&W.width>0&&W.width<=ut&&W.height>0&&W.height<=Yt,"copy texture read out of bounds")}else if(le){if(e(le))W.channels=W.channels||4,W.data=le,"type"in de||W.type!==Os||(W.type=Xb(le));else if(zb(le))W.channels=W.channels||4,oD(W,le),W.alignment=1,W.needsFree=!0;else if(hi(le)){var X=le.data;Array.isArray(X)||W.type!==Os||(W.type=Xb(X));var z,Q,re,ue,$,ee,ae=le.shape,G=le.stride;ae.length===3?(re=ae[2],ee=G[2]):(O(ae.length===2,"invalid ndarray pixel data, must be 2 or 3D"),re=1,ee=1),z=ae[0],Q=ae[1],ue=G[0],$=G[1],W.alignment=1,W.width=z,W.height=Q,W.channels=re,W.format=W.internalformat=dh[re],W.needsFree=!0,aD(W,X,ue,$,ee,le.offset)}else if(Gb(le)||Ub(le)||tD(le))Gb(le)||Ub(le)?W.element=le:W.element=le.canvas,W.width=W.element.width,W.height=W.element.height,W.channels=4;else if(nD(le))W.element=le,W.width=le.width,W.height=le.height,W.channels=4;else if(rD(le))W.element=le,W.width=le.naturalWidth,W.height=le.naturalHeight,W.channels=4;else if(iD(le))W.element=le,W.width=le.videoWidth,W.height=le.videoHeight,W.channels=4;else if(Fb(le)){var V=W.width||le[0].length,Y=W.height||le.length,ce=W.channels;ce=Bn(le[0][0])?ce||le[0][0].length:ce||1;for(var ie=oh.shape(le),ge=1,Ee=0;Ee<ie.length;++Ee)ge*=ie[Ee];var ke=Yb(W,ge);oh.flatten(le,ie,"",ke),Wb(W,ke),W.alignment=1,W.width=V,W.height=Y,W.channels=ce,W.format=W.internalformat=dh[ce],W.needsFree=!0}}else W.width=W.width||1,W.height=W.height||1,W.channels=W.channels||4;W.type===Ku?O(K.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):W.type===Ts&&O(K.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Ge(W,de,le){var ut=W.element,Yt=W.data,X=W.internalformat,z=W.format,Q=W.type,re=W.width,ue=W.height;jt(W),ut?I.texImage2D(de,le,z,z,Q,ut):W.compressed?I.compressedTexImage2D(de,le,X,re,ue,0,Yt):W.needsCopy?(fe(),I.copyTexImage2D(de,le,z,W.xOffset,W.yOffset,re,ue,0)):I.texImage2D(de,le,z,re,ue,0,z,Q,Yt||null)}function nt(W,de,le,ut,Yt){var X=W.element,z=W.data,Q=W.internalformat,re=W.format,ue=W.type,$=W.width,ee=W.height;jt(W),X?I.texSubImage2D(de,Yt,le,ut,re,ue,X):W.compressed?I.compressedTexSubImage2D(de,Yt,le,ut,Q,$,ee,z):W.needsCopy?(fe(),I.copyTexSubImage2D(de,Yt,le,ut,W.xOffset,W.yOffset,$,ee)):I.texSubImage2D(de,Yt,le,ut,$,ee,re,ue,z)}var Ft=[];function lt(){return Ft.pop()||new $e}function Xt(W){W.needsFree&&kn.freeType(W.data),$e.call(W),Ft.push(W)}function Bt(){Ce.call(this),this.genMipmaps=!1,this.mipmapHint=fh,this.mipmask=0,this.images=Array(16)}function Lt(W,de,le){var ut=W.images[0]=lt();W.mipmask=1,ut.width=W.width=de,ut.height=W.height=le,ut.channels=W.channels=4}function Wt(W,de){var le=null;if(xg(de))He(le=W.images[0]=lt(),W),tt(le,de),W.mipmask=1;else if(mt(W,de),Array.isArray(de.mipmap))for(var ut=de.mipmap,Yt=0;Yt<ut.length;++Yt)He(le=W.images[Yt]=lt(),W),le.width>>=Yt,le.height>>=Yt,tt(le,ut[Yt]),W.mipmask|=1<<Yt;else He(le=W.images[0]=lt(),W),tt(le,de),W.mipmask=1;He(W,W.images[0]),!W.compressed||W.internalformat!==lg&&W.internalformat!==hg&&W.internalformat!==fg&&W.internalformat!==dg||O(W.width%4==0&&W.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function An(W,de){for(var le=W.images,ut=0;ut<le.length;++ut){if(!le[ut])return;Ge(le[ut],de,ut)}}var Qn=[];function zn(){var W=Qn.pop()||new Bt;Ce.call(W),W.mipmask=0;for(var de=0;de<16;++de)W.images[de]=null;return W}function Ht(W){for(var de=W.images,le=0;le<de.length;++le)de[le]&&Xt(de[le]),de[le]=null;Qn.push(W)}function In(){this.minFilter=mg,this.magFilter=mg,this.wrapS=vg,this.wrapT=vg,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=fh}function Tn(W,de){if("min"in de){var le=de.min;O.parameter(le,Le),W.minFilter=Le[le],JN.indexOf(W.minFilter)>=0&&!("faces"in de)&&(W.genMipmaps=!0)}if("mag"in de){var ut=de.mag;O.parameter(ut,je),W.magFilter=je[ut]}var Yt=W.wrapS,X=W.wrapT;if("wrap"in de){var z=de.wrap;typeof z=="string"?(O.parameter(z,Fe),Yt=X=Fe[z]):Array.isArray(z)&&(O.parameter(z[0],Fe),O.parameter(z[1],Fe),Yt=Fe[z[0]],X=Fe[z[1]])}else{if("wrapS"in de){var Q=de.wrapS;O.parameter(Q,Fe),Yt=Fe[Q]}if("wrapT"in de){var re=de.wrapT;O.parameter(re,Fe),X=Fe[re]}}if(W.wrapS=Yt,W.wrapT=X,"anisotropic"in de){var ue=de.anisotropic;O(typeof ue=="number"&&ue>=1&&ue<=K.maxAnisotropic,"aniso samples must be between 1 and "),W.anisotropic=de.anisotropic}if("mipmap"in de){var $=!1;switch(typeof de.mipmap){case"string":O.parameter(de.mipmap,Pe,"invalid mipmap hint"),W.mipmapHint=Pe[de.mipmap],W.genMipmaps=!0,$=!0;break;case"boolean":$=W.genMipmaps=de.mipmap;break;case"object":O(Array.isArray(de.mipmap),"invalid mipmap type"),W.genMipmaps=!1,$=!0;break;default:O.raise("invalid mipmap type")}$&&!("min"in de)&&(W.minFilter=yg)}}function Ln(W,de){I.texParameteri(de,XN,W.minFilter),I.texParameteri(de,UN,W.magFilter),I.texParameteri(de,BN,W.wrapS),I.texParameteri(de,zN,W.wrapT),U.ext_texture_filter_anisotropic&&I.texParameteri(de,qN,W.anisotropic),W.genMipmaps&&(I.hint(WN,W.mipmapHint),I.generateMipmap(de))}var Rn=0,Xn={},Jn=K.maxTextureUnits,Mn=Array(Jn).map(function(){return null});function Gt(W){Ce.call(this),this.mipmask=0,this.internalformat=La,this.id=Rn++,this.refCount=1,this.target=W,this.texture=I.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new In,ve.profile&&(this.stats={size:0})}function er(W){I.activeTexture($u),I.bindTexture(W.target,W.texture)}function un(){var W=Mn[0];W?I.bindTexture(W.target,W.texture):I.bindTexture(Pi,null)}function _t(W){var de=W.texture;O(de,"must not double destroy texture");var le=W.unit,ut=W.target;le>=0&&(I.activeTexture($u+le),I.bindTexture(ut,null),Mn[le]=null),I.deleteTexture(de),W.texture=null,W.params=null,W.pixels=null,W.refCount=0,delete Xn[W.id],se.textureCount--}function Vt(W,de){var le=new Gt(Pi);function ut(z,Q){var re=le.texInfo;In.call(re);var ue=zn();return typeof z=="number"?Lt(ue,0|z,typeof Q=="number"?0|Q:0|z):z?(O.type(z,"object","invalid arguments to regl.texture"),Tn(re,z),Wt(ue,z)):Lt(ue,1,1),re.genMipmaps&&(ue.mipmask=(ue.width<<1)-1),le.mipmask=ue.mipmask,He(le,ue),O.texture2D(re,ue,K),le.internalformat=ue.internalformat,ut.width=ue.width,ut.height=ue.height,er(le),An(ue,Pi),Ln(re,Pi),un(),Ht(ue),ve.profile&&(le.stats.size=ph(le.internalformat,le.type,ue.width,ue.height,re.genMipmaps,!1)),ut.format=ze[le.internalformat],ut.type=rt[le.type],ut.mag=Ae[re.magFilter],ut.min=st[re.minFilter],ut.wrapS=Ie[re.wrapS],ut.wrapT=Ie[re.wrapT],ut}function Yt(z,Q,re,ue){O(!!z,"must specify image data");var $=0|Q,ee=0|re,ae=0|ue,G=lt();return He(G,le),G.width=0,G.height=0,tt(G,z),G.width=G.width||(le.width>>ae)-$,G.height=G.height||(le.height>>ae)-ee,O(le.type===G.type&&le.format===G.format&&le.internalformat===G.internalformat,"incompatible format for texture.subimage"),O($>=0&&ee>=0&&$+G.width<=le.width&&ee+G.height<=le.height,"texture.subimage write out of bounds"),O(le.mipmask&1<<ae,"missing mipmap data"),O(G.data||G.element||G.needsCopy,"missing image data"),er(le),nt(G,Pi,$,ee,ae),un(),Xt(G),ut}function X(z,Q){var re=0|z,ue=0|Q||re;if(re===le.width&&ue===le.height)return ut;ut.width=le.width=re,ut.height=le.height=ue,er(le);for(var $=0;le.mipmask>>$;++$){var ee=re>>$,ae=ue>>$;if(!ee||!ae)break;I.texImage2D(Pi,$,le.format,ee,ae,0,le.format,le.type,null)}return un(),ve.profile&&(le.stats.size=ph(le.internalformat,le.type,re,ue,!1,!1)),ut}return Xn[le.id]=le,se.textureCount++,ut(W,de),ut.subimage=Yt,ut.resize=X,ut._reglType="texture2d",ut._texture=le,ve.profile&&(ut.stats=le.stats),ut.destroy=function(){le.decRef()},ut}function Jt(W,de,le,ut,Yt,X){var z=new Gt(ig);Xn[z.id]=z,se.cubeCount++;var Q=new Array(6);function re(ee,ae,G,V,Y,ce){var ie,ge=z.texInfo;for(In.call(ge),ie=0;ie<6;++ie)Q[ie]=zn();if(typeof ee!="number"&&ee)if(typeof ee=="object")if(ae)Wt(Q[0],ee),Wt(Q[1],ae),Wt(Q[2],G),Wt(Q[3],V),Wt(Q[4],Y),Wt(Q[5],ce);else if(Tn(ge,ee),mt(z,ee),"faces"in ee){var Ee=ee.faces;for(O(Array.isArray(Ee)&&Ee.length===6,"cube faces must be a length 6 array"),ie=0;ie<6;++ie)O(typeof Ee[ie]=="object"&&!!Ee[ie],"invalid input for cube map face"),He(Q[ie],z),Wt(Q[ie],Ee[ie])}else for(ie=0;ie<6;++ie)Wt(Q[ie],ee);else O.raise("invalid arguments to cube map");else{var ke=0|ee||1;for(ie=0;ie<6;++ie)Lt(Q[ie],ke,ke)}for(He(z,Q[0]),K.npotTextureCube||O(bb(z.width)&&bb(z.height),"your browser does not support non power or two texture dimensions"),ge.genMipmaps?z.mipmask=(Q[0].width<<1)-1:z.mipmask=Q[0].mipmask,O.textureCube(z,ge,Q,K),z.internalformat=Q[0].internalformat,re.width=Q[0].width,re.height=Q[0].height,er(z),ie=0;ie<6;++ie)An(Q[ie],uh+ie);for(Ln(ge,ig),un(),ve.profile&&(z.stats.size=ph(z.internalformat,z.type,re.width,re.height,ge.genMipmaps,!0)),re.format=ze[z.internalformat],re.type=rt[z.type],re.mag=Ae[ge.magFilter],re.min=st[ge.minFilter],re.wrapS=Ie[ge.wrapS],re.wrapT=Ie[ge.wrapT],ie=0;ie<6;++ie)Ht(Q[ie]);return re}function ue(ee,ae,G,V,Y){O(!!ae,"must specify image data"),O(typeof ee=="number"&&ee===(0|ee)&&ee>=0&&ee<6,"invalid face");var ce=0|G,ie=0|V,ge=0|Y,Ee=lt();return He(Ee,z),Ee.width=0,Ee.height=0,tt(Ee,ae),Ee.width=Ee.width||(z.width>>ge)-ce,Ee.height=Ee.height||(z.height>>ge)-ie,O(z.type===Ee.type&&z.format===Ee.format&&z.internalformat===Ee.internalformat,"incompatible format for texture.subimage"),O(ce>=0&&ie>=0&&ce+Ee.width<=z.width&&ie+Ee.height<=z.height,"texture.subimage write out of bounds"),O(z.mipmask&1<<ge,"missing mipmap data"),O(Ee.data||Ee.element||Ee.needsCopy,"missing image data"),er(z),nt(Ee,uh+ee,ce,ie,ge),un(),Xt(Ee),re}function $(ee){var ae=0|ee;if(ae!==z.width){re.width=z.width=ae,re.height=z.height=ae,er(z);for(var G=0;G<6;++G)for(var V=0;z.mipmask>>V;++V)I.texImage2D(uh+G,V,z.format,ae>>V,ae>>V,0,z.format,z.type,null);return un(),ve.profile&&(z.stats.size=ph(z.internalformat,z.type,re.width,re.height,!1,!0)),re}}return re(W,de,le,ut,Yt,X),re.subimage=ue,re.resize=$,re._reglType="textureCube",re._texture=z,ve.profile&&(re.stats=z.stats),re.destroy=function(){z.decRef()},re}function Sn(){for(var W=0;W<Jn;++W)I.activeTexture($u+W),I.bindTexture(Pi,null),Mn[W]=null;Pr(Xn).forEach(_t),se.cubeCount=0,se.textureCount=0}function Ri(){for(var W=0;W<Jn;++W){var de=Mn[W];de&&(de.bindCount=0,de.unit=-1,Mn[W]=null)}Pr(Xn).forEach(function(le){le.texture=I.createTexture(),I.bindTexture(le.target,le.texture);for(var ut=0;ut<32;++ut)if(le.mipmask&1<<ut)if(le.target===Pi)I.texImage2D(Pi,ut,le.internalformat,le.width>>ut,le.height>>ut,0,le.internalformat,le.type,null);else for(var Yt=0;Yt<6;++Yt)I.texImage2D(uh+Yt,ut,le.internalformat,le.width>>ut,le.height>>ut,0,le.internalformat,le.type,null);Ln(le.texInfo,le.target)})}function Xa(){for(var W=0;W<Jn;++W){var de=Mn[W];de&&(de.bindCount=0,de.unit=-1,Mn[W]=null),I.activeTexture($u+W),I.bindTexture(Pi,null),I.bindTexture(ig,null)}}return n(Gt.prototype,{bind:function(){var W=this;W.bindCount+=1;var de=W.unit;if(de<0){for(var le=0;le<Jn;++le){var ut=Mn[le];if(ut){if(ut.bindCount>0)continue;ut.unit=-1}Mn[le]=W,de=le;break}de>=Jn&&O.raise("insufficient number of texture units"),ve.profile&&se.maxTextureUnits<de+1&&(se.maxTextureUnits=de+1),W.unit=de,I.activeTexture($u+de),I.bindTexture(W.target,W.texture)}return de},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&_t(this)}}),ve.profile&&(se.getTotalTextureSize=function(){var W=0;return Object.keys(Xn).forEach(function(de){W+=Xn[de].stats.size}),W}),{create2D:Vt,createCube:Jt,clear:Sn,getTexture:function(W){return null},restore:Ri,refresh:Xa}}$n[xb]=2,$n[ag]=2,$n[wb]=2,$n[hh]=4,$n[lg]=.5,$n[hg]=.5,$n[fg]=1,$n[dg]=1,$n[Eb]=.5,$n[Mb]=1,$n[Sb]=1,$n[_b]=.5,$n[kb]=.25,$n[Cb]=.5,$n[Ab]=.25,$n[Ib]=.5;var Yo=36161,gh=32854,Vb=32855,Hb=36194,qb=33189,Zb=36168,Kb=34041,$b=35907,Qb=34836,Jb=34842,ex=34843,fi=[];function tx(I,U,K){return fi[I]*U*K}fi[gh]=2,fi[Vb]=2,fi[Hb]=2,fi[qb]=2,fi[Zb]=1,fi[Kb]=4,fi[$b]=4,fi[Qb]=16,fi[Jb]=8,fi[ex]=6;var uD=function(I,U,K,fe,be){var se={rgba4:gh,rgb565:Hb,"rgb5 a1":Vb,depth:qb,stencil:Zb,"depth stencil":Kb};U.ext_srgb&&(se.srgba=$b),U.ext_color_buffer_half_float&&(se.rgba16f=Jb,se.rgb16f=ex),U.webgl_color_buffer_float&&(se.rgba32f=Qb);var ve=[];Object.keys(se).forEach(function(Ne){var Qe=se[Ne];ve[Qe]=Ne});var Pe=0,Fe={};function je(Ne){this.id=Pe++,this.refCount=1,this.renderbuffer=Ne,this.format=gh,this.width=0,this.height=0,be.profile&&(this.stats={size:0})}function Le(Ne){var Qe=Ne.renderbuffer;O(Qe,"must not double destroy renderbuffer"),I.bindRenderbuffer(Yo,null),I.deleteRenderbuffer(Qe),Ne.renderbuffer=null,Ne.refCount=0,delete Fe[Ne.id],fe.renderbufferCount--}function Ye(Ne,Qe){var oe=new je(I.createRenderbuffer());function me(rt,Ae){var st=0,Ie=0,Ke=gh;if(typeof rt=="object"&&rt){var Ce=rt;if("shape"in Ce){var He=Ce.shape;O(Array.isArray(He)&&He.length>=2,"invalid renderbuffer shape"),st=0|He[0],Ie=0|He[1]}else"radius"in Ce&&(st=Ie=0|Ce.radius),"width"in Ce&&(st=0|Ce.width),"height"in Ce&&(Ie=0|Ce.height);"format"in Ce&&(O.parameter(Ce.format,se,"invalid renderbuffer format"),Ke=se[Ce.format])}else typeof rt=="number"?(st=0|rt,Ie=typeof Ae=="number"?0|Ae:st):rt?O.raise("invalid arguments to renderbuffer constructor"):st=Ie=1;if(O(st>0&&Ie>0&&st<=K.maxRenderbufferSize&&Ie<=K.maxRenderbufferSize,"invalid renderbuffer size"),st!==oe.width||Ie!==oe.height||Ke!==oe.format)return me.width=oe.width=st,me.height=oe.height=Ie,oe.format=Ke,I.bindRenderbuffer(Yo,oe.renderbuffer),I.renderbufferStorage(Yo,Ke,st,Ie),O(I.getError()===0,"invalid render buffer format"),be.profile&&(oe.stats.size=tx(oe.format,oe.width,oe.height)),me.format=ve[oe.format],me}function ze(rt,Ae){var st=0|rt,Ie=0|Ae||st;return st===oe.width&&Ie===oe.height||(O(st>0&&Ie>0&&st<=K.maxRenderbufferSize&&Ie<=K.maxRenderbufferSize,"invalid renderbuffer size"),me.width=oe.width=st,me.height=oe.height=Ie,I.bindRenderbuffer(Yo,oe.renderbuffer),I.renderbufferStorage(Yo,oe.format,st,Ie),O(I.getError()===0,"invalid render buffer format"),be.profile&&(oe.stats.size=tx(oe.format,oe.width,oe.height))),me}return Fe[oe.id]=oe,fe.renderbufferCount++,me(Ne,Qe),me.resize=ze,me._reglType="renderbuffer",me._renderbuffer=oe,be.profile&&(me.stats=oe.stats),me.destroy=function(){oe.decRef()},me}function et(){Pr(Fe).forEach(function(Ne){Ne.renderbuffer=I.createRenderbuffer(),I.bindRenderbuffer(Yo,Ne.renderbuffer),I.renderbufferStorage(Yo,Ne.format,Ne.width,Ne.height)}),I.bindRenderbuffer(Yo,null)}return je.prototype.decRef=function(){--this.refCount<=0&&Le(this)},be.profile&&(fe.getTotalRenderbufferSize=function(){var Ne=0;return Object.keys(Fe).forEach(function(Qe){Ne+=Fe[Qe].stats.size}),Ne}),{create:Ye,clear:function(){Pr(Fe).forEach(Le)},restore:et}},lo=36160,wg=36161,ja=3553,vh=34069,nx=36064,rx=36096,ix=36128,ox=33306,ax=36053,cD=36054,lD=36055,hD=36057,fD=36061,dD=36193,pD=5121,gD=5126,sx=6407,ux=6408,vD=6402,mD=[sx,ux],Eg=[];Eg[ux]=4,Eg[sx]=3;var mh=[];mh[pD]=1,mh[gD]=4,mh[dD]=2;var yD=33189,bD=36168,cx=34041,xD=[32854,32855,36194,35907,34842,34843,34836],Ps={};function wD(I,U,K,fe,be,se){var ve={cur:null,next:null,dirty:!1,setFBO:null},Pe=["rgba"],Fe=["rgba4","rgb565","rgb5 a1"];U.ext_srgb&&Fe.push("srgba"),U.ext_color_buffer_half_float&&Fe.push("rgba16f","rgb16f"),U.webgl_color_buffer_float&&Fe.push("rgba32f");var je=["uint8"];function Le($e,tt,Ge){this.target=$e,this.texture=tt,this.renderbuffer=Ge;var nt=0,Ft=0;tt?(nt=tt.width,Ft=tt.height):Ge&&(nt=Ge.width,Ft=Ge.height),this.width=nt,this.height=Ft}function Ye($e){$e&&($e.texture&&$e.texture._texture.decRef(),$e.renderbuffer&&$e.renderbuffer._renderbuffer.decRef())}function et($e,tt,Ge){if($e)if($e.texture){var nt=$e.texture._texture,Ft=Math.max(1,nt.width),lt=Math.max(1,nt.height);O(Ft===tt&&lt===Ge,"inconsistent width/height for supplied texture"),nt.refCount+=1}else{var Xt=$e.renderbuffer._renderbuffer;O(Xt.width===tt&&Xt.height===Ge,"inconsistent width/height for renderbuffer"),Xt.refCount+=1}}function Ne($e,tt){tt&&(tt.texture?I.framebufferTexture2D(lo,$e,tt.target,tt.texture._texture.texture,0):I.framebufferRenderbuffer(lo,$e,wg,tt.renderbuffer._renderbuffer.renderbuffer))}function Qe($e){var tt=ja,Ge=null,nt=null,Ft=$e;typeof $e=="object"&&(Ft=$e.data,"target"in $e&&(tt=0|$e.target)),O.type(Ft,"function","invalid attachment data");var lt=Ft._reglType;return lt==="texture2d"?(Ge=Ft,O(tt===ja)):lt==="textureCube"?(Ge=Ft,O(tt>=vh&&tt<vh+6,"invalid cube map target")):lt==="renderbuffer"?(nt=Ft,tt=wg):O.raise("invalid regl object for attachment"),new Le(tt,Ge,nt)}function oe($e,tt,Ge,nt,Ft){if(Ge){var lt=fe.create2D({width:$e,height:tt,format:nt,type:Ft});return lt._texture.refCount=0,new Le(ja,lt,null)}var Xt=be.create({width:$e,height:tt,format:nt});return Xt._renderbuffer.refCount=0,new Le(wg,null,Xt)}function me($e){return $e&&($e.texture||$e.renderbuffer)}function ze($e,tt,Ge){$e&&($e.texture?$e.texture.resize(tt,Ge):$e.renderbuffer&&$e.renderbuffer.resize(tt,Ge),$e.width=tt,$e.height=Ge)}U.oes_texture_half_float&&je.push("half float","float16"),U.oes_texture_float&&je.push("float","float32");var rt=0,Ae={};function st(){this.id=rt++,Ae[this.id]=this,this.framebuffer=I.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Ie($e){$e.colorAttachments.forEach(Ye),Ye($e.depthAttachment),Ye($e.stencilAttachment),Ye($e.depthStencilAttachment)}function Ke($e){var tt=$e.framebuffer;O(tt,"must not double destroy framebuffer"),I.deleteFramebuffer(tt),$e.framebuffer=null,se.framebufferCount--,delete Ae[$e.id]}function Ce($e){var tt;I.bindFramebuffer(lo,$e.framebuffer);var Ge=$e.colorAttachments;for(tt=0;tt<Ge.length;++tt)Ne(nx+tt,Ge[tt]);for(tt=Ge.length;tt<K.maxColorAttachments;++tt)I.framebufferTexture2D(lo,nx+tt,ja,null,0);I.framebufferTexture2D(lo,ox,ja,null,0),I.framebufferTexture2D(lo,rx,ja,null,0),I.framebufferTexture2D(lo,ix,ja,null,0),Ne(rx,$e.depthAttachment),Ne(ix,$e.stencilAttachment),Ne(ox,$e.depthStencilAttachment);var nt=I.checkFramebufferStatus(lo);I.isContextLost()||nt===ax||O.raise("framebuffer configuration not supported, status = "+Ps[nt]),I.bindFramebuffer(lo,ve.next?ve.next.framebuffer:null),ve.cur=ve.next,I.getError()}function He($e,tt){var Ge=new st;function nt(lt,Xt){var Bt;O(ve.next!==Ge,"can not update framebuffer which is currently in use");var Lt=0,Wt=0,An=!0,Qn=!0,zn=null,Ht=!0,In="rgba",Tn="uint8",Ln=1,Rn=null,Xn=null,Jn=null,Mn=!1;if(typeof lt=="number")Lt=0|lt,Wt=0|Xt||Lt;else if(lt){O.type(lt,"object","invalid arguments for framebuffer");var Gt=lt;if("shape"in Gt){var er=Gt.shape;O(Array.isArray(er)&&er.length>=2,"invalid shape for framebuffer"),Lt=er[0],Wt=er[1]}else"radius"in Gt&&(Lt=Wt=Gt.radius),"width"in Gt&&(Lt=Gt.width),"height"in Gt&&(Wt=Gt.height);("color"in Gt||"colors"in Gt)&&(zn=Gt.color||Gt.colors,Array.isArray(zn)&&O(zn.length===1||U.webgl_draw_buffers,"multiple render targets not supported")),zn||("colorCount"in Gt&&(Ln=0|Gt.colorCount,O(Ln>0,"invalid color buffer count")),"colorTexture"in Gt&&(Ht=!!Gt.colorTexture,In="rgba4"),"colorType"in Gt&&(Tn=Gt.colorType,Ht?(O(U.oes_texture_float||!(Tn==="float"||Tn==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),O(U.oes_texture_half_float||!(Tn==="half float"||Tn==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Tn==="half float"||Tn==="float16"?(O(U.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),In="rgba16f"):Tn!=="float"&&Tn!=="float32"||(O(U.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),In="rgba32f"),O.oneOf(Tn,je,"invalid color type")),"colorFormat"in Gt&&(In=Gt.colorFormat,Pe.indexOf(In)>=0?Ht=!0:Fe.indexOf(In)>=0?Ht=!1:Ht?O.oneOf(Gt.colorFormat,Pe,"invalid color format for texture"):O.oneOf(Gt.colorFormat,Fe,"invalid color format for renderbuffer"))),("depthTexture"in Gt||"depthStencilTexture"in Gt)&&(Mn=!(!Gt.depthTexture&&!Gt.depthStencilTexture),O(!Mn||U.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Gt&&(typeof Gt.depth=="boolean"?An=Gt.depth:(Rn=Gt.depth,Qn=!1)),"stencil"in Gt&&(typeof Gt.stencil=="boolean"?Qn=Gt.stencil:(Xn=Gt.stencil,An=!1)),"depthStencil"in Gt&&(typeof Gt.depthStencil=="boolean"?An=Qn=Gt.depthStencil:(Jn=Gt.depthStencil,An=!1,Qn=!1))}else Lt=Wt=1;var un=null,_t=null,Vt=null,Jt=null;if(Array.isArray(zn))un=zn.map(Qe);else if(zn)un=[Qe(zn)];else for(un=new Array(Ln),Bt=0;Bt<Ln;++Bt)un[Bt]=oe(Lt,Wt,Ht,In,Tn);O(U.webgl_draw_buffers||un.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),O(un.length<=K.maxColorAttachments,"too many color attachments, not supported"),Lt=Lt||un[0].width,Wt=Wt||un[0].height,Rn?_t=Qe(Rn):An&&!Qn&&(_t=oe(Lt,Wt,Mn,"depth","uint32")),Xn?Vt=Qe(Xn):Qn&&!An&&(Vt=oe(Lt,Wt,!1,"stencil","uint8")),Jn?Jt=Qe(Jn):!Rn&&!Xn&&Qn&&An&&(Jt=oe(Lt,Wt,Mn,"depth stencil","depth stencil")),O(!!Rn+!!Xn+!!Jn<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Sn=null;for(Bt=0;Bt<un.length;++Bt)if(et(un[Bt],Lt,Wt),O(!un[Bt]||un[Bt].texture&&mD.indexOf(un[Bt].texture._texture.format)>=0||un[Bt].renderbuffer&&xD.indexOf(un[Bt].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Bt+" is invalid"),un[Bt]&&un[Bt].texture){var Ri=Eg[un[Bt].texture._texture.format]*mh[un[Bt].texture._texture.type];Sn===null?Sn=Ri:O(Sn===Ri,"all color attachments much have the same number of bits per pixel.")}return et(_t,Lt,Wt),O(!_t||_t.texture&&_t.texture._texture.format===vD||_t.renderbuffer&&_t.renderbuffer._renderbuffer.format===yD,"invalid depth attachment for framebuffer object"),et(Vt,Lt,Wt),O(!Vt||Vt.renderbuffer&&Vt.renderbuffer._renderbuffer.format===bD,"invalid stencil attachment for framebuffer object"),et(Jt,Lt,Wt),O(!Jt||Jt.texture&&Jt.texture._texture.format===cx||Jt.renderbuffer&&Jt.renderbuffer._renderbuffer.format===cx,"invalid depth-stencil attachment for framebuffer object"),Ie(Ge),Ge.width=Lt,Ge.height=Wt,Ge.colorAttachments=un,Ge.depthAttachment=_t,Ge.stencilAttachment=Vt,Ge.depthStencilAttachment=Jt,nt.color=un.map(me),nt.depth=me(_t),nt.stencil=me(Vt),nt.depthStencil=me(Jt),nt.width=Ge.width,nt.height=Ge.height,Ce(Ge),nt}function Ft(lt,Xt){O(ve.next!==Ge,"can not resize a framebuffer which is currently in use");var Bt=Math.max(0|lt,1),Lt=Math.max(0|Xt||Bt,1);if(Bt===Ge.width&&Lt===Ge.height)return nt;for(var Wt=Ge.colorAttachments,An=0;An<Wt.length;++An)ze(Wt[An],Bt,Lt);return ze(Ge.depthAttachment,Bt,Lt),ze(Ge.stencilAttachment,Bt,Lt),ze(Ge.depthStencilAttachment,Bt,Lt),Ge.width=nt.width=Bt,Ge.height=nt.height=Lt,Ce(Ge),nt}return se.framebufferCount++,nt($e,tt),n(nt,{resize:Ft,_reglType:"framebuffer",_framebuffer:Ge,destroy:function(){Ke(Ge),Ie(Ge)},use:function(lt){ve.setFBO({framebuffer:nt},lt)}})}function mt($e){var tt=Array(6);function Ge(Ft){var lt;O(tt.indexOf(ve.next)<0,"can not update framebuffer which is currently in use");var Xt,Bt={color:null},Lt=0,Wt=null,An="rgba",Qn="uint8",zn=1;if(typeof Ft=="number")Lt=0|Ft;else if(Ft){O.type(Ft,"object","invalid arguments for framebuffer");var Ht=Ft;if("shape"in Ht){var In=Ht.shape;O(Array.isArray(In)&&In.length>=2,"invalid shape for framebuffer"),O(In[0]===In[1],"cube framebuffer must be square"),Lt=In[0]}else"radius"in Ht&&(Lt=0|Ht.radius),"width"in Ht?(Lt=0|Ht.width,"height"in Ht&&O(Ht.height===Lt,"must be square")):"height"in Ht&&(Lt=0|Ht.height);("color"in Ht||"colors"in Ht)&&(Wt=Ht.color||Ht.colors,Array.isArray(Wt)&&O(Wt.length===1||U.webgl_draw_buffers,"multiple render targets not supported")),Wt||("colorCount"in Ht&&(zn=0|Ht.colorCount,O(zn>0,"invalid color buffer count")),"colorType"in Ht&&(O.oneOf(Ht.colorType,je,"invalid color type"),Qn=Ht.colorType),"colorFormat"in Ht&&(An=Ht.colorFormat,O.oneOf(Ht.colorFormat,Pe,"invalid color format for texture"))),"depth"in Ht&&(Bt.depth=Ht.depth),"stencil"in Ht&&(Bt.stencil=Ht.stencil),"depthStencil"in Ht&&(Bt.depthStencil=Ht.depthStencil)}else Lt=1;if(Wt)if(Array.isArray(Wt))for(Xt=[],lt=0;lt<Wt.length;++lt)Xt[lt]=Wt[lt];else Xt=[Wt];else{Xt=Array(zn);var Tn={radius:Lt,format:An,type:Qn};for(lt=0;lt<zn;++lt)Xt[lt]=fe.createCube(Tn)}for(Bt.color=Array(Xt.length),lt=0;lt<Xt.length;++lt){var Ln=Xt[lt];O(typeof Ln=="function"&&Ln._reglType==="textureCube","invalid cube map"),Lt=Lt||Ln.width,O(Ln.width===Lt&&Ln.height===Lt,"invalid cube map shape"),Bt.color[lt]={target:vh,data:Xt[lt]}}for(lt=0;lt<6;++lt){for(var Rn=0;Rn<Xt.length;++Rn)Bt.color[Rn].target=vh+lt;lt>0&&(Bt.depth=tt[0].depth,Bt.stencil=tt[0].stencil,Bt.depthStencil=tt[0].depthStencil),tt[lt]?tt[lt](Bt):tt[lt]=He(Bt)}return n(Ge,{width:Lt,height:Lt,color:Xt})}function nt(Ft){var lt,Xt=0|Ft;if(O(Xt>0&&Xt<=K.maxCubeMapSize,"invalid radius for cube fbo"),Xt===Ge.width)return Ge;var Bt=Ge.color;for(lt=0;lt<Bt.length;++lt)Bt[lt].resize(Xt);for(lt=0;lt<6;++lt)tt[lt].resize(Xt);return Ge.width=Ge.height=Xt,Ge}return Ge($e),n(Ge,{faces:tt,resize:nt,_reglType:"framebufferCube",destroy:function(){tt.forEach(function(Ft){Ft.destroy()})}})}function jt(){ve.cur=null,ve.next=null,ve.dirty=!0,Pr(Ae).forEach(function($e){$e.framebuffer=I.createFramebuffer(),Ce($e)})}return n(ve,{getFramebuffer:function($e){if(typeof $e=="function"&&$e._reglType==="framebuffer"){var tt=$e._framebuffer;if(tt instanceof st)return tt}return null},create:He,createCube:mt,clear:function(){Pr(Ae).forEach(Ke)},restore:jt})}Ps[ax]="complete",Ps[cD]="incomplete attachment",Ps[hD]="incomplete dimensions",Ps[lD]="incomplete, missing attachment",Ps[fD]="unsupported";var ED=5126,lx=34962;function Mg(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=ED,this.offset=0,this.stride=0,this.divisor=0}function MD(I,U,K,fe,be){for(var se=K.maxAttributes,ve=new Array(se),Pe=0;Pe<se;++Pe)ve[Pe]=new Mg;var Fe=0,je={},Le={Record:Mg,scope:{},state:ve,currentVAO:null,targetVAO:null,restore:et()?Ae:function(){},createVAO:st,getVAO:Qe,destroyBuffer:Ye,setVAO:et()?oe:me,clear:et()?ze:function(){}};function Ye(Ie){for(var Ke=0;Ke<ve.length;++Ke){var Ce=ve[Ke];Ce.buffer===Ie&&(I.disableVertexAttribArray(Ke),Ce.buffer=null)}}function et(){return U.oes_vertex_array_object}function Ne(){return U.angle_instanced_arrays}function Qe(Ie){return typeof Ie=="function"&&Ie._vao?Ie._vao:null}function oe(Ie){if(Ie!==Le.currentVAO){var Ke=et();Ie?Ke.bindVertexArrayOES(Ie.vao):Ke.bindVertexArrayOES(null),Le.currentVAO=Ie}}function me(Ie){if(Ie!==Le.currentVAO){if(Ie)Ie.bindAttrs();else for(var Ke=Ne(),Ce=0;Ce<ve.length;++Ce){var He=ve[Ce];He.buffer?(I.enableVertexAttribArray(Ce),I.vertexAttribPointer(Ce,He.size,He.type,He.normalized,He.stride,He.offfset),Ke&&He.divisor&&Ke.vertexAttribDivisorANGLE(Ce,He.divisor)):(I.disableVertexAttribArray(Ce),I.vertexAttrib4f(Ce,He.x,He.y,He.z,He.w))}Le.currentVAO=Ie}}function ze(){Pr(je).forEach(function(Ie){Ie.destroy()})}function rt(){this.id=++Fe,this.attributes=[];var Ie=et();this.vao=Ie?Ie.createVertexArrayOES():null,je[this.id]=this,this.buffers=[]}function Ae(){et()&&Pr(je).forEach(function(Ie){Ie.refresh()})}function st(Ie){var Ke=new rt;function Ce(He){O(Array.isArray(He),"arguments to vertex array constructor must be an array"),O(He.length<se,"too many attributes"),O(He.length>0,"must specify at least one attribute");var mt={},jt=Ke.attributes;jt.length=He.length;for(var $e=0;$e<He.length;++$e){var tt,Ge=He[$e],nt=jt[$e]=new Mg,Ft=Ge.data||Ge;Array.isArray(Ft)||e(Ft)||hi(Ft)?(Ke.buffers[$e]&&(tt=Ke.buffers[$e],e(Ft)&&tt._buffer.byteLength>=Ft.byteLength?tt.subdata(Ft):(tt.destroy(),Ke.buffers[$e]=null)),Ke.buffers[$e]||(tt=Ke.buffers[$e]=be.create(Ge,lx,!1,!0)),nt.buffer=be.getBuffer(tt),nt.size=0|nt.buffer.dimension,nt.normalized=!1,nt.type=nt.buffer.dtype,nt.offset=0,nt.stride=0,nt.divisor=0,nt.state=1,mt[$e]=1):be.getBuffer(Ge)?(nt.buffer=be.getBuffer(Ge),nt.size=0|nt.buffer.dimension,nt.normalized=!1,nt.type=nt.buffer.dtype,nt.offset=0,nt.stride=0,nt.divisor=0,nt.state=1):be.getBuffer(Ge.buffer)?(nt.buffer=be.getBuffer(Ge.buffer),nt.size=0|(+Ge.size||nt.buffer.dimension),nt.normalized=!!Ge.normalized||!1,"type"in Ge?(O.parameter(Ge.type,Da,"invalid buffer type"),nt.type=Da[Ge.type]):nt.type=nt.buffer.dtype,nt.offset=0|(Ge.offset||0),nt.stride=0|(Ge.stride||0),nt.divisor=0|(Ge.divisor||0),nt.state=1,O(nt.size>=1&&nt.size<=4,"size must be between 1 and 4"),O(nt.offset>=0,"invalid offset"),O(nt.stride>=0&&nt.stride<=255,"stride must be between 0 and 255"),O(nt.divisor>=0,"divisor must be positive"),O(!nt.divisor||!!U.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Ge?(O($e>0,"first attribute must not be a constant"),nt.x=+Ge.x||0,nt.y=+Ge.y||0,nt.z=+Ge.z||0,nt.w=+Ge.w||0,nt.state=2):O(!1,"invalid attribute spec for location "+$e)}for(var lt=0;lt<Ke.buffers.length;++lt)!mt[lt]&&Ke.buffers[lt]&&(Ke.buffers[lt].destroy(),Ke.buffers[lt]=null);return Ke.refresh(),Ce}return fe.vaoCount+=1,Ce.destroy=function(){for(var He=0;He<Ke.buffers.length;++He)Ke.buffers[He]&&Ke.buffers[He].destroy();Ke.buffers.length=0,Ke.destroy()},Ce._vao=Ke,Ce._reglType="vao",Ce(Ie)}return rt.prototype.bindAttrs=function(){for(var Ie=Ne(),Ke=this.attributes,Ce=0;Ce<Ke.length;++Ce){var He=Ke[Ce];He.buffer?(I.enableVertexAttribArray(Ce),I.bindBuffer(lx,He.buffer.buffer),I.vertexAttribPointer(Ce,He.size,He.type,He.normalized,He.stride,He.offset),Ie&&He.divisor&&Ie.vertexAttribDivisorANGLE(Ce,He.divisor)):(I.disableVertexAttribArray(Ce),I.vertexAttrib4f(Ce,He.x,He.y,He.z,He.w))}for(var mt=Ke.length;mt<se;++mt)I.disableVertexAttribArray(mt)},rt.prototype.refresh=function(){var Ie=et();Ie&&(Ie.bindVertexArrayOES(this.vao),this.bindAttrs(),Le.currentVAO=this)},rt.prototype.destroy=function(){if(this.vao){var Ie=et();this===Le.currentVAO&&(Le.currentVAO=null,Ie.bindVertexArrayOES(null)),Ie.deleteVertexArrayOES(this.vao),this.vao=null}je[this.id]&&(delete je[this.id],fe.vaoCount-=1)},Le}var hx=35632,SD=35633,_D=35718,kD=35721;function CD(I,U,K,fe){var be={},se={};function ve(oe,me,ze,rt){this.name=oe,this.id=me,this.location=ze,this.info=rt}function Pe(oe,me){for(var ze=0;ze<oe.length;++ze)if(oe[ze].id===me.id)return void(oe[ze].location=me.location);oe.push(me)}function Fe(oe,me,ze){var rt=oe===hx?be:se,Ae=rt[me];if(!Ae){var st=U.str(me);Ae=I.createShader(oe),I.shaderSource(Ae,st),I.compileShader(Ae),O.shaderError(I,Ae,st,oe,ze),rt[me]=Ae}return Ae}var je={},Le=[],Ye=0;function et(oe,me){this.id=Ye++,this.fragId=oe,this.vertId=me,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,fe.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Ne(oe,me,ze){var rt,Ae,st=Fe(hx,oe.fragId),Ie=Fe(SD,oe.vertId),Ke=oe.program=I.createProgram();if(I.attachShader(Ke,st),I.attachShader(Ke,Ie),ze)for(rt=0;rt<ze.length;++rt){var Ce=ze[rt];I.bindAttribLocation(Ke,Ce[0],Ce[1])}I.linkProgram(Ke),O.linkError(I,Ke,U.str(oe.fragId),U.str(oe.vertId),me);var He=I.getProgramParameter(Ke,_D);fe.profile&&(oe.stats.uniformsCount=He);var mt=oe.uniforms;for(rt=0;rt<He;++rt)if(Ae=I.getActiveUniform(Ke,rt))if(Ae.size>1)for(var jt=0;jt<Ae.size;++jt){var $e=Ae.name.replace("[0]","["+jt+"]");Pe(mt,new ve($e,U.id($e),I.getUniformLocation(Ke,$e),Ae))}else Pe(mt,new ve(Ae.name,U.id(Ae.name),I.getUniformLocation(Ke,Ae.name),Ae));var tt=I.getProgramParameter(Ke,kD);fe.profile&&(oe.stats.attributesCount=tt);var Ge=oe.attributes;for(rt=0;rt<tt;++rt)(Ae=I.getActiveAttrib(Ke,rt))&&Pe(Ge,new ve(Ae.name,U.id(Ae.name),I.getAttribLocation(Ke,Ae.name),Ae))}function Qe(){be={},se={};for(var oe=0;oe<Le.length;++oe)Ne(Le[oe],null,Le[oe].attributes.map(function(me){return[me.location,me.name]}))}return fe.profile&&(K.getMaxUniformsCount=function(){var oe=0;return Le.forEach(function(me){me.stats.uniformsCount>oe&&(oe=me.stats.uniformsCount)}),oe},K.getMaxAttributesCount=function(){var oe=0;return Le.forEach(function(me){me.stats.attributesCount>oe&&(oe=me.stats.attributesCount)}),oe}),{clear:function(){var oe=I.deleteShader.bind(I);Pr(be).forEach(oe),be={},Pr(se).forEach(oe),se={},Le.forEach(function(me){I.deleteProgram(me.program)}),Le.length=0,je={},K.shaderCount=0},program:function(oe,me,ze,rt){O.command(oe>=0,"missing vertex shader",ze),O.command(me>=0,"missing fragment shader",ze);var Ae=je[me];Ae||(Ae=je[me]={});var st=Ae[oe];if(st&&(st.refCount++,!rt))return st;var Ie=new et(me,oe);return K.shaderCount++,Ne(Ie,ze,rt),st||(Ae[oe]=Ie),Le.push(Ie),n(Ie,{destroy:function(){if(Ie.refCount--,Ie.refCount<=0){I.deleteProgram(Ie.program);var Ke=Le.indexOf(Ie);Le.splice(Ke,1),K.shaderCount--}Ae[Ie.vertId].refCount<=0&&(I.deleteShader(se[Ie.vertId]),delete se[Ie.vertId],delete je[Ie.fragId][Ie.vertId]),Object.keys(je[Ie.fragId]).length||(I.deleteShader(be[Ie.fragId]),delete be[Ie.fragId],delete je[Ie.fragId])}})},restore:Qe,shader:Fe,frag:-1,vert:-1}}var AD=6408,Qu=5121,ID=3333,yh=5126;function TD(I,U,K,fe,be,se,ve){function Pe(Le){var Ye;U.next===null?(O(be.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Ye=Qu):(O(U.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Ye=U.next.colorAttachments[0].texture._texture.type,se.oes_texture_float?(O(Ye===Qu||Ye===yh,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Ye===yh&&O(ve.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):O(Ye===Qu,"Reading from a framebuffer is only allowed for the type 'uint8'"));var et=0,Ne=0,Qe=fe.framebufferWidth,oe=fe.framebufferHeight,me=null;e(Le)?me=Le:Le&&(O.type(Le,"object","invalid arguments to regl.read()"),et=0|Le.x,Ne=0|Le.y,O(et>=0&&et<fe.framebufferWidth,"invalid x offset for regl.read"),O(Ne>=0&&Ne<fe.framebufferHeight,"invalid y offset for regl.read"),Qe=0|(Le.width||fe.framebufferWidth-et),oe=0|(Le.height||fe.framebufferHeight-Ne),me=Le.data||null),me&&(Ye===Qu?O(me instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Ye===yh&&O(me instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),O(Qe>0&&Qe+et<=fe.framebufferWidth,"invalid width for read pixels"),O(oe>0&&oe+Ne<=fe.framebufferHeight,"invalid height for read pixels"),K();var ze=Qe*oe*4;return me||(Ye===Qu?me=new Uint8Array(ze):Ye===yh&&(me=me||new Float32Array(ze))),O.isTypedArray(me,"data buffer for regl.read() must be a typedarray"),O(me.byteLength>=ze,"data buffer for regl.read() too small"),I.pixelStorei(ID,4),I.readPixels(et,Ne,Qe,oe,AD,Ye,me),me}function Fe(Le){var Ye;return U.setFBO({framebuffer:Le.framebuffer},function(){Ye=Pe(Le)}),Ye}function je(Le){return Le&&"framebuffer"in Le?Fe(Le):Pe(Le)}return je}function Ls(I){return Array.prototype.slice.call(I)}function Rs(I){return Ls(I).join("")}function OD(){var I=0,U=[],K=[];function fe(Ye){for(var et=0;et<K.length;++et)if(K[et]===Ye)return U[et];var Ne="g"+I++;return U.push(Ne),K.push(Ye),Ne}function be(){var Ye=[];function et(){Ye.push.apply(Ye,Ls(arguments))}var Ne=[];function Qe(){var oe="v"+I++;return Ne.push(oe),arguments.length>0&&(Ye.push(oe,"="),Ye.push.apply(Ye,Ls(arguments)),Ye.push(";")),oe}return n(et,{def:Qe,toString:function(){return Rs([Ne.length>0?"var "+Ne.join(",")+";":"",Rs(Ye)])}})}function se(){var Ye=be(),et=be(),Ne=Ye.toString,Qe=et.toString;function oe(me,ze){et(me,ze,"=",Ye.def(me,ze),";")}return n(function(){Ye.apply(Ye,Ls(arguments))},{def:Ye.def,entry:Ye,exit:et,save:oe,set:function(me,ze,rt){oe(me,ze),Ye(me,ze,"=",rt,";")},toString:function(){return Ne()+Qe()}})}function ve(){var Ye=Rs(arguments),et=se(),Ne=se(),Qe=et.toString,oe=Ne.toString;return n(et,{then:function(){return et.apply(et,Ls(arguments)),this},else:function(){return Ne.apply(Ne,Ls(arguments)),this},toString:function(){var me=oe();return me&&(me="else{"+me+"}"),Rs(["if(",Ye,"){",Qe(),"}",me])}})}var Pe=be(),Fe={};function je(Ye,et){var Ne=[];function Qe(){var rt="a"+Ne.length;return Ne.push(rt),rt}et=et||0;for(var oe=0;oe<et;++oe)Qe();var me=se(),ze=me.toString;return Fe[Ye]=n(me,{arg:Qe,toString:function(){return Rs(["function(",Ne.join(),"){",ze(),"}"])}})}function Le(){var Ye=['"use strict";',Pe,"return {"];Object.keys(Fe).forEach(function(Ne){Ye.push('"',Ne,'":',Fe[Ne].toString(),",")}),Ye.push("}");var et=Rs(Ye).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`);return Function.apply(null,U.concat(et)).apply(null,K)}return{global:Pe,link:fe,block:be,proc:je,scope:se,cond:ve,compile:Le}}var js="xyzw".split(""),fx=5121,Bs=1,Sg=2,_g=0,kg=1,Cg=2,Ag=3,bh=4,dx=5,px=6,gx="dither",vx="blend.enable",mx="blend.color",Ig="blend.equation",Tg="blend.func",yx="depth.enable",bx="depth.func",xx="depth.range",wx="depth.mask",Og="colorMask",Ex="cull.enable",Mx="cull.face",Ng="frontFace",Dg="lineWidth",Sx="polygonOffset.enable",Pg="polygonOffset.offset",_x="sample.alpha",kx="sample.enable",Lg="sample.coverage",Cx="stencil.enable",Ax="stencil.mask",Rg="stencil.func",jg="stencil.opFront",Ju="stencil.opBack",Ix="scissor.enable",xh="scissor.box",ho="viewport",ec="profile",Ba="framebuffer",tc="vert",nc="frag",za="elements",Fa="primitive",Ga="count",wh="offset",Eh="instances",rc="vao",Bg="Width",zg="Height",zs=Ba+Bg,Fs=Ba+zg,ND=ho+Bg,DD=ho+zg,Tx="drawingBuffer",Ox=Tx+Bg,Nx=Tx+zg,PD=[Tg,Ig,Rg,jg,Ju,Lg,ho,xh,Pg],Gs=34962,LD=34963,Dx=3553,RD=34067,jD=2884,BD=3042,zD=3024,FD=2960,GD=2929,UD=3089,XD=32823,YD=32926,WD=32928,Fg=5126,Mh=35664,Sh=35665,_h=35666,Gg=5124,kh=35667,Ch=35668,Ah=35669,Ug=35670,Ih=35671,Th=35672,Oh=35673,ic=35674,oc=35675,ac=35676,sc=35678,uc=35680,Px=4,cc=1028,Ua=1029,Lx=2304,Xg=2305,VD=32775,HD=32776,qD=519,Wo=7680,Rx=0,jx=1,Bx=32774,ZD=513,zx=36160,KD=36064,Li={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Fx=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Us={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Vo={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Gx={frag:35632,vert:35633},Yg={cw:Lx,ccw:Xg};function Nh(I){return Array.isArray(I)||e(I)||hi(I)}function Ux(I){return I.sort(function(U,K){return U===ho?-1:K===ho?1:U<K?-1:1})}function br(I,U,K,fe){this.thisDep=I,this.contextDep=U,this.propDep=K,this.append=fe}function Ho(I){return I&&!(I.thisDep||I.contextDep||I.propDep)}function Cn(I){return new br(!1,!1,!1,I)}function Sr(I,U){var K=I.type;if(K===_g){var fe=I.data.length;return new br(!0,fe>=1,fe>=2,U)}if(K===bh){var be=I.data;return new br(be.thisDep,be.contextDep,be.propDep,U)}if(K===dx)return new br(!1,!1,!1,U);if(K===px){for(var se=!1,ve=!1,Pe=!1,Fe=0;Fe<I.data.length;++Fe){var je=I.data[Fe];if(je.type===kg)Pe=!0;else if(je.type===Cg)ve=!0;else if(je.type===Ag)se=!0;else if(je.type===_g){se=!0;var Le=je.data;Le>=1&&(ve=!0),Le>=2&&(Pe=!0)}else je.type===bh&&(se=se||je.data.thisDep,ve=ve||je.data.contextDep,Pe=Pe||je.data.propDep)}return new br(se,ve,Pe,U)}return new br(K===Ag,K===Cg,K===kg,U)}var Xx=new br(!1,!1,!1,function(){});function $D(I,U,K,fe,be,se,ve,Pe,Fe,je,Le,Ye,et,Ne,Qe){var oe=je.Record,me={add:32774,subtract:32778,"reverse subtract":32779};K.ext_blend_minmax&&(me.min=VD,me.max=HD);var ze=K.angle_instanced_arrays,rt=K.webgl_draw_buffers,Ae={dirty:!0,profile:Qe.profile},st={},Ie=[],Ke={},Ce={};function He(X){return X.replace(".","_")}function mt(X,z,Q){var re=He(X);Ie.push(X),st[re]=Ae[re]=!!Q,Ke[re]=z}function jt(X,z,Q){var re=He(X);Ie.push(X),Array.isArray(Q)?(Ae[re]=Q.slice(),st[re]=Q.slice()):Ae[re]=st[re]=Q,Ce[re]=z}mt(gx,zD),mt(vx,BD),jt(mx,"blendColor",[0,0,0,0]),jt(Ig,"blendEquationSeparate",[Bx,Bx]),jt(Tg,"blendFuncSeparate",[jx,Rx,jx,Rx]),mt(yx,GD,!0),jt(bx,"depthFunc",ZD),jt(xx,"depthRange",[0,1]),jt(wx,"depthMask",!0),jt(Og,Og,[!0,!0,!0,!0]),mt(Ex,jD),jt(Mx,"cullFace",Ua),jt(Ng,Ng,Xg),jt(Dg,Dg,1),mt(Sx,XD),jt(Pg,"polygonOffset",[0,0]),mt(_x,YD),mt(kx,WD),jt(Lg,"sampleCoverage",[1,!1]),mt(Cx,FD),jt(Ax,"stencilMask",-1),jt(Rg,"stencilFunc",[qD,0,-1]),jt(jg,"stencilOpSeparate",[cc,Wo,Wo,Wo]),jt(Ju,"stencilOpSeparate",[Ua,Wo,Wo,Wo]),mt(Ix,UD),jt(xh,"scissor",[0,0,I.drawingBufferWidth,I.drawingBufferHeight]),jt(ho,ho,[0,0,I.drawingBufferWidth,I.drawingBufferHeight]);var $e={gl:I,context:et,strings:U,next:st,current:Ae,draw:Ye,elements:se,buffer:be,shader:Le,attributes:je.state,vao:je,uniforms:Fe,framebuffer:Pe,extensions:K,timer:Ne,isBufferArgs:Nh},tt={primTypes:Cs,compareFuncs:Us,blendFuncs:Li,blendEquations:me,stencilOps:Vo,glTypes:Da,orientationType:Yg};O.optional(function(){$e.isArrayLike=Bn}),rt&&(tt.backBuffer=[Ua],tt.drawBuffer=zt(fe.maxDrawbuffers,function(X){return X===0?[0]:zt(X,function(z){return KD+z})}));var Ge=0;function nt(){var X=OD(),z=X.link,Q=X.global;X.id=Ge++,X.batchId="0";var re=z($e),ue=X.shared={props:"a0"};Object.keys($e).forEach(function(V){ue[V]=Q.def(re,".",V)}),O.optional(function(){X.CHECK=z(O),X.commandStr=O.guessCommand(),X.command=z(X.commandStr),X.assert=function(V,Y,ce){V("if(!(",Y,"))",this.CHECK,".commandRaise(",z(ce),",",this.command,");")},tt.invalidBlendCombinations=Fx});var $=X.next={},ee=X.current={};Object.keys(Ce).forEach(function(V){Array.isArray(Ae[V])&&($[V]=Q.def(ue.next,".",V),ee[V]=Q.def(ue.current,".",V))});var ae=X.constants={};Object.keys(tt).forEach(function(V){ae[V]=Q.def(JSON.stringify(tt[V]))}),X.invoke=function(V,Y){switch(Y.type){case _g:var ce=["this",ue.context,ue.props,X.batchId];return V.def(z(Y.data),".call(",ce.slice(0,Math.max(Y.data.length+1,4)),")");case kg:return V.def(ue.props,Y.data);case Cg:return V.def(ue.context,Y.data);case Ag:return V.def("this",Y.data);case bh:return Y.data.append(X,V),Y.data.ref;case dx:return Y.data.toString();case px:return Y.data.map(function(ie){return X.invoke(V,ie)})}},X.attribCache={};var G={};return X.scopeAttrib=function(V){var Y=U.id(V);if(Y in G)return G[Y];var ce=je.scope[Y];return ce||(ce=je.scope[Y]=new oe),G[Y]=z(ce)},X}function Ft(X){var z,Q=X.static,re=X.dynamic;if(ec in Q){var ue=!!Q[ec];(z=Cn(function(ee,ae){return ue})).enable=ue}else if(ec in re){var $=re[ec];z=Sr($,function(ee,ae){return ee.invoke(ae,$)})}return z}function lt(X,z){var Q=X.static,re=X.dynamic;if(Ba in Q){var ue=Q[Ba];return ue?(ue=Pe.getFramebuffer(ue),O.command(ue,"invalid framebuffer object"),Cn(function(ee,ae){var G=ee.link(ue),V=ee.shared;ae.set(V.framebuffer,".next",G);var Y=V.context;return ae.set(Y,"."+zs,G+".width"),ae.set(Y,"."+Fs,G+".height"),G})):Cn(function(ee,ae){var G=ee.shared;ae.set(G.framebuffer,".next","null");var V=G.context;return ae.set(V,"."+zs,V+"."+Ox),ae.set(V,"."+Fs,V+"."+Nx),"null"})}if(Ba in re){var $=re[Ba];return Sr($,function(ee,ae){var G=ee.invoke(ae,$),V=ee.shared,Y=V.framebuffer,ce=ae.def(Y,".getFramebuffer(",G,")");O.optional(function(){ee.assert(ae,"!"+G+"||"+ce,"invalid framebuffer object")}),ae.set(Y,".next",ce);var ie=V.context;return ae.set(ie,"."+zs,ce+"?"+ce+".width:"+ie+"."+Ox),ae.set(ie,"."+Fs,ce+"?"+ce+".height:"+ie+"."+Nx),ce})}return null}function Xt(X,z,Q){var re=X.static,ue=X.dynamic;function $(G){if(G in re){var V=re[G];O.commandType(V,"object","invalid "+G,Q.commandStr);var Y,ce,ie=!0,ge=0|V.x,Ee=0|V.y;return"width"in V?(Y=0|V.width,O.command(Y>=0,"invalid "+G,Q.commandStr)):ie=!1,"height"in V?(ce=0|V.height,O.command(ce>=0,"invalid "+G,Q.commandStr)):ie=!1,new br(!ie&&z&&z.thisDep,!ie&&z&&z.contextDep,!ie&&z&&z.propDep,function(gt,Ot){var ct=gt.shared.context,Pt=Y;"width"in V||(Pt=Ot.def(ct,".",zs,"-",ge));var Ut=ce;return"height"in V||(Ut=Ot.def(ct,".",Fs,"-",Ee)),[ge,Ee,Pt,Ut]})}if(G in ue){var ke=ue[G],ht=Sr(ke,function(gt,Ot){var ct=gt.invoke(Ot,ke);O.optional(function(){gt.assert(Ot,ct+"&&typeof "+ct+'==="object"',"invalid "+G)});var Pt=gt.shared.context,Ut=Ot.def(ct,".x|0"),rn=Ot.def(ct,".y|0"),cn=Ot.def('"width" in ',ct,"?",ct,".width|0:","(",Pt,".",zs,"-",Ut,")"),Xs=Ot.def('"height" in ',ct,"?",ct,".height|0:","(",Pt,".",Fs,"-",rn,")");return O.optional(function(){gt.assert(Ot,cn+">=0&&"+Xs+">=0","invalid "+G)}),[Ut,rn,cn,Xs]});return z&&(ht.thisDep=ht.thisDep||z.thisDep,ht.contextDep=ht.contextDep||z.contextDep,ht.propDep=ht.propDep||z.propDep),ht}return z?new br(z.thisDep,z.contextDep,z.propDep,function(gt,Ot){var ct=gt.shared.context;return[0,0,Ot.def(ct,".",zs),Ot.def(ct,".",Fs)]}):null}var ee=$(ho);if(ee){var ae=ee;ee=new br(ee.thisDep,ee.contextDep,ee.propDep,function(G,V){var Y=ae.append(G,V),ce=G.shared.context;return V.set(ce,"."+ND,Y[2]),V.set(ce,"."+DD,Y[3]),Y})}return{viewport:ee,scissor_box:$(xh)}}function Bt(X,z){var Q=X.static;if(typeof Q[nc]=="string"&&typeof Q[tc]=="string"){if(Object.keys(z.dynamic).length>0)return null;var re=z.static,ue=Object.keys(re);if(ue.length>0&&typeof re[ue[0]]=="number"){for(var $=[],ee=0;ee<ue.length;++ee)O(typeof re[ue[ee]]=="number","must specify all vertex attribute locations when using vaos"),$.push([0|re[ue[ee]],ue[ee]]);return $}}return null}function Lt(X,z,Q){var re=X.static,ue=X.dynamic;function $(Y){if(Y in re){var ce=U.id(re[Y]);O.optional(function(){Le.shader(Gx[Y],ce,O.guessCommand())});var ie=Cn(function(){return ce});return ie.id=ce,ie}if(Y in ue){var ge=ue[Y];return Sr(ge,function(Ee,ke){var ht=Ee.invoke(ke,ge),gt=ke.def(Ee.shared.strings,".id(",ht,")");return O.optional(function(){ke(Ee.shared.shader,".shader(",Gx[Y],",",gt,",",Ee.command,");")}),gt})}return null}var ee,ae=$(nc),G=$(tc),V=null;return Ho(ae)&&Ho(G)?(V=Le.program(G.id,ae.id,null,Q),ee=Cn(function(Y,ce){return Y.link(V)})):ee=new br(ae&&ae.thisDep||G&&G.thisDep,ae&&ae.contextDep||G&&G.contextDep,ae&&ae.propDep||G&&G.propDep,function(Y,ce){var ie,ge=Y.shared.shader;ie=ae?ae.append(Y,ce):ce.def(ge,".",nc);var Ee=ge+".program("+(G?G.append(Y,ce):ce.def(ge,".",tc))+","+ie;return O.optional(function(){Ee+=","+Y.command}),ce.def(Ee+")")}),{frag:ae,vert:G,progVar:ee,program:V}}function Wt(X,z){var Q=X.static,re=X.dynamic;function ue(){if(za in Q){var Y=Q[za];Nh(Y)?Y=se.getElements(se.create(Y,!0)):Y&&(Y=se.getElements(Y),O.command(Y,"invalid elements",z.commandStr));var ce=Cn(function(ge,Ee){if(Y){var ke=ge.link(Y);return ge.ELEMENTS=ke,ke}return ge.ELEMENTS=null,null});return ce.value=Y,ce}if(za in re){var ie=re[za];return Sr(ie,function(ge,Ee){var ke=ge.shared,ht=ke.isBufferArgs,gt=ke.elements,Ot=ge.invoke(Ee,ie),ct=Ee.def("null"),Pt=Ee.def(ht,"(",Ot,")"),Ut=ge.cond(Pt).then(ct,"=",gt,".createStream(",Ot,");").else(ct,"=",gt,".getElements(",Ot,");");return O.optional(function(){ge.assert(Ut.else,"!"+Ot+"||"+ct,"invalid elements")}),Ee.entry(Ut),Ee.exit(ge.cond(Pt).then(gt,".destroyStream(",ct,");")),ge.ELEMENTS=ct,ct})}return null}var $=ue();function ee(){if(Fa in Q){var Y=Q[Fa];return O.commandParameter(Y,Cs,"invalid primitve",z.commandStr),Cn(function(ie,ge){return Cs[Y]})}if(Fa in re){var ce=re[Fa];return Sr(ce,function(ie,ge){var Ee=ie.constants.primTypes,ke=ie.invoke(ge,ce);return O.optional(function(){ie.assert(ge,ke+" in "+Ee,"invalid primitive, must be one of "+Object.keys(Cs))}),ge.def(Ee,"[",ke,"]")})}return $?Ho($)?$.value?Cn(function(ie,ge){return ge.def(ie.ELEMENTS,".primType")}):Cn(function(){return Px}):new br($.thisDep,$.contextDep,$.propDep,function(ie,ge){var Ee=ie.ELEMENTS;return ge.def(Ee,"?",Ee,".primType:",Px)}):null}function ae(Y,ce){if(Y in Q){var ie=0|Q[Y];return O.command(!ce||ie>=0,"invalid "+Y,z.commandStr),Cn(function(Ee,ke){return ce&&(Ee.OFFSET=ie),ie})}if(Y in re){var ge=re[Y];return Sr(ge,function(Ee,ke){var ht=Ee.invoke(ke,ge);return ce&&(Ee.OFFSET=ht,O.optional(function(){Ee.assert(ke,ht+">=0","invalid "+Y)})),ht})}return ce&&$?Cn(function(Ee,ke){return Ee.OFFSET="0",0}):null}var G=ae(wh,!0);function V(){if(Ga in Q){var Y=0|Q[Ga];return O.command(typeof Y=="number"&&Y>=0,"invalid vertex count",z.commandStr),Cn(function(){return Y})}if(Ga in re){var ce=re[Ga];return Sr(ce,function(Ee,ke){var ht=Ee.invoke(ke,ce);return O.optional(function(){Ee.assert(ke,"typeof "+ht+'==="number"&&'+ht+">=0&&"+ht+"===("+ht+"|0)","invalid vertex count")}),ht})}if($){if(Ho($)){if($)return G?new br(G.thisDep,G.contextDep,G.propDep,function(Ee,ke){var ht=ke.def(Ee.ELEMENTS,".vertCount-",Ee.OFFSET);return O.optional(function(){Ee.assert(ke,ht+">=0","invalid vertex offset/element buffer too small")}),ht}):Cn(function(Ee,ke){return ke.def(Ee.ELEMENTS,".vertCount")});var ie=Cn(function(){return-1});return O.optional(function(){ie.MISSING=!0}),ie}var ge=new br($.thisDep||G.thisDep,$.contextDep||G.contextDep,$.propDep||G.propDep,function(Ee,ke){var ht=Ee.ELEMENTS;return Ee.OFFSET?ke.def(ht,"?",ht,".vertCount-",Ee.OFFSET,":-1"):ke.def(ht,"?",ht,".vertCount:-1")});return O.optional(function(){ge.DYNAMIC=!0}),ge}return null}return{elements:$,primitive:ee(),count:V(),instances:ae(Eh,!1),offset:G}}function An(X,z){var Q=X.static,re=X.dynamic,ue={};return Ie.forEach(function($){var ee=He($);function ae(G,V){if($ in Q){var Y=G(Q[$]);ue[ee]=Cn(function(){return Y})}else if($ in re){var ce=re[$];ue[ee]=Sr(ce,function(ie,ge){return V(ie,ge,ie.invoke(ge,ce))})}}switch($){case Ex:case vx:case gx:case Cx:case yx:case Ix:case Sx:case _x:case kx:case wx:return ae(function(G){return O.commandType(G,"boolean",$,z.commandStr),G},function(G,V,Y){return O.optional(function(){G.assert(V,"typeof "+Y+'==="boolean"',"invalid flag "+$,G.commandStr)}),Y});case bx:return ae(function(G){return O.commandParameter(G,Us,"invalid "+$,z.commandStr),Us[G]},function(G,V,Y){var ce=G.constants.compareFuncs;return O.optional(function(){G.assert(V,Y+" in "+ce,"invalid "+$+", must be one of "+Object.keys(Us))}),V.def(ce,"[",Y,"]")});case xx:return ae(function(G){return O.command(Bn(G)&&G.length===2&&typeof G[0]=="number"&&typeof G[1]=="number"&&G[0]<=G[1],"depth range is 2d array",z.commandStr),G},function(G,V,Y){return O.optional(function(){G.assert(V,G.shared.isArrayLike+"("+Y+")&&"+Y+".length===2&&typeof "+Y+'[0]==="number"&&typeof '+Y+'[1]==="number"&&'+Y+"[0]<="+Y+"[1]","depth range must be a 2d array")}),[V.def("+",Y,"[0]"),V.def("+",Y,"[1]")]});case Tg:return ae(function(G){O.commandType(G,"object","blend.func",z.commandStr);var V="srcRGB"in G?G.srcRGB:G.src,Y="srcAlpha"in G?G.srcAlpha:G.src,ce="dstRGB"in G?G.dstRGB:G.dst,ie="dstAlpha"in G?G.dstAlpha:G.dst;return O.commandParameter(V,Li,ee+".srcRGB",z.commandStr),O.commandParameter(Y,Li,ee+".srcAlpha",z.commandStr),O.commandParameter(ce,Li,ee+".dstRGB",z.commandStr),O.commandParameter(ie,Li,ee+".dstAlpha",z.commandStr),O.command(Fx.indexOf(V+", "+ce)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+V+", "+ce+")",z.commandStr),[Li[V],Li[ce],Li[Y],Li[ie]]},function(G,V,Y){var ce=G.constants.blendFuncs;function ie(gt,Ot){var ct=V.def('"',gt,Ot,'" in ',Y,"?",Y,".",gt,Ot,":",Y,".",gt);return O.optional(function(){G.assert(V,ct+" in "+ce,"invalid "+$+"."+gt+Ot+", must be one of "+Object.keys(Li))}),ct}O.optional(function(){G.assert(V,Y+"&&typeof "+Y+'==="object"',"invalid blend func, must be an object")});var ge=ie("src","RGB"),Ee=ie("dst","RGB");O.optional(function(){var gt=G.constants.invalidBlendCombinations;G.assert(V,gt+".indexOf("+ge+'+", "+'+Ee+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var ke=V.def(ce,"[",ge,"]"),ht=V.def(ce,"[",ie("src","Alpha"),"]");return[ke,V.def(ce,"[",Ee,"]"),ht,V.def(ce,"[",ie("dst","Alpha"),"]")]});case Ig:return ae(function(G){return typeof G=="string"?(O.commandParameter(G,me,"invalid "+$,z.commandStr),[me[G],me[G]]):typeof G=="object"?(O.commandParameter(G.rgb,me,$+".rgb",z.commandStr),O.commandParameter(G.alpha,me,$+".alpha",z.commandStr),[me[G.rgb],me[G.alpha]]):void O.commandRaise("invalid blend.equation",z.commandStr)},function(G,V,Y){var ce=G.constants.blendEquations,ie=V.def(),ge=V.def(),Ee=G.cond("typeof ",Y,'==="string"');return O.optional(function(){function ke(ht,gt,Ot){G.assert(ht,Ot+" in "+ce,"invalid "+gt+", must be one of "+Object.keys(me))}ke(Ee.then,$,Y),G.assert(Ee.else,Y+"&&typeof "+Y+'==="object"',"invalid "+$),ke(Ee.else,$+".rgb",Y+".rgb"),ke(Ee.else,$+".alpha",Y+".alpha")}),Ee.then(ie,"=",ge,"=",ce,"[",Y,"];"),Ee.else(ie,"=",ce,"[",Y,".rgb];",ge,"=",ce,"[",Y,".alpha];"),V(Ee),[ie,ge]});case mx:return ae(function(G){return O.command(Bn(G)&&G.length===4,"blend.color must be a 4d array",z.commandStr),zt(4,function(V){return+G[V]})},function(G,V,Y){return O.optional(function(){G.assert(V,G.shared.isArrayLike+"("+Y+")&&"+Y+".length===4","blend.color must be a 4d array")}),zt(4,function(ce){return V.def("+",Y,"[",ce,"]")})});case Ax:return ae(function(G){return O.commandType(G,"number",ee,z.commandStr),0|G},function(G,V,Y){return O.optional(function(){G.assert(V,"typeof "+Y+'==="number"',"invalid stencil.mask")}),V.def(Y,"|0")});case Rg:return ae(function(G){O.commandType(G,"object",ee,z.commandStr);var V=G.cmp||"keep",Y=G.ref||0,ce="mask"in G?G.mask:-1;return O.commandParameter(V,Us,$+".cmp",z.commandStr),O.commandType(Y,"number",$+".ref",z.commandStr),O.commandType(ce,"number",$+".mask",z.commandStr),[Us[V],Y,ce]},function(G,V,Y){var ce=G.constants.compareFuncs;return O.optional(function(){function ie(){G.assert(V,Array.prototype.join.call(arguments,""),"invalid stencil.func")}ie(Y+"&&typeof ",Y,'==="object"'),ie('!("cmp" in ',Y,")||(",Y,".cmp in ",ce,")")}),[V.def('"cmp" in ',Y,"?",ce,"[",Y,".cmp]",":",Wo),V.def(Y,".ref|0"),V.def('"mask" in ',Y,"?",Y,".mask|0:-1")]});case jg:case Ju:return ae(function(G){O.commandType(G,"object",ee,z.commandStr);var V=G.fail||"keep",Y=G.zfail||"keep",ce=G.zpass||"keep";return O.commandParameter(V,Vo,$+".fail",z.commandStr),O.commandParameter(Y,Vo,$+".zfail",z.commandStr),O.commandParameter(ce,Vo,$+".zpass",z.commandStr),[$===Ju?Ua:cc,Vo[V],Vo[Y],Vo[ce]]},function(G,V,Y){var ce=G.constants.stencilOps;function ie(ge){return O.optional(function(){G.assert(V,'!("'+ge+'" in '+Y+")||("+Y+"."+ge+" in "+ce+")","invalid "+$+"."+ge+", must be one of "+Object.keys(Vo))}),V.def('"',ge,'" in ',Y,"?",ce,"[",Y,".",ge,"]:",Wo)}return O.optional(function(){G.assert(V,Y+"&&typeof "+Y+'==="object"',"invalid "+$)}),[$===Ju?Ua:cc,ie("fail"),ie("zfail"),ie("zpass")]});case Pg:return ae(function(G){O.commandType(G,"object",ee,z.commandStr);var V=0|G.factor,Y=0|G.units;return O.commandType(V,"number",ee+".factor",z.commandStr),O.commandType(Y,"number",ee+".units",z.commandStr),[V,Y]},function(G,V,Y){return O.optional(function(){G.assert(V,Y+"&&typeof "+Y+'==="object"',"invalid "+$)}),[V.def(Y,".factor|0"),V.def(Y,".units|0")]});case Mx:return ae(function(G){var V=0;return G==="front"?V=cc:G==="back"&&(V=Ua),O.command(!!V,ee,z.commandStr),V},function(G,V,Y){return O.optional(function(){G.assert(V,Y+'==="front"||'+Y+'==="back"',"invalid cull.face")}),V.def(Y,'==="front"?',cc,":",Ua)});case Dg:return ae(function(G){return O.command(typeof G=="number"&&G>=fe.lineWidthDims[0]&&G<=fe.lineWidthDims[1],"invalid line width, must be a positive number between "+fe.lineWidthDims[0]+" and "+fe.lineWidthDims[1],z.commandStr),G},function(G,V,Y){return O.optional(function(){G.assert(V,"typeof "+Y+'==="number"&&'+Y+">="+fe.lineWidthDims[0]+"&&"+Y+"<="+fe.lineWidthDims[1],"invalid line width")}),Y});case Ng:return ae(function(G){return O.commandParameter(G,Yg,ee,z.commandStr),Yg[G]},function(G,V,Y){return O.optional(function(){G.assert(V,Y+'==="cw"||'+Y+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),V.def(Y+'==="cw"?'+Lx+":"+Xg)});case Og:return ae(function(G){return O.command(Bn(G)&&G.length===4,"color.mask must be length 4 array",z.commandStr),G.map(function(V){return!!V})},function(G,V,Y){return O.optional(function(){G.assert(V,G.shared.isArrayLike+"("+Y+")&&"+Y+".length===4","invalid color.mask")}),zt(4,function(ce){return"!!"+Y+"["+ce+"]"})});case Lg:return ae(function(G){O.command(typeof G=="object"&&G,ee,z.commandStr);var V="value"in G?G.value:1,Y=!!G.invert;return O.command(typeof V=="number"&&V>=0&&V<=1,"sample.coverage.value must be a number between 0 and 1",z.commandStr),[V,Y]},function(G,V,Y){return O.optional(function(){G.assert(V,Y+"&&typeof "+Y+'==="object"',"invalid sample.coverage")}),[V.def('"value" in ',Y,"?+",Y,".value:1"),V.def("!!",Y,".invert")]})}}),ue}function Qn(X,z){var Q=X.static,re=X.dynamic,ue={};return Object.keys(Q).forEach(function($){var ee,ae=Q[$];if(typeof ae=="number"||typeof ae=="boolean")ee=Cn(function(){return ae});else if(typeof ae=="function"){var G=ae._reglType;G==="texture2d"||G==="textureCube"?ee=Cn(function(V){return V.link(ae)}):G==="framebuffer"||G==="framebufferCube"?(O.command(ae.color.length>0,'missing color attachment for framebuffer sent to uniform "'+$+'"',z.commandStr),ee=Cn(function(V){return V.link(ae.color[0])})):O.commandRaise('invalid data for uniform "'+$+'"',z.commandStr)}else Bn(ae)?ee=Cn(function(V){var Y=V.global.def("[",zt(ae.length,function(ce){return O.command(typeof ae[ce]=="number"||typeof ae[ce]=="boolean","invalid uniform "+$,V.commandStr),ae[ce]}),"]");return Y}):O.commandRaise('invalid or missing data for uniform "'+$+'"',z.commandStr);ee.value=ae,ue[$]=ee}),Object.keys(re).forEach(function($){var ee=re[$];ue[$]=Sr(ee,function(ae,G){return ae.invoke(G,ee)})}),ue}function zn(X,z){var Q=X.static,re=X.dynamic,ue={};return Object.keys(Q).forEach(function($){var ee=Q[$],ae=U.id($),G=new oe;if(Nh(ee))G.state=Bs,G.buffer=be.getBuffer(be.create(ee,Gs,!1,!0)),G.type=0;else{var V=be.getBuffer(ee);if(V)G.state=Bs,G.buffer=V,G.type=0;else if(O.command(typeof ee=="object"&&ee,"invalid data for attribute "+$,z.commandStr),"constant"in ee){var Y=ee.constant;G.buffer="null",G.state=Sg,typeof Y=="number"?G.x=Y:(O.command(Bn(Y)&&Y.length>0&&Y.length<=4,"invalid constant for attribute "+$,z.commandStr),js.forEach(function(gt,Ot){Ot<Y.length&&(G[gt]=Y[Ot])}))}else{V=Nh(ee.buffer)?be.getBuffer(be.create(ee.buffer,Gs,!1,!0)):be.getBuffer(ee.buffer),O.command(!!V,'missing buffer for attribute "'+$+'"',z.commandStr);var ce=0|ee.offset;O.command(ce>=0,'invalid offset for attribute "'+$+'"',z.commandStr);var ie=0|ee.stride;O.command(ie>=0&&ie<256,'invalid stride for attribute "'+$+'", must be integer betweeen [0, 255]',z.commandStr);var ge=0|ee.size;O.command(!("size"in ee)||ge>0&&ge<=4,'invalid size for attribute "'+$+'", must be 1,2,3,4',z.commandStr);var Ee=!!ee.normalized,ke=0;"type"in ee&&(O.commandParameter(ee.type,Da,"invalid type for attribute "+$,z.commandStr),ke=Da[ee.type]);var ht=0|ee.divisor;"divisor"in ee&&(O.command(ht===0||ze,'cannot specify divisor for attribute "'+$+'", instancing not supported',z.commandStr),O.command(ht>=0,'invalid divisor for attribute "'+$+'"',z.commandStr)),O.optional(function(){var gt=z.commandStr,Ot=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(ee).forEach(function(ct){O.command(Ot.indexOf(ct)>=0,'unknown parameter "'+ct+'" for attribute pointer "'+$+'" (valid parameters are '+Ot+")",gt)})}),G.buffer=V,G.state=Bs,G.size=ge,G.normalized=Ee,G.type=ke||V.dtype,G.offset=ce,G.stride=ie,G.divisor=ht}}ue[$]=Cn(function(gt,Ot){var ct=gt.attribCache;if(ae in ct)return ct[ae];var Pt={isStream:!1};return Object.keys(G).forEach(function(Ut){Pt[Ut]=G[Ut]}),G.buffer&&(Pt.buffer=gt.link(G.buffer),Pt.type=Pt.type||Pt.buffer+".dtype"),ct[ae]=Pt,Pt})}),Object.keys(re).forEach(function($){var ee=re[$];function ae(G,V){var Y=G.invoke(V,ee),ce=G.shared,ie=G.constants,ge=ce.isBufferArgs,Ee=ce.buffer;O.optional(function(){G.assert(V,Y+"&&(typeof "+Y+'==="object"||typeof '+Y+'==="function")&&('+ge+"("+Y+")||"+Ee+".getBuffer("+Y+")||"+Ee+".getBuffer("+Y+".buffer)||"+ge+"("+Y+'.buffer)||("constant" in '+Y+"&&(typeof "+Y+'.constant==="number"||'+ce.isArrayLike+"("+Y+".constant))))",'invalid dynamic attribute "'+$+'"')});var ke={isStream:V.def(!1)},ht=new oe;ht.state=Bs,Object.keys(ht).forEach(function(Pt){ke[Pt]=V.def(""+ht[Pt])});var gt=ke.buffer,Ot=ke.type;function ct(Pt){V(ke[Pt],"=",Y,".",Pt,"|0;")}return V("if(",ge,"(",Y,")){",ke.isStream,"=true;",gt,"=",Ee,".createStream(",Gs,",",Y,");",Ot,"=",gt,".dtype;","}else{",gt,"=",Ee,".getBuffer(",Y,");","if(",gt,"){",Ot,"=",gt,".dtype;",'}else if("constant" in ',Y,"){",ke.state,"=",Sg,";","if(typeof "+Y+'.constant === "number"){',ke[js[0]],"=",Y,".constant;",js.slice(1).map(function(Pt){return ke[Pt]}).join("="),"=0;","}else{",js.map(function(Pt,Ut){return ke[Pt]+"="+Y+".constant.length>"+Ut+"?"+Y+".constant["+Ut+"]:0;"}).join(""),"}}else{","if(",ge,"(",Y,".buffer)){",gt,"=",Ee,".createStream(",Gs,",",Y,".buffer);","}else{",gt,"=",Ee,".getBuffer(",Y,".buffer);","}",Ot,'="type" in ',Y,"?",ie.glTypes,"[",Y,".type]:",gt,".dtype;",ke.normalized,"=!!",Y,".normalized;"),ct("size"),ct("offset"),ct("stride"),ct("divisor"),V("}}"),V.exit("if(",ke.isStream,"){",Ee,".destroyStream(",gt,");","}"),ke}ue[$]=Sr(ee,ae)}),ue}function Ht(X,z){var Q=X.static,re=X.dynamic;if(rc in Q){var ue=Q[rc];return ue!==null&&je.getVAO(ue)===null&&(ue=je.createVAO(ue)),Cn(function(ee){return ee.link(je.getVAO(ue))})}if(rc in re){var $=re[rc];return Sr($,function(ee,ae){var G=ee.invoke(ae,$);return ae.def(ee.shared.vao+".getVAO("+G+")")})}return null}function In(X){var z=X.static,Q=X.dynamic,re={};return Object.keys(z).forEach(function(ue){var $=z[ue];re[ue]=Cn(function(ee,ae){return typeof $=="number"||typeof $=="boolean"?""+$:ee.link($)})}),Object.keys(Q).forEach(function(ue){var $=Q[ue];re[ue]=Sr($,function(ee,ae){return ee.invoke(ae,$)})}),re}function Tn(X,z,Q,re,ue){var $=X.static,ee=X.dynamic;O.optional(function(){var ct=[Ba,tc,nc,za,Fa,wh,Ga,Eh,ec,rc].concat(Ie);function Pt(Ut){Object.keys(Ut).forEach(function(rn){O.command(ct.indexOf(rn)>=0,'unknown parameter "'+rn+'"',ue.commandStr)})}Pt($),Pt(ee)});var ae=Bt(X,z),G=lt(X),V=Xt(X,G,ue),Y=Wt(X,ue),ce=An(X,ue),ie=Lt(X,ue,ae);function ge(ct){var Pt=V[ct];Pt&&(ce[ct]=Pt)}ge(ho),ge(He(xh));var Ee=Object.keys(ce).length>0,ke={framebuffer:G,draw:Y,shader:ie,state:ce,dirty:Ee,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(ke.profile=Ft(X),ke.uniforms=Qn(Q,ue),ke.drawVAO=ke.scopeVAO=Ht(X),!ke.drawVAO&&ie.program&&!ae&&K.angle_instanced_arrays){var ht=!0,gt=ie.program.attributes.map(function(ct){var Pt=z.static[ct];return ht=ht&&!!Pt,Pt});if(ht&&gt.length>0){var Ot=je.getVAO(je.createVAO(gt));ke.drawVAO=new br(null,null,null,function(ct,Pt){return ct.link(Ot)}),ke.useVAO=!0}}return ae?ke.useVAO=!0:ke.attributes=zn(z,ue),ke.context=In(re),ke}function Ln(X,z,Q){var re=X.shared.context,ue=X.scope();Object.keys(Q).forEach(function($){z.save(re,"."+$);var ee=Q[$].append(X,z);Array.isArray(ee)?ue(re,".",$,"=[",ee.join(),"];"):ue(re,".",$,"=",ee,";")}),z(ue)}function Rn(X,z,Q,re){var ue,$=X.shared,ee=$.gl,ae=$.framebuffer;rt&&(ue=z.def($.extensions,".webgl_draw_buffers"));var G,V=X.constants,Y=V.drawBuffer,ce=V.backBuffer;G=Q?Q.append(X,z):z.def(ae,".next"),re||z("if(",G,"!==",ae,".cur){"),z("if(",G,"){",ee,".bindFramebuffer(",zx,",",G,".framebuffer);"),rt&&z(ue,".drawBuffersWEBGL(",Y,"[",G,".colorAttachments.length]);"),z("}else{",ee,".bindFramebuffer(",zx,",null);"),rt&&z(ue,".drawBuffersWEBGL(",ce,");"),z("}",ae,".cur=",G,";"),re||z("}")}function Xn(X,z,Q){var re=X.shared,ue=re.gl,$=X.current,ee=X.next,ae=re.current,G=re.next,V=X.cond(ae,".dirty");Ie.forEach(function(Y){var ce,ie,ge=He(Y);if(!(ge in Q.state))if(ge in ee){ce=ee[ge],ie=$[ge];var Ee=zt(Ae[ge].length,function(ht){return V.def(ce,"[",ht,"]")});V(X.cond(Ee.map(function(ht,gt){return ht+"!=="+ie+"["+gt+"]"}).join("||")).then(ue,".",Ce[ge],"(",Ee,");",Ee.map(function(ht,gt){return ie+"["+gt+"]="+ht}).join(";"),";"))}else{ce=V.def(G,".",ge);var ke=X.cond(ce,"!==",ae,".",ge);V(ke),ge in Ke?ke(X.cond(ce).then(ue,".enable(",Ke[ge],");").else(ue,".disable(",Ke[ge],");"),ae,".",ge,"=",ce,";"):ke(ue,".",Ce[ge],"(",ce,");",ae,".",ge,"=",ce,";")}}),Object.keys(Q.state).length===0&&V(ae,".dirty=false;"),z(V)}function Jn(X,z,Q,re){var ue=X.shared,$=X.current,ee=ue.current,ae=ue.gl;Ux(Object.keys(Q)).forEach(function(G){var V=Q[G];if(!re||re(V)){var Y=V.append(X,z);if(Ke[G]){var ce=Ke[G];Ho(V)?z(ae,Y?".enable(":".disable(",ce,");"):z(X.cond(Y).then(ae,".enable(",ce,");").else(ae,".disable(",ce,");")),z(ee,".",G,"=",Y,";")}else if(Bn(Y)){var ie=$[G];z(ae,".",Ce[G],"(",Y,");",Y.map(function(ge,Ee){return ie+"["+Ee+"]="+ge}).join(";"),";")}else z(ae,".",Ce[G],"(",Y,");",ee,".",G,"=",Y,";")}})}function Mn(X,z){ze&&(X.instancing=z.def(X.shared.extensions,".angle_instanced_arrays"))}function Gt(X,z,Q,re,ue){var $,ee,ae,G=X.shared,V=X.stats,Y=G.current,ce=G.timer,ie=Q.profile;function ge(){return typeof performance>"u"?"Date.now()":"performance.now()"}function Ee(ct){ct($=z.def(),"=",ge(),";"),typeof ue=="string"?ct(V,".count+=",ue,";"):ct(V,".count++;"),Ne&&(re?ct(ee=z.def(),"=",ce,".getNumPendingQueries();"):ct(ce,".beginQuery(",V,");"))}function ke(ct){ct(V,".cpuTime+=",ge(),"-",$,";"),Ne&&(re?ct(ce,".pushScopeStats(",ee,",",ce,".getNumPendingQueries(),",V,");"):ct(ce,".endQuery();"))}function ht(ct){var Pt=z.def(Y,".profile");z(Y,".profile=",ct,";"),z.exit(Y,".profile=",Pt,";")}if(ie){if(Ho(ie))return void(ie.enable?(Ee(z),ke(z.exit),ht("true")):ht("false"));ht(ae=ie.append(X,z))}else ae=z.def(Y,".profile");var gt=X.block();Ee(gt),z("if(",ae,"){",gt,"}");var Ot=X.block();ke(Ot),z.exit("if(",ae,"){",Ot,"}")}function er(X,z,Q,re,ue){var $=X.shared;function ee(G){switch(G){case Mh:case kh:case Ih:return 2;case Sh:case Ch:case Th:return 3;case _h:case Ah:case Oh:return 4;default:return 1}}function ae(G,V,Y){var ce=$.gl,ie=z.def(G,".location"),ge=z.def($.attributes,"[",ie,"]"),Ee=Y.state,ke=Y.buffer,ht=[Y.x,Y.y,Y.z,Y.w],gt=["buffer","normalized","offset","stride"];function Ot(){z("if(!",ge,".buffer){",ce,".enableVertexAttribArray(",ie,");}");var Pt,Ut=Y.type;if(Pt=Y.size?z.def(Y.size,"||",V):V,z("if(",ge,".type!==",Ut,"||",ge,".size!==",Pt,"||",gt.map(function(cn){return ge+"."+cn+"!=="+Y[cn]}).join("||"),"){",ce,".bindBuffer(",Gs,",",ke,".buffer);",ce,".vertexAttribPointer(",[ie,Pt,Ut,Y.normalized,Y.stride,Y.offset],");",ge,".type=",Ut,";",ge,".size=",Pt,";",gt.map(function(cn){return ge+"."+cn+"="+Y[cn]+";"}).join(""),"}"),ze){var rn=Y.divisor;z("if(",ge,".divisor!==",rn,"){",X.instancing,".vertexAttribDivisorANGLE(",[ie,rn],");",ge,".divisor=",rn,";}")}}function ct(){z("if(",ge,".buffer){",ce,".disableVertexAttribArray(",ie,");",ge,".buffer=null;","}if(",js.map(function(Pt,Ut){return ge+"."+Pt+"!=="+ht[Ut]}).join("||"),"){",ce,".vertexAttrib4f(",ie,",",ht,");",js.map(function(Pt,Ut){return ge+"."+Pt+"="+ht[Ut]+";"}).join(""),"}")}Ee===Bs?Ot():Ee===Sg?ct():(z("if(",Ee,"===",Bs,"){"),Ot(),z("}else{"),ct(),z("}"))}re.forEach(function(G){var V,Y=G.name,ce=Q.attributes[Y];if(ce){if(!ue(ce))return;V=ce.append(X,z)}else{if(!ue(Xx))return;var ie=X.scopeAttrib(Y);O.optional(function(){X.assert(z,ie+".state","missing attribute "+Y)}),V={},Object.keys(new oe).forEach(function(ge){V[ge]=z.def(ie,".",ge)})}ae(X.link(G),ee(G.info.type),V)})}function un(X,z,Q,re,ue){for(var $,ee=X.shared,ae=ee.gl,G=0;G<re.length;++G){var V,Y=re[G],ce=Y.name,ie=Y.info.type,ge=Q.uniforms[ce],Ee=X.link(Y)+".location";if(ge){if(!ue(ge))continue;if(Ho(ge)){var ke=ge.value;if(O.command(ke!=null,'missing uniform "'+ce+'"',X.commandStr),ie===sc||ie===uc){O.command(typeof ke=="function"&&(ie===sc&&(ke._reglType==="texture2d"||ke._reglType==="framebuffer")||ie===uc&&(ke._reglType==="textureCube"||ke._reglType==="framebufferCube")),"invalid texture for uniform "+ce,X.commandStr);var ht=X.link(ke._texture||ke.color[0]._texture);z(ae,".uniform1i(",Ee,",",ht+".bind());"),z.exit(ht,".unbind();")}else if(ie===ic||ie===oc||ie===ac){O.optional(function(){O.command(Bn(ke),"invalid matrix for uniform "+ce,X.commandStr),O.command(ie===ic&&ke.length===4||ie===oc&&ke.length===9||ie===ac&&ke.length===16,"invalid length for matrix uniform "+ce,X.commandStr)});var gt=X.global.def("new Float32Array(["+Array.prototype.slice.call(ke)+"])"),Ot=2;ie===oc?Ot=3:ie===ac&&(Ot=4),z(ae,".uniformMatrix",Ot,"fv(",Ee,",false,",gt,");")}else{switch(ie){case Fg:O.commandType(ke,"number","uniform "+ce,X.commandStr),$="1f";break;case Mh:O.command(Bn(ke)&&ke.length===2,"uniform "+ce,X.commandStr),$="2f";break;case Sh:O.command(Bn(ke)&&ke.length===3,"uniform "+ce,X.commandStr),$="3f";break;case _h:O.command(Bn(ke)&&ke.length===4,"uniform "+ce,X.commandStr),$="4f";break;case Ug:O.commandType(ke,"boolean","uniform "+ce,X.commandStr),$="1i";break;case Gg:O.commandType(ke,"number","uniform "+ce,X.commandStr),$="1i";break;case Ih:case kh:O.command(Bn(ke)&&ke.length===2,"uniform "+ce,X.commandStr),$="2i";break;case Th:case Ch:O.command(Bn(ke)&&ke.length===3,"uniform "+ce,X.commandStr),$="3i";break;case Oh:case Ah:O.command(Bn(ke)&&ke.length===4,"uniform "+ce,X.commandStr),$="4i"}z(ae,".uniform",$,"(",Ee,",",Bn(ke)?Array.prototype.slice.call(ke):ke,");")}continue}V=ge.append(X,z)}else{if(!ue(Xx))continue;V=z.def(ee.uniforms,"[",U.id(ce),"]")}ie===sc?(O(!Array.isArray(V),"must specify a scalar prop for textures"),z("if(",V,"&&",V,'._reglType==="framebuffer"){',V,"=",V,".color[0];","}")):ie===uc&&(O(!Array.isArray(V),"must specify a scalar prop for cube maps"),z("if(",V,"&&",V,'._reglType==="framebufferCube"){',V,"=",V,".color[0];","}")),O.optional(function(){function cn(pi,Kx){X.assert(z,pi,'bad data or missing for uniform "'+ce+'".  '+Kx)}function Xs(pi){O(!Array.isArray(V),"must not specify an array type for uniform"),cn("typeof "+V+'==="'+pi+'"',"invalid type, expected "+pi)}function di(pi,Kx){Array.isArray(V)?O(V.length===pi,"must have length "+pi):cn(ee.isArrayLike+"("+V+")&&"+V+".length==="+pi,"invalid vector, should have length "+pi,X.commandStr)}function Zx(pi){O(!Array.isArray(V),"must not specify a value type"),cn("typeof "+V+'==="function"&&'+V+'._reglType==="texture'+(pi===Dx?"2d":"Cube")+'"',"invalid texture type",X.commandStr)}switch(ie){case Gg:Xs("number");break;case kh:di(2);break;case Ch:di(3);break;case Ah:di(4);break;case Fg:Xs("number");break;case Mh:di(2);break;case Sh:di(3);break;case _h:di(4);break;case Ug:Xs("boolean");break;case Ih:di(2);break;case Th:di(3);break;case Oh:case ic:di(4);break;case oc:di(9);break;case ac:di(16);break;case sc:Zx(Dx);break;case uc:Zx(RD)}});var ct=1;switch(ie){case sc:case uc:var Pt=z.def(V,"._texture");z(ae,".uniform1i(",Ee,",",Pt,".bind());"),z.exit(Pt,".unbind();");continue;case Gg:case Ug:$="1i";break;case kh:case Ih:$="2i",ct=2;break;case Ch:case Th:$="3i",ct=3;break;case Ah:case Oh:$="4i",ct=4;break;case Fg:$="1f";break;case Mh:$="2f",ct=2;break;case Sh:$="3f",ct=3;break;case _h:$="4f",ct=4;break;case ic:$="Matrix2fv";break;case oc:$="Matrix3fv";break;case ac:$="Matrix4fv"}if(z(ae,".uniform",$,"(",Ee,","),$.charAt(0)==="M"){var Ut=Math.pow(ie-ic+2,2),rn=X.global.def("new Float32Array(",Ut,")");Array.isArray(V)?z("false,(",zt(Ut,function(cn){return rn+"["+cn+"]="+V[cn]}),",",rn,")"):z("false,(Array.isArray(",V,")||",V," instanceof Float32Array)?",V,":(",zt(Ut,function(cn){return rn+"["+cn+"]="+V+"["+cn+"]"}),",",rn,")")}else ct>1?z(zt(ct,function(cn){return Array.isArray(V)?V[cn]:V+"["+cn+"]"})):(O(!Array.isArray(V),"uniform value must not be an array"),z(V));z(");")}}function _t(X,z,Q,re){var ue=X.shared,$=ue.gl,ee=ue.draw,ae=re.draw;function G(){var Ut,rn=ae.elements,cn=z;return rn?((rn.contextDep&&re.contextDynamic||rn.propDep)&&(cn=Q),Ut=rn.append(X,cn)):Ut=cn.def(ee,".",za),Ut&&cn("if("+Ut+")"+$+".bindBuffer("+LD+","+Ut+".buffer.buffer);"),Ut}function V(){var Ut,rn=ae.count,cn=z;return rn?((rn.contextDep&&re.contextDynamic||rn.propDep)&&(cn=Q),Ut=rn.append(X,cn),O.optional(function(){rn.MISSING&&X.assert(z,"false","missing vertex count"),rn.DYNAMIC&&X.assert(cn,Ut+">=0","missing vertex count")})):(Ut=cn.def(ee,".",Ga),O.optional(function(){X.assert(cn,Ut+">=0","missing vertex count")})),Ut}var Y=G();function ce(Ut){var rn=ae[Ut];return rn?rn.contextDep&&re.contextDynamic||rn.propDep?rn.append(X,Q):rn.append(X,z):z.def(ee,".",Ut)}var ie,ge,Ee=ce(Fa),ke=ce(wh),ht=V();if(typeof ht=="number"){if(ht===0)return}else Q("if(",ht,"){"),Q.exit("}");ze&&(ie=ce(Eh),ge=X.instancing);var gt=Y+".type",Ot=ae.elements&&Ho(ae.elements);function ct(){function Ut(){Q(ge,".drawElementsInstancedANGLE(",[Ee,ht,gt,ke+"<<(("+gt+"-"+fx+")>>1)",ie],");")}function rn(){Q(ge,".drawArraysInstancedANGLE(",[Ee,ke,ht,ie],");")}Y?Ot?Ut():(Q("if(",Y,"){"),Ut(),Q("}else{"),rn(),Q("}")):rn()}function Pt(){function Ut(){Q($+".drawElements("+[Ee,ht,gt,ke+"<<(("+gt+"-"+fx+")>>1)"]+");")}function rn(){Q($+".drawArrays("+[Ee,ke,ht]+");")}Y?Ot?Ut():(Q("if(",Y,"){"),Ut(),Q("}else{"),rn(),Q("}")):rn()}ze&&(typeof ie!="number"||ie>=0)?typeof ie=="string"?(Q("if(",ie,">0){"),ct(),Q("}else if(",ie,"<0){"),Pt(),Q("}")):ct():Pt()}function Vt(X,z,Q,re,ue){var $=nt(),ee=$.proc("body",ue);return O.optional(function(){$.commandStr=z.commandStr,$.command=$.link(z.commandStr)}),ze&&($.instancing=ee.def($.shared.extensions,".angle_instanced_arrays")),X($,ee,Q,re),$.compile().body}function Jt(X,z,Q,re){Mn(X,z),Q.useVAO?Q.drawVAO?z(X.shared.vao,".setVAO(",Q.drawVAO.append(X,z),");"):z(X.shared.vao,".setVAO(",X.shared.vao,".targetVAO);"):(z(X.shared.vao,".setVAO(null);"),er(X,z,Q,re.attributes,function(){return!0})),un(X,z,Q,re.uniforms,function(){return!0}),_t(X,z,z,Q)}function Sn(X,z){var Q=X.proc("draw",1);Mn(X,Q),Ln(X,Q,z.context),Rn(X,Q,z.framebuffer),Xn(X,Q,z),Jn(X,Q,z.state),Gt(X,Q,z,!1,!0);var re=z.shader.progVar.append(X,Q);if(Q(X.shared.gl,".useProgram(",re,".program);"),z.shader.program)Jt(X,Q,z,z.shader.program);else{Q(X.shared.vao,".setVAO(null);");var ue=X.global.def("{}"),$=Q.def(re,".id"),ee=Q.def(ue,"[",$,"]");Q(X.cond(ee).then(ee,".call(this,a0);").else(ee,"=",ue,"[",$,"]=",X.link(function(ae){return Vt(Jt,X,z,ae,1)}),"(",re,");",ee,".call(this,a0);"))}Object.keys(z.state).length>0&&Q(X.shared.current,".dirty=true;")}function Ri(X,z,Q,re){function ue(){return!0}X.batchId="a1",Mn(X,z),er(X,z,Q,re.attributes,ue),un(X,z,Q,re.uniforms,ue),_t(X,z,z,Q)}function Xa(X,z,Q,re){Mn(X,z);var ue=Q.contextDep,$=z.def(),ee="a0",ae="a1",G=z.def();X.shared.props=G,X.batchId=$;var V=X.scope(),Y=X.scope();function ce(gt){return gt.contextDep&&ue||gt.propDep}function ie(gt){return!ce(gt)}if(z(V.entry,"for(",$,"=0;",$,"<",ae,";++",$,"){",G,"=",ee,"[",$,"];",Y,"}",V.exit),Q.needsContext&&Ln(X,Y,Q.context),Q.needsFramebuffer&&Rn(X,Y,Q.framebuffer),Jn(X,Y,Q.state,ce),Q.profile&&ce(Q.profile)&&Gt(X,Y,Q,!1,!0),re)Q.useVAO?Q.drawVAO?ce(Q.drawVAO)?Y(X.shared.vao,".setVAO(",Q.drawVAO.append(X,Y),");"):V(X.shared.vao,".setVAO(",Q.drawVAO.append(X,V),");"):V(X.shared.vao,".setVAO(",X.shared.vao,".targetVAO);"):(V(X.shared.vao,".setVAO(null);"),er(X,V,Q,re.attributes,ie),er(X,Y,Q,re.attributes,ce)),un(X,V,Q,re.uniforms,ie),un(X,Y,Q,re.uniforms,ce),_t(X,V,Y,Q);else{var ge=X.global.def("{}"),Ee=Q.shader.progVar.append(X,Y),ke=Y.def(Ee,".id"),ht=Y.def(ge,"[",ke,"]");Y(X.shared.gl,".useProgram(",Ee,".program);","if(!",ht,"){",ht,"=",ge,"[",ke,"]=",X.link(function(gt){return Vt(Ri,X,Q,gt,2)}),"(",Ee,");}",ht,".call(this,a0[",$,"],",$,");")}}function W(X,z){var Q=X.proc("batch",2);X.batchId="0",Mn(X,Q);var re=!1,ue=!0;Object.keys(z.context).forEach(function(ge){re=re||z.context[ge].propDep}),re||(Ln(X,Q,z.context),ue=!1);var $=z.framebuffer,ee=!1;function ae(ge){return ge.contextDep&&re||ge.propDep}$?($.propDep?re=ee=!0:$.contextDep&&re&&(ee=!0),ee||Rn(X,Q,$)):Rn(X,Q,null),z.state.viewport&&z.state.viewport.propDep&&(re=!0),Xn(X,Q,z),Jn(X,Q,z.state,function(ge){return!ae(ge)}),z.profile&&ae(z.profile)||Gt(X,Q,z,!1,"a1"),z.contextDep=re,z.needsContext=ue,z.needsFramebuffer=ee;var G=z.shader.progVar;if(G.contextDep&&re||G.propDep)Xa(X,Q,z,null);else{var V=G.append(X,Q);if(Q(X.shared.gl,".useProgram(",V,".program);"),z.shader.program)Xa(X,Q,z,z.shader.program);else{Q(X.shared.vao,".setVAO(null);");var Y=X.global.def("{}"),ce=Q.def(V,".id"),ie=Q.def(Y,"[",ce,"]");Q(X.cond(ie).then(ie,".call(this,a0,a1);").else(ie,"=",Y,"[",ce,"]=",X.link(function(ge){return Vt(Xa,X,z,ge,2)}),"(",V,");",ie,".call(this,a0,a1);"))}}Object.keys(z.state).length>0&&Q(X.shared.current,".dirty=true;")}function de(X,z){var Q=X.proc("scope",3);X.batchId="a2";var re=X.shared,ue=re.current;function $(ee){var ae=z.shader[ee];ae&&Q.set(re.shader,"."+ee,ae.append(X,Q))}Ln(X,Q,z.context),z.framebuffer&&z.framebuffer.append(X,Q),Ux(Object.keys(z.state)).forEach(function(ee){var ae=z.state[ee].append(X,Q);Bn(ae)?ae.forEach(function(G,V){Q.set(X.next[ee],"["+V+"]",G)}):Q.set(re.next,"."+ee,ae)}),Gt(X,Q,z,!0,!0),[za,wh,Ga,Eh,Fa].forEach(function(ee){var ae=z.draw[ee];ae&&Q.set(re.draw,"."+ee,""+ae.append(X,Q))}),Object.keys(z.uniforms).forEach(function(ee){var ae=z.uniforms[ee].append(X,Q);Array.isArray(ae)&&(ae="["+ae.join()+"]"),Q.set(re.uniforms,"["+U.id(ee)+"]",ae)}),Object.keys(z.attributes).forEach(function(ee){var ae=z.attributes[ee].append(X,Q),G=X.scopeAttrib(ee);Object.keys(new oe).forEach(function(V){Q.set(G,"."+V,ae[V])})}),z.scopeVAO&&Q.set(re.vao,".targetVAO",z.scopeVAO.append(X,Q)),$(tc),$(nc),Object.keys(z.state).length>0&&(Q(ue,".dirty=true;"),Q.exit(ue,".dirty=true;")),Q("a1(",X.shared.context,",a0,",X.batchId,");")}function le(X){if(typeof X=="object"&&!Bn(X)){for(var z=Object.keys(X),Q=0;Q<z.length;++Q)if(xn.isDynamic(X[z[Q]]))return!0;return!1}}function ut(X,z,Q){var re=z.static[Q];if(re&&le(re)){var ue=X.global,$=Object.keys(re),ee=!1,ae=!1,G=!1,V=X.global.def("{}");$.forEach(function(ce){var ie=re[ce];if(xn.isDynamic(ie)){typeof ie=="function"&&(ie=re[ce]=xn.unbox(ie));var ge=Sr(ie,null);ee=ee||ge.thisDep,G=G||ge.propDep,ae=ae||ge.contextDep}else{switch(ue(V,".",ce,"="),typeof ie){case"number":ue(ie);break;case"string":ue('"',ie,'"');break;case"object":Array.isArray(ie)&&ue("[",ie.join(),"]");break;default:ue(X.link(ie))}ue(";")}}),z.dynamic[Q]=new xn.DynamicVariable(bh,{thisDep:ee,contextDep:ae,propDep:G,ref:V,append:Y}),delete z.static[Q]}function Y(ce,ie){$.forEach(function(ge){var Ee=re[ge];if(xn.isDynamic(Ee)){var ke=ce.invoke(ie,Ee);ie(V,".",ge,"=",ke,";")}})}}function Yt(X,z,Q,re,ue){var $=nt();$.stats=$.link(ue),Object.keys(z.static).forEach(function(ae){ut($,z,ae)}),PD.forEach(function(ae){ut($,X,ae)});var ee=Tn(X,z,Q,re,$);return Sn($,ee),de($,ee),W($,ee),n($.compile(),{destroy:function(){ee.shader.program.destroy()}})}return{next:st,current:Ae,procs:function(){var X=nt(),z=X.proc("poll"),Q=X.proc("refresh"),re=X.block();z(re),Q(re);var ue,$=X.shared,ee=$.gl,ae=$.next,G=$.current;re(G,".dirty=false;"),Rn(X,z),Rn(X,Q,null,!0),ze&&(ue=X.link(ze)),K.oes_vertex_array_object&&Q(X.link(K.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var V=0;V<fe.maxAttributes;++V){var Y=Q.def($.attributes,"[",V,"]"),ce=X.cond(Y,".buffer");ce.then(ee,".enableVertexAttribArray(",V,");",ee,".bindBuffer(",Gs,",",Y,".buffer.buffer);",ee,".vertexAttribPointer(",V,",",Y,".size,",Y,".type,",Y,".normalized,",Y,".stride,",Y,".offset);").else(ee,".disableVertexAttribArray(",V,");",ee,".vertexAttrib4f(",V,",",Y,".x,",Y,".y,",Y,".z,",Y,".w);",Y,".buffer=null;"),Q(ce),ze&&Q(ue,".vertexAttribDivisorANGLE(",V,",",Y,".divisor);")}return Q(X.shared.vao,".currentVAO=null;",X.shared.vao,".setVAO(",X.shared.vao,".targetVAO);"),Object.keys(Ke).forEach(function(ie){var ge=Ke[ie],Ee=re.def(ae,".",ie),ke=X.block();ke("if(",Ee,"){",ee,".enable(",ge,")}else{",ee,".disable(",ge,")}",G,".",ie,"=",Ee,";"),Q(ke),z("if(",Ee,"!==",G,".",ie,"){",ke,"}")}),Object.keys(Ce).forEach(function(ie){var ge,Ee,ke=Ce[ie],ht=Ae[ie],gt=X.block();if(gt(ee,".",ke,"("),Bn(ht)){var Ot=ht.length;ge=X.global.def(ae,".",ie),Ee=X.global.def(G,".",ie),gt(zt(Ot,function(ct){return ge+"["+ct+"]"}),");",zt(Ot,function(ct){return Ee+"["+ct+"]="+ge+"["+ct+"];"}).join("")),z("if(",zt(Ot,function(ct){return ge+"["+ct+"]!=="+Ee+"["+ct+"]"}).join("||"),"){",gt,"}")}else ge=re.def(ae,".",ie),Ee=re.def(G,".",ie),gt(ge,");",G,".",ie,"=",ge,";"),z("if(",ge,"!==",Ee,"){",gt,"}");Q(gt)}),X.compile()}(),compile:Yt}}function QD(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var JD=34918,eP=34919,Yx=35007,tP=function(I,U){if(!U.ext_disjoint_timer_query)return null;var K=[];function fe(){return K.pop()||U.ext_disjoint_timer_query.createQueryEXT()}function be(ze){K.push(ze)}var se=[];function ve(ze){var rt=fe();U.ext_disjoint_timer_query.beginQueryEXT(Yx,rt),se.push(rt),Ne(se.length-1,se.length,ze)}function Pe(){U.ext_disjoint_timer_query.endQueryEXT(Yx)}function Fe(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var je=[];function Le(){return je.pop()||new Fe}function Ye(ze){je.push(ze)}var et=[];function Ne(ze,rt,Ae){var st=Le();st.startQueryIndex=ze,st.endQueryIndex=rt,st.sum=0,st.stats=Ae,et.push(st)}var Qe=[],oe=[];function me(){var ze,rt,Ae=se.length;if(Ae!==0){oe.length=Math.max(oe.length,Ae+1),Qe.length=Math.max(Qe.length,Ae+1),Qe[0]=0,oe[0]=0;var st=0;for(ze=0,rt=0;rt<se.length;++rt){var Ie=se[rt];U.ext_disjoint_timer_query.getQueryObjectEXT(Ie,eP)?(st+=U.ext_disjoint_timer_query.getQueryObjectEXT(Ie,JD),be(Ie)):se[ze++]=Ie,Qe[rt+1]=st,oe[rt+1]=ze}for(se.length=ze,ze=0,rt=0;rt<et.length;++rt){var Ke=et[rt],Ce=Ke.startQueryIndex,He=Ke.endQueryIndex;Ke.sum+=Qe[He]-Qe[Ce];var mt=oe[Ce],jt=oe[He];jt===mt?(Ke.stats.gpuTime+=Ke.sum/1e6,Ye(Ke)):(Ke.startQueryIndex=mt,Ke.endQueryIndex=jt,et[ze++]=Ke)}et.length=ze}}return{beginQuery:ve,endQuery:Pe,pushScopeStats:Ne,update:me,getNumPendingQueries:function(){return se.length},clear:function(){K.push.apply(K,se);for(var ze=0;ze<K.length;ze++)U.ext_disjoint_timer_query.deleteQueryEXT(K[ze]);se.length=0,K.length=0},restore:function(){se.length=0,K.length=0}}},nP=16384,rP=256,iP=1024,oP=34962,Wx="webglcontextlost",Vx="webglcontextrestored",Hx=1,aP=2,sP=3;function qx(I,U){for(var K=0;K<I.length;++K)if(I[K]===U)return K;return-1}function uP(I){var U=sn(I);if(!U)return null;var K=U.gl,fe=K.getContextAttributes(),be=K.isContextLost(),se=Dt(K,U);if(!se)return null;var ve=hr(),Pe=QD(),Fe=se.extensions,je=tP(K,Fe),Le=Mr(),Ye=K.drawingBufferWidth,et=K.drawingBufferHeight,Ne={tick:0,time:0,viewportWidth:Ye,viewportHeight:et,framebufferWidth:Ye,framebufferHeight:et,drawingBufferWidth:Ye,drawingBufferHeight:et,pixelRatio:U.pixelRatio},Qe={},oe={elements:null,primitive:4,count:-1,offset:0,instances:-1},me=mN(K,Fe),ze=MN(K,Pe,U,Ae),rt=MD(K,Fe,me,Pe,ze);function Ae(_t){return rt.destroyBuffer(_t)}var st=TN(K,Fe,ze,Pe),Ie=CD(K,ve,Pe,U),Ke=sD(K,Fe,me,function(){mt.procs.poll()},Ne,Pe,U),Ce=uD(K,Fe,me,Pe,U),He=wD(K,Fe,me,Ke,Ce,Pe),mt=$D(K,ve,Fe,me,ze,st,Ke,He,Qe,rt,Ie,oe,Ne,je,U),jt=TD(K,He,mt.procs.poll,Ne,fe,Fe,me),$e=mt.next,tt=K.canvas,Ge=[],nt=[],Ft=[],lt=[U.onDestroy],Xt=null;function Bt(){if(Ge.length===0)return je&&je.update(),void(Xt=null);Xt=ar.next(Bt),Jn();for(var _t=Ge.length-1;_t>=0;--_t){var Vt=Ge[_t];Vt&&Vt(Ne,null,0)}K.flush(),je&&je.update()}function Lt(){!Xt&&Ge.length>0&&(Xt=ar.next(Bt))}function Wt(){Xt&&(ar.cancel(Bt),Xt=null)}function An(_t){_t.preventDefault(),be=!0,Wt(),nt.forEach(function(Vt){Vt()})}function Qn(_t){K.getError(),be=!1,se.restore(),Ie.restore(),ze.restore(),Ke.restore(),Ce.restore(),He.restore(),rt.restore(),je&&je.restore(),mt.procs.refresh(),Lt(),Ft.forEach(function(Vt){Vt()})}function zn(){Ge.length=0,Wt(),tt&&(tt.removeEventListener(Wx,An),tt.removeEventListener(Vx,Qn)),Ie.clear(),He.clear(),Ce.clear(),Ke.clear(),st.clear(),ze.clear(),rt.clear(),je&&je.clear(),lt.forEach(function(_t){_t()})}function Ht(_t){function Vt(ue){var $=n({},ue);function ee(ae){if(ae in $){var G=$[ae];delete $[ae],Object.keys(G).forEach(function(V){$[ae+"."+V]=G[V]})}}return delete $.uniforms,delete $.attributes,delete $.context,delete $.vao,"stencil"in $&&$.stencil.op&&($.stencil.opBack=$.stencil.opFront=$.stencil.op,delete $.stencil.op),ee("blend"),ee("depth"),ee("cull"),ee("stencil"),ee("polygonOffset"),ee("scissor"),ee("sample"),"vao"in ue&&($.vao=ue.vao),$}function Jt(ue,$){var ee={},ae={};return Object.keys(ue).forEach(function(G){var V=ue[G];if(xn.isDynamic(V))ae[G]=xn.unbox(V,G);else{if($&&Array.isArray(V)){for(var Y=0;Y<V.length;++Y)if(xn.isDynamic(V[Y]))return void(ae[G]=xn.unbox(V,G))}ee[G]=V}}),{dynamic:ae,static:ee}}O(!!_t,"invalid args to regl({...})"),O.type(_t,"object","invalid args to regl({...})");var Sn=Jt(_t.context||{},!0),Ri=Jt(_t.uniforms||{},!0),Xa=Jt(_t.attributes||{},!1),W=Jt(Vt(_t),!1),de={gpuTime:0,cpuTime:0,count:0},le=mt.compile(W,Xa,Ri,Sn,de),ut=le.draw,Yt=le.batch,X=le.scope,z=[];function Q(ue){for(;z.length<ue;)z.push(null);return z}function re(ue,$){var ee;if(be&&O.raise("context lost"),typeof ue=="function")return X.call(this,null,ue,0);if(typeof $=="function")if(typeof ue=="number")for(ee=0;ee<ue;++ee)X.call(this,null,$,ee);else{if(!Array.isArray(ue))return X.call(this,ue,$,0);for(ee=0;ee<ue.length;++ee)X.call(this,ue[ee],$,ee)}else if(typeof ue=="number"){if(ue>0)return Yt.call(this,Q(0|ue),0|ue)}else{if(!Array.isArray(ue))return ut.call(this,ue);if(ue.length)return Yt.call(this,ue,ue.length)}}return n(re,{stats:de,destroy:function(){le.destroy()}})}tt&&(tt.addEventListener(Wx,An,!1),tt.addEventListener(Vx,Qn,!1));var In=He.setFBO=Ht({framebuffer:xn.define.call(null,Hx,"framebuffer")});function Tn(_t,Vt){var Jt=0;mt.procs.poll();var Sn=Vt.color;Sn&&(K.clearColor(+Sn[0]||0,+Sn[1]||0,+Sn[2]||0,+Sn[3]||0),Jt|=nP),"depth"in Vt&&(K.clearDepth(+Vt.depth),Jt|=rP),"stencil"in Vt&&(K.clearStencil(0|Vt.stencil),Jt|=iP),O(!!Jt,"called regl.clear with no buffer specified"),K.clear(Jt)}function Ln(_t){if(O(typeof _t=="object"&&_t,"regl.clear() takes an object as input"),"framebuffer"in _t)if(_t.framebuffer&&_t.framebuffer_reglType==="framebufferCube")for(var Vt=0;Vt<6;++Vt)In(n({framebuffer:_t.framebuffer.faces[Vt]},_t),Tn);else In(_t,Tn);else Tn(null,_t)}function Rn(_t){function Vt(){var Jt=qx(Ge,_t);function Sn(){var Ri=qx(Ge,Sn);Ge[Ri]=Ge[Ge.length-1],Ge.length-=1,Ge.length<=0&&Wt()}O(Jt>=0,"cannot cancel a frame twice"),Ge[Jt]=Sn}return O.type(_t,"function","regl.frame() callback must be a function"),Ge.push(_t),Lt(),{cancel:Vt}}function Xn(){var _t=$e.viewport,Vt=$e.scissor_box;_t[0]=_t[1]=Vt[0]=Vt[1]=0,Ne.viewportWidth=Ne.framebufferWidth=Ne.drawingBufferWidth=_t[2]=Vt[2]=K.drawingBufferWidth,Ne.viewportHeight=Ne.framebufferHeight=Ne.drawingBufferHeight=_t[3]=Vt[3]=K.drawingBufferHeight}function Jn(){Ne.tick+=1,Ne.time=Gt(),Xn(),mt.procs.poll()}function Mn(){Ke.refresh(),Xn(),mt.procs.refresh(),je&&je.update()}function Gt(){return(Mr()-Le)/1e3}function er(_t,Vt){var Jt;switch(O.type(Vt,"function","listener callback must be a function"),_t){case"frame":return Rn(Vt);case"lost":Jt=nt;break;case"restore":Jt=Ft;break;case"destroy":Jt=lt;break;default:O.raise("invalid event, must be one of frame,lost,restore,destroy")}return Jt.push(Vt),{cancel:function(){for(var Sn=0;Sn<Jt.length;++Sn)if(Jt[Sn]===Vt)return Jt[Sn]=Jt[Jt.length-1],void Jt.pop()}}}Mn();var un=n(Ht,{clear:Ln,prop:xn.define.bind(null,Hx),context:xn.define.bind(null,aP),this:xn.define.bind(null,sP),draw:Ht({}),buffer:function(_t){return ze.create(_t,oP,!1,!1)},elements:function(_t){return st.create(_t,!1)},texture:Ke.create2D,cube:Ke.createCube,renderbuffer:Ce.create,framebuffer:He.create,framebufferCube:He.createCube,vao:rt.createVAO,attributes:fe,frame:Rn,on:er,limits:me,hasExtension:function(_t){return me.extensions.indexOf(_t.toLowerCase())>=0},read:jt,destroy:zn,_gl:K,_refresh:Mn,poll:function(){Jn(),je&&je.update()},now:Gt,stats:Pe});return U.onDone(null,un),un}return uP}();const oX=Bi(M3.exports);var ba,Mp,xa,Ni,Sp,xs,_p,p1,To,zu,yr,Oo,No,g1,aX=function(){function e(n,t){Ti(this,e),this.attribute=void 0,this.buffer=void 0;var r=t.buffer,i=t.offset,o=t.stride,a=t.normalized,s=t.size,u=t.divisor;this.buffer=r,this.attribute={buffer:r.get(),offset:i||0,stride:o||0,normalized:a||!1,divisor:u||0},s&&(this.attribute.size=s)}return Oi(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(n){this.buffer.subData(n)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),sX=(ot(ba={},De.POINTS,"points"),ot(ba,De.LINES,"lines"),ot(ba,De.LINE_LOOP,"line loop"),ot(ba,De.LINE_STRIP,"line strip"),ot(ba,De.TRIANGLES,"triangles"),ot(ba,De.TRIANGLE_FAN,"triangle fan"),ot(ba,De.TRIANGLE_STRIP,"triangle strip"),ba),S3=(ot(Mp={},De.STATIC_DRAW,"static"),ot(Mp,De.DYNAMIC_DRAW,"dynamic"),ot(Mp,De.STREAM_DRAW,"stream"),Mp),v1=(ot(xa={},De.BYTE,"int8"),ot(xa,De.UNSIGNED_INT,"int16"),ot(xa,De.INT,"int32"),ot(xa,De.UNSIGNED_BYTE,"uint8"),ot(xa,De.UNSIGNED_SHORT,"uint16"),ot(xa,De.UNSIGNED_INT,"uint32"),ot(xa,De.FLOAT,"float"),xa),uX=(ot(Ni={},De.ALPHA,"alpha"),ot(Ni,De.LUMINANCE,"luminance"),ot(Ni,De.LUMINANCE_ALPHA,"luminance alpha"),ot(Ni,De.RGB,"rgb"),ot(Ni,De.RGBA,"rgba"),ot(Ni,De.RGBA4,"rgba4"),ot(Ni,De.RGB5_A1,"rgb5 a1"),ot(Ni,De.RGB565,"rgb565"),ot(Ni,De.DEPTH_COMPONENT,"depth"),ot(Ni,De.DEPTH_STENCIL,"depth stencil"),Ni),cX=(ot(Sp={},De.DONT_CARE,"dont care"),ot(Sp,De.NICEST,"nice"),ot(Sp,De.FASTEST,"fast"),Sp),_3=(ot(xs={},De.NEAREST,"nearest"),ot(xs,De.LINEAR,"linear"),ot(xs,De.LINEAR_MIPMAP_LINEAR,"mipmap"),ot(xs,De.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),ot(xs,De.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),ot(xs,De.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),xs),k3=(ot(_p={},De.REPEAT,"repeat"),ot(_p,De.CLAMP_TO_EDGE,"clamp"),ot(_p,De.MIRRORED_REPEAT,"mirror"),_p),lX=(ot(p1={},De.NONE,"none"),ot(p1,De.BROWSER_DEFAULT_WEBGL,"browser"),p1),hX=(ot(To={},De.NEVER,"never"),ot(To,De.ALWAYS,"always"),ot(To,De.LESS,"less"),ot(To,De.LEQUAL,"lequal"),ot(To,De.GREATER,"greater"),ot(To,De.GEQUAL,"gequal"),ot(To,De.EQUAL,"equal"),ot(To,De.NOTEQUAL,"notequal"),To),C3=(ot(zu={},De.FUNC_ADD,"add"),ot(zu,De.MIN_EXT,"min"),ot(zu,De.MAX_EXT,"max"),ot(zu,De.FUNC_SUBTRACT,"subtract"),ot(zu,De.FUNC_REVERSE_SUBTRACT,"reverse subtract"),zu),kp=(ot(yr={},De.ZERO,"zero"),ot(yr,De.ONE,"one"),ot(yr,De.SRC_COLOR,"src color"),ot(yr,De.ONE_MINUS_SRC_COLOR,"one minus src color"),ot(yr,De.SRC_ALPHA,"src alpha"),ot(yr,De.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),ot(yr,De.DST_COLOR,"dst color"),ot(yr,De.ONE_MINUS_DST_COLOR,"one minus dst color"),ot(yr,De.DST_ALPHA,"dst alpha"),ot(yr,De.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),ot(yr,De.CONSTANT_COLOR,"constant color"),ot(yr,De.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),ot(yr,De.CONSTANT_ALPHA,"constant alpha"),ot(yr,De.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),ot(yr,De.SRC_ALPHA_SATURATE,"src alpha saturate"),yr),fX=(ot(Oo={},De.NEVER,"never"),ot(Oo,De.ALWAYS,"always"),ot(Oo,De.LESS,"less"),ot(Oo,De.LEQUAL,"lequal"),ot(Oo,De.GREATER,"greater"),ot(Oo,De.GEQUAL,"gequal"),ot(Oo,De.EQUAL,"equal"),ot(Oo,De.NOTEQUAL,"notequal"),Oo),Fu=(ot(No={},De.ZERO,"zero"),ot(No,De.KEEP,"keep"),ot(No,De.REPLACE,"replace"),ot(No,De.INVERT,"invert"),ot(No,De.INCR,"increment"),ot(No,De.DECR,"decrement"),ot(No,De.INCR_WRAP,"increment wrap"),ot(No,De.DECR_WRAP,"decrement wrap"),No),dX=(ot(g1={},De.FRONT,"front"),ot(g1,De.BACK,"back"),g1),pX=function(){function e(n,t){Ti(this,e),this.buffer=void 0;var r=t.data,i=t.usage,o=t.type;this.buffer=n.buffer({data:r,usage:S3[i||De.STATIC_DRAW],type:v1[o||De.UNSIGNED_BYTE]})}return Oi(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(n){var t=n.data,r=n.offset;this.buffer.subdata(t,r)}}]),e}();function m1(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function gX(e){return function(n){if(Array.isArray(n))return m1(n)}(e)||function(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}(e)||function(n,t){if(n){if(typeof n=="string")return m1(n,t);var r={}.toString.call(n).slice(8,-1);return r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set"?Array.from(n):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m1(n,t):void 0}}(e)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function A3(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,r)}return t}function I3(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?A3(Object(t),!0).forEach(function(r){ot(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):A3(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var T3=0,vX=function(){function e(t,r){var i=this;Ti(this,e),this.reGl=t,this.context=r,this.entity=y3(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var o={};this.context.uniforms.forEach(function(l){var h=l.name,f=l.type,d=l.data,p=l.isReferer,g=l.storageClass;if(g===Bu.StorageBuffer){if(p)i.textureCache[h]={data:void 0},o["".concat(h,"Size")]=function(){return d.compiledBundle.context.output.textureSize};else{i.textureCache[h]=i.calcDataTexture(h,f,d);var v=i.textureCache[h],m=v.textureWidth,y=v.isOutput;o["".concat(h,"Size")]=[m,m],y&&(i.outputTextureName=h,i.context.needPingpong&&(i.outputTextureName="".concat(h,"Output"),i.textureCache[i.outputTextureName]=i.calcDataTexture(h,f,d)))}o[h]=function(){return i.textureCache[h].texture}}else if(g===Bu.Uniform){if(d&&(Array.isArray(d)||wp(d))&&d.length>16)throw new Error("invalid data type ".concat(f));o[h]=function(){return l.data}}});var a=this.getOuputDataTexture(),s=a.textureWidth,u=a.texelCount;o.u_OutputTextureSize=[s,s],o.u_OutputTexelCount=u,this.context.output.textureSize=[s,s];var c={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(this.context.shader),uniforms:o,vert:`attribute vec3 a_Position;
attribute vec2 a_TexCoord;

varying vec2 v_TexCoord;

void main() {
  gl_Position = vec4(a_Position, 1.0);
  v_TexCoord = a_TexCoord;
}`,primitive:"triangle strip",count:4};this.computeCommand=this.reGl(c)}var n;return Oi(e,[{key:"run",value:function(){var t=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use(function(){t.computeCommand()})}},{key:"readData",value:(n=ya(mr.mark(function t(){var r,i,o,a,s,u,c,l,h=this;return mr.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this.reGl({framebuffer:this.texFBO})(function(){r=h.reGl.read()}),!r){f.next=6;break}if(i=this.getOuputDataTexture(),o=i.originalDataLength,a=i.elementsPerTexel,s=i.typedArrayConstructor,u=s===void 0?Float32Array:s,c=[],a!==4)for(l=0;l<r.length;l+=4)a===1?c.push(r[l]):a===2?c.push(r[l],r[l+1]):c.push(r[l],r[l+1],r[l+2]);else c=r;return f.abrupt("return",new u(c.slice(0,o)));case 6:return f.abrupt("return",new Float32Array);case 7:case"end":return f.stop()}},t,this)})),function(){return n.apply(this,arguments)})},{key:"confirmInput",value:function(t,r){var i;this.entity===t.entity?(this.dynamicPingpong=!0,i=this):i=t,this.textureCache[r].id=i.getOuputDataTexture().id,this.textureCache[r].texture=i.getOuputDataTexture().texture}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(t,r){var i=this.context.uniforms.find(function(u){return u.name===t});if(i){var o=this.calcDataTexture(t,i.type,r),a=o.texture,s=o.data;this.textureCache[t].data=s,this.textureCache[t].texture=a}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var t=this.context.output.name;this.textureCache[t].id=this.getOuputDataTexture().id,this.textureCache[t].texture=this.getOuputDataTexture().texture}var r=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=r}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var t=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=t}},{key:"cloneDataTexture",value:function(t){var r=t.data,i=t.textureWidth;return I3(I3({},t),{},{id:T3++,texture:this.reGl.texture({width:i,height:i,data:r,type:"float"})})}},{key:"calcDataTexture",value:function(t,r,i){var o=1;r===Nl.Vector4FloatArray&&(o=4);for(var a=[],s=0;s<i.length;s+=o)o===1?a.push(i[s],0,0,0):o===2?a.push(i[s],i[s+1],0,0):o===3?a.push(i[s],i[s+1],i[s+2],0):o===4&&a.push(i[s],i[s+1],i[s+2],i[s+3]);var u=i.length,c=Math.ceil(u/o),l=Math.ceil(Math.sqrt(c)),h=l*l;c<h&&a.push.apply(a,gX(new Array(4*(h-c)).fill(0)));var f=this.reGl.texture({width:l,height:l,data:a,type:"float"});return{id:T3++,data:a,originalDataLength:u,typedArrayConstructor:wp(i)?i.constructor:void 0,textureWidth:l,texture:f,texelCount:c,elementsPerTexel:o,isOutput:t===this.context.output.name}}}]),e}(),mX=function(){function e(n,t){Ti(this,e),this.elements=void 0;var r=t.data,i=t.usage,o=t.type,a=t.count;this.elements=n.elements({data:r,usage:S3[i||De.STATIC_DRAW],type:v1[o||De.UNSIGNED_BYTE],count:a})}return Oi(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(n){var t=n.data;this.elements.subdata(t)}},{key:"destroy",value:function(){this.elements.destroy()}}]),e}(),yX=function(){function e(n,t){Ti(this,e),this.framebuffer=void 0;var r=t.width,i=t.height,o=t.color,a=t.colors;t.depth,t.stencil;var s={width:r,height:i};Array.isArray(a)&&(s.colors=a.map(function(u){return u.get()})),o&&typeof o!="boolean"&&(s.color=o.get()),this.framebuffer=n.framebuffer(s)}return Oi(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(n){var t=n.width,r=n.height;this.framebuffer.resize(t,r)}}]),e}(),bX=function(e,n){return function(t){return e(n(t))}},xX=bX(Object.getPrototypeOf,Object),wX=h1,EX=xX,MX=f1,SX=Function.prototype,_X=Object.prototype,O3=SX.toString,kX=_X.hasOwnProperty,CX=O3.call(Object);const AX=Bi(function(e){if(!MX(e)||wX(e)!="[object Object]")return!1;var n=EX(e);if(n===null)return!0;var t=kX.call(n,"constructor")&&n.constructor;return typeof t=="function"&&t instanceof t&&O3.call(t)==CX});function y1(e){var n={};return Object.keys(e).forEach(function(t){b1(t,e[t],n,"")}),n}function b1(e,n,t,r){n===null||typeof n=="number"||typeof n=="boolean"||Array.isArray(n)&&typeof n[0]=="number"||wp(n)||n===""||n.resize!==void 0?t["".concat(r&&r+".").concat(e)]=n:(AX(n)&&Object.keys(n).forEach(function(i){b1(i,n[i],t,"".concat(r&&r+".").concat(e))}),Array.isArray(n)&&n.forEach(function(i,o){Object.keys(i).forEach(function(a){b1(a,i[a],t,"".concat(r&&r+".").concat(e,"[").concat(o,"]"))})}))}function N3(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,r)}return t}function Gu(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?N3(Object(t),!0).forEach(function(r){ot(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):N3(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var IX=function(){function e(n,t){Ti(this,e),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=n;var r=t.vs,i=t.fs,o=t.defines,a=t.attributes,s=t.uniforms,u=t.primitive,c=t.count,l=t.elements,h=t.depth,f=t.blend,d=t.stencil,p=t.cull,g=t.instances,v=t.scissor,m=t.viewport,y={};s&&(this.uniforms=y1(s),Object.keys(s).forEach(function(E){y[E]=n.prop(E)}));var b={};Object.keys(a).forEach(function(E){b[E]=a[E].get()});var x=o&&this.generateDefines(o)||"",w={attributes:b,frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(x,`
`).concat(i),uniforms:y,vert:`
`.concat(x,`
`).concat(r),primitive:sX[u===void 0?De.TRIANGLES:u]};g&&(w.instances=g),c&&(w.count=c),l&&(w.elements=l.get()),v&&(w.scissor=v),m&&(w.viewport=m),this.initDepthDrawParams({depth:h},w),this.initBlendDrawParams({blend:f},w),this.initStencilDrawParams({stencil:d},w),this.initCullDrawParams({cull:p},w),this.drawCommand=n(w)}return Oi(e,[{key:"addUniforms",value:function(n){this.uniforms=Gu(Gu({},this.uniforms),y1(n))}},{key:"draw",value:function(n){var t=Gu(Gu({},this.uniforms),y1(n.uniforms||{})),r={};Object.keys(t).forEach(function(i){var o=ju(t[i]);o==="boolean"||o==="number"||Array.isArray(t[i])||t[i].BYTES_PER_ELEMENT?r[i]=t[i]:o==="string"||(r[i]=t[i].get())}),this.drawCommand(r)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(n,t){var r=n.depth;r&&(t.depth={enable:r.enable===void 0||!!r.enable,mask:r.mask===void 0||!!r.mask,func:hX[r.func||De.LESS],range:r.range||[0,1]})}},{key:"initBlendDrawParams",value:function(n,t){var r=n.blend;if(r){var i=r.enable,o=r.func,a=r.equation,s=r.color,u=s===void 0?[0,0,0,0]:s;t.blend={enable:!!i,func:{srcRGB:kp[o&&o.srcRGB||De.SRC_ALPHA],srcAlpha:kp[o&&o.srcAlpha||De.SRC_ALPHA],dstRGB:kp[o&&o.dstRGB||De.ONE_MINUS_SRC_ALPHA],dstAlpha:kp[o&&o.dstAlpha||De.ONE_MINUS_SRC_ALPHA]},equation:{rgb:C3[a&&a.rgb||De.FUNC_ADD],alpha:C3[a&&a.alpha||De.FUNC_ADD]},color:u}}}},{key:"initStencilDrawParams",value:function(n,t){var r=n.stencil;if(r){var i=r.enable,o=r.mask,a=o===void 0?-1:o,s=r.func,u=s===void 0?{cmp:De.ALWAYS,ref:0,mask:-1}:s,c=r.opFront,l=c===void 0?{fail:De.KEEP,zfail:De.KEEP,zpass:De.KEEP}:c,h=r.opBack,f=h===void 0?{fail:De.KEEP,zfail:De.KEEP,zpass:De.KEEP}:h;t.stencil={enable:!!i,mask:a,func:Gu(Gu({},u),{},{cmp:fX[u.cmp]}),opFront:{fail:Fu[l.fail],zfail:Fu[l.zfail],zpass:Fu[l.zpass]},opBack:{fail:Fu[f.fail],zfail:Fu[f.zfail],zpass:Fu[f.zpass]}}}}},{key:"initCullDrawParams",value:function(n,t){var r=n.cull;if(r){var i=r.enable,o=r.face,a=o===void 0?De.BACK:o;t.cull={enable:!!i,face:dX[a]}}}},{key:"generateDefines",value:function(n){return Object.keys(n).map(function(t){return"#define ".concat(t," ").concat(Number(n[t]))}).join(`
`)}}]),e}(),TX=function(){function e(n,t){Ti(this,e),this.texture=void 0,this.width=void 0,this.height=void 0;var r=t.data,i=t.type,o=i===void 0?De.UNSIGNED_BYTE:i,a=t.width,s=t.height,u=t.flipY,c=u!==void 0&&u,l=t.format,h=l===void 0?De.RGBA:l,f=t.mipmap,d=f!==void 0&&f,p=t.wrapS,g=p===void 0?De.CLAMP_TO_EDGE:p,v=t.wrapT,m=v===void 0?De.CLAMP_TO_EDGE:v,y=t.aniso,b=y===void 0?0:y,x=t.alignment,w=x===void 0?1:x,E=t.premultiplyAlpha,M=E!==void 0&&E,_=t.mag,k=_===void 0?De.NEAREST:_,S=t.min,C=S===void 0?De.NEAREST:S,T=t.colorSpace,A=T===void 0?De.BROWSER_DEFAULT_WEBGL:T;this.width=a,this.height=s;var D={width:a,height:s,type:v1[o],format:uX[h],wrapS:k3[g],wrapT:k3[m],mag:_3[k],min:_3[C],alignment:w,flipY:c,colorSpace:lX[A],premultiplyAlpha:M,aniso:b};r&&(D.data=r),typeof d=="number"?D.mipmap=cX[d]:typeof d=="boolean"&&(D.mipmap=d),this.texture=n.texture(D)}return Oi(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(n){var t=n.width,r=n.height;this.texture.resize(t,r),this.width=t,this.height=r}},{key:"destroy",value:function(){this.texture.destroy()}}]),e}(),OX=function(){function e(){var t=this;Ti(this,e),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var r=ya(mr.mark(function i(o){return mr.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!o.uniforms){a.next=3;break}return a.next=3,Promise.all(Object.keys(o.uniforms).map(function(){var s=ya(mr.mark(function u(c){var l;return mr.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!o.uniforms[c]||o.uniforms[c].load===void 0){h.next=5;break}return h.next=3,o.uniforms[c].load();case 3:l=h.sent,o.uniforms[c]=l;case 5:case"end":return h.stop()}},u)}));return function(u){return s.apply(this,arguments)}}()));case 3:return a.abrupt("return",new IX(t.gl,o));case 4:case"end":return a.stop()}},i)}));return function(i){return r.apply(this,arguments)}}(),this.createAttribute=function(r){return new aX(t.gl,r)},this.createBuffer=function(r){return new pX(t.gl,r)},this.createElements=function(r){return new mX(t.gl,r)},this.createTexture2D=function(r){return new TX(t.gl,r)},this.createFramebuffer=function(r){return new yX(t.gl,r)},this.useFramebuffer=function(r,i){t.gl({framebuffer:r?r.get():null})(i)},this.createComputeModel=function(){var r=ya(mr.mark(function i(o){return mr.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new vX(t.gl,o));case 1:case"end":return a.stop()}},i)}));return function(i){return r.apply(this,arguments)}}(),this.clear=function(r){var i=r.color,o=r.depth,a=r.stencil,s=r.framebuffer,u=s===void 0?null:s,c={color:i,depth:o,stencil:a};c.framebuffer=u===null?u:u.get(),t.gl.clear(c)},this.setScissor=function(r){t.gl&&t.gl._gl&&(r.enable&&r.box?(t.gl._gl.enable(De.SCISSOR_TEST),t.gl._gl.scissor(r.box.x,r.box.y,r.box.width,r.box.height)):t.gl._gl.disable(De.SCISSOR_TEST),t.gl._refresh())},this.viewport=function(r){var i=r.x,o=r.y,a=r.width,s=r.height;t.gl&&t.gl._gl&&(t.gl._gl.viewport(i,o,a,s),t.gl._refresh())},this.readPixels=function(r){var i=r.framebuffer,o={x:r.x,y:r.y,width:r.width,height:r.height};return i&&(o.framebuffer=i.get()),t.gl.read(o)},this.getCanvas=function(){return t.$canvas},this.getGLContext=function(){return t.gl._gl},this.destroy=function(){t.gl&&(t.gl.destroy(),t.inited=!1)}}var n;return Oi(e,[{key:"init",value:(n=ya(mr.mark(function t(r){return mr.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!this.inited){i.next=2;break}return i.abrupt("return");case 2:return this.$canvas=r.canvas,i.next=5,new Promise(function(o,a){oX({canvas:r.canvas,attributes:{alpha:!0,antialias:r.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(s,u){!s&&u||a(s),o(u)}})});case 5:this.gl=i.sent,this.inited=!0;case 7:case"end":return i.stop()}},t,this)})),function(t){return n.apply(this,arguments)})},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),e}(),NX=function(){function e(){Ti(this,e),this.engine=void 0,this.configService=new rX}return Oi(e,[{key:"setConfig",value:function(n){this.configService.set(n)}},{key:"setEngine",value:function(n){this.engine=n}},{key:"createEntity",value:function(){return y3()}},{key:"createKernel",value:function(n){var t=new E3(this.engine,this.configService);return typeof n=="string"?t.setBundle(JSON.parse(n)):t.setBundle(n),t.init(),t}},{key:"destroy",value:function(){this.engine.destroy()}}],[{key:"create",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=new e;return t.setConfig(n),t.setEngine(new OX),t}}]),e}();const D3=ji(Object.freeze(Object.defineProperty({__proto__:null,Kernel:E3,World:NX},Symbol.toStringTag,{value:"Module"})));var Hr={};Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.arrayToTextureData=Hr.attributesToTextureData=Hr.buildTextureDataWithTwoEdgeAttr=Hr.buildTextureData=Hr.proccessToFunc=void 0;var DX=_n(),Cp=gd;Hr.proccessToFunc=function(e,n){return e?(0,DX.isNumber)(e)?function(){return e}:e:function(){return n||1}},Hr.buildTextureData=function(e,n){var t=[],r=[],i={},o=0;for(o=0;o<e.length;o++){var a=e[o];i[a.id]=o,t.push(a.x),t.push(a.y),t.push(0),t.push(0),r.push([])}for(o=0;o<n.length;o++){var s=n[o],u=(0,Cp.getEdgeTerminal)(s,"source"),c=(0,Cp.getEdgeTerminal)(s,"target");isNaN(i[u])||isNaN(i[c])||(r[i[u]].push(i[c]),r[i[c]].push(i[u]))}var l=0;for(o=0;o<e.length;o++){var h=t.length,f=r[o],d=f.length;t[4*o+2]=h,t[4*o+3]=d,l=Math.max(l,d);for(var p=0;p<d;++p){var g=f[p];t.push(+g)}}for(;t.length%4!=0;)t.push(0);return{maxEdgePerVetex:l,array:new Float32Array(t)}},Hr.buildTextureDataWithTwoEdgeAttr=function(e,n,t,r){var i=[],o=[],a={},s=0;for(s=0;s<e.length;s++){var u=e[s];a[u.id]=s,i.push(u.x),i.push(u.y),i.push(0),i.push(0),o.push([])}for(s=0;s<n.length;s++){var c=n[s],l=(0,Cp.getEdgeTerminal)(c,"source"),h=(0,Cp.getEdgeTerminal)(c,"target");o[a[l]].push(a[h]),o[a[l]].push(t(c)),o[a[l]].push(r(c)),o[a[l]].push(0),o[a[h]].push(a[l]),o[a[h]].push(t(c)),o[a[h]].push(r(c)),o[a[h]].push(0)}var f=0;for(s=0;s<e.length;s++){var d=i.length,p=o[s],g=p.length;i[4*s+2]=d+1048576*g/4,i[4*s+3]=0,f=Math.max(f,g/4);for(var v=0;v<g;++v){var m=p[v];i.push(+m)}}for(;i.length%4!=0;)i.push(0);return{maxEdgePerVetex:f,array:new Float32Array(i)}},Hr.attributesToTextureData=function(e,n){var t=[],r=e.length,i={};return n.forEach(function(o){e.forEach(function(a,s){if(i[o[a]]===void 0&&(i[o[a]]=Object.keys(i).length),t.push(i[o[a]]),s===r-1)for(;t.length%4!=0;)t.push(0)})}),{array:new Float32Array(t),count:Object.keys(i).length}},Hr.arrayToTextureData=function(e){for(var n=[],t=e.length,r=e[0].length,i=function(a){e.forEach(function(s,u){if(n.push(s[a]),u===t-1)for(;n.length%4!=0;)n.push(0)})},o=0;o<r;o++)i(o);return new Float32Array(n)};var io={};Object.defineProperty(io,"__esModule",{value:!0}),io.clusterBundle=io.clusterCode=io.fruchtermanBundle=io.fruchtermanCode=void 0,io.fruchtermanCode=`
import { globalInvocationID } from 'g-webgpu';
const MAX_EDGE_PER_VERTEX;
const VERTEX_COUNT;
@numthreads(1, 1, 1)
class Fruchterman {
  @in @out
  u_Data: vec4[];
  @in
  u_K: float;
  @in
  u_K2: float;
  
  @in
  u_Center: vec2;
  @in
  u_Gravity: float;
  @in
  u_ClusterGravity: float;
  @in
  u_Speed: float;
  @in
  u_MaxDisplace: float;
  @in
  u_Clustering: float;
  @in
  u_AttributeArray: vec4[];
  @in
  u_ClusterCenters: vec4[];
  calcRepulsive(i: int, currentNode: vec4): vec2 {
    let dx = 0, dy = 0;
    for (let j = 0; j < VERTEX_COUNT; j++) {
      if (i != j) {
        const nextNode = this.u_Data[j];
        const xDist = currentNode[0] - nextNode[0];
        const yDist = currentNode[1] - nextNode[1];
        const dist = (xDist * xDist + yDist * yDist) + 0.01;
        let param = this.u_K2 / dist;
        
        if (dist > 0.0) {
          dx += param * xDist;
          dy += param * yDist;
          if (xDist == 0 && yDist == 0) {
            const sign = i < j ? 1 : -1;
            dx += param * sign;
            dy += param * sign;
          }
        }
      }
    }
    return [dx, dy];
  }
  calcGravity(currentNode: vec4, nodeAttributes: vec4): vec2 { // 
    let dx = 0, dy = 0;
    const vx = currentNode[0] - this.u_Center[0];
    const vy = currentNode[1] - this.u_Center[1];
    const gf = 0.01 * this.u_K * this.u_Gravity;
    dx = gf * vx;
    dy = gf * vy;
    if (this.u_Clustering == 1) {
      const clusterIdx = int(nodeAttributes[0]);
      const center = this.u_ClusterCenters[clusterIdx];
      const cvx = currentNode[0] - center[0];
      const cvy = currentNode[1] - center[1];
      const dist = sqrt(cvx * cvx + cvy * cvy) + 0.01;
      const parma = this.u_K * this.u_ClusterGravity / dist;
      dx += parma * cvx;
      dy += parma * cvy;
    }
    return [dx, dy];
  }
  calcAttractive(i: int, currentNode: vec4): vec2 {
    let dx = 0, dy = 0;
    const arr_offset = int(floor(currentNode[2] + 0.5));
    const length = int(floor(currentNode[3] + 0.5));
    const node_buffer: vec4;
    for (let p = 0; p < MAX_EDGE_PER_VERTEX; p++) {
      if (p >= length) break;
      const arr_idx = arr_offset + p;
      // when arr_idx % 4 == 0 update currentNodedx_buffer
      const buf_offset = arr_idx - arr_idx / 4 * 4;
      if (p == 0 || buf_offset == 0) {
        node_buffer = this.u_Data[int(arr_idx / 4)];
      }
      const float_j = buf_offset == 0 ? node_buffer[0] :
                      buf_offset == 1 ? node_buffer[1] :
                      buf_offset == 2 ? node_buffer[2] :
                                        node_buffer[3];
      const nextNode = this.u_Data[int(float_j)];
      const xDist = currentNode[0] - nextNode[0];
      const yDist = currentNode[1] - nextNode[1];
      const dist = sqrt(xDist * xDist + yDist * yDist) + 0.01;
      let attractiveF = dist / this.u_K;
    
      if (dist > 0.0) {
        dx -= xDist * attractiveF;
        dy -= yDist * attractiveF;
        if (xDist == 0 && yDist == 0) {
          const sign = i < int(float_j) ? 1 : -1;
          dx -= sign * attractiveF;
          dy -= sign * attractiveF;
        }
      }
    }
    return [dx, dy];
  }
  @main
  compute() {
    const i = globalInvocationID.x;
    const currentNode = this.u_Data[i];
    let dx = 0, dy = 0;
    if (i >= VERTEX_COUNT) {
      this.u_Data[i] = currentNode;
      return;
    }

    // [gravity, fx, fy, 0]
    const nodeAttributes = this.u_AttributeArray[i];

    if (nodeAttributes[1] != 0 && nodeAttributes[2] != 0) {
      // the node is fixed
      this.u_Data[i] = [
        nodeAttributes[1],
        nodeAttributes[2],
        currentNode[2],
        currentNode[3]
      ];
      return;
    }

    // repulsive
    const repulsive = this.calcRepulsive(i, currentNode);
    dx += repulsive[0];
    dy += repulsive[1];
    // attractive
    const attractive = this.calcAttractive(i, currentNode);
    dx += attractive[0];
    dy += attractive[1];
    // gravity
    const gravity = this.calcGravity(currentNode, nodeAttributes);
    dx -= gravity[0];
    dy -= gravity[1];
    // speed
    dx *= this.u_Speed;
    dy *= this.u_Speed;

    // move
    const distLength = sqrt(dx * dx + dy * dy);
    if (distLength > 0.0) {
      const limitedDist = min(this.u_MaxDisplace * this.u_Speed, distLength);
      this.u_Data[i] = [
        currentNode[0] + dx / distLength * limitedDist,
        currentNode[1] + dy / distLength * limitedDist,
        currentNode[2],
        currentNode[3]
      ];
    }
  }
}
`,io.fruchtermanBundle='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',io.clusterCode=`
import { globalInvocationID } from 'g-webgpu';
const VERTEX_COUNT;
const CLUSTER_COUNT;
@numthreads(1, 1, 1)
class CalcCenter {
  @in
  u_Data: vec4[];
  @in
  u_NodeAttributes: vec4[]; // [[clusterIdx, 0, 0, 0], ...]
  @in @out
  u_ClusterCenters: vec4[]; // [[cx, cy, nodeCount, clusterIdx], ...]
  @main
  compute() {
    const i = globalInvocationID.x;
    const center = this.u_ClusterCenters[i];
    let sumx = 0;
    let sumy = 0;
    let count = 0;
    for (let j = 0; j < VERTEX_COUNT; j++) {
      const attributes = this.u_NodeAttributes[j];
      const clusterIdx = int(attributes[0]);
      const vertex = this.u_Data[j];
      if (clusterIdx == i) {
        sumx += vertex.x;
        sumy += vertex.y;
        count += 1;
      }
    }
    this.u_ClusterCenters[i] = [
      sumx / count,
      sumy / count,
      count,
      i
    ];
  }
}
`,io.clusterBundle='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}';var PX=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ap=xe&&xe.__awaiter||function(e,n,t,r){return new(t||(t=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(l){o(l)}}function s(c){try{u(r.throw(c))}catch(l){o(l)}}function u(c){var l;c.done?i(c.value):(l=c.value,l instanceof t?l:new t(function(h){h(l)})).then(a,s)}u((r=r.apply(e,n||[])).next())})},Ip=xe&&xe.__generator||function(e,n){var t,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(a=0)),a;)try{if(t=1,r&&(i=2&l[0]?r.return:l[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,l[1])).done)return i;switch(r=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,r=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||l[0]!==6&&l[0]!==2)){a=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){a.label=l[1];break}if(l[0]===6&&a.label<i[1]){a.label=i[1],i=l;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(l);break}i[2]&&a.ops.pop(),a.trys.pop();continue}l=n.call(e,a)}catch(h){l=[6,h],r=0}finally{t=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([u,c])}}};Object.defineProperty(Tl,"__esModule",{value:!0}),Tl.FruchtermanGPULayout=void 0;var LX=Nn,Uu=_n(),P3=D3,L3=Hr,R3=io,RX=Eo,jX=function(e){function n(t){var r=e.call(this)||this;return r.maxIteration=1e3,r.gravity=10,r.speed=1,r.clustering=!1,r.clusterField="cluster",r.clusterGravity=10,r.workerEnabled=!1,r.nodes=[],r.edges=[],r.width=300,r.height=300,r.nodeMap={},r.nodeIdxMap={},r.updateCfg(t),r}return PX(n,e),n.prototype.getDefaultCfg=function(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}},n.prototype.execute=function(){return Ap(this,void 0,void 0,function(){var t,r,i,o,a,s=this;return Ip(this,function(u){switch(u.label){case 0:return(r=(t=this).nodes)&&r.length!==0?(t.width||typeof window>"u"||(t.width=window.innerWidth),t.height||typeof window>"u"||(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]),i=t.center,r.length===1?(r[0].x=i[0],r[0].y=i[1],t.onLayoutEnd&&t.onLayoutEnd(),[2]):(o={},a={},r.forEach(function(c,l){(0,Uu.isNumber)(c.x)||(c.x=Math.random()*s.width),(0,Uu.isNumber)(c.y)||(c.y=Math.random()*s.height),o[c.id]=c,a[c.id]=l}),t.nodeMap=o,t.nodeIdxMap=a,[4,t.run()])):(t.onLayoutEnd&&t.onLayoutEnd(),[2]);case 1:return u.sent(),[2]}})})},n.prototype.executeWithWorker=function(t,r){return Ap(this,void 0,void 0,function(){var i,o,a,s,u,c=this;return Ip(this,function(l){switch(l.label){case 0:return o=(i=this).nodes,a=i.center,o&&o.length!==0?o.length===1?(o[0].x=a[0],o[0].y=a[1],[2]):(s={},u={},o.forEach(function(h,f){(0,Uu.isNumber)(h.x)||(h.x=Math.random()*c.width),(0,Uu.isNumber)(h.y)||(h.y=Math.random()*c.height),s[h.id]=h,u[h.id]=f}),i.nodeMap=s,i.nodeIdxMap=u,[4,i.run(t,r)]):[2];case 1:return l.sent(),[2]}})})},n.prototype.run=function(t,r){return Ap(this,void 0,void 0,function(){var i,o,a,s,u,c,l,h,f,d,p,g,v,m,y,b,x,w,E,M,_,k,S,C,T,A,D=this;return Ip(this,function(j){switch(j.label){case 0:for(o=(i=this).nodes,a=i.edges,s=i.maxIteration,u=i.center,c=i.height*i.width,l=Math.sqrt(c)/10,h=c/(o.length+1),f=Math.sqrt(h),d=i.speed,p=i.clustering,g=(0,L3.attributesToTextureData)([i.clusterField],o),v=g.array,m=g.count,o.forEach(function(L,B){var N=0,R=0;(0,Uu.isNumber)(L.fx)&&(0,Uu.isNumber)(L.fy)&&(N=L.fx||.001,R=L.fy||.001),v[4*B+1]=N,v[4*B+2]=R}),y=o.length,b=(0,L3.buildTextureData)(o,a),x=b.maxEdgePerVetex,w=b.array,E=i.workerEnabled,M=E?P3.World.create({canvas:t,engineOptions:{supportCompute:!0}}):P3.World.create({engineOptions:{supportCompute:!0}}),_=i.onLayoutEnd,k=[],S=0;S<m;S++)k.push(0,0,0,0);return C=M.createKernel(R3.fruchtermanBundle).setDispatch([y,1,1]).setBinding({u_Data:w,u_K:f,u_K2:h,u_Gravity:i.gravity,u_ClusterGravity:i.clusterGravity||i.gravity||1,u_Speed:d,u_MaxDisplace:l,u_Clustering:p?1:0,u_Center:u,u_AttributeArray:v,u_ClusterCenters:k,MAX_EDGE_PER_VERTEX:x,VERTEX_COUNT:y}),p&&(T=M.createKernel(R3.clusterBundle).setDispatch([m,1,1]).setBinding({u_Data:w,u_NodeAttributes:v,u_ClusterCenters:k,VERTEX_COUNT:y,CLUSTER_COUNT:m})),A=function(){return Ap(D,void 0,void 0,function(){var L,B;return Ip(this,function(N){switch(N.label){case 0:L=0,N.label=1;case 1:return L<s?[4,C.execute()]:[3,6];case 2:return N.sent(),p?(T.setBinding({u_Data:C}),[4,T.execute()]):[3,4];case 3:N.sent(),C.setBinding({u_ClusterCenters:T}),N.label=4;case 4:C.setBinding({u_MaxDisplace:l*=.99}),N.label=5;case 5:return L++,[3,1];case 6:return[4,C.getOutput()];case 7:return B=N.sent(),t?r.postMessage({type:RX.LAYOUT_MESSAGE.GPUEND,vertexEdgeData:B}):o.forEach(function(R,P){var H=B[4*P],ne=B[4*P+1];R.x=H,R.y=ne}),_&&_(),[2]}})})},[4,A()];case 1:return j.sent(),[2]}})})},n.prototype.getType=function(){return"fruchterman-gpu"},n}(LX.Base);Tl.FruchtermanGPULayout=jX;var Pl={},oo={};Object.defineProperty(oo,"__esModule",{value:!0}),oo.aveMovementBundle=oo.aveMovementCode=oo.gForceBundle=oo.gForceCode=void 0,oo.gForceCode=`
import { globalInvocationID } from 'g-webgpu';

const MAX_EDGE_PER_VERTEX;
const VERTEX_COUNT;
const SHIFT_20 = 1048576;

@numthreads(1, 1, 1)
class GGForce {
  @in @out
  u_Data: vec4[];

  @in
  u_damping: float;
  
  @in
  u_maxSpeed: float;

  @in
  u_minMovement: float;

  @in
  u_AveMovement: vec4[];

  @in
  u_coulombDisScale: float;

  @in
  u_factor: float;

  @in
  u_NodeAttributeArray1: vec4[];

  @in
  u_NodeAttributeArray2: vec4[];

  @in
  u_interval: float;

  unpack_float(packedValue: float): ivec2 {
    const packedIntValue = int(packedValue);
    const v0 = packedIntValue / SHIFT_20;
    return [v0, packedIntValue - v0 * SHIFT_20];
  }

  calcRepulsive(i: int, currentNode: vec4): vec2 {
    let ax = 0, ay = 0;
    for (let j: int = 0; j < VERTEX_COUNT; j++) {
      if (i != j) {
        const nextNode = this.u_Data[j];
        const vx = currentNode[0] - nextNode[0];
        const vy = currentNode[1] - nextNode[1];
        const dist = sqrt(vx * vx + vy * vy) + 0.01;
        const n_dist = (dist + 0.1) * this.u_coulombDisScale;
        const direx = vx / dist;
        const direy = vy / dist;
        const attributesi = this.u_NodeAttributeArray1[i];
        const attributesj = this.u_NodeAttributeArray1[j];
        const massi = attributesi[0];
        const nodeStrengthi = attributesi[2];
        const nodeStrengthj = attributesj[2];
        const nodeStrength = (nodeStrengthi + nodeStrengthj) / 2;
        // const param = nodeStrength * this.u_factor / (n_dist * n_dist * massi);
        const param = nodeStrength * this.u_factor / (n_dist * n_dist);
        ax += direx * param;
        ay += direy * param;
      }
    }
    return [ax, ay];
  }

  calcGravity(i: int, currentNode: vec4, attributes2: vec4): vec2 {
    // note: attributes2 = [centerX, centerY, gravity, 0]

    const vx = currentNode[0] - attributes2[0];
    const vy = currentNode[1] - attributes2[1];
    
    const ax = vx * attributes2[2];
    const ay = vy * attributes2[2];
    
    return [ax, ay];
  }

  calcAttractive(i: int, currentNode: vec4, attributes1: vec4): vec2 {
    // note: attributes1 = [mass, degree, nodeSterngth, 0]

    const mass = attributes1[0];
    let ax = 0, ay = 0;
    // const arr_offset = int(floor(currentNode[2] + 0.5));
    // const length = int(floor(currentNode[3] + 0.5));

    const compressed = this.unpack_float(currentNode[2]);
    const length = compressed[0];
    const arr_offset = compressed[1];

    const node_buffer: vec4;
    for (let p: int = 0; p < MAX_EDGE_PER_VERTEX; p++) {
      if (p >= length) break;
      const arr_idx = arr_offset + 4 * p; // i \u8282\u70B9\u7684\u7B2C p \u6761\u8FB9\u5F00\u59CB\u7684\u5C0F\u683C\u5B50\u4F4D\u7F6E
      const buf_offset = arr_idx - arr_idx / 4 * 4;
      if (p == 0 || buf_offset == 0) {
        node_buffer = this.u_Data[int(arr_idx / 4)]; // \u5927\u683C\u5B50\uFF0C\u5927\u683C\u5B50\u4F4D\u7F6E=\u5C0F\u4E2A\u5B50\u4F4D\u7F6E / 4\uFF0C
      }

      let float_j: float = node_buffer[0];

      const nextNode = this.u_Data[int(float_j)];
      const vx = nextNode[0] - currentNode[0];
      const vy = nextNode[1] - currentNode[1];
      const dist = sqrt(vx * vx + vy * vy) + 0.01;
      const direx = vx / dist;
      const direy = vy / dist;
      const edgeLength = node_buffer[1];
      const edgeStrength = node_buffer[2];
      const diff: float = edgeLength - dist;//edgeLength
      // const param = diff * this.u_stiffness / mass; //
      const param = diff * edgeStrength / mass; // 
      ax -= direx * param;
      ay -= direy * param;
    }
    return [ax, ay];
  }

  @main
  compute() {
    const i = globalInvocationID.x;
    const currentNode = this.u_Data[i];
    const movement = u_AveMovement[0];
    let ax = 0, ay = 0;

    if (i >= VERTEX_COUNT || movement.x < u_minMovement) {
      this.u_Data[i] = currentNode;
      return;
    }

    // \u6BCF\u4E2A\u8282\u70B9\u5C5E\u6027\u5360\u4E24\u4E2A\u6570\u7EC4\u4E2D\u5404\u4E00\u683C
    // [mass, degree, nodeStrength, fx]
    const nodeAttributes1 = this.u_NodeAttributeArray1[i];
    // [centerX, centerY, centerGravity, fy]
    const nodeAttributes2 = this.u_NodeAttributeArray2[i];

    // repulsive
    const repulsive = this.calcRepulsive(i, currentNode);
    ax += repulsive[0];
    ay += repulsive[1];

    // attractive
    const attractive = this.calcAttractive(i, currentNode, nodeAttributes1);
    ax += attractive[0];
    ay += attractive[1];

    // gravity
    const gravity = this.calcGravity(i, currentNode, nodeAttributes2);
    ax -= gravity[0];
    ay -= gravity[1];

    // speed
    const param = this.u_interval * this.u_damping;
    let vx = ax * param;
    let vy = ay * param;
    const vlength = sqrt(vx * vx + vy * vy) + 0.0001;
    if (vlength > this.u_maxSpeed) {
      const param2 = this.u_maxSpeed / vlength;
      vx = param2 * vx;
      vy = param2 * vy;
    }

    // move
    if (nodeAttributes1[3] != 0 && nodeAttributes2[3] != 0) {
      this.u_Data[i] = [
        nodeAttributes1[3],
        nodeAttributes2[3],
        currentNode[2],
        0
      ];
    } else {
      const distx = vx * this.u_interval;
      const disty = vy * this.u_interval;
      const distLength = sqrt(distx * distx + disty * disty);
      this.u_Data[i] = [
        currentNode[0] + distx,
        currentNode[1] + disty,
        currentNode[2],
        distLength
      ];
    }
    
    // the avarage move distance
    // need to share memory
    
  }
}
`,oo.gForceBundle='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {float distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\ngl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',oo.aveMovementCode=`
const VERTEX_COUNT;
@numthreads(1, 1, 1)
class CalcAveMovement {
  @in
  u_Data: vec4[];
  @in
  u_iter: float;
  @in @out
  u_AveMovement: vec4[];
  @main
  compute() {
    let movement = 0;
    for (let j: int = 0; j < VERTEX_COUNT; j++) {
      const vertex = this.u_Data[j];
      movement += vertex[3];
    }
    movement = movement / float(VERTEX_COUNT);
    this.u_AveMovement[0] = [movement, 0, 0, 0];
  }
}
`,oo.aveMovementBundle='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}';var BX=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),x1=xe&&xe.__awaiter||function(e,n,t,r){return new(t||(t=Promise))(function(i,o){function a(c){try{u(r.next(c))}catch(l){o(l)}}function s(c){try{u(r.throw(c))}catch(l){o(l)}}function u(c){var l;c.done?i(c.value):(l=c.value,l instanceof t?l:new t(function(h){h(l)})).then(a,s)}u((r=r.apply(e,n||[])).next())})},w1=xe&&xe.__generator||function(e,n){var t,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(a=0)),a;)try{if(t=1,r&&(i=2&l[0]?r.return:l[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,l[1])).done)return i;switch(r=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,r=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||l[0]!==6&&l[0]!==2)){a=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){a.label=l[1];break}if(l[0]===6&&a.label<i[1]){a.label=i[1],i=l;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(l);break}i[2]&&a.ops.pop(),a.trys.pop();continue}l=n.call(e,a)}catch(h){l=[6,h],r=0}finally{t=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([u,c])}}};Object.defineProperty(Pl,"__esModule",{value:!0}),Pl.GForceGPULayout=void 0;var zX=Nn,Do=_n(),j3=D3,Po=Hr,FX=gd,B3=oo,GX=Eo,UX=function(e){function n(t){var r=e.call(this)||this;return r.maxIteration=1e3,r.edgeStrength=200,r.nodeStrength=1e3,r.coulombDisScale=.005,r.damping=.9,r.maxSpeed=1e3,r.minMovement=.5,r.interval=.02,r.factor=1,r.linkDistance=1,r.gravity=10,r.workerEnabled=!1,r.nodes=[],r.edges=[],r.width=300,r.height=300,r.nodeMap={},r.nodeIdxMap={},r.updateCfg(t),r}return BX(n,e),n.prototype.getDefaultCfg=function(){return{maxIteration:2e3,gravity:10,clustering:!1,clusterGravity:10}},n.prototype.execute=function(){return x1(this,void 0,void 0,function(){var t,r,i,o,a;return w1(this,function(s){switch(s.label){case 0:return(r=(t=this).nodes)&&r.length!==0?(t.width||typeof window>"u"||(t.width=window.innerWidth),t.height||typeof window>"u"||(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]),i=t.center,r.length===1?(r[0].x=i[0],r[0].y=i[1],t.onLayoutEnd&&t.onLayoutEnd(),[2]):(o={},a={},r.forEach(function(u,c){(0,Do.isNumber)(u.x)||(u.x=Math.random()*t.width),(0,Do.isNumber)(u.y)||(u.y=Math.random()*t.height),o[u.id]=u,a[u.id]=c}),t.nodeMap=o,t.nodeIdxMap=a,t.nodeStrength=(0,Po.proccessToFunc)(t.nodeStrength,1),t.edgeStrength=(0,Po.proccessToFunc)(t.edgeStrength,1),[4,t.run()])):(t.onLayoutEnd&&t.onLayoutEnd(),[2]);case 1:return s.sent(),[2]}})})},n.prototype.executeWithWorker=function(t,r){var i=this,o=i.nodes,a=i.center;if(o&&o.length!==0){if(o.length===1)return o[0].x=a[0],void(o[0].y=a[1]);var s={},u={};o.forEach(function(c,l){(0,Do.isNumber)(c.x)||(c.x=Math.random()*i.width),(0,Do.isNumber)(c.y)||(c.y=Math.random()*i.height),s[c.id]=c,u[c.id]=l}),i.nodeMap=s,i.nodeIdxMap=u,i.nodeStrength=(0,Po.proccessToFunc)(i.nodeStrength,1),i.edgeStrength=(0,Po.proccessToFunc)(i.edgeStrength,1),i.run(t,r)}},n.prototype.run=function(t,r){return x1(this,void 0,void 0,function(){var i,o,a,s,u,c,l,h,f,d,p,g,v,m,y,b,x,w,E,M,_,k,S,C,T,A,D,j=this;return w1(this,function(L){switch(L.label){case 0:for(o=(i=this).nodes,a=i.edges,s=i.maxIteration,i.width||typeof window>"u"||(i.width=window.innerWidth),i.height||typeof window>"u"||(i.height=window.innerHeight),u=o.length,i.linkDistance=(0,Po.proccessToFunc)(i.linkDistance),i.edgeStrength=(0,Po.proccessToFunc)(i.edgeStrength),c=(0,Po.buildTextureDataWithTwoEdgeAttr)(o,a,i.linkDistance,i.edgeStrength),l=c.maxEdgePerVetex,h=c.array,i.degrees=(0,FX.getDegree)(o.length,i.nodeIdxMap,a).map(function(B){return B.all}),f=[],d=[],p=[],g=[],v=[],m=[],y=[],i.getMass||(i.getMass=function(B){return i.degrees[i.nodeIdxMap[B.id]]||1}),b=i.gravity,x=i.center,o.forEach(function(B,N){f.push(i.getMass(B)),d.push(i.nodeStrength(B)),i.degrees[N]||(i.degrees[N]=0);var R=[x[0],x[1],b];if(i.getCenter){var P=i.getCenter(B,i.degrees[N]);P&&(0,Do.isNumber)(P[0])&&(0,Do.isNumber)(P[1])&&(0,Do.isNumber)(P[2])&&(R=P)}p.push(R[0]),g.push(R[1]),v.push(R[2]),(0,Do.isNumber)(B.fx)&&(0,Do.isNumber)(B.fy)?(m.push(B.fx||.001),y.push(B.fy||.001)):(m.push(0),y.push(0))}),w=(0,Po.arrayToTextureData)([f,i.degrees,d,m]),E=(0,Po.arrayToTextureData)([p,g,v,y]),M=i.workerEnabled,_=M?j3.World.create({canvas:t,engineOptions:{supportCompute:!0}}):j3.World.create({engineOptions:{supportCompute:!0}}),k=i.onLayoutEnd,S=[],h.forEach(function(B){S.push(B)}),C=0;C<4;C++)S.push(0);return T=_.createKernel(B3.gForceBundle).setDispatch([u,1,1]).setBinding({u_Data:h,u_damping:i.damping,u_maxSpeed:i.maxSpeed,u_minMovement:i.minMovement,u_coulombDisScale:i.coulombDisScale,u_factor:i.factor,u_NodeAttributeArray1:w,u_NodeAttributeArray2:E,MAX_EDGE_PER_VERTEX:l,VERTEX_COUNT:u,u_AveMovement:S,u_interval:i.interval}),A=_.createKernel(B3.aveMovementBundle).setDispatch([1,1,1]).setBinding({u_Data:h,VERTEX_COUNT:u,u_AveMovement:[0,0,0,0]}),D=function(){return x1(j,void 0,void 0,function(){var B,N,R;return w1(this,function(P){switch(P.label){case 0:B=0,P.label=1;case 1:return B<s?[4,T.execute()]:[3,5];case 2:return P.sent(),A.setBinding({u_Data:T}),[4,A.execute()];case 3:P.sent(),N=Math.max(.02,i.interval-.002*B),T.setBinding({u_interval:N,u_AveMovement:A}),P.label=4;case 4:return B++,[3,1];case 5:return[4,T.getOutput()];case 6:return R=P.sent(),t?r.postMessage({type:GX.LAYOUT_MESSAGE.GPUEND,vertexEdgeData:R}):o.forEach(function(H,ne){var Z=R[4*ne],q=R[4*ne+1];H.x=Z,H.y=q}),k&&k(),[2]}})})},[4,D()];case 1:return L.sent(),[2]}})})},n.prototype.getType=function(){return"gForce-gpu"},n}(zX.Base);Pl.GForceGPULayout=UX;var Ll={},XX=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(Ll,"__esModule",{value:!0}),Ll.ComboForceLayout=void 0;var YX=Nn,Zt=_n(),WX=function(e){function n(t){var r=e.call(this)||this;return r.center=[0,0],r.maxIteration=100,r.gravity=10,r.comboGravity=10,r.linkDistance=10,r.alpha=1,r.alphaMin=.001,r.alphaDecay=1-Math.pow(r.alphaMin,1/300),r.alphaTarget=0,r.velocityDecay=.6,r.edgeStrength=.6,r.nodeStrength=30,r.preventOverlap=!1,r.preventNodeOverlap=!1,r.preventComboOverlap=!1,r.collideStrength=void 0,r.nodeCollideStrength=.5,r.comboCollideStrength=.5,r.comboSpacing=20,r.comboPadding=10,r.optimizeRangeFactor=1,r.onTick=function(){},r.onLayoutEnd=function(){},r.depthAttractiveForceScale=1,r.depthRepulsiveForceScale=2,r.nodes=[],r.edges=[],r.combos=[],r.comboTrees=[],r.width=300,r.height=300,r.bias=[],r.nodeMap={},r.oriComboMap={},r.indexMap={},r.comboMap={},r.previousLayouted=!1,r.updateCfg(t),r}return XX(n,e),n.prototype.getDefaultCfg=function(){return{maxIteration:100,center:[0,0],gravity:10,speed:1,comboGravity:30,preventOverlap:!1,preventComboOverlap:!0,preventNodeOverlap:!0,nodeSpacing:void 0,collideStrength:void 0,nodeCollideStrength:.5,comboCollideStrength:.5,comboSpacing:20,comboPadding:10,edgeStrength:.6,nodeStrength:30,linkDistance:10}},n.prototype.execute=function(){var t=this,r=t.nodes,i=t.center;if(t.comboTree={id:"comboTreeRoot",depth:-1,children:t.comboTrees},r&&r.length!==0){if(r.length===1)return r[0].x=i[0],r[0].y=i[1],void(t.onLayoutEnd&&t.onLayoutEnd());t.initVals(),t.run(),t.onLayoutEnd&&t.onLayoutEnd()}else t.onLayoutEnd&&t.onLayoutEnd()},n.prototype.run=function(){var t=this,r=t.nodes,i=t.previousLayouted?t.maxIteration/5:t.maxIteration;t.width||typeof window>"u"||(t.width=window.innerWidth),t.height||typeof window>"u"||(t.height=window.innerHeight);var o=t.center,a=t.velocityDecay,s=t.comboMap;t.previousLayouted||t.initPos(s);for(var u=function(f){var d=[];r.forEach(function(p,g){d[g]={x:0,y:0}}),t.applyCalculate(d),t.applyComboCenterForce(d),r.forEach(function(p,g){(0,Zt.isNumber)(p.x)&&(0,Zt.isNumber)(p.y)&&(p.x+=d[g].x*a,p.y+=d[g].y*a)}),t.alpha+=(t.alphaTarget-t.alpha)*t.alphaDecay,t.onTick()},c=0;c<i;c++)u();var l=[0,0];r.forEach(function(f){(0,Zt.isNumber)(f.x)&&(0,Zt.isNumber)(f.y)&&(l[0]+=f.x,l[1]+=f.y)}),l[0]/=r.length,l[1]/=r.length;var h=[o[0]-l[0],o[1]-l[1]];r.forEach(function(f,d){(0,Zt.isNumber)(f.x)&&(0,Zt.isNumber)(f.y)&&(f.x+=h[0],f.y+=h[1])}),t.combos.forEach(function(f){var d=s[f.id];d&&d.empty&&(f.x=d.cx||f.x,f.y=d.cy||f.y)}),t.previousLayouted=!0},n.prototype.initVals=function(){var t=this,r=t.edges,i=t.nodes,o=t.combos,a={},s={},u={};i.forEach(function(L,B){s[L.id]=L,u[L.id]=B}),t.nodeMap=s,t.indexMap=u;var c={};o.forEach(function(L){c[L.id]=L}),t.oriComboMap=c,t.comboMap=t.getComboMap();var l=t.preventOverlap;t.preventComboOverlap=t.preventComboOverlap||l,t.preventNodeOverlap=t.preventNodeOverlap||l;var h=t.collideStrength;h&&(t.comboCollideStrength=h,t.nodeCollideStrength=h),t.comboCollideStrength=t.comboCollideStrength?t.comboCollideStrength:0,t.nodeCollideStrength=t.nodeCollideStrength?t.nodeCollideStrength:0;for(var f=0;f<r.length;++f){var d=(0,Zt.getEdgeTerminal)(r[f],"source"),p=(0,Zt.getEdgeTerminal)(r[f],"target");a[d]?a[d]++:a[d]=1,a[p]?a[p]++:a[p]=1}var g=[];for(f=0;f<r.length;++f)d=(0,Zt.getEdgeTerminal)(r[f],"source"),p=(0,Zt.getEdgeTerminal)(r[f],"target"),g[f]=a[d]/(a[d]+a[p]);this.bias=g;var v,m,y=t.nodeSize,b=t.nodeSpacing;if(m=(0,Zt.isNumber)(b)?function(){return b}:(0,Zt.isFunction)(b)?b:function(){return 0},this.nodeSpacing=m,y)if((0,Zt.isFunction)(y))v=function(L){return y(L)};else if((0,Zt.isArray)(y)){var x=(y[0]>y[1]?y[0]:y[1])/2;v=function(L){return x}}else{var w=y/2;v=function(L){return w}}else v=function(L){return L.size?(0,Zt.isArray)(L.size)?(L.size[0]>L.size[1]?L.size[0]:L.size[1])/2:(0,Zt.isObject)(L.size)?(L.size.width>L.size.height?L.size.width:L.size.height)/2:L.size/2:10};this.nodeSize=v;var E,M=t.comboSpacing;E=(0,Zt.isNumber)(M)?function(){return M}:(0,Zt.isFunction)(M)?M:function(){return 0},this.comboSpacing=E;var _,k=t.comboPadding;_=(0,Zt.isNumber)(k)?function(){return k}:(0,Zt.isArray)(k)?function(){return Math.max.apply(null,k)}:(0,Zt.isFunction)(k)?k:function(){return 0},this.comboPadding=_;var S,C=this.linkDistance;C||(C=10),S=(0,Zt.isNumber)(C)?function(L){return C}:C,this.linkDistance=S;var T,A=this.edgeStrength;A||(A=1),T=(0,Zt.isNumber)(A)?function(L){return A}:A,this.edgeStrength=T;var D,j=this.nodeStrength;j||(j=30),D=(0,Zt.isNumber)(j)?function(L){return j}:j,this.nodeStrength=D},n.prototype.initPos=function(t){this.nodes.forEach(function(r,i){var o=r.comboId,a=t[o];o&&a?(r.x=a.cx+100/(i+1),r.y=a.cy+100/(i+1)):(r.x=100/(i+1),r.y=100/(i+1))})},n.prototype.getComboMap=function(){var t=this,r=t.nodeMap,i=t.comboTrees,o=t.oriComboMap,a={};return(i||[]).forEach(function(s){var u=[];(0,Zt.traverseTreeUp)(s,function(c){if(c.itemType==="node"||!o[c.id])return!0;if(a[c.id]===void 0){var l={id:c.id,name:c.id,cx:0,cy:0,count:0,depth:t.oriComboMap[c.id].depth||0,children:[]};a[c.id]=l}var h=c.children;h&&h.forEach(function(p){if(!a[p.id]&&!r[p.id])return!0;u.push(p)});var f=a[c.id];if(f.cx=0,f.cy=0,u.length===0){f.empty=!0;var d=o[c.id];f.cx=d.x,f.cy=d.y}return u.forEach(function(p){if(f.count++,p.itemType!=="node"){var g=a[p.id];return(0,Zt.isNumber)(g.cx)&&(f.cx+=g.cx),void((0,Zt.isNumber)(g.cy)&&(f.cy+=g.cy))}var v=r[p.id];v&&((0,Zt.isNumber)(v.x)&&(f.cx+=v.x),(0,Zt.isNumber)(v.y)&&(f.cy+=v.y))}),f.cx/=f.count||1,f.cy/=f.count||1,f.children=u,!0})}),a},n.prototype.applyComboCenterForce=function(t){var r=this,i=r.gravity,o=r.comboGravity||i,a=this.alpha,s=r.comboTrees,u=r.indexMap,c=r.nodeMap,l=r.comboMap;(s||[]).forEach(function(h){(0,Zt.traverseTreeUp)(h,function(f){if(f.itemType==="node"||!l[f.id])return!0;var d=l[f.id],p=(d.depth+1)/10*.5,g=d.cx,v=d.cy;return d.cx=0,d.cy=0,d.children.forEach(function(m){if(m.itemType!=="node"){var y=l[m.id];return y&&(0,Zt.isNumber)(y.cx)&&(d.cx+=y.cx),void(y&&(0,Zt.isNumber)(y.cy)&&(d.cy+=y.cy))}var b=c[m.id],x=b.x-g||.005,w=b.y-v||.005,E=Math.sqrt(x*x+w*w),M=u[b.id],_=o*a/E*p;t[M].x-=x*_,t[M].y-=w*_,(0,Zt.isNumber)(b.x)&&(d.cx+=b.x),(0,Zt.isNumber)(b.y)&&(d.cy+=b.y)}),d.cx/=d.count||1,d.cy/=d.count||1,!0})})},n.prototype.applyCalculate=function(t){var r=this,i=r.comboMap,o=r.nodes,a={};o.forEach(function(s,u){o.forEach(function(c,l){if(!(u<l)){var h=s.x-c.x||.005,f=s.y-c.y||.005,d=h*h+f*f,p=Math.sqrt(d);d<1&&(d=p),a["".concat(s.id,"-").concat(c.id)]={vx:h,vy:f,vl2:d,vl:p},a["".concat(c.id,"-").concat(s.id)]={vl2:d,vl:p,vx:-h,vy:-f}}})}),r.updateComboSizes(i),r.calRepulsive(t,a),r.calAttractive(t,a),r.preventComboOverlap&&r.comboNonOverlapping(t,i)},n.prototype.updateComboSizes=function(t){var r=this,i=r.comboTrees,o=r.nodeMap,a=r.nodeSize,s=r.comboSpacing,u=r.comboPadding;(i||[]).forEach(function(c){var l=[];(0,Zt.traverseTreeUp)(c,function(h){if(h.itemType==="node")return!0;var f=t[h.id];if(!f)return!1;var d=h.children;d&&d.forEach(function(v){(t[v.id]||o[v.id])&&l.push(v)}),f.minX=1/0,f.minY=1/0,f.maxX=-1/0,f.maxY=-1/0,l.forEach(function(v){if(v.itemType!=="node")return!0;var m=o[v.id];if(!m)return!0;var y=a(m),b=m.x-y,x=m.y-y,w=m.x+y,E=m.y+y;f.minX>b&&(f.minX=b),f.minY>x&&(f.minY=x),f.maxX<w&&(f.maxX=w),f.maxY<E&&(f.maxY=E)});var p=r.oriComboMap[h.id].size||10;(0,Zt.isArray)(p)&&(p=p[0]);var g=Math.max(f.maxX-f.minX,f.maxY-f.minY,p);return f.r=g/2+s(f)/2+u(f),!0})})},n.prototype.comboNonOverlapping=function(t,r){var i=this,o=i.comboTree,a=i.comboCollideStrength,s=i.indexMap,u=i.nodeMap;(0,Zt.traverseTreeUp)(o,function(c){if(!r[c.id]&&!u[c.id]&&c.id!=="comboTreeRoot")return!1;var l=c.children;return l&&l.length>1&&l.forEach(function(h,f){if(h.itemType==="node")return!1;var d=r[h.id];d&&l.forEach(function(p,g){if(f<=g||p.itemType==="node")return!1;var v=r[p.id];if(!v)return!1;var m=d.cx-v.cx||.005,y=d.cy-v.cy||.005,b=m*m+y*y,x=d.r||1,w=v.r||1,E=x+w,M=w*w,_=x*x;if(b<E*E){var k=h.children;if(!k||k.length===0)return!1;var S=p.children;if(!S||S.length===0)return!1;var C=Math.sqrt(b),T=(E-C)/C*a,A=m*T,D=y*T,j=M/(_+M),L=1-j;k.forEach(function(B){if(B.itemType!=="node")return!1;if(u[B.id]){var N=s[B.id];S.forEach(function(R){if(R.itemType!=="node"||!u[R.id])return!1;var P=s[R.id];t[N].x+=A*j,t[N].y+=D*j,t[P].x-=A*L,t[P].y-=D*L})}})}})}),!0})},n.prototype.calRepulsive=function(t,r){var i=this,o=i.nodes,a=i.width*i.optimizeRangeFactor,s=i.nodeStrength,u=i.alpha,c=i.nodeCollideStrength,l=i.preventNodeOverlap,h=i.nodeSize,f=i.nodeSpacing,d=i.depthRepulsiveForceScale,p=i.center;o.forEach(function(g,v){if(g.x&&g.y){if(p){var m=i.gravity,y=g.x-p[0]||.005,b=g.y-p[1]||.005,x=Math.sqrt(y*y+b*b);t[v].x-=y*m*u/x,t[v].y-=b*m*u/x}o.forEach(function(w,E){if(v!==E&&w.x&&w.y){var M=r["".concat(g.id,"-").concat(w.id)],_=M.vl2,k=M.vl;if(!(k>a)){var S=r["".concat(g.id,"-").concat(w.id)],C=S.vx,T=S.vy,A=Math.log(Math.abs(w.depth-g.depth)/10)+1||1;A=A<1?1:A,w.comboId!==g.comboId&&(A+=1);var D=A?Math.pow(d,A):1,j=s(w)*u/_*D;if(t[v].x+=C*j,t[v].y+=T*j,v<E&&l){var L=h(g)+f(g)||1,B=h(w)+f(w)||1,N=L+B;if(_<N*N){var R=(N-k)/k*c,P=B*B,H=P/(L*L+P),ne=C*R,Z=T*R;t[v].x+=ne*H,t[v].y+=Z*H,H=1-H,t[E].x-=ne*H,t[E].y-=Z*H}}}}})}})},n.prototype.calAttractive=function(t,r){var i=this,o=i.edges,a=i.linkDistance,s=i.alpha,u=i.edgeStrength,c=i.bias,l=i.depthAttractiveForceScale;o.forEach(function(h,f){var d=(0,Zt.getEdgeTerminal)(h,"source"),p=(0,Zt.getEdgeTerminal)(h,"target");if(d&&p&&d!==p){var g=i.indexMap[d],v=i.indexMap[p],m=i.nodeMap[d],y=i.nodeMap[p];if(m&&y){var b=m.depth===y.depth?0:Math.log(Math.abs(m.depth-y.depth)/10);m.comboId===y.comboId&&(b/=2);var x=b?Math.pow(l,b):1;if(m.comboId!==y.comboId&&x===1?x=l/2:m.comboId===y.comboId&&(x=2),(0,Zt.isNumber)(y.x)&&(0,Zt.isNumber)(m.x)&&(0,Zt.isNumber)(y.y)&&(0,Zt.isNumber)(m.y)){var w=r["".concat(p,"-").concat(d)],E=w.vl,M=w.vx,_=w.vy,k=(E-a(h))/E*s*u(h)*x,S=M*k,C=_*k,T=c[f];t[v].x-=S*T,t[v].y-=C*T,t[g].x+=S*(1-T),t[g].y+=C*(1-T)}}}})},n.prototype.getType=function(){return"comboForce"},n}(YX.Base);Ll.ComboForceLayout=WX;var z3,Rl={};function F3(){if(z3)return Rl;z3=1;var e=xe&&xe.__extends||function(){var s=function(u,c){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,h){l.__proto__=h}||function(l,h){for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(l[f]=h[f])},s(u,c)};return function(u,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");function l(){this.constructor=u}s(u,c),u.prototype=c===null?Object.create(c):(l.prototype=c.prototype,new l)}}(),n=xe&&xe.__assign||function(){return n=Object.assign||function(s){for(var u,c=1,l=arguments.length;c<l;c++)for(var h in u=arguments[c])Object.prototype.hasOwnProperty.call(u,h)&&(s[h]=u[h]);return s},n.apply(this,arguments)};Object.defineProperty(Rl,"__esModule",{value:!0}),Rl.ComboCombinedLayout=void 0;var t=Eo,r=Nn,i=_n(),o=$3(),a=function(s){function u(c){var l=s.call(this)||this;return l.center=[0,0],l.nodes=[],l.edges=[],l.combos=[],l.comboEdges=[],l.comboPadding=10,l.comboTrees=[],l.updateCfg(c),l}return e(u,s),u.prototype.getDefaultCfg=function(){return{}},u.prototype.execute=function(){var c=this,l=c.nodes,h=c.center;if(l&&l.length!==0){if(l.length===1)return l[0].x=h[0],l[0].y=h[1],void(c.onLayoutEnd&&c.onLayoutEnd());c.initVals(),c.run(),c.onLayoutEnd&&c.onLayoutEnd()}else c.onLayoutEnd&&c.onLayoutEnd()},u.prototype.run=function(){var c,l=this,h=l.nodes,f=l.edges,d=l.combos,p=l.comboEdges,g=l.center,v={};h.forEach(function(D){v[D.id]=D});var m={};d.forEach(function(D){m[D.id]=D});var y=l.getInnerGraphs(v),b=[],x=[],w={},E=!0;this.comboTrees.forEach(function(D){var j=y[D.id];if(j){var L=n(n({},D),{x:j.x||m[D.id].x,y:j.y||m[D.id].y,fx:j.fx||m[D.id].fx,fy:j.fy||m[D.id].fy,mass:j.mass||m[D.id].mass,size:j.size});x.push(L),isNaN(L.x)||L.x===0||isNaN(L.y)||L.y===0?(L.x=100*Math.random(),L.y=100*Math.random()):E=!1,b.push(D.id),(0,i.traverseTreeUp)(D,function(B){return B.id!==D.id&&(w[B.id]=D.id),!0})}}),h.forEach(function(D){if(!D.comboId||!m[D.comboId]){var j=n({},D);x.push(j),isNaN(j.x)||j.x===0||isNaN(j.y)||j.y===0?(j.x=100*Math.random(),j.y=100*Math.random()):E=!1,b.push(D.id)}});var M=[];if(f.concat(p).forEach(function(D){var j=w[D.source]||D.source,L=w[D.target]||D.target;j!==L&&b.includes(j)&&b.includes(L)&&M.push({source:j,target:L})}),x==null?void 0:x.length){if(x.length===1)x[0].x=g[0],x[0].y=g[1];else{var _={nodes:x,edges:M},k=this.outerLayout||new o.GForceLayout({gravity:1,factor:4,linkDistance:function(D,j,L){var B,N,R=((((B=j.size)===null||B===void 0?void 0:B[0])||30)+(((N=L.size)===null||N===void 0?void 0:N[0])||30))/2;return Math.min(1.5*R,700)}}),S=(c=k.getType)===null||c===void 0?void 0:c.call(k);k.updateCfg({center:g,kg:5,preventOverlap:!0,animate:!1}),E&&t.FORCE_LAYOUT_TYPE_MAP[S]&&(x.length<100?new o.MDSLayout:new o.GridLayout).layout(_),k.layout(_)}x.forEach(function(D){var j=y[D.id];if(j)j.visited=!0,j.x=D.x,j.y=D.y,j.nodes.forEach(function(B){B.x+=D.x,B.y+=D.y});else{var L=v[D.id];L&&(L.x=D.x,L.y=D.y)}})}for(var C=Object.keys(y),T=function(D){var j=C[D],L=y[j];if(!L)return"continue";L.nodes.forEach(function(B){L.visited||(B.x+=L.x||0,B.y+=L.y||0),v[B.id]&&(v[B.id].x=B.x,v[B.id].y=B.y)}),m[j]&&(m[j].x=L.x,m[j].y=L.y)},A=C.length-1;A>=0;A--)T(A);return{nodes:h,edges:f,combos:d,comboEdges:p}},u.prototype.getInnerGraphs=function(c){var l=this,h=l.comboTrees,f=l.nodeSize,d=l.edges,p=l.comboPadding,g=l.spacing,v={},m=this.innerLayout||new o.ConcentricLayout({type:"concentric",sortBy:"id"});return m.center=[0,0],m.preventOverlap=!0,m.nodeSpacing=g,(h||[]).forEach(function(y){(0,i.traverseTreeUp)(y,function(b){var x,w=(p==null?void 0:p(b))||10;if((0,i.isArray)(w)&&(w=Math.max.apply(Math,w)),(x=b.children)===null||x===void 0?void 0:x.length){var E=b.children.map(function(R){if(R.itemType==="combo")return v[R.id];var P=c[R.id]||{};return n(n({},P),R)}),M=E.map(function(R){return R.id}),_={nodes:E,edges:d.filter(function(R){return M.includes(R.source)&&M.includes(R.target)})},k=1/0;E.forEach(function(R){var P;R.size||(R.size=((P=v[R.id])===null||P===void 0?void 0:P.size)||(f==null?void 0:f(R))||[30,30]),(0,i.isNumber)(R.size)&&(R.size=[R.size,R.size]),k>R.size[0]&&(k=R.size[0]),k>R.size[1]&&(k=R.size[1])}),m.layout(_);var S=(0,i.getLayoutBBox)(E),C=S.minX,T=S.minY,A=S.maxX,D=S.maxY,j={x:(A+C)/2,y:(D+T)/2};_.nodes.forEach(function(R){R.x-=j.x,R.y-=j.y});var L=Math.max(A-C,k)+2*w,B=Math.max(D-T,k)+2*w;v[b.id]={id:b.id,nodes:E,size:[L,B]}}else if(b.itemType==="combo"){var N=w?[2*w,2*w]:[30,30];v[b.id]={id:b.id,nodes:[],size:N}}return!0})}),v},u.prototype.initVals=function(){var c,l,h=this,f=h.nodeSize,d=h.spacing;if(l=(0,i.isNumber)(d)?function(){return d}:(0,i.isFunction)(d)?d:function(){return 0},this.spacing=l,f)if((0,i.isFunction)(f))c=function(y){var b=f(y),x=l(y);return(0,i.isArray)(y.size)?((y.size[0]>y.size[1]?y.size[0]:y.size[1])+x)/2:((b||10)+x)/2};else if((0,i.isArray)(f)){var p=(f[0]>f[1]?f[0]:f[1])/2;c=function(y){return p+l(y)/2}}else{var g=f/2;c=function(y){return g+l(y)/2}}else c=function(y){var b=l(y);return y.size?(0,i.isArray)(y.size)?((y.size[0]>y.size[1]?y.size[0]:y.size[1])+b)/2:(0,i.isObject)(y.size)?((y.size.width>y.size.height?y.size.width:y.size.height)+b)/2:(y.size+b)/2:10+b/2};this.nodeSize=c;var v,m=h.comboPadding;v=(0,i.isNumber)(m)?function(){return m}:(0,i.isArray)(m)?function(){return Math.max.apply(null,m)}:(0,i.isFunction)(m)?m:function(){return 0},this.comboPadding=v},u.prototype.getType=function(){return"comboCombined"},u}(r.Base);return Rl.ComboCombinedLayout=a,Rl}var jl={},E1={};Object.defineProperty(E1,"__esModule",{value:!0});var VX=function(){function e(n){this.id=n.id||0,this.rx=n.rx,this.ry=n.ry,this.fx=0,this.fy=0,this.mass=n.mass,this.degree=n.degree,this.g=n.g||0}return e.prototype.distanceTo=function(n){var t=this.rx-n.rx,r=this.ry-n.ry;return Math.hypot(t,r)},e.prototype.setPos=function(n,t){this.rx=n,this.ry=t},e.prototype.resetForce=function(){this.fx=0,this.fy=0},e.prototype.addForce=function(n){var t=n.rx-this.rx,r=n.ry-this.ry,i=Math.hypot(t,r);i=i<1e-4?1e-4:i;var o=this.g*(this.degree+1)*(n.degree+1)/i;this.fx+=o*t/i,this.fy+=o*r/i},e.prototype.in=function(n){return n.contains(this.rx,this.ry)},e.prototype.add=function(n){var t=this.mass+n.mass;return new e({rx:(this.rx*this.mass+n.rx*n.mass)/t,ry:(this.ry*this.mass+n.ry*n.mass)/t,mass:t,degree:this.degree+n.degree})},e}();E1.default=VX;var M1={};Object.defineProperty(M1,"__esModule",{value:!0});var HX=function(){function e(n){this.xmid=n.xmid,this.ymid=n.ymid,this.length=n.length,this.massCenter=n.massCenter||[0,0],this.mass=n.mass||1}return e.prototype.getLength=function(){return this.length},e.prototype.contains=function(n,t){var r=this.length/2;return n<=this.xmid+r&&n>=this.xmid-r&&t<=this.ymid+r&&t>=this.ymid-r},e.prototype.NW=function(){return new e({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},e.prototype.NE=function(){return new e({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},e.prototype.SW=function(){return new e({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},e.prototype.SE=function(){return new e({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},e}();M1.default=HX;var S1={};Object.defineProperty(S1,"__esModule",{value:!0});var qX=function(){function e(n){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,n!=null&&(this.quad=n)}return e.prototype.insert=function(n){this.body!=null?this._isExternal()?(this.quad&&(this.NW=new e(this.quad.NW()),this.NE=new e(this.quad.NE()),this.SW=new e(this.quad.SW()),this.SE=new e(this.quad.SE())),this._putBody(this.body),this._putBody(n),this.body=this.body.add(n)):(this.body=this.body.add(n),this._putBody(n)):this.body=n},e.prototype._putBody=function(n){this.quad&&(n.in(this.quad.NW())&&this.NW?this.NW.insert(n):n.in(this.quad.NE())&&this.NE?this.NE.insert(n):n.in(this.quad.SW())&&this.SW?this.SW.insert(n):n.in(this.quad.SE())&&this.SE&&this.SE.insert(n))},e.prototype._isExternal=function(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null},e.prototype.updateForce=function(n){this.body!=null&&n!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(n)<this.theta?n.addForce(this.body):(this.NW&&this.NW.updateForce(n),this.NE&&this.NE.updateForce(n),this.SW&&this.SW.updateForce(n),this.SE&&this.SE.updateForce(n)))},e}();S1.default=qX;var ZX=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),_1=xe&&xe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(jl,"__esModule",{value:!0}),jl.ForceAtlas2Layout=void 0;var KX=Nn,Lo=_n(),$X=_1(E1),QX=_1(M1),JX=_1(S1),eY=function(e){function n(t){var r=e.call(this)||this;return r.center=[0,0],r.width=300,r.height=300,r.nodes=[],r.edges=[],r.kr=5,r.kg=1,r.mode="normal",r.preventOverlap=!1,r.dissuadeHubs=!1,r.barnesHut=void 0,r.maxIteration=0,r.ks=.1,r.ksmax=10,r.tao=.1,r.onLayoutEnd=function(){},r.prune=void 0,r.updateCfg(t),r}return ZX(n,e),n.prototype.getDefaultCfg=function(){return{}},n.prototype.execute=function(){var t=this,r=t.nodes,i=t.onLayoutEnd,o=t.prune,a=t.maxIteration;t.width||typeof window>"u"||(t.width=window.innerWidth),t.height||typeof window>"u"||(t.height=window.innerHeight);for(var s=[],u=r.length,c=0;c<u;c+=1){var l=r[c],h=10,f=10;(0,Lo.isNumber)(l.size)&&(h=l.size,f=l.size),(0,Lo.isArray)(l.size)?(isNaN(l.size[0])||(h=l.size[0]),isNaN(l.size[1])||(f=l.size[1])):(0,Lo.isObject)(l.size)&&(h=l.size.width,f=l.size.height),t.getWidth&&!isNaN(t.getWidth(l))&&(f=t.getWidth(l)),t.getHeight&&!isNaN(t.getHeight(l))&&(h=t.getHeight(l));var d=Math.max(h,f);s.push(d)}t.barnesHut===void 0&&u>250&&(t.barnesHut=!0),t.prune===void 0&&u>100&&(t.prune=!0),this.maxIteration!==0||t.prune?this.maxIteration===0&&o&&(a=100,u<=200&&u>100?a=500:u>200&&(a=950),this.maxIteration=a):(a=250,u<=200&&u>100?a=1e3:u>200&&(a=1200),this.maxIteration=a),t.kr||(t.kr=50,u>100&&u<=500?t.kr=20:u>500&&(t.kr=1)),t.kg||(t.kg=20,u>100&&u<=500?t.kg=10:u>500&&(t.kg=1)),this.nodes=t.updateNodesByForces(s),i()},n.prototype.updateNodesByForces=function(t){for(var r=this,i=r.edges,o=r.maxIteration,a=r.nodes,s=i.filter(function(M){return(0,Lo.getEdgeTerminal)(M,"source")!==(0,Lo.getEdgeTerminal)(M,"target")}),u=a.length,c=s.length,l=[],h={},f={},d=[],p=0;p<u;p+=1)h[a[p].id]=p,l[p]=0,(a[p].x===void 0||isNaN(a[p].x))&&(a[p].x=1e3*Math.random()),(a[p].y===void 0||isNaN(a[p].y))&&(a[p].y=1e3*Math.random()),d.push({x:a[p].x,y:a[p].y});for(p=0;p<c;p+=1){for(var g=void 0,v=void 0,m=0,y=0,b=0;b<u;b+=1){var x=(0,Lo.getEdgeTerminal)(s[p],"source"),w=(0,Lo.getEdgeTerminal)(s[p],"target");a[b].id===x?(g=a[b],m=b):a[b].id===w&&(v=a[b],y=b),f[p]={sourceIdx:m,targetIdx:y}}g&&(l[h[g.id]]+=1),v&&(l[h[v.id]]+=1)}var E=o;if(a=this.iterate(E,h,f,c,l,t),r.prune){for(b=0;b<c;b+=1)l[f[b].sourceIdx]<=1?(a[f[b].sourceIdx].x=a[f[b].targetIdx].x,a[f[b].sourceIdx].y=a[f[b].targetIdx].y):l[f[b].targetIdx]<=1&&(a[f[b].targetIdx].x=a[f[b].sourceIdx].x,a[f[b].targetIdx].y=a[f[b].sourceIdx].y);r.prune=!1,r.barnesHut=!1,E=100,a=this.iterate(E,h,f,c,l,t)}return a},n.prototype.iterate=function(t,r,i,o,a,s){for(var u=this,c=u.nodes,l=u.kr,h=u.preventOverlap,f=u.barnesHut,d=c.length,p=0,g=t,v=[],m=[],y=[],b=0;b<d;b+=1)if(v[2*b]=0,v[2*b+1]=0,f){var x={id:b,rx:c[b].x,ry:c[b].y,mass:1,g:l,degree:a[b]};y[b]=new $X.default(x)}for(;g>0;){for(b=0;b<d;b+=1)m[2*b]=v[2*b],m[2*b+1]=v[2*b+1],v[2*b]=0,v[2*b+1]=0;v=this.getAttrForces(g,50,o,r,i,a,s,v),v=f&&(h&&g>50||!h)?this.getOptRepGraForces(v,y,a):this.getRepGraForces(g,50,v,100,s,a);var w=this.updatePos(v,m,p,a);c=w.nodes,p=w.sg,g--,u.tick&&u.tick()}return c},n.prototype.getAttrForces=function(t,r,i,o,a,s,u,c){for(var l=this,h=l.nodes,f=l.preventOverlap,d=l.dissuadeHubs,p=l.mode,g=l.prune,v=0;v<i;v+=1){var m=h[a[v].sourceIdx],y=a[v].sourceIdx,b=h[a[v].targetIdx],x=a[v].targetIdx;if(!g||!(s[y]<=1||s[x]<=1)){var w=[b.x-m.x,b.y-m.y],E=Math.hypot(w[0],w[1]);E=E<1e-4?1e-4:E,w[0]=w[0]/E,w[1]=w[1]/E,f&&t<r&&(E=E-u[y]-u[x]);var M=E,_=M;p==="linlog"&&(_=M=Math.log(1+E)),d&&(M=E/s[y],_=E/s[x]),f&&t<r&&E<=0?(M=0,_=0):f&&t<r&&E>0&&(M=E,_=E),c[2*o[m.id]]+=M*w[0],c[2*o[b.id]]-=_*w[0],c[2*o[m.id]+1]+=M*w[1],c[2*o[b.id]+1]-=_*w[1]}}return c},n.prototype.getRepGraForces=function(t,r,i,o,a,s){for(var u=this,c=u.nodes,l=u.preventOverlap,h=u.kr,f=u.kg,d=u.center,p=u.prune,g=c.length,v=0;v<g;v+=1){for(var m=v+1;m<g;m+=1)if(!p||!(s[v]<=1||s[m]<=1)){var y=[c[m].x-c[v].x,c[m].y-c[v].y],b=Math.hypot(y[0],y[1]);b=b<1e-4?1e-4:b,y[0]=y[0]/b,y[1]=y[1]/b,l&&t<r&&(b=b-a[v]-a[m]);var x=h*(s[v]+1)*(s[m]+1)/b;l&&t<r&&b<0?x=o*(s[v]+1)*(s[m]+1):l&&t<r&&b===0?x=0:l&&t<r&&b>0&&(x=h*(s[v]+1)*(s[m]+1)/b),i[2*v]-=x*y[0],i[2*m]+=x*y[0],i[2*v+1]-=x*y[1],i[2*m+1]+=x*y[1]}var w=[c[v].x-d[0],c[v].y-d[1]],E=Math.hypot(w[0],w[1]);w[0]=w[0]/E,w[1]=w[1]/E;var M=f*(s[v]+1);i[2*v]-=M*w[0],i[2*v+1]-=M*w[1]}return i},n.prototype.getOptRepGraForces=function(t,r,i){for(var o=this,a=o.nodes,s=o.kg,u=o.center,c=o.prune,l=a.length,h=9e10,f=-9e10,d=9e10,p=-9e10,g=0;g<l;g+=1)c&&i[g]<=1||(r[g].setPos(a[g].x,a[g].y),a[g].x>=f&&(f=a[g].x),a[g].x<=h&&(h=a[g].x),a[g].y>=p&&(p=a[g].y),a[g].y<=d&&(d=a[g].y));var v={xmid:(f+h)/2,ymid:(p+d)/2,length:Math.max(f-h,p-d),massCenter:u,mass:l},m=new QX.default(v),y=new JX.default(m);for(g=0;g<l;g+=1)c&&i[g]<=1||r[g].in(m)&&y.insert(r[g]);for(g=0;g<l;g+=1)if(!(c&&i[g]<=1)){r[g].resetForce(),y.updateForce(r[g]),t[2*g]-=r[g].fx,t[2*g+1]-=r[g].fy;var b=[a[g].x-u[0],a[g].y-u[1]],x=Math.hypot(b[0],b[1]);x=x<1e-4?1e-4:x,b[0]=b[0]/x,b[1]=b[1]/x;var w=s*(i[g]+1);t[2*g]-=w*b[0],t[2*g+1]-=w*b[1]}return t},n.prototype.updatePos=function(t,r,i,o){for(var a=this,s=a.nodes,u=a.ks,c=a.tao,l=a.prune,h=a.ksmax,f=s.length,d=[],p=[],g=0,v=0,m=0;m<f;m+=1)if(!(l&&o[m]<=1)){var y=[t[2*m]-r[2*m],t[2*m+1]-r[2*m+1]],b=Math.hypot(y[0],y[1]),x=[t[2*m]+r[2*m],t[2*m+1]+r[2*m+1]],w=Math.hypot(x[0],x[1]);d[m]=b,p[m]=w/2,g+=(o[m]+1)*d[m],v+=(o[m]+1)*p[m]}var E=i;for(i=c*v/g,E!==0&&(i=i>1.5*E?1.5*E:i),m=0;m<f;m+=1)if(!(l&&o[m]<=1||(0,Lo.isNumber)(s[m].fx)&&(0,Lo.isNumber)(s[m].fy))){var M=u*i/(1+i*Math.sqrt(d[m])),_=Math.hypot(t[2*m],t[2*m+1]),k=h/(_=_<1e-4?1e-4:_),S=(M=M>k?k:M)*t[2*m],C=M*t[2*m+1];s[m].x+=S,s[m].y+=C}return{nodes:s,sg:i}},n}(KX.Base);jl.ForceAtlas2Layout=eY;var Bl={},k1={},C1={},A1={},Xu=xe&&xe.__assign||function(){return Xu=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},Xu.apply(this,arguments)};Object.defineProperty(A1,"__esModule",{value:!0});var tY=function(){function e(){this.cells=[],this.columnNum=0,this.rowNum=0,this.additionColumn=[],this.additionRow=[]}return e.prototype.init=function(n,t,r){this.cells=[],this.CELL_W=r.CELL_W||e.DEFAULT_CELL_W,this.CELL_H=r.CELL_H||e.DEFAULT_CELL_H,this.columnNum=Math.ceil(n/this.CELL_W),this.rowNum=Math.ceil(t/this.CELL_H),e.MIN_DIST=Math.pow(n,2)+Math.pow(t,2);for(var i=0;i<this.columnNum;i++){for(var o=[],a=0;a<this.rowNum;a++){var s={dx:i,dy:a,x:i*this.CELL_W,y:a*this.CELL_H,occupied:!1};o.push(s)}this.cells.push(o)}},e.prototype.findGridByNodeId=function(n){for(var t,r,i=0;i<this.columnNum;i++)for(var o=0;o<this.rowNum;o++)if(this.cells[i][o].node&&((r=(t=this.cells[i][o])===null||t===void 0?void 0:t.node)===null||r===void 0?void 0:r.id)===n)return{column:i,row:o};return null},e.prototype.sqdist=function(n,t){return Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2)},e.prototype.occupyNearest=function(n){for(var t,r=e.MIN_DIST,i=null,o=0;o<this.columnNum;o++)for(var a=0;a<this.rowNum;a++)!this.cells[o][a].occupied&&(t=this.sqdist(n,this.cells[o][a]))<r&&(r=t,i=this.cells[o][a]);return i&&(i.occupied=!0),i},e.prototype.insertColumn=function(n,t){if(!(t<=0)){for(var r=0;r<t;r++){this.cells[r+this.columnNum]=[];for(var i=0;i<this.rowNum;i++)this.cells[r+this.columnNum][i]={dx:r,dy:i,x:r*this.CELL_W,y:i*this.CELL_H,occupied:!1,node:null}}for(r=this.columnNum-1;r>n;r--)for(i=0;i<this.rowNum;i++)this.cells[r+t][i]=Xu(Xu({},this.cells[r][i]),{x:(r+t)*this.CELL_W,y:i*this.CELL_H}),this.cells[r][i]={x:r*this.CELL_W,y:i*this.CELL_H,occupied:!0,node:null};for(i=0;i<this.additionColumn.length;i++)this.additionColumn[i]>=n&&(this.additionColumn[i]+=t);for(r=0;r<t;r++)this.additionColumn.push(n+r+1);this.columnNum+=t}},e.prototype.insertRow=function(n,t){if(!(t<=0)){for(var r=0;r<t;r++)for(var i=0;i<this.columnNum;i++)this.cells[i][r+this.rowNum]={dx:i,dy:r,x:i*this.CELL_W,y:r*this.CELL_H,occupied:!1,node:null};for(i=0;i<this.columnNum;i++)for(r=this.rowNum-1;r>n;r--)this.cells[i][r+t]=Xu(Xu({},this.cells[i][r]),{dx:i,dy:r+t,x:i*this.CELL_W,y:(r+t)*this.CELL_H}),this.cells[i][r]={dx:i,dy:r,x:i*this.CELL_W,y:r*this.CELL_H,occupied:!1,node:null};for(r=0;r<this.additionRow.length;r++)this.additionRow[r]>=n&&(this.additionRow[r]+=t);for(i=0;i<t;i++)this.additionRow.push(n+i+1);this.rowNum+=t}},e.prototype.getNodes=function(){for(var n=[],t=0;t<this.columnNum;t++)for(var r=0;r<this.rowNum;r++)this.cells[t][r].node&&n.push(this.cells[t][r]);return n},e.MIN_DIST=50,e.DEFAULT_CELL_W=80,e.DEFAULT_CELL_H=80,e}();A1.default=tY;var nY=xe&&xe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(C1,"__esModule",{value:!0});var rY=nY(A1);C1.default=function(e,n){if(!e.nodes||e.nodes.length===0)return e;var t=n.width,r=n.height,i=n.nodeMinGap,o=1e4,a=1e4;e.nodes.forEach(function(m){var y=m.size[0]||50,b=m.size[1]||50;o=Math.min(y,o),a=Math.min(b,a)});var s=new rY.default;s.init(t,r,{CELL_H:a,CELL_W:o}),e.nodes.forEach(function(m){var y=s.occupyNearest(m);y&&(y.node={id:m.id,size:m.size},m.x=y.x,m.y=y.y,m.dx=y.dx,m.dy=y.dy)});for(var u=0;u<e.nodes.length;u++){var c=e.nodes[u],l=s.findGridByNodeId(c.id);if(!l)throw new Error("can not find node cell");var h=l.column,f=l.row;if(c.size[0]+i>o){for(var d=g=Math.ceil((c.size[0]+i)/o)-1,p=0;p<g&&!(!(s.additionColumn.indexOf(h+p+1)>-1)||s.cells[h+p+1][f].node);p++)d--;s.insertColumn(h,d)}if(c.size[1]+i>a){var g;for(d=g=Math.ceil((c.size[1]+i)/a)-1,p=0;p<g&&!(!(s.additionRow.indexOf(f+p+1)>-1)||s.cells[h][f+p+1].node);p++)d--;s.insertRow(f,d)}}for(u=0;u<s.columnNum;u++){var v=function(m){var y=s.cells[u][m];if(y.node){var b=e.nodes.find(function(x){var w;return x.id===((w=y==null?void 0:y.node)===null||w===void 0?void 0:w.id)});b&&(b.x=y.x+b.size[0]/2,b.y=y.y+b.size[1]/2)}};for(p=0;p<s.rowNum;p++)v(p)}};var I1={};Object.defineProperty(I1,"__esModule",{value:!0});var G3=1e7,U3=3.141592653589793,X3=1.5707963267948966,iY=.375*U3,oY=.625*U3,Tp=new Map,T1=.8;function Y3(e,n){var t=(Tp.get(e.id)||[]).find(function(M){return M.source===n.id||M.target===n.id}),r=e.size[0]*e.size[1],i=n.size[0]*n.size[1],o=r>i?n:e,a=r>i?e:n,s=o.x-o.size[0]/2,u=o.y-o.size[1]/2,c=o.x+o.size[0]/2,l=o.y+o.size[1]/2,h=a.x-a.size[0]/2,f=a.y-a.size[1]/2,d=a.x+a.size[0]/2,p=a.y+a.size[1]/2,g=o.x,v=o.y,m=a.x,y=a.y,b=0,x=0;if(c>=h&&d>=s&&l>=f&&p>=u)(x=Math.sqrt(Math.pow(m-g,2)+Math.pow(y-v,2)))===0&&(x=1e-7),b=10/x*100+((c<d?c:d)-(s>h?s:h))*((l<p?l:p)-(u>f?u:f)),b*=G3;else{var w=!1,E=function(M,_,k){var S=M.x-M.size[0]/2,C=M.y-M.size[1]/2,T=M.x+M.size[0]/2,A=M.y+M.size[1]/2,D=_.x-_.size[0]/2,j=_.y-_.size[1]/2,L=_.x+_.size[0]/2,B=_.y+_.size[1]/2,N=M.x,R=M.y,P=_.x,H=_.y,ne=P-N,Z=Math.atan2(ne,H-R),q=0,te=0,we=0,pe=0;Z>X3?(te=C-B,q=D-T,we=parseFloat(te?(te/Math.cos(Z)).toFixed(2):q.toFixed(2)),pe=parseFloat(q?(q/Math.sin(Z)).toFixed(2):te.toFixed(2))):we=pe=0<Z&&Z<=X3?(te=j-A)>(q=D-T)?parseFloat(te?(te/Math.cos(Z)).toFixed(2):q.toFixed(2)):parseFloat(q?(q/Math.sin(Z)).toFixed(2):te.toFixed(2)):Z<-1.5707963267948966?(te=C-B)>(q=-(L-S))?parseFloat(te?(te/Math.cos(Z)).toFixed(2):q.toFixed(2)):parseFloat(q?(q/Math.sin(Z)).toFixed(2):te.toFixed(2)):(te=j-A)>(q=Math.abs(ne)>(T-S)/2?S-L:ne)?parseFloat(te?(te/Math.cos(Z)).toFixed(2):q.toFixed(2)):parseFloat(q&&Z!==0?(q/Math.sin(Z)).toFixed(2):te.toFixed(2));var Me=parseFloat(Z.toFixed(2)),Be=k;return k&&(Be=iY<Me&&Me<oY),{distance:Math.abs(we<pe?we:pe),isHoriz:Be}}(o,a,w);x=E.distance,w=E.isHoriz,x<=10?b+=x!==0?t?10+1e7/x:10+1e8/x:G3:(b+=x,t&&(b+=x*x))}return b}function W3(e){for(var n=0,t=0;t<e.length;t++){var r=e[t];(r.x<0||r.y<0||r.x>1200||r.y>800)&&(n+=1e12);for(var i=t+1;i<e.length;i++)n+=Y3(r,e[i])}return n}function aY(e,n,t,r){var i=new Map;t.forEach(function(p,g){i.set(p.id,p)});var o=r.filter(function(p){return p.source===e.id||p.target===e.id})||[],a=[];o.forEach(function(p){var g=p.source===e.id?p.target:p.source,v=i.get(g);v&&a.push(v)});for(var s=!0,u=0;u<a.length;u++){var c=a[u],l=180*Math.atan((e.y-c.y)/(c.x-e.y)),h=180*Math.atan((n.y-c.y)/(c.x-n.y)),f=l>70&&l<110,d=h>70&&h<110;if((l<30||l>150)&&!(h<30||h>150)||l*h<0){s=!1;break}if(f&&!d||l*h<0){s=!1;break}if((c.x-e.x)*(c.x-n.x)<0){s=!1;break}if((c.y-e.y)*(c.y-n.y)<0){s=!1;break}}return s}function sY(e,n){for(var t=!1,r=[10,-10,0,0],i=[0,0,10,-10],o=0;o<e.length;++o)for(var a=e[o],s=V3(a,e),u=0;u<r.length;u++)if(aY(a,{x:a.x+r[u],y:a.y+i[u]},e,n)){a.x+=r[u],a.y+=i[u];var c=V3(a,e),l=Math.random();c<s||l<T1&&l>.1?(s=c,t=!0):(a.x-=r[u],a.y-=i[u])}return T1>.1&&(T1*=.5),t?W3(e):0}function V3(e,n){var t=0;(e.x<0||e.y<0||e.x+e.size[0]+20>1200||e.y+e.size[1]+20>800)&&(t+=1e12);for(var r=0;r<n.length;++r)e.id!==n[r].id&&(t+=Y3(e,n[r]));return t}I1.default=function(e,n){if(e.length===0)return{nodes:e,edges:n};e.forEach(function(u){var c=n.filter(function(l){return l.source===u.id||l.target===u.id});Tp.set(u,c)}),e.sort(function(u,c){var l,h;return((l=Tp.get(u.id))===null||l===void 0?void 0:l.length)-((h=Tp.get(c.id))===null||h===void 0?void 0:h.length)});for(var t=W3(e),r=20,i=1,o=0,a=0;r>0&&!(++a>=50);){var s=sY(e,n);s!==0&&(o=s),i=o-t,t=o,i===0?--r:r=20}return e.forEach(function(u){u.x=u.x-u.size[0]/2,u.y=u.y-u.size[1]/2}),{nodes:e,edges:n}};var O1=xe&&xe.__assign||function(){return O1=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},O1.apply(this,arguments)},uY=xe&&xe.__createBinding||(Object.create?function(e,n,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(n,t);i&&!("get"in i?!n.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(e,r,i)}:function(e,n,t,r){r===void 0&&(r=t),e[r]=n[t]}),cY=xe&&xe.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),lY=xe&&xe.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var t in e)t!=="default"&&Object.prototype.hasOwnProperty.call(e,t)&&uY(n,e,t);return cY(n,e),n},H3=xe&&xe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(k1,"__esModule",{value:!0});var Yu=lY(xm),hY=H3(C1),fY=H3(I1),dY=fu;k1.default=function(e,n){var t=e.nodes,r=e.edges,i=n.width,o=n.height;if(!(t!=null&&t.length))return Promise.resolve();var a=[];t.forEach(function(f){if(r.filter(function(p){return p.source===f.id||p.target===f.id}).length>1){var d=O1({},f);delete d.size,a.push(d)}});var s=[];r.forEach(function(f){var d=a.find(function(g){return g.id===f.source}),p=a.find(function(g){return g.id===f.target});d&&p&&s.push(f)});var u=new dY.DagreLayout({type:"dagre",ranksep:n.nodeMinGap,nodesep:n.nodeMinGap}).layout({nodes:a,edges:s}).nodes;t.forEach(function(f){var d=(u||[]).find(function(p){return p.id===f.id});f.x=(d==null?void 0:d.x)||i/2,f.y=(d==null?void 0:d.y)||o/2});var c=JSON.parse(JSON.stringify(t)),l=JSON.parse(JSON.stringify(r)),h=Yu.forceSimulation().nodes(c).force("link",Yu.forceLink(l).id(function(f){return f.id}).distance(function(f){return s.find(function(d){return d.source===f.source&&d.target===f.target})?30:20})).force("charge",Yu.forceManyBody()).force("center",Yu.forceCenter(i/2,o/2)).force("x",Yu.forceX(i/2)).force("y",Yu.forceY(o/2)).alpha(.3).alphaDecay(.08).alphaMin(.001);return new Promise(function(f){h.on("end",function(){t.forEach(function(b){var x=c.find(function(w){return w.id===b.id});x&&(b.x=x.x,b.y=x.y)});var d=Math.min.apply(Math,t.map(function(b){return b.x})),p=Math.max.apply(Math,t.map(function(b){return b.x})),g=Math.min.apply(Math,t.map(function(b){return b.y})),v=Math.max.apply(Math,t.map(function(b){return b.y})),m=i/(p-d),y=o/(v-g);t.forEach(function(b){b.x!==void 0&&m<1&&(b.x=(b.x-d)*m),b.y!==void 0&&y<1&&(b.y=(b.y-g)*y)}),t.forEach(function(b){b.sizeTemp=b.size,b.size=[10,10]}),(0,fY.default)(t,r),t.forEach(function(b){b.size=b.sizeTemp||[],delete b.sizeTemp}),(0,hY.default)({nodes:t,edges:r},n),f()})})};var pY=xe&&xe.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),gY=xe&&xe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Bl,"__esModule",{value:!0}),Bl.ERLayout=void 0;var vY=Nn,mY=gY(k1),yY=function(e){function n(t){var r=e.call(this)||this;return r.width=300,r.height=300,r.nodeMinGap=50,r.onLayoutEnd=function(){},t&&r.updateCfg(t),r}return pY(n,e),n.prototype.getDefaultCfg=function(){return{width:300,height:300,nodeMinGap:50}},n.prototype.execute=function(){var t=this,r=t.nodes,i=t.edges;return r==null||r.forEach(function(o){o.size||(o.size=[50,50])}),(0,mY.default)({nodes:r,edges:i},{width:this.width,height:this.height,nodeMinGap:this.nodeMinGap}).then(function(){t.onLayoutEnd&&t.onLayoutEnd()})},n.prototype.getType=function(){return"er"},n}(vY.Base);Bl.ERLayout=yY;var q3,ws={},Z3,K3={};function $3(){return Z3||(Z3=1,function(e){var n=xe&&xe.__createBinding||(Object.create?function(E,M,_,k){k===void 0&&(k=_);var S=Object.getOwnPropertyDescriptor(M,_);S&&!("get"in S?!M.__esModule:S.writable||S.configurable)||(S={enumerable:!0,get:function(){return M[_]}}),Object.defineProperty(E,k,S)}:function(E,M,_,k){k===void 0&&(k=_),E[k]=M[_]}),t=xe&&xe.__exportStar||function(E,M){for(var _ in E)_==="default"||Object.prototype.hasOwnProperty.call(M,_)||n(M,E,_)};Object.defineProperty(e,"__esModule",{value:!0}),e.ERLayout=e.ForceAtlas2Layout=e.ComboCombinedLayout=e.ComboForceLayout=e.GForceGPULayout=e.FruchtermanGPULayout=e.FruchtermanLayout=e.MDSLayout=e.ConcentricLayout=e.RadialLayout=e.DagreCompoundLayout=e.DagreLayout=e.CircularLayout=e.ForceLayout=e.Force2Layout=e.GForceLayout=e.RandomLayout=e.GridLayout=e.Layouts=e.Layout=void 0;var r=el;Object.defineProperty(e,"GridLayout",{enumerable:!0,get:function(){return r.GridLayout}});var i=tl;Object.defineProperty(e,"RandomLayout",{enumerable:!0,get:function(){return i.RandomLayout}});var o=nl;Object.defineProperty(e,"GForceLayout",{enumerable:!0,get:function(){return o.GForceLayout}});var a=rl;Object.defineProperty(e,"Force2Layout",{enumerable:!0,get:function(){return a.Force2Layout}});var s=mm;Object.defineProperty(e,"ForceLayout",{enumerable:!0,get:function(){return s.ForceLayout}});var u=ul;Object.defineProperty(e,"CircularLayout",{enumerable:!0,get:function(){return u.CircularLayout}});var c=fu;Object.defineProperty(e,"DagreLayout",{enumerable:!0,get:function(){return c.DagreLayout}});var l=gl;Object.defineProperty(e,"DagreCompoundLayout",{enumerable:!0,get:function(){return l.DagreCompoundLayout}});var h=i1;Object.defineProperty(e,"RadialLayout",{enumerable:!0,get:function(){return h.RadialLayout}});var f=kl;Object.defineProperty(e,"ConcentricLayout",{enumerable:!0,get:function(){return f.ConcentricLayout}});var d=Cl;Object.defineProperty(e,"MDSLayout",{enumerable:!0,get:function(){return d.MDSLayout}});var p=Il;Object.defineProperty(e,"FruchtermanLayout",{enumerable:!0,get:function(){return p.FruchtermanLayout}});var g=Tl;Object.defineProperty(e,"FruchtermanGPULayout",{enumerable:!0,get:function(){return g.FruchtermanGPULayout}});var v=Pl;Object.defineProperty(e,"GForceGPULayout",{enumerable:!0,get:function(){return v.GForceGPULayout}});var m=Ll;Object.defineProperty(e,"ComboForceLayout",{enumerable:!0,get:function(){return m.ComboForceLayout}});var y=F3();Object.defineProperty(e,"ComboCombinedLayout",{enumerable:!0,get:function(){return y.ComboCombinedLayout}});var b=jl;Object.defineProperty(e,"ForceAtlas2Layout",{enumerable:!0,get:function(){return b.ForceAtlas2Layout}});var x=Bl;Object.defineProperty(e,"ERLayout",{enumerable:!0,get:function(){return x.ERLayout}});var w=function(){if(q3)return ws;q3=1,Object.defineProperty(ws,"__esModule",{value:!0}),ws.Layouts=ws.Layout=void 0;var E=wo,M=el,_=tl,k=rl,S=nl,C=mm,T=ul,A=fu,D=i1,j=kl,L=Cl,B=Il,N=Tl,R=Pl,P=Ll,H=F3(),ne=jl,Z=Bl,q=gl,te=_n(),we=function(){function pe(Me){var Be=(0,E.getLayoutByName)(Me.type);this.layoutInstance=new Be(Me)}return pe.prototype.layout=function(Me){return this.layoutInstance.layout(Me)},pe.prototype.updateCfg=function(Me){this.layoutInstance.updateCfg(Me)},pe.prototype.init=function(Me){this.correctLayers(Me.nodes),this.layoutInstance.init(Me)},pe.prototype.correctLayers=function(Me){if(Me!=null&&Me.length){var Be=1/0,dt=[];if(Me.forEach(function(at){(0,te.isString)(at.layer)&&(at.layer=parseInt(at.layer,10)),at.layer===void 0||isNaN(at.layer)||(dt.push(at),at.layer<Be&&(Be=at.layer))}),Be<=0){var It=Math.abs(Be)+1;dt.forEach(function(at){return at.layer+=It})}}},pe.prototype.execute=function(){this.layoutInstance.execute()},pe.prototype.getDefaultCfg=function(){return this.layoutInstance.getDefaultCfg()},pe.prototype.destroy=function(){return this.layoutInstance.destroy()},pe}();return ws.Layout=we,ws.Layouts={force:C.ForceLayout,fruchterman:B.FruchtermanLayout,forceAtlas2:ne.ForceAtlas2Layout,gForce:S.GForceLayout,force2:k.Force2Layout,dagre:A.DagreLayout,dagreCompound:q.DagreCompoundLayout,circular:T.CircularLayout,radial:D.RadialLayout,concentric:j.ConcentricLayout,grid:M.GridLayout,mds:L.MDSLayout,comboForce:P.ComboForceLayout,comboCombined:H.ComboCombinedLayout,random:_.RandomLayout,"gForce-gpu":R.GForceGPULayout,"fruchterman-gpu":N.FruchtermanGPULayout,er:Z.ERLayout},ws}();Object.defineProperty(e,"Layout",{enumerable:!0,get:function(){return w.Layout}}),Object.defineProperty(e,"Layouts",{enumerable:!0,get:function(){return w.Layouts}}),t(K3,e)}(Kk)),Kk}Object.defineProperty(K3,"__esModule",{value:!0}),function(e){var n=xe&&xe.__createBinding||(Object.create?function(i,o,a,s){s===void 0&&(s=a);var u=Object.getOwnPropertyDescriptor(o,a);u&&!("get"in u?!o.__esModule:u.writable||u.configurable)||(u={enumerable:!0,get:function(){return o[a]}}),Object.defineProperty(i,s,u)}:function(i,o,a,s){s===void 0&&(s=a),i[s]=o[a]}),t=xe&&xe.__exportStar||function(i,o){for(var a in i)a==="default"||Object.prototype.hasOwnProperty.call(o,a)||n(o,i,a)};Object.defineProperty(e,"__esModule",{value:!0}),e.getLayoutByName=e.unRegisterLayout=e.registerLayout=void 0;var r=wo;Object.defineProperty(e,"registerLayout",{enumerable:!0,get:function(){return r.registerLayout}}),Object.defineProperty(e,"unRegisterLayout",{enumerable:!0,get:function(){return r.unRegisterLayout}}),Object.defineProperty(e,"getLayoutByName",{enumerable:!0,get:function(){return r.getLayoutByName}}),t($3(),e)}($t);var wa={assign:Object.assign,getHeight:function(e,n,t,r){return r===void 0&&(r="height"),t==="center"?(e[r]+n[r])/2:e.height}},Q3=wa,bY={getId:function(e){return e.id||e.name},getPreH:function(e){return e.preH||0},getPreV:function(e){return e.preV||0},getHGap:function(e){return e.hgap||18},getVGap:function(e){return e.vgap||18},getChildren:function(e){return e.children},getHeight:function(e){return e.height||36},getWidth:function(e){var n=e.label||" ";return e.width||18*n.split("").length}};function Op(e,n){var t=this;if(t.vgap=t.hgap=0,e instanceof Op)return e;t.data=e;var r=n.getHGap(e),i=n.getVGap(e);return t.preH=n.getPreH(e),t.preV=n.getPreV(e),t.width=n.getWidth(e),t.height=n.getHeight(e),t.width+=t.preH,t.height+=t.preV,t.id=n.getId(e),t.x=t.y=0,t.depth=0,t.children||(t.children=[]),t.addGap(r,i),t}Q3.assign(Op.prototype,{isRoot:function(){return this.depth===0},isLeaf:function(){return this.children.length===0},addGap:function(e,n){var t=this;t.hgap+=e,t.vgap+=n,t.width+=2*e,t.height+=2*n},eachNode:function(e){for(var n,t=[this];n=t.shift();)e(n),t=n.children.concat(t)},DFTraverse:function(e){this.eachNode(e)},BFTraverse:function(e){for(var n,t=[this];n=t.shift();)e(n),t=t.concat(n.children)},getBoundingBox:function(){var e={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(n){e.left=Math.min(e.left,n.x),e.top=Math.min(e.top,n.y),e.width=Math.max(e.width,n.x+n.width),e.height=Math.max(e.height,n.y+n.height)}),e},translate:function(e,n){e===void 0&&(e=0),n===void 0&&(n=0),this.eachNode(function(t){t.x+=e,t.y+=n,t.x+=t.preH,t.y+=t.preV})},right2left:function(){var e=this,n=e.getBoundingBox();e.eachNode(function(t){t.x=t.x-2*(t.x-n.left)-t.width}),e.translate(n.width,0)},bottom2top:function(){var e=this,n=e.getBoundingBox();e.eachNode(function(t){t.y=t.y-2*(t.y-n.top)-t.height}),e.translate(0,n.height)}});var J3=function(e,n,t){n===void 0&&(n={});var r,i=new Op(e,n=Q3.assign({},bY,n)),o=[i];if(!t&&!e.collapsed){for(;r=o.shift();)if(!r.data.collapsed){var a=n.getChildren(r.data),s=a?a.length:0;if(r.children=new Array(s),a&&s)for(var u=0;u<s;u++){var c=new Op(a[u],n);r.children[u]=c,o.push(c),c.parent=r,c.depth=r.depth+1}}}return i},xY=J3,wY=function(){function e(n,t){t===void 0&&(t={}),this.options=t,this.rootNode=xY(n,t)}return e.prototype.execute=function(){throw new Error("please override this method")},e}(),Np=wY;function zl(e,n,t,r){r===void 0&&(r=[]);var i=this;i.w=e||0,i.h=n||0,i.y=t||0,i.x=0,i.c=r||[],i.cs=r.length,i.prelim=0,i.mod=0,i.shift=0,i.change=0,i.tl=null,i.tr=null,i.el=null,i.er=null,i.msel=0,i.mser=0}function eO(e,n,t){t?e.y+=n:e.x+=n,e.children.forEach(function(r){eO(r,n,t)})}function tO(e,n){var t=n?e.y:e.x;return e.children.forEach(function(r){t=Math.min(tO(r,n),t)}),t}function EY(e,n){eO(e,-tO(e,n),n)}function nO(e,n,t){t?n.y=e.x:n.x=e.x,e.c.forEach(function(r,i){nO(r,n.children[i],t)})}function rO(e,n,t){t===void 0&&(t=0),n?(e.x=t,t+=e.width):(e.y=t,t+=e.height),e.children.forEach(function(r){rO(r,n,t)})}zl.fromNode=function(e,n){if(!e)return null;var t=[];return e.children.forEach(function(r){t.push(zl.fromNode(r,n))}),n?new zl(e.height,e.width,e.x,t):new zl(e.width,e.height,e.y,t)};var iO=J3,oO=function(e,n){for(var t=iO(e.data,n,!0),r=iO(e.data,n,!0),i=e.children.length,o=Math.round(i/2),a=n.getSide||function(c,l){return l<o?"right":"left"},s=0;s<i;s++){var u=e.children[s];a(u,s)==="right"?r.children.push(u):t.children.push(u)}return t.eachNode(function(c){c.isRoot()||(c.side="left")}),r.eachNode(function(c){c.isRoot()||(c.side="right")}),{left:t,right:r}},MY=oO,Ea=["LR","RL","TB","BT","H","V"],SY=["LR","RL","H"],_Y=Ea[0],N1=function(e,n,t){var r=n.direction||_Y;if(n.isHorizontal=function(c){return SY.indexOf(c)>-1}(r),Ea.indexOf(r)===-1)throw new TypeError("Invalid direction: "+r);if(r===Ea[0])t(e,n);else if(r===Ea[1])t(e,n),e.right2left();else if(r===Ea[2])t(e,n);else if(r===Ea[3])t(e,n),e.bottom2top();else if(r===Ea[4]||r===Ea[5]){var i=MY(e,n),o=i.left,a=i.right;t(o,n),t(a,n),n.isHorizontal?o.right2left():o.bottom2top(),a.translate(o.x-a.x,o.y-a.y),e.x=o.x,e.y=a.y;var s=e.getBoundingBox();n.isHorizontal?s.top<0&&e.translate(0,-s.top):s.left<0&&e.translate(-s.left,0)}var u=n.fixedRoot;return u===void 0&&(u=!0),u&&e.translate(-(e.x+e.width/2+e.hgap),-(e.y+e.height/2+e.vgap)),function(c,l){if(l.radial){var h=l.isHorizontal?["x","y"]:["y","x"],f=h[0],d=h[1],p={x:1/0,y:1/0},g={x:-1/0,y:-1/0},v=0;c.DFTraverse(function(b){v++;var x=b.x,w=b.y;p.x=Math.min(p.x,x),p.y=Math.min(p.y,w),g.x=Math.max(g.x,x),g.y=Math.max(g.y,w)});var m=g[d]-p[d];if(m===0)return;var y=2*Math.PI/v;c.DFTraverse(function(b){var x=(b[d]-p[d])/m*(2*Math.PI-y)+y,w=b[f]-c[f];b.x=Math.cos(x)*w,b.y=Math.sin(x)*w})}}(e,n),e};function D1(e,n){return D1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},D1(e,n)}var kY=function(e,n){n===void 0&&(n={});var t=n.isHorizontal;function r(h){h.cs===0?(h.el=h,h.er=h,h.msel=h.mser=0):(h.el=h.c[0].el,h.msel=h.c[0].msel,h.er=h.c[h.cs-1].er,h.mser=h.c[h.cs-1].mser)}function i(h,f,d){for(var p=h.c[f-1],g=p.mod,v=h.c[f],m=v.mod;p!==null&&v!==null;){u(p)>d.low&&(d=d.nxt);var y=g+p.prelim+p.w-(m+v.prelim);y>0&&(m+=y,o(h,f,d.index,y));var b=u(p),x=u(v);b<=x&&(p=s(p))!==null&&(g+=p.mod),b>=x&&(v=a(v))!==null&&(m+=v.mod)}!p&&v?function(w,E,M,_){var k=w.c[0].el;k.tl=M;var S=_-M.mod-w.c[0].msel;k.mod+=S,k.prelim-=S,w.c[0].el=w.c[E].el,w.c[0].msel=w.c[E].msel}(h,f,v,m):p&&!v&&function(w,E,M,_){var k=w.c[E].er;k.tr=M;var S=_-M.mod-w.c[E].mser;k.mod+=S,k.prelim-=S,w.c[E].er=w.c[E-1].er,w.c[E].mser=w.c[E-1].mser}(h,f,p,g)}function o(h,f,d,p){h.c[f].mod+=p,h.c[f].msel+=p,h.c[f].mser+=p,function(g,v,m,y){if(m!==v-1){var b=v-m;g.c[m+1].shift+=y/b,g.c[v].shift-=y/b,g.c[v].change-=y-y/b}}(h,f,d,p)}function a(h){return h.cs===0?h.tl:h.c[0]}function s(h){return h.cs===0?h.tr:h.c[h.cs-1]}function u(h){return h.y+h.h}function c(h,f,d){for(;d!==null&&h>=d.low;)d=d.nxt;return{low:h,index:f,nxt:d}}rO(e,t);var l=zl.fromNode(e,t);return function h(f){if(f.cs!==0){h(f.c[0]);for(var d=c(u(f.c[0].el),0,null),p=1;p<f.cs;++p){h(f.c[p]);var g=u(f.c[p].er);i(f,p,d),d=c(g,p,d)}(function(v){v.prelim=(v.c[0].prelim+v.c[0].mod+v.c[v.cs-1].mod+v.c[v.cs-1].prelim+v.c[v.cs-1].w)/2-v.w/2})(f),r(f)}else r(f)}(l),function h(f,d){d+=f.mod,f.x=f.prelim+d,function(g){for(var v=0,m=0,y=0;y<g.cs;y++)m+=(v+=g.c[y].shift)+g.c[y].change,g.c[y].mod+=m}(f);for(var p=0;p<f.cs;p++)h(f.c[p],d)}(l,0),nO(l,e,t),EY(e,t),e},CY=N1,AY=wa,IY=function(e){function n(){return e.apply(this,arguments)||this}return function(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,D1(t,r)}(n,e),n.prototype.execute=function(){return CY(this.rootNode,this.options,kY)},n}(Np),TY={},OY=function(e,n){return n=AY.assign({},TY,n),new IY(e,n).execute()},NY=wa;function DY(e,n){n===void 0&&(n=[]);var t=this;t.x=t.y=0,t.leftChild=t.rightChild=null,t.height=0,t.children=n}var PY={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function aO(e,n,t){t?(n.x=e.x,n.y=e.y):(n.x=e.y,n.y=e.x),e.children.forEach(function(r,i){aO(r,n.children[i],t)})}function P1(e,n){return P1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},P1(e,n)}var LY=function(e,n){n===void 0&&(n={}),n=NY.assign({},PY,n);var t,r=0,i=function o(a){if(!a)return null;a.width=0,a.depth&&a.depth>r&&(r=a.depth);var s=a.children,u=s.length,c=new DY(a.height,[]);return s.forEach(function(l,h){var f=o(l);c.children.push(f),h===0&&(c.leftChild=f),h===u-1&&(c.rightChild=f)}),c.originNode=a,c.isLeaf=a.isLeaf(),c}(e);return function o(a){if(a.isLeaf||a.children.length===0)a.drawingDepth=r;else{var s=a.children.map(function(c){return o(c)}),u=Math.min.apply(null,s);a.drawingDepth=u-1}return a.drawingDepth}(i),function o(a){a.x=a.drawingDepth*n.rankSep,a.isLeaf?(a.y=0,t&&(a.y=t.y+t.height+n.nodeSep,a.originNode.parent!==t.originNode.parent&&(a.y+=n.subTreeSep)),t=a):(a.children.forEach(function(s){o(s)}),a.y=(a.leftChild.y+a.rightChild.y)/2)}(i),aO(i,e,n.isHorizontal),e},RY=N1,jY=wa,BY=function(e){function n(){return e.apply(this,arguments)||this}return function(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,P1(t,r)}(n,e),n.prototype.execute=function(){var t=this;return t.rootNode.width=0,RY(t.rootNode,t.options,LY)},n}(Np),zY={},FY=function(e,n){return n=jY.assign({},zY,n),new BY(e,n).execute()},sO=wa;function L1(e,n){return L1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},L1(e,n)}var GY=Np,Dp=function(e,n,t,r){var i=null;e.eachNode(function(o){(function(a,s,u,c,l){var h=(typeof u=="function"?u(a):u)*a.depth;if(!c)try{if(a.id===a.parent.children[0].id)return a.x+=h,void(a.y=s?s.y:0)}catch{}if(a.x+=h,s){if(a.y=s.y+sO.getHeight(s,a,l),s.parent&&a.parent.id!==s.parent.id){var f=s.parent,d=f.y+sO.getHeight(f,a,l);a.y=d>a.y?d:a.y}}else a.y=0})(o,i,n,t,r),i=o})},UY=oO,XY=wa,Fl=["LR","RL","H"],YY=Fl[0],WY=function(e){function n(){return e.apply(this,arguments)||this}return function(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,L1(t,r)}(n,e),n.prototype.execute=function(){var t=this.options,r=this.rootNode;t.isHorizontal=!0;var i=t.indent,o=i===void 0?20:i,a=t.dropCap,s=a===void 0||a,u=t.direction,c=u===void 0?YY:u,l=t.align;if(c&&Fl.indexOf(c)===-1)throw new TypeError("Invalid direction: "+c);if(c===Fl[0])Dp(r,o,s,l);else if(c===Fl[1])Dp(r,o,s,l),r.right2left();else if(c===Fl[2]){var h=UY(r,t),f=h.left,d=h.right;Dp(f,o,s,l),f.right2left(),Dp(d,o,s,l);var p=f.getBoundingBox();d.translate(p.width,0),r.x=d.x-r.width/2}return r},n}(GY),VY={},HY=function(e,n){return n=XY.assign({},VY,n),new WY(e,n).execute()},qY=wa;function uO(e,n){var t=0;return e.children.length?e.children.forEach(function(r){t+=uO(r,n)}):t=e.height,e._subTreeSep=n.getSubTreeSep(e.data),e.totalHeight=Math.max(e.height,t)+2*e._subTreeSep,e.totalHeight}function cO(e){var n=e.children,t=n.length;if(t){n.forEach(function(u){cO(u)});var r=n[0],i=n[t-1],o=i.y-r.y+i.height,a=0;if(n.forEach(function(u){a+=u.totalHeight}),o>e.height)e.y=r.y+o/2-e.height/2;else if(n.length!==1||e.height>a){var s=e.y+(e.height-o)/2-r.y;n.forEach(function(u){u.translate(0,s)})}else e.y=(r.y+r.height/2+i.y+i.height/2)/2-e.height/2}}var ZY={getSubTreeSep:function(){return 0}};function R1(e,n){return R1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},R1(e,n)}var KY=function(e,n){n===void 0&&(n={}),n=qY.assign({},ZY,n),e.parent={x:0,width:0,height:0,y:0},e.BFTraverse(function(t){t.x=t.parent.x+t.parent.width}),e.parent=null,uO(e,n),e.startY=0,e.y=e.totalHeight/2-e.height/2,e.eachNode(function(t){var r=t.children,i=r.length;if(i){var o=r[0];if(o.startY=t.startY+t._subTreeSep,i===1)o.y=t.y+t.height/2-o.height/2;else{o.y=o.startY+o.totalHeight/2-o.height/2;for(var a=1;a<i;a++){var s=r[a];s.startY=r[a-1].startY+r[a-1].totalHeight,s.y=s.startY+s.totalHeight/2-s.height/2}}}}),cO(e)},$Y=N1,QY=wa,JY=function(e){function n(){return e.apply(this,arguments)||this}return function(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,R1(t,r)}(n,e),n.prototype.execute=function(){return $Y(this.rootNode,this.options,KY)},n}(Np),eW={},tW=function(e,n){return n=QY.assign({},eW,n),new JY(e,n).execute()};const Pp=Bi({compactBox:OY,dendrogram:FY,indented:HY,mindmap:tW});var lO=gr.traverseTree;const nW=Object.freeze(Object.defineProperty({__proto__:null,arrayToTextureData:function(e){for(var n=[],t=e.length,r=e[0].length,i=function(a){e.forEach(function(s,u){if(n.push(s[a]),u===t-1)for(;n.length%4!=0;)n.push(0)})},o=0;o<r;o++)i(o);return new Float32Array(n)},attributesToTextureData:function(e,n){var t=[],r=e.length,i={};return n.forEach(function(o){e.forEach(function(a,s){if(i[o[a]]===void 0&&(i[o[a]]=Object.keys(i).length),t.push(i[o[a]]),s===r-1)for(;t.length%4!=0;)t.push(0)})}),{array:new Float32Array(t),count:Object.keys(i).length}},buildTextureData:function(e,n){var t=[],r=[],i={},o=0;for(o=0;o<e.length;o++){var a=e[o];i[a.id]=o,t.push(a.x),t.push(a.y),t.push(0),t.push(0),r.push([])}for(o=0;o<n.length;o++){var s=n[o];r[i[s.source]].push(i[s.target]),r[i[s.target]].push(i[s.source])}var u=0;for(o=0;o<e.length;o++){var c=t.length,l=r[o],h=l.length;t[4*o+2]=c,t[4*o+3]=l.length,u=Math.max(u,l.length);for(var f=0;f<h;++f){var d=l[f];t.push(+d)}}for(;t.length%4!=0;)t.push(0);return{array:new Float32Array(t),maxEdgePerVetex:u}},buildTextureDataWithOneEdgeAttr:function(e,n,t){var r=[],i=[],o={},a=0;for(a=0;a<e.length;a++){var s=e[a];o[s.id]=a,r.push(s.x),r.push(s.y),r.push(0),r.push(0),i.push([])}for(a=0;a<n.length;a++){var u=n[a];i[o[u.source]].push(o[u.target]),i[o[u.source]].push(t(u)),i[o[u.target]].push(o[u.source]),i[o[u.target]].push(t(u))}var c=0;for(a=0;a<e.length;a++){var l=r.length,h=i[a],f=h.length;r[4*a+2]=l,r[4*a+3]=f/2,c=Math.max(c,f/2);for(var d=0;d<f;++d){var p=h[d];r.push(+p)}}for(;r.length%4!=0;)r.push(0);return{array:new Float32Array(r),maxEdgePerVetex:c}},buildTextureDataWithTwoEdgeAttr:function(e,n,t,r){var i=[],o=[],a={},s=0;for(s=0;s<e.length;s++){var u=e[s];a[u.id]=s,i.push(u.x),i.push(u.y),i.push(0),i.push(0),o.push([])}for(s=0;s<n.length;s++){var c=n[s];o[a[c.source]].push(a[c.target]),o[a[c.source]].push(t(c)),o[a[c.source]].push(r(c)),o[a[c.source]].push(0),o[a[c.target]].push(a[c.source]),o[a[c.target]].push(t(c)),o[a[c.target]].push(r(c)),o[a[c.target]].push(0)}var l=0;for(s=0;s<e.length;s++){var h=i.length,f=o[s],d=f.length;i[4*s+2]=h+1048576*d/4,i[4*s+3]=0,l=Math.max(l,d/4);for(var p=0;p<d;++p){var g=f[p];i.push(+g)}}for(;i.length%4!=0;)i.push(0);return{array:new Float32Array(i),maxEdgePerVetex:l}},proccessToFunc:function(e,n){return e?xt(e)?function(t){return e}:e:function(t){return n||1}},radialLayout:function(e,n){var t={x:1/0,y:1/0},r={x:-1/0,y:-1/0},i="x",o="y";n&&["V","TB","BT"].indexOf(n)>=0&&(o="x",i="y");var a=0;lO(e,function(c){return a++,c.x>r.x&&(r.x=c.x),c.x<t.x&&(t.x=c.x),c.y>r.y&&(r.y=c.y),c.y<t.y&&(t.y=c.y),!0});var s=2*Math.PI/a,u=r[o]-t[o];return u===0||lO(e,function(c){var l=(c[o]-t[o])/u*(2*Math.PI-s)+s,h=Math.abs(i==="x"?c.x-e.x:c.y-e.y);return c.x=h*Math.cos(l),c.y=h*Math.sin(l),!0}),e}},Symbol.toStringTag,{value:"Module"}));var hO=function e(){return typeof window>"u"||typeof document>"u"?{}:{canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var n=document.createElement("canvas");return!(!window.WebGLRenderingContext||!n.getContext("webgl")&&!n.getContext("experimental-webgl"))}catch{return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var n=document.createElement("div");return n.id="webgl-error-message",n.style.fontFamily="monospace",n.style.fontSize="13px",n.style.fontWeight="normal",n.style.textAlign="center",n.style.background="#fff",n.style.color="#000",n.style.padding="1.5em",n.style.width="400px",n.style.margin="5em auto 0",this.webgl||(n.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" rel="external nofollow" rel="external nofollow" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" rel="external nofollow" rel="external nofollow" style="color:#000">here</a>.'].join(`
`):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" rel="external nofollow" rel="external nofollow" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" rel="external nofollow" rel="external nofollow" style="color:#000">here</a>.'].join(`
`)),n},addGetWebGLMessage:function(n){var t=(n=n||{}).parent!==void 0?n.parent:document.body,r=n.id!==void 0?n.id:"oldie",i=e().getWebGLErrorMessage();i.id=r,t.appendChild(i)}}};const rW=Object.freeze(Object.defineProperty({__proto__:null,gpuDetector:hO},Symbol.toStringTag,{value:"Module"}));var fO=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("firefox")>-1?"firefox":e.indexOf("safari")>-1?"safari":e.indexOf("opr")>-1?"opera":e.indexOf("chrome")>-1?"chrome":e.indexOf("trident")>-1?"ie 11":e.indexOf("ie")>-1?"ie":"unknown"};const iW=Object.freeze(Object.defineProperty({__proto__:null,getBrowserName:fO},Symbol.toStringTag,{value:"Module"}));var Ro=F(F(F(F(F({},gr),OB),nW),rW),iW),oW=Ro.radialLayout,aW=function(){function e(n){this.type=n.type,this.radial=n.radial,this.config=n}return e.prototype.init=function(n){var t=this;this.data=n,this.radial?this.layoutMethod=function(r){var i=Pp[t.type](r,t.config);return oW(i),i}:this.layoutMethod=function(r){return Pp[t.type](r,t.config)}},e.prototype.execute=function(){return this.layoutMethod(this.data,this.config)},e.prototype.layout=function(n){return this.init(n),this.execute()},e}();$t.registerLayout("grid",$t.GridLayout),$t.registerLayout("random",$t.RandomLayout),$t.registerLayout("force",$t.ForceLayout),$t.registerLayout("circular",$t.CircularLayout),$t.registerLayout("dagre",$t.DagreLayout),$t.registerLayout("dagreCompound",$t.DagreCompoundLayout),$t.registerLayout("radial",$t.RadialLayout),$t.registerLayout("concentric",$t.ConcentricLayout),$t.registerLayout("mds",$t.MDSLayout),$t.registerLayout("fruchterman",$t.FruchtermanLayout),$t.registerLayout("fruchterman-gpu",$t.FruchtermanGPULayout),$t.registerLayout("gForce",$t.GForceLayout),$t.registerLayout("force2",$t.Force2Layout),$t.registerLayout("gForce-gpu",$t.GForceGPULayout),$t.registerLayout("comboForce",$t.ComboForceLayout),$t.registerLayout("comboCombined",$t.ComboCombinedLayout),$t.registerLayout("forceAtlas2",$t.ForceAtlas2Layout);var sW=function(e,n){var t=e.toString(),r=new Blob(["importScripts('".concat(n,"');(").concat(t,")()")],{type:"text/javascript"});return new Worker(URL.createObjectURL(r))},uW=function(e){e===void 0&&(e="https://unpkg.com/@antv/layout@0.3.23/dist/layout.min.js");var n=new sW(function(){var t="LAYOUT_RUN",r="LAYOUT_END",i="LAYOUT_ERROR",o="GPU_LAYOUT_RUN";layout.registerLayout("grid",layout.GridLayout),layout.registerLayout("random",layout.RandomLayout),layout.registerLayout("force",layout.ForceLayout),layout.registerLayout("force2",layout.Force2Layout),layout.registerLayout("circular",layout.CircularLayout),layout.registerLayout("dagre",layout.DagreLayout),layout.registerLayout("dagreCompound",layout.DagreCompoundLayout),layout.registerLayout("radial",layout.RadialLayout),layout.registerLayout("concentric",layout.ConcentricLayout),layout.registerLayout("mds",layout.MDSLayout),layout.registerLayout("fruchterman",layout.FruchtermanLayout),layout.registerLayout("fruchterman-gpu",layout.FruchtermanGPULayout),layout.registerLayout("gForce",layout.GForceLayout),layout.registerLayout("gForce-gpu",layout.GForceGPULayout),layout.registerLayout("comboForce",layout.ComboForceLayout),layout.registerLayout("comboCombined",layout.ComboCombinedLayout),layout.registerLayout("forceAtlas2",layout.ForceAtlas2Layout),onmessage=function(a){(function(s){var u=s.data.type;return u===t||u===o})(a)&&function(s){var u=this;switch(s.data.type){case t:var c,l=s.data,h=l.nodes,f=l.edges,d=l.layoutCfg,p=(b=d===void 0?{}:d).type;if(!(g=layout.getLayoutByName(p))){this.postMessage({type:i,message:"layout ".concat(p," not found")});break}b.onLayoutEnd=function(){u.postMessage({type:r,nodes:h}),c==null||c.destroy()},(c=new g(b)).init({nodes:h,edges:f}),c.execute();break;case o:var g,v=s.data,m=v.nodes,y=(f=v.edges,v.layoutCfg),b=y===void 0?{}:y,x=v.canvas;if(p=b.type,!(g=layout.getLayoutByName(p))){this.postMessage({type:i,message:"layout ".concat(p," not found")});break}if(p.split("-")[1]!=="gpu"){this.postMessage({type:i,message:"layout ".concat(p," does not support GPU")});break}var w=new g(b);w.init({nodes:m,edges:f}),w.executeWithWorker(x,this)}}(a)}},e);return n},cW="LAYOUT_RUN",lW="LAYOUT_END",hW="LAYOUT_TICK",fW="GPU_LAYOUT_RUN",dW="GPU_LAYOUT_END";function j1(e){return j1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},j1(e)}var pW=function(e){return setTimeout(e,16)},gW=function(e){return clearTimeout(e)},dO=function(e){return(typeof window<"u"&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame)||pW)(e)},pO=function(e){return(typeof window<"u"&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame)||gW)(e)},vW=["fruchterman","gForce"],mW=["force","grid","circular"],yW=function(e){function n(t){var r=e.call(this,t)||this;return r.graph=t,r.layoutCfg=t.get("layout")||{},r.layoutType=r.getLayoutType(),r.worker=null,r.workerData={},r.initLayout(),r}return Nt(n,e),n.prototype.initLayout=function(){},n.prototype.getWorker=function(){return this.worker||(typeof Worker>"u"?this.worker=null:this.worker=uW(this.layoutCfg.workerScriptURL)),this.worker},n.prototype.stopWorker=function(){var t=this.workerData;this.worker&&(this.worker.terminate(),this.worker=null,t.requestId&&(pO(t.requestId),t.requestId=null),t.requestId2&&(pO(t.requestId2),t.requestId2=null))},n.prototype.execLayoutMethod=function(t,r){var i=this;return new Promise(function(o,a){return Rr(i,void 0,void 0,function(){var s,u,c,l,h,f,d,p,g;return jr(this,function(v){switch(v.label){case 0:if(!(s=this.graph)||s.get("destroyed"))return[2];u=t.type,t.onLayoutEnd=function(){s.emit("aftersublayout",{type:u}),o()},u&&this.isGPU&&gO(u)&&(u="".concat(u,"-gpu")),gr.isForce(u)?(c=t.onTick,l=t.animate,h=l===void 0&&(u==="force"||u==="force2"),p=function(){c&&c(),(l||h)&&s.refreshPositions()},t.tick=p):u!=="comboForce"&&u!=="comboCombined"||(t.comboTrees=s.get("comboTrees"));try{f=new $t.Layouts[u](t),this.layoutMethods[r]&&this.layoutMethods[r].destroy(),this.layoutMethods[r]=f}catch{a()}return f.enableTick&&(d=t.onTick,p=function(){d&&d(),s.refreshPositions()},f.tick=p),function(m,y){var b;!((b=m==null?void 0:m.nodes)===null||b===void 0)&&b.length&&m.nodes.forEach(function(x){x.layoutOrder=y})}(g=this.filterLayoutData(this.data,t),r),f.init(g),s.emit("beforesublayout",{type:u}),[4,f.execute()];case 1:return v.sent(),f.isCustomLayout&&t.onLayoutEnd&&t.onLayoutEnd(),[2]}})})})},n.prototype.updateLayoutMethod=function(t,r){var i=this;return new Promise(function(o,a){return Rr(i,void 0,void 0,function(){var s,u,c,l,h,f,d;return jr(this,function(p){switch(p.label){case 0:return s=this.graph,u=r==null?void 0:r.type,r.onLayoutEnd=function(){s.emit("aftersublayout",{type:u}),o()},gr.isForce(u)&&(c=r.onTick,l=r.animate,h=l===void 0&&(u==="force"||u==="force2"),f=function(){c==null||c(),(l||h)&&s.refreshPositions()},r.tick=f),d=this.filterLayoutData(this.data,r),t.init(d),t.updateCfg(r),s.emit("beforesublayout",{type:u}),[4,t.execute()];case 1:return p.sent(),t.isCustomLayout&&r.onLayoutEnd&&r.onLayoutEnd(),[2]}})})})},n.prototype.layout=function(t){var r,i=this,o=this.graph;if(o&&!o.get("destroyed")){this.data=this.setDataFromGraph();var a=this.data,s=a.nodes,u=a.hiddenNodes;if(!s)return!1;var c=o.get("width"),l=o.get("height"),h={};Object.assign(h,{width:c,height:l,center:[c/2,l/2]},this.layoutCfg),this.layoutCfg=h;var f=h.type,d=!1;(r=this.layoutMethods)===null||r===void 0||r.forEach(function(x){var w;return d=!!(!((w=x.nodes)===null||w===void 0)&&w.length)||d});var p=this.destoryLayoutMethods();o.emit("beforelayout");var g=Promise.resolve();d&&f&&(p==null?void 0:p.length)===1&&p[0]===f?this.tweakInit():g=this.initPositions(h.center,s),this.initPositions(h.center,u).then(),this.isGPU=vO(h,f);var v=h.onLayoutEnd,m=h.layoutEndFormatted,y=h.adjust;if(m||(h.layoutEndFormatted=!0,h.onAllLayoutEnd=function(){return Rr(i,void 0,void 0,function(){return jr(this,function(x){switch(x.label){case 0:return v&&v(s),this.refreshLayout(),y&&h.pipes?[4,this.adjustPipesBox(this.data,y)]:[3,2];case 1:x.sent(),this.refreshLayout(),x.label=2;case 2:return o.emit("afterlayout"),[2]}})})}),this.stopWorker(),h.workerEnabled&&this.layoutWithWorker(this.data,t))return!0;var b=!1;return h.type?(b=!0,g=g.then(function(){return Rr(i,void 0,void 0,function(){return jr(this,function(x){switch(x.label){case 0:return[4,this.execLayoutMethod(h,0)];case 1:return[2,x.sent()]}})})})):h.pipes&&(b=!0,h.pipes.forEach(function(x,w){g=g.then(function(){return Rr(i,void 0,void 0,function(){return jr(this,function(E){switch(E.label){case 0:return[4,this.execLayoutMethod(x,w)];case 1:return[2,E.sent()]}})})})})),b?g.then(function(){h.onAllLayoutEnd&&h.onAllLayoutEnd(),t&&t()}).catch(function(x){}):(o.refreshPositions(),t==null||t()),!1}},n.prototype.tweakInit=function(){var t=this.data,r=this.graph,i=t.nodes,o=t.edges;if(i!=null&&i.length){var a={};i.forEach(function(c){var l=c.x,h=c.y;isNaN(l)||isNaN(h)||(a[c.id]={x:l,y:h},c.mass=c.mass||2)}),o.forEach(function(c){var l=c.source,h=c.target,f=a[l],d=a[h];!f&&d?a[l]={x:d.x+80*(Math.random()-.5),y:d.y+80*(Math.random()-.5)}:!d&&f&&(a[h]={x:f.x+80*(Math.random()-.5),y:f.y+80*(Math.random()-.5)})});var s=r.get("width"),u=r.get("height");i.forEach(function(c){var l=a[c.id]||{x:s/2+20*(Math.random()-.5),y:u/2+20*(Math.random()-.5)};c.x=l.x,c.y=l.y})}},n.prototype.initWithPreset=function(t,r){var i=this;return new Promise(function(o,a){return Rr(i,void 0,void 0,function(){var s,u,c,l,h,f,d;return jr(this,function(p){switch(p.label){case 0:return u=(s=this).layoutCfg,c=s.data,(l=u.preset)!=null&&l.type&&$t.Layouts[l==null?void 0:l.type]?(h=vO(l,l.type),f=h?"".concat(l.type,"-gpu"):l.type,d=new $t.Layouts[f](l),delete u.preset,d.init(c),[4,d.execute()]):(r==null||r(),o(),[2,!1]);case 1:return p.sent(),t==null||t(),o(),[2,!0]}})})})},n.prototype.layoutWithWorker=function(t,r){var i=this,o=this.layoutCfg,a=this.graph,s=this.getWorker(),u=this.workerData;if(!s)return!1;u.requestId=null,u.requestId2=null,u.currentTick=null,u.currentTickData=null,a.emit("beforelayout");var c=Promise.resolve(),l=!1;if(o.type)l=!0,c=c.then(function(){return i.runWebworker(s,t,o)});else if(o.pipes){l=!0;for(var h=function(p){c=c.then(function(){return i.runWebworker(s,t,p)})},f=0,d=o.pipes;f<d.length;f++)h(d[f])}return l&&c.then(function(){o.onAllLayoutEnd&&o.onAllLayoutEnd(),r==null||r()}).catch(function(p){}),!0},n.prototype.runWebworker=function(t,r,i){var o=this,a=this.isGPU,s=this.filterLayoutData(r,i),u=s.nodes,c=s.edges,l=document.createElement("canvas"),h=a&&typeof window<"u"&&window.navigator&&!navigator.gpu&&"OffscreenCanvas"in window&&"transferControlToOffscreen"in l,f=function(p,g){var v={};return p&&j1(p)==="object"?(Object.keys(p).forEach(function(m){p.hasOwnProperty(m)&&g(p[m])&&(v[m]=p[m])}),v):p}(i,function(p){return typeof p!="function"});if(h){var d=l.transferControlToOffscreen();f.type="".concat(f.type,"-gpu"),t.postMessage({type:fW,nodes:u,edges:c,layoutCfg:f,canvas:d},[d])}else t.postMessage({type:cW,nodes:u,edges:c,layoutCfg:f});return new Promise(function(p,g){t.onmessage=function(v){o.handleWorkerMessage(p,g,v,s,i)}})},n.prototype.handleWorkerMessage=function(t,r,i,o,a){var s=this.graph,u=this.workerData,c=i.data,l=c.type,h=function(){a.onTick&&a.onTick()};switch(l){case hW:u.currentTick=c.currentTick,u.currentTickData=c,u.requestId||(u.requestId=dO(function(){B1(o,c),s.refreshPositions(),h(),c.currentTick===c.totalTicks?t():u.currentTick===c.totalTicks&&(u.requestId2=dO(function(){B1(o,u.currentTickData),s.refreshPositions(),u.requestId2=null,h(),t()})),u.requestId=null}));break;case lW:u.currentTick==null&&(B1(o,c),t());break;case dW:u.currentTick==null&&(function(f,d){for(var p=f.nodes,g=d.vertexEdgeData,v=p.length,m=0;m<v;m++){var y=p[m],b=g[4*m],x=g[4*m+1];y.x=b,y.y=x}}(o,c),t());break;default:r()}},n.prototype.updateLayoutCfg=function(t){var r=this,i=this.graph,o=this.layoutMethods;if(i&&!i.get("destroyed")){var a=t.disableTriggerLayout,s=Yn(t,["disableTriggerLayout"]),u=St({},this.layoutCfg,s);if(this.layoutCfg=u,!a)if(o!=null&&o.length){if(this.data=this.setDataFromGraph(),this.stopWorker(),!s.workerEnabled||!this.layoutWithWorker(this.data,null)){i.emit("beforelayout");var c=Promise.resolve(),l=!1;(o==null?void 0:o.length)===1?(l=!0,c=c.then(function(){return Rr(r,void 0,void 0,function(){return jr(this,function(h){switch(h.label){case 0:return[4,this.updateLayoutMethod(o[0],u)];case 1:return[2,h.sent()]}})})})):o!=null&&o.length&&(l=!0,o.forEach(function(h,f){var d=u.pipes[f];c=c.then(function(){return Rr(r,void 0,void 0,function(){return jr(this,function(p){switch(p.label){case 0:return[4,this.updateLayoutMethod(h,d)];case 1:return[2,p.sent()]}})})})})),l&&c.then(function(){u.onAllLayoutEnd&&u.onAllLayoutEnd()}).catch(function(h){})}}else this.layout()}},n.prototype.adjustPipesBox=function(t,r){var i=this;return new Promise(function(o){var a=t.nodes;a!=null&&a.length||o(),mW.includes(r)||o();var s={center:i.layoutCfg.center,nodeSize:function(f){return Math.max(f.height,f.width)},preventOverlap:!0,onLayoutEnd:function(){}},u=i.getLayoutBBox(a),c=u.groupNodes,l=u.layoutNodes,h=Kt(l);s.onLayoutEnd=function(){l==null||l.forEach(function(f,d){var p,g,v,m=f.x-((p=h[d])===null||p===void 0?void 0:p.x),y=f.y-((g=h[d])===null||g===void 0?void 0:g.y);(v=c[d])===null||v===void 0||v.forEach(function(b){b.x+=m,b.y+=y})}),o()},new $t.Layouts[r](s).layout({nodes:l})})},n.prototype.destroy=function(){this.destoryLayoutMethods();var t=this.worker;t&&(t.terminate(),this.worker=null),this.destroyed=!0,this.graph.set("layout",void 0),this.layoutCfg=void 0,this.layoutType=void 0,this.layoutMethods=void 0,this.graph=null},n}(cR);function B1(e,n){for(var t=e.nodes,r=n.nodes,i=t.length,o=0;o<i;o++){var a=t[o];a.x=r[o].x,a.y=r[o].y}}function gO(e){return vW.includes(e)}function vO(e,n){var t=n;n&&n.split("-")[1]==="gpu"&&(t=n.split("-")[0],e.gpuEnabled=!0);var r=!1;return e.gpuEnabled&&(r=!0,hO().webgl||(r=!1)),r&&!gO(t)&&(r=!1),r}var mO=Qr,yO=function(e){function n(t){var r=e.call(this,t)||this,i=r.get("defaultNode");return i||r.set("defaultNode",{type:"circle"}),i.type||(i.type="circle",r.set("defaultNode",i)),r.destroyed=!1,r}return Nt(n,e),n.prototype.initLayoutController=function(){var t=new yW(this);this.set({layoutController:t})},n.prototype.initEventController=function(){var t=new LB(this);this.set({eventController:t})},n.prototype.initCanvas=function(){var t=this.get("container");if(typeof t=="string"&&(t=document.getElementById(t),this.set("container",t)),!t)throw new Error("invalid container");var r,i=t.clientWidth,o=t.clientHeight,a=this.get("width")||i,s=this.get("height")||o;if(this.get("width")||this.get("height")||(this.set("width",i),this.set("height",o)),this.get("renderer")==="svg")r=new Hc({container:t,width:a,height:s});else{var u={container:t,width:a,height:s},c=this.get("pixelRatio");c&&(u.pixelRatio=c,window.devicePixelRatio=c),r=new bo(u)}this.set("canvas",r)},n.prototype.initPlugins=function(){var t=this;ye(t.get("plugins"),function(r){!r.destroyed&&r.initPlugin&&r.initPlugin(t)})},n.prototype.downloadImageWatermark=function(t,r,i,o){return Rr(this,void 0,void 0,function(){var a,s,u;return jr(this,function(c){switch(c.label){case 0:return a=t.style.backgroundImage,s=a.slice(5,a.length-2),(u=new Image).src=s,[4,new Promise(function(l){u.onload=function(){var h=r.createPattern(u,"repeat");r.rect(0,0,i,o),r.fillStyle=h,r.fill(),l("")}})];case 1:return c.sent(),[2]}})})},n.prototype.asyncToDataUrl=function(t,r,i,o,a,s){var u=this,c=document.querySelector(".g6-graph-watermarker"),l=this.get("canvas"),h=l.getRenderer(),f=s||l.get("el"),d="";t||(t="image/png"),setTimeout(function(){return Rr(u,void 0,void 0,function(){var p,g,v,m,y,b,x,w,E,M;return jr(this,function(_){switch(_.label){case 0:return h!=="svg"?[3,1]:(p=f.cloneNode(!0),g=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),(v=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",g)).replaceChild(p,v.documentElement),m=new XMLSerializer().serializeToString(v),d="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(m)),[3,4]);case 1:return y=void 0,b=f.getContext("2d"),x=o||this.get("width"),w=a||this.get("height"),E=void 0,c?[4,this.downloadImageWatermark(c,b,x,w)]:[3,3];case 2:_.sent(),_.label=3;case 3:if(r){M=typeof window<"u"?window.devicePixelRatio:1;try{y=b.getImageData(0,0,x*M,w*M),E=b.globalCompositeOperation,b.globalCompositeOperation="destination-over",b.fillStyle=r,b.fillRect(0,0,x,w)}catch{}}d=f.toDataURL(t),r&&(b.clearRect(0,0,x,w),b.putImageData(y,0,0),b.globalCompositeOperation=E),_.label=4;case 4:return i&&i(d),[2]}})})},16)},n.prototype.toDataURL=function(t,r){var i=this.get("canvas"),o=i.getRenderer(),a=i.get("el");t||(t="image/png");var s="";if(o==="svg"){var u=a.cloneNode(!0),c=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),l=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",c);l.replaceChild(u,l.documentElement);var h=new XMLSerializer().serializeToString(l);s="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(h))}else{var f=void 0,d=a.getContext("2d"),p=Math.max(this.get("width"),500),g=Math.max(this.get("height"),500),v=void 0;if(r){var m=typeof window<"u"&&window.devicePixelRatio||1;try{f=d.getImageData(0,0,p*m,g*m),v=d.globalCompositeOperation,d.globalCompositeOperation="destination-over",d.fillStyle=r,d.fillRect(0,0,p,g)}catch{}}s=a.toDataURL(t),r&&(d.clearRect(0,0,p,g),d.putImageData(f,0,0),d.globalCompositeOperation=v)}return s},n.prototype.toFullDataURL=function(t,r,i){var o=this.get("group").getCanvasBBox(),a=o.height,s=o.width,u=this.get("renderer"),c=gn('<div id="virtual-image"></div>'),l=i?i.backgroundColor:void 0,h=i?i.padding:void 0;h?xt(h)&&(h=[h,h,h,h]):h=[0,0,0,0];var f=a+h[0]+h[2],d=s+h[1]+h[3],p={container:c,height:f,width:d,quickHit:!0},g=u==="svg"?new Hc(p):new bo(p),v=this.get("group").clone(),m=Kt(v.getMatrix());m||(m=[1,0,0,0,1,0,0,0,1]);var y=(o.maxX+o.minX)/2,b=(o.maxY+o.minY)/2;m=mO(m,[["t",-y,-b],["t",s/2+h[3],a/2+h[0]]]),v.resetMatrix(),v.setMatrix(m),g.add(v);var x=g.get("el"),w="";r||(r="image/png"),setTimeout(function(){if(u==="svg"){var E=x.cloneNode(!0),M=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),_=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",M);_.replaceChild(E,_.documentElement);var k=new XMLSerializer().serializeToString(_);w="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(k))}else{var S=void 0,C=x.getContext("2d"),T=void 0;if(l){var A=typeof window<"u"?window.devicePixelRatio:1;try{S=C.getImageData(0,0,d*A,f*A),T=C.globalCompositeOperation,C.globalCompositeOperation="destination-over",C.fillStyle=l,C.fillRect(0,0,d,f)}catch{}}w=x.toDataURL(r),l&&(C.clearRect(0,0,d,f),C.putImageData(S,0,0),C.globalCompositeOperation=T)}t&&t(w)},16)},n.prototype.downloadFullImage=function(t,r,i){var o=this,a=this.get("group").getCanvasBBox(),s=a.height,u=a.width,c=this.get("renderer"),l=gn('<div id="virtual-image"></div>'),h=document.querySelector(".g6-graph-watermarker"),f=i?i.backgroundColor:void 0,d=i?i.padding:void 0;d?xt(d)&&(d=[d,d,d,d]):d=[0,0,0,0];var p=s+d[0]+d[2],g=u+d[1]+d[3];if(h){var v=this.get("graphWaterMarker").cfg||{},m=v.width,y=v.height;p=Math.ceil(p/y)*y,g=Math.ceil(g/m)*m}var b,x,w={container:l,height:p,width:g},E=c==="svg"?new Hc(w):new bo(w),M=this.get("group"),_=(x=(b=M).clone(),NB(b,x),x),k=Kt(_.getMatrix());k||(k=[1,0,0,0,1,0,0,0,1]);var S=(a.maxX+a.minX)/2,C=(a.maxY+a.minY)/2;k=mO(k,[["t",-S,-C],["t",u/2+d[3],s/2+d[0]]]),_.resetMatrix(),_.setMatrix(k),E.add(_);var T=E.get("el");r||(r="image/png"),this.asyncToDataUrl(r,f,function(A){var D=document.createElement("a"),j=(t||"graph")+(c==="svg"?".svg":".".concat(r.split("/")[1]));o.dataURLToImage(A,c,D,j);var L=document.createEvent("MouseEvents");L.initEvent("click",!1,!1),D.dispatchEvent(L)},g,p,T)},n.prototype.downloadImage=function(t,r,i){var o=this,a=this;a.stopAnimate();var s=a.get("canvas").getRenderer();r||(r="image/png");var u=(t||"graph")+(s==="svg"?".svg":".".concat(r.split("/")[1])),c=document.createElement("a");a.asyncToDataUrl(r,i,function(l){o.dataURLToImage(l,s,c,u);var h=document.createEvent("MouseEvents");h.initEvent("click",!1,!1),c.dispatchEvent(h)})},n.prototype.dataURLToImage=function(t,r,i,o){if(t&&t!=="data:"&&typeof window<"u")if(window.Blob&&window.URL&&r!=="svg"){var a=t.split(","),s="";if(a&&a.length>0){var u=a[0].match(/:(.*?);/);u&&u.length>=2&&(s=u[1])}for(var c=atob(a[1]),l=c.length,h=new Uint8Array(l);l--;)h[l]=c.charCodeAt(l);var f=new Blob([h],{type:s});window.navigator.msSaveBlob?window.navigator.msSaveBlob(f,o):i.addEventListener("click",function(){i.download=o,i.href=window.URL.createObjectURL(f)})}else i.addEventListener("click",function(){i.download=o,i.href=t})},n.prototype.addPlugin=function(t){t.destroyed||(this.get("plugins").push(t),t.initPlugin(this))},n.prototype.removePlugin=function(t){var r=this.get("plugins"),i=r.indexOf(t);i>=0&&(t.destroyPlugin(),r.splice(i,1))},n.prototype.setImageWaterMarker=function(t,r){t===void 0&&(t=is.waterMarkerImage);var i=this.get("container");Re(i)&&(i=document.getElementById(i)),i.style.position||(i.style.position="relative");var o=this.get("graphWaterMarker"),a=fn({},is.imageWaterMarkerConfig,r),s=a.width,u=a.height,c=a.compatible,l=a.image;if(!t){var h=c?i:document.querySelector(".g6-graph-watermarker");return h&&(h.style.cssText=void 0),void(o&&o.clear())}if(o)o.clear();else{var f={container:i,width:s,height:u,capture:!1},d=this.get("pixelRatio");d&&(f.pixelRatio=d,window.devicePixelRatio=d),o=new bo(f),this.set("graphWaterMarker",o)}o.get("el").style.display="none";var p=o.get("context"),g=l.rotate,v=l.x,m=l.y;p.rotate(-g*Math.PI/180);var y=new Image;y.crossOrigin="anonymous",y.src=t,y.onload=function(){if(p.drawImage(y,v,m,l.width,l.height),p.rotate(g*Math.PI/180),c)i.style.cssText="background-image: url(".concat(o.get("el").toDataURL("image/png"),");background-repeat:repeat;");else{var b=document.querySelector(".g6-graph-watermarker");b||((b=document.createElement("div")).className="g6-graph-watermarker"),b.className="g6-graph-watermarker",o.destroyed||(b.style.cssText="background-image: url(".concat(o.get("el").toDataURL("image/png"),");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:-1;"),i.appendChild(b))}}},n.prototype.setTextWaterMarker=function(t,r){var i=this.get("container");Re(i)&&(i=document.getElementById(i)),i.style.position||(i.style.position="relative");var o=this.get("graphWaterMarker"),a=fn({},is.textWaterMarkerConfig,r),s=a.width,u=a.height,c=a.compatible,l=a.text;if(!(t!=null&&t.length)){var h=c?i:document.querySelector(".g6-graph-watermarker");return h&&(h.style.cssText=void 0),void(o&&o.clear())}if(o)o.clear();else{var f={container:i,width:s,height:u,capture:!1},d=this.get("pixelRatio");d&&(f.pixelRatio=d,window.devicePixelRatio=d),o=new bo(f),this.set("graphWaterMarker",o)}o.get("el").style.display="none";var p=o.get("context"),g=l.rotate,v=l.fill,m=l.fontFamily,y=l.fontSize,b=l.baseline,x=l.x,w=l.y,E=l.lineHeight;p.rotate(-g*Math.PI/180),p.font="".concat(y,"px ").concat(m),p.fillStyle=v,p.textBaseline=b;for(var M=Re(t)?[t]:t,_=M.length-1;_>=0;_--)p.fillText(M[_],x,w+_*E);if(p.rotate(g*Math.PI/180),c)i.style.cssText="background-image: url(".concat(o.get("el").toDataURL("image/png"),");background-repeat:repeat;");else{var k=document.querySelector(".g6-graph-watermarker");k||((k=document.createElement("div")).className="g6-graph-watermarker"),k.style.cssText="background-image: url(".concat(o.get("el").toDataURL("image/png"),");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:99;"),i.appendChild(k)}},n.prototype.destroy=function(){var t,r,i,o;ye(this.get("plugins"),function(l){l.destroyPlugin()});var a=this.get("tooltips");if(a)for(var s=0;s<a.length;s++){var u=a[s];if(u){var c=u.parentElement;c&&c.removeChild(u)}}(t=this.get("eventController"))===null||t===void 0||t.destroy(),(r=this.get("layoutController"))===null||r===void 0||r.destroy(),(i=this.get("graphWaterMarker"))===null||i===void 0||i.destroy(),(o=document.querySelector(".g6-graph-watermarker"))===null||o===void 0||o.remove(),e.prototype.destroy.call(this)},n}(Q6);function z1(e){return z1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},z1(e)}function bO(e,n){if(n===void 0&&(n=new WeakMap),e===null)return e;if(e instanceof Date)return new Date(e);if(e instanceof RegExp)return new RegExp(e);if(z1(e)!=="object")return e;if(n.get(e))return n.get(e);var t=Array.isArray(e)?[]:{};for(var r in n.set(e,t),e)e.hasOwnProperty(r)&&e[r]!==void 0&&(t[r]=bO(e[r],n));return t}function bW(e){try{return structuredClone(e)}catch{return bO(e)}}var Lp,xW=Ro.radialLayout,F1=Ro.traverseTree,wW=function(e){function n(t){var r=e.call(this,t)||this;return r.layoutAnimating=!1,r.set("removeList",[]),r.set("layoutMethod",r.getLayout()),r}return Nt(n,e),n.prototype.getLayout=function(){var t=this.get("layout");return t?typeof t=="function"?t:(t.type||(t.type="dendrogram"),t.direction||(t.direction=t.type==="indented"?"LR":"TB"),t.radial?function(r){var i=Pp[t.type](r,t);return xW(i),i}:function(r){return Pp[t.type](r,t)}):null},n.indexOfChild=function(t,r){var i=-1;return ye(t,function(o,a){if(r===o.id)return i=a,!1}),i},n.prototype.getDefaultCfg=function(){var t=e.prototype.getDefaultCfg.call(this);return t.animate=!0,t},n.prototype.innerAddChild=function(t,r,i){var o=this,a=t.data;a&&(a.x=t.x,a.y=t.y,a.depth=t.depth);var s=o.addItem("node",a,!1);if(r){if(s.set("parent",r),i){var u=r.get("originAttrs");if(u)s.set("originAttrs",u);else{var c=r.getModel();s.set("originAttrs",{x:c.x,y:c.y})}}var l=r.get("children");l?l.push(s):r.set("children",[s]),o.addItem("edge",{source:r.get("id"),target:s.get("id"),id:"".concat(r.get("id"),":").concat(s.get("id"))},!1)}return ye(t.children||[],function(h){o.innerAddChild(h,s,i)}),o.emit("afteraddchild",{item:s,parent:r}),s},n.prototype.innerUpdateChild=function(t,r,i){var o=this,a=o.findById(t.id);if(a){ye(t.children||[],function(d){o.innerUpdateChild(d,a,i)});var s,u,c=a.get("children");if(c&&c.length>0)for(var l=c.length-1;l>=0;l--){var h=c[l].getModel();n.indexOfChild(t.children||[],h.id)===-1&&(o.innerRemoveChild(h.id,{x:t.x,y:t.y},i),c.splice(l,1))}a.get("originAttrs")&&(s=a.get("originAttrs").x,u=a.get("originAttrs").y);var f=a.getModel();i&&a.set("originAttrs",{x:f.x,y:f.y}),a.set("model",Object.assign(f,t.data)),s===t.x&&u===t.y||a.updatePosition({x:t.x,y:t.y})}else o.innerAddChild(t,r,i)},n.prototype.innerRemoveChild=function(t,r,i){var o=this,a=o.findById(t);if(a)if(ye(a.get("children"),function(u){o.innerRemoveChild(u.getModel().id,r,i)}),i){var s=a.getModel();a.set("to",r),a.set("originAttrs",{x:s.x,y:s.y}),o.get("removeList").push(a)}else o.removeItem(a,!1)},n.prototype.changeData=function(t,r){r===void 0&&(r=!0);var i=this;this.getNodes().map(function(o){return i.clearItemStates(o)}),this.getEdges().map(function(o){return i.clearItemStates(o)}),r&&this.get("enabledStack")&&this.pushStack("changedata",{before:i.get("originData"),after:t||i.get("data")}),t?(i.data(t),i.render(!1)):i.layout(this.get("fitView"))},n.prototype.changeLayout=function(t){this.updateLayout(t)},n.prototype.updateLayout=function(t,r,i,o){o===void 0&&(o=!0);var a=this;if(t&&(o&&this.get("enabledStack")&&this.pushStack("layout",{before:a.get("layout"),after:t}),a.set("layout",t),a.set("layoutMethod",a.getLayout()),a.layout(),r)){var s=i;s||(s=r==="begin"?{x:0,y:0}:{x:this.getWidth()/2,y:this.getHeight()/2}),s=this.getPointByCanvas(s.x,s.y);var u=this.getGroup().getMatrix()||[1,0,0,0,1,0,0,0,1];s.x=s.x*u[0]+u[6],s.y=s.y*u[0]+u[7];var c=this.getGroup().getCanvasBBox(),l=c.minX,h=c.maxX,f=c.minY,d={x:(l+h)/2,y:(f+c.maxY)/2};r==="begin"&&(d.x=l,d.y=f),this.translate(s.x-d.x,s.y-d.y)}},n.prototype.refreshLayout=function(t){this.layout(t)},n.prototype.layout=function(t){var r=this,i=this,o=i.get("data"),a=i.get("layoutMethod"),s=i.get("layout"),u=o;if(s!=null&&s.excludeInvisibles){o=Kt(i.get("data"));var c={};F1(o,function(h){var f=h.children;if(!(f!=null&&f.length))return!0;for(var d=f.length-1;d>=0;d--){var p=r.findById(f[d].id);(p?!p.isVisible():f[d].visible===!1)&&(c[h.id]=c[h.id]||[],c[h.id].push({idx:d,child:f.splice(d,1)[0]}))}}),u=a?a(o,i.get("layout")):o,F1(u,function(h){var f=c[h.id];if(f!=null&&f.length)for(var d=f.length-1;d>=0;d--){var p=f[d],g=p.idx,v=p.child;h.children.splice(g,0,v)}})}else u=a?a(o,i.get("layout")):o;var l=i.get("animate");i.emit("beforerefreshlayout",{data:o,layoutData:u}),i.emit("beforelayout"),i.innerUpdateChild(u,void 0,l),t&&i.get("viewController").fitView(),l?i.layoutAnimate(u):(i.refresh(),i.paint()),i.emit("afterrefreshlayout",{data:o,layoutData:u}),i.emit("afterlayout")},n.prototype.addChild=function(t,r,i){i===void 0&&(i=!0);var o=this;o.emit("beforeaddchild",{model:t,parent:r}),Re(r)||(r=r.get("id"));var a=o.findDataById(r);a&&(a.children||(a.children=[]),a.children.push(t),o.findById(r).refresh(),o.changeData(void 0,i))},n.prototype.updateChildren=function(t,r,i){i===void 0&&(i=!0);var o=this,a=o.findById(r);r&&a&&(o.findDataById(r).children=t,a.refresh(),o.changeData(void 0,i))},n.prototype.updateChild=function(t,r,i){i===void 0&&(i=!0);var o=this;if(r&&o.findById(r)){var a=o.findDataById(r),s=o.findById(t.id);if(a.children||(a.children=[]),s){var u=n.indexOfChild(a.children,t.id);u>-1&&(a.children[u]=t)}else a.children.push(t);var c=o.findById(r);c==null||c.refresh(),o.changeData(void 0,i)}else o.changeData(t,i)},n.prototype.removeChild=function(t,r){r===void 0&&(r=!0);var i,o=this,a=o.findById(t);if((i=a?a==null?void 0:a.get("parent"):o.getNodes().find(function(h){return!!(h.getModel().children||[]).find(function(f){return f.id===t})}))&&!i.destroyed){var s=i.get("id"),u=o.findDataById(s),c=u&&u.children||[],l=n.indexOfChild(c,t);c.splice(l,1),i.refresh()}o.changeData(void 0,r)},n.prototype.findDataById=function(t,r){var i=this;if(r||(r=i.get("data")),t===r.id)return r;var o=null;return ye(r.children||[],function(a){return a.id===t?(o=a,!1):!(o=i.findDataById(t,a))&&void 0}),o},n.prototype.layoutAnimate=function(t,r){var i=this,o=this.get("animateCfg");i.emit("beforeanimate",{data:t}),i.getEdges().forEach(function(a){var s=a.get("model");s.sourceAnchor||(s.sourceAnchor=a.get("sourceAnchorIndex"))}),this.get("canvas").animate(function(a){F1(t,function(s){var u=i.findById(s.id);if(u){var c=u.get("originAttrs"),l=u.get("model");if(c||(c={x:l.x,y:l.y},u.set("originAttrs",c)),r){var h=r(u,a,c,t);u.set("model",Object.assign(l,h))}else l.x=c.x+(s.x-c.x)*a,l.y=c.y+(s.y-c.y)*a}return!0}),ye(i.get("removeList"),function(s){var u=s.getModel(),c=s.get("originAttrs"),l=s.get("to");u.x=c.x+(l.x-c.x)*a,u.y=c.y+(l.y-c.y)*a}),i.refreshPositions()},{duration:o.duration,easing:o.ease,callback:function(){ye(i.getNodes(),function(a){a.set("originAttrs",null)}),ye(i.get("removeList"),function(a){i.removeItem(a,!1)}),i.set("removeList",[]),o.callback&&o.callback(),i.emit("afteranimate",{data:t})},delay:o.delay})},n.prototype.stopLayoutAnimate=function(){this.get("canvas").stopAnimate(),this.emit("layoutanimateend",{data:this.get("data")}),this.layoutAnimating=!1},n.prototype.isLayoutAnimating=function(){return this.layoutAnimating},n.prototype.render=function(t){t===void 0&&(t=!0);var r=this,i=r.get("data");if(!i||!tr(i)||!Object.keys(i).length)throw new Error("data must be defined first");r.clear(),t&&this.get("enabledStack")&&this.clearStack(),r.emit("beforerender"),r.layout(this.get("fitView")),r.emit("afterrender")},n.prototype.save=function(){return this.get("data")},n.prototype.data=function(t){e.prototype.data.call(this,t),this.set("originData",bW(t))},n}(yO),qr=function(){function e(n){this._cfgs=fn(this.getDefaultCfgs(),n),this._events={},this.destroyed=!1}return e.prototype.getDefaultCfgs=function(){return{}},e.prototype.initPlugin=function(n){var t=this;t.set("graph",n);var r=t.getEvents(),i={};ye(r,function(o,a){var s=Ya(t,o);i[a]=s,n.on(a,s)}),this._events=i,this.init()},e.prototype.getEvents=function(){return{}},e.prototype.get=function(n){var t;return(t=this._cfgs)===null||t===void 0?void 0:t[n]},e.prototype.set=function(n,t){this._cfgs[n]=t},e.prototype.destroy=function(){},e.prototype.destroyPlugin=function(){this.destroy();var n=this.get("graph");ye(this._events,function(t,r){n.off(r,t)}),this._events=null,this._cfgs=null,this.destroyed=!0},e}(),EW=(Lp=function(e,n){return Lp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},Lp(e,n)},function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function t(){this.constructor=e}Lp(e,n),e.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}),xO="url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAwIDEwIEwgNDAgMTAgTSAxMCAwIEwgMTAgNDAgTSAwIDIwIEwgNDAgMjAgTSAyMCAwIEwgMjAgNDAgTSAwIDMwIEwgNDAgMzAgTSAzMCAwIEwgMzAgNDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2UwZTBlMCIgb3BhY2l0eT0iMC4yIiBzdHJva2Utd2lkdGg9IjEiLz48cGF0aCBkPSJNIDQwIDAgTCAwIDAgMCA0MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZTBlMGUwIiBzdHJva2Utd2lkdGg9IjEiLz48L3BhdHRlcm4+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JpZCkiLz48L3N2Zz4=)",MW=function(e){function n(t){return e.call(this,t)||this}return EW(n,e),n.prototype.getDefaultCfgs=function(){return{img:xO,follow:!0}},n.prototype.init=function(){var t=this.get("graph"),r=t.get("container"),i=t.get("canvas").get("el"),o=this.get("img")||xO;o.includes("url(")||(o='url("'.concat(o,'")'));var a=gn(`<div class='g6-grid-container' style="position:absolute;overflow:hidden;z-index: -1;"></div>`),s=gn(`<div
        class='g6-grid'
        style='position:absolute;
        background-image: `.concat(o,`;
        user-select: none
        '></div>`));this.set("container",a),this.set("gridContainer",s),this.positionInit(),a.appendChild(s),r.insertBefore(a,i)},n.prototype.positionInit=function(){var t=this.get("graph"),r=t.get("minZoom"),i=t.get("width"),o=t.get("height");qt(this.get("container"),{width:"".concat(i,"px"),height:"".concat(o,"px")});var a=80*i/r,s=80*o/r;qt(this.get("gridContainer"),{width:"".concat(a,"px"),height:"".concat(s,"px"),left:"-".concat(a/2,"px"),top:"-".concat(s/2,"px")})},n.prototype.getEvents=function(){return{viewportchange:"updateGrid"}},n.prototype.updateGrid=function(t){var r=this.get("gridContainer"),i=t.matrix;i||(i=[1,0,0,0,1,0,0,0,1]);var o=this.get("follow");qt(r,{transform:"matrix(".concat(i[0],", ").concat(i[1],", ").concat(i[3],", ").concat(i[4],", ").concat(o?i[6]:"0",", ").concat(o?i[7]:"0",")")})},n.prototype.getContainer=function(){return this.get("container")},n.prototype.destroy=function(){var t=this.get("graph").get("container"),r=this.get("container");t.removeChild(r)},n}(qr),G1={exports:{}},wO=[],Gl=[];function EO(e,n){if(n=n||{},e===void 0)throw new Error("insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).");var t,r=n.prepend===!0?"prepend":"append",i=n.container!==void 0?n.container:document.querySelector("head"),o=wO.indexOf(i);return o===-1&&(o=wO.push(i)-1,Gl[o]={}),Gl[o]!==void 0&&Gl[o][r]!==void 0?t=Gl[o][r]:(t=Gl[o][r]=function(){var a=document.createElement("style");return a.setAttribute("type","text/css"),a}(),r==="prepend"?i.insertBefore(t,i.childNodes[0]):i.appendChild(t)),e.charCodeAt(0)===65279&&(e=e.substr(1,e.length)),t.styleSheet?t.styleSheet.cssText+=e:t.textContent+=e,t}G1.exports=EO,G1.exports.insertCss=EO;const Rp=Bi(G1.exports);var SW=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();typeof document<"u"&&Rp(`
  .g6-component-contextmenu {
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 10px 8px;
    box-shadow: rgb(174, 174, 174) 0px 0px 10px;
  }
  .g6-contextmenu-ul {
    padding: 0;
    margin: 0;
    list-style: none;
  }

`);var _W=function(e){function n(t){return e.call(this,t)||this}return SW(n,e),n.prototype.getDefaultCfgs=function(){return{offsetX:6,offsetY:6,handleMenuClick:void 0,getContent:function(t){return`
          <ul class='g6-contextmenu-ul'>
            <li>\u83DC\u5355\u98791</li>
            <li>\u83DC\u5355\u98792</li>
          </ul>
        `},shouldBegin:function(t){return!0},onHide:function(){return!0},itemTypes:["node","edge","combo"],trigger:"contextmenu"}},n.prototype.getEvents=function(){return this.get("trigger")==="click"?{click:"onMenuShow",touchend:"onMenuShow"}:{contextmenu:"onMenuShow"}},n.prototype.init=function(){var t=this.get("className"),r=gn("<div class=".concat(t||"g6-component-contextmenu","></div>"));qt(r,{top:"0px",position:"absolute",visibility:"hidden"});var i=this.get("container");i||(i=this.get("graph").get("container")),Re(i)&&(i=document.getElementById(i)),i.appendChild(r),this.set("menu",r)},n.prototype.onMenuShow=function(t){var r=this;t.preventDefault();var i=this.get("itemTypes");if(t.item){if(t.item&&t.item.getType&&i.indexOf(t.item.getType())===-1)return void r.onMenuHide()}else if(i.indexOf("canvas")===-1)return void r.onMenuHide();if(this.get("shouldBegin")(t)){var o=this.get("menu"),a=this.get("getContent"),s=this.get("graph"),u=a(t,s);Re(u)?o.innerHTML=u:o.innerHTML=u.outerHTML,this.removeMenuEventListener();var c=this.get("handleMenuClick");if(c){var l=function(E){c(E.target,t.item,s)};this.set("handleMenuClickWrapper",l),o.addEventListener("click",l)}var h=s.get("width"),f=s.get("height"),d=o.getBoundingClientRect(),p=this.get("offsetX")||0,g=this.get("offsetY")||0,v=s.getContainer().offsetTop,m=s.getContainer().offsetLeft,y=t.canvasX+m+p,b=t.canvasY+v+g;y+d.width>h&&(y=t.canvasX-d.width-p+m),b+d.height>f&&(b=t.canvasY-d.height-g+v),b<0&&(b=0),qt(o,{top:"".concat(b,"px"),left:"".concat(y,"px"),visibility:"visible"});var x=this.get("trigger")==="click",w=function(E){x?x=!1:r.onMenuHide()};document.body.addEventListener("click",w),this.set("handler",w)}},n.prototype.removeMenuEventListener=function(){var t=this.get("handleMenuClickWrapper"),r=this.get("handler");t&&(this.get("menu").removeEventListener("click",t),this.set("handleMenuClickWrapper",null)),r&&document.body.removeEventListener("click",r)},n.prototype.onMenuHide=function(){var t=this.get("menu");t&&qt(t,{visibility:"hidden"}),this.removeMenuEventListener()},n.prototype.destroy=function(){var t=this.get("menu");if(this.removeMenuEventListener(),t){var r=this.get("container");r||(r=this.get("graph").get("container")),Re(r)&&(r=document.getElementById(r)),r.removeChild(t)}},n}(qr),kW=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),U1=function(){return U1=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},U1.apply(this,arguments)},MO=Math.max,CW=Qr,AW=function(e){function n(t){var r=e.call(this,t)||this;return r.handleUpdateCanvas=fc(function(i){var o=r;o.destroyed||o.updateCanvas()},100,!1),r}return kW(n,e),n.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-minimap",viewportClassName:"g6-minimap-viewport",type:"default",padding:50,size:[200,120],delegateStyle:{fill:"#40a9ff",stroke:"#096dd9"},refresh:!0,hideEdge:!1}},n.prototype.getEvents=function(){return{beforepaint:"updateViewport",beforeanimate:"disableRefresh",afteranimate:"enableRefresh",viewportchange:"disableOneRefresh"}},n.prototype.disableRefresh=function(){this.set("refresh",!1)},n.prototype.enableRefresh=function(){this.set("refresh",!0),this.updateCanvas()},n.prototype.disableOneRefresh=function(){this.set("viewportChange",!0)},n.prototype.initViewport=function(){var t=this,r=this._cfgs,i=r.size,o=r.graph;if(!this.destroyed){var a=this.get("canvas").get("container"),s=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,u=navigator.userAgent.toLowerCase().indexOf("safari")>-1,c=gn(`
      <div
        class=`.concat(r.viewportClassName,`
        style='position:absolute;
          left:0;
          top:0;
          box-sizing:border-box;
          outline: 2px solid #1980ff;
          cursor:move'
        draggable=`).concat(!u&&!s,`
      </div>`)),l=0,h=0,f=!1,d=0,p=0,g=0,v=0,m=0,y=0,b=u||s?"mousedown":"dragstart";c.addEventListener(b,function(M){var _,k;if(M.dataTransfer){var S=new Image;S.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' %3E%3Cpath /%3E%3C/svg%3E",(k=(_=M.dataTransfer).setDragImage)===null||k===void 0||k.call(_,S,0,0);try{M.dataTransfer.setData("text/html","view-port-minimap")}catch{M.dataTransfer.setData("text","view-port-minimap")}}if(r.refresh=!1,M.target===c){var C=c.style;d=parseInt(C.left,10),p=parseInt(C.top,10),g=parseInt(C.width,10),v=parseInt(C.height,10),g>i[0]||v>i[1]||(y=o.getZoom(),m=t.get("ratio"),f=!0,l=M.clientX,h=M.clientY)}},!1);var x=function(M){if(f&&!yt(M.clientX)&&!yt(M.clientY)){var _=l-M.clientX,k=h-M.clientY;(d-_<0||d-_+g>=i[0])&&(_=0),(p-k<0||p-k+v>=i[1])&&(k=0),p-=k,qt(c,{left:"".concat(d-=_,"px"),top:"".concat(p,"px")}),o.translate(_*y/m,k*y/m),l=M.clientX,h=M.clientY}};u||s||c.addEventListener("drag",x,!1);var w=function(){f=!1,r.refresh=!0},E=u||s?"mouseup":"dragend";c.addEventListener(E,w,!1),a.addEventListener("mouseleave",w),a.addEventListener("mouseup",w),(u||s)&&a.addEventListener("mousemove",x,!1),this.set("viewport",c),a.appendChild(c)}},n.prototype.updateViewport=function(){if(!this.destroyed){var t=this.get("ratio"),r=this.get("totaldx"),i=this.get("totaldy"),o=this.get("graph"),a=this.get("size"),s=o.get("canvas").get("el"),u=o.get("width")||s.scrollWidth||500,c=o.get("height")||s.scrollHeight||500,l=o.getPointByCanvas(0,0),h=o.getPointByCanvas(u,c),f=this.get("viewport");f||this.initViewport();var d=(h.x-l.x)*t,p=(h.y-l.y)*t,g=l.x*t+r,v=l.y*t+i,m=g+d,y=v+p;g<0&&(d+=g,g=0),m>a[0]&&(d-=m-a[0]),v<0&&(p+=v,v=0),y>a[1]&&(p-=y-a[1]),this.set("ratio",t),qt(f,{left:"".concat(g,"px"),top:"".concat(v,"px"),width:"".concat(d,"px"),height:"".concat(p,"px")})}},n.prototype.updateGraphShapes=function(){var t,r=this._cfgs.graph,i=this.get("canvas"),o=r.get("group");o.destroyed||(i.clear(),this.get("hideEdge")?(t=i.addGroup(),o.get("children").forEach(function(a){a.get("id").includes("-edge")||t.add(a.clone())})):((t=o.clone()).resetMatrix(),i.add(t)),r.get("renderer")==="svg"&&this.updateVisible(t))},n.prototype.updateVisible=function(t){var r=this;if(t.isGroup()||t.get("visible")){var i=t.get("children");if(!i||!i.length)return;i.forEach(function(o){o.get("visible")||o.hide(),r.updateVisible(o)})}else t.hide()},n.prototype.updateKeyShapes=function(){var t=this,r=this._cfgs.graph,i=this.get("canvas"),o=i.get("children")[0]||i.addGroup();this.get("hideEdge")||ye(r.getEdges(),function(u){t.updateOneEdgeKeyShape(u,o)}),ye(r.getNodes(),function(u){t.updateOneNodeKeyShape(u,o)});var a=r.getCombos();if(a&&a.length){var s=o.find(function(u){return u.get("name")==="comboGroup"})||o.addGroup({name:"comboGroup"});setTimeout(function(){t.destroyed||(ye(a,function(u){t.updateOneComboKeyShape(u,s)}),s==null||s.sort(),s==null||s.toBack(),t.updateCanvas())},250)}this.clearDestroyedShapes()},n.prototype.updateOneComboKeyShape=function(t,r){if(!this.destroyed){var i=this.get("itemMap")||{},o=i[t.get("id")],a=t.getBBox(),s=t.get("keyShape").clone(),u=s.attr(),c={x:a.centerX,y:a.centerY};o?c=Object.assign(u,c):(o=s,r.add(o));var l=o.get("type");l!=="rect"&&l!=="image"||(c.x=a.minX,c.y=a.minY),o.attr(c),t.isVisible()?o.show():o.hide(),o.exist=!0;var h=t.getModel().depth;isNaN(h)||o.set("zIndex",h),i[t.get("id")]=o,this.set("itemMap",i)}},n.prototype.updateOneNodeKeyShape=function(t,r){var i=this.get("itemMap")||{},o=i[t.get("id")],a=t.getBBox(),s=t.get("keyShape").clone(),u=s.attr(),c={x:a.centerX,y:a.centerY};o?(c=Object.assign(u,c),o.toFront()):(o=s,r.add(o));var l=o.get("type");l!=="rect"&&l!=="image"||(c.x=a.minX,c.y=a.minY),o.attr(c),t.isVisible()?o.show():o.hide(),o.exist=!0;var h=t.getModel().depth;isNaN(h)||o.set("zIndex",h),i[t.get("id")]=o,this.set("itemMap",i)},n.prototype.updateDelegateShapes=function(){var t=this,r=this._cfgs.graph,i=this.get("canvas"),o=i.get("children")[0]||i.addGroup();this.get("hideEdge")||ye(r.getEdges(),function(u){t.updateOneEdgeKeyShape(u,o)}),ye(r.getNodes(),function(u){t.updateOneNodeDelegateShape(u,o)});var a=r.getCombos();if(a&&a.length){var s=o.find(function(u){return u.get("name")==="comboGroup"})||o.addGroup({name:"comboGroup"});setTimeout(function(){t.destroyed||(ye(a,function(u){t.updateOneComboKeyShape(u,s)}),s==null||s.sort(),s==null||s.toBack(),t.updateCanvas())},250)}this.clearDestroyedShapes()},n.prototype.clearDestroyedShapes=function(){var t=this.get("itemMap")||{},r=Object.keys(t);if(r&&r.length!==0)for(var i=r.length-1;i>=0;i--){var o=t[r[i]],a=o.exist;o.exist=!1,a||(o.remove(),delete t[r[i]])}},n.prototype.updateOneEdgeKeyShape=function(t,r){var i=this.get("itemMap")||{},o=i[t.get("id")];if(o){var a=t.get("keyShape").attr("path");o.attr("path",a)}else o=t.get("keyShape").clone(),r.add(o);t.isVisible()?o.show():o.hide(),o.exist=!0,i[t.get("id")]=o,this.set("itemMap",i)},n.prototype.updateOneNodeDelegateShape=function(t,r){var i=this.get("delegateStyle"),o=this.get("itemMap")||{},a=o[t.get("id")],s=t.getBBox();if(a){var u={x:s.minX,y:s.minY,width:s.width,height:s.height};a.attr(u),a.toFront()}else a=r.addShape("rect",{attrs:U1({x:s.minX,y:s.minY,width:s.width,height:s.height},i),name:"minimap-node-shape"});t.isVisible()?a.show():a.hide(),a.exist=!0,o[t.get("id")]=a,this.set("itemMap",o)},n.prototype.init=function(){this.initContainer(),this.get("graph").on("afterupdateitem",this.handleUpdateCanvas),this.get("graph").on("afteritemstatechange",this.handleUpdateCanvas),this.get("graph").on("afteradditem",this.handleUpdateCanvas),this.get("graph").on("afterremoveitem",this.handleUpdateCanvas),this.get("graph").on("afterrender",this.handleUpdateCanvas),this.get("graph").on("afterlayout",this.handleUpdateCanvas)},n.prototype.initContainer=function(){var t=this,r=t.get("graph"),i=t.get("size"),o=t.get("className"),a=t.get("container"),s=gn("<div class='".concat(o,"' style='width: ").concat(i[0],"px; height: ").concat(i[1],"px; overflow: hidden'></div>"));Re(a)&&(a=document.getElementById(a)),a?a.appendChild(s):r.get("container").appendChild(s),t.set("container",s);var u,c=gn('<div class="g6-minimap-container" style="position: relative;"></div>');s.appendChild(c),c.addEventListener("dragenter",function(l){l.preventDefault()}),c.addEventListener("dragover",function(l){l.preventDefault()}),u=r.get("renderer")==="svg"?new Hc({container:c,width:i[0],height:i[1]}):new bo({container:c,width:i[0],height:i[1]}),t.set("canvas",u),t.updateCanvas()},n.prototype.updateCanvas=function(){if(!this.destroyed&&this.get("refresh")){var t=this.get("graph");if(!t.get("destroyed")){this.get("viewportChange")&&(this.set("viewportChange",!1),this.updateViewport());var r=this.get("size"),i=this.get("canvas"),o=this.get("type"),a=this.get("padding");if(!i.destroyed){switch(o){case"default":this.updateGraphShapes();break;case"keyShape":this.updateKeyShapes();break;case"delegate":this.updateDelegateShapes()}var s=i.get("children")[0];if(s){s.resetMatrix();var u=s.getCanvasBBox(),c=t.get("canvas").getCanvasBBox(),l=t.getZoom()||1,h=c.width/l,f=c.height/l;Number.isFinite(u.width)&&(h=MO(u.width,h),f=MO(u.height,f)),h+=2*a,f+=2*a;var d=Math.min(r[0]/h,r[1]/f),p=[1,0,0,0,1,0,0,0,1],g=0,v=0;Number.isFinite(u.minX)&&(g=-u.minX),Number.isFinite(u.minY)&&(v=-u.minY);var m=(r[0]-(h-2*a)*d)/2,y=(r[1]-(f-2*a)*d)/2;p=CW(p,[["t",g,v],["s",d,d],["t",m,y]]),s.setMatrix(p),this.set("ratio",d),this.set("totaldx",m+g*d),this.set("totaldy",y+v*d),this.set("dx",m),this.set("dy",y),this.updateViewport()}}}}},n.prototype.getCanvas=function(){return this.get("canvas")},n.prototype.getViewport=function(){return this.get("viewport")},n.prototype.getContainer=function(){return this.get("container")},n.prototype.destroy=function(){var t;(t=this.get("canvas"))===null||t===void 0||t.destroy();var r=this.get("container");r!=null&&r.parentNode&&r.parentNode.removeChild(r)},n}(qr),IW=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();function ao(e,n,t){var r=e.x-n.x,i=e.y-n.y;return Math.sqrt(r*r+i*i)}function SO(e,n){var t=(n.source.y-n.target.y)/(n.source.x-n.target.x),r=(t*t*n.source.x+t*(e.y-n.source.y)+e.x)/(t*t+1);return{x:r,y:t*(r-n.source.x)+n.source.y}}var TW=function(e){function n(t){return e.call(this,t)||this}return IW(n,e),n.prototype.getDefaultCfgs=function(){return{edgeBundles:[],edgePoints:[],K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:.6666667,bundleThreshold:.6,eps:1e-6,onLayoutEnd:function(){},onTick:function(){}}},n.prototype.init=function(){var t=this.get("graph"),r=this.get("onTick");this.set("tick",function(){r&&r(),t.refreshPositions()})},n.prototype.bundling=function(t){var r=this;if(r.set("data",t),!r.isTicking()){var i=t.edges||[],o=t.nodes||[],a={},s=!1;if(o.forEach(function(b){b.x!==null&&!b.y!==null&&b.x!==void 0&&!b.y!==void 0||(s=!0),a[b.id]=b}),s)throw new Error("please layout the graph or assign x and y for nodes first");r.set("nodeIdMap",a);var u=r.get("divisions"),c=r.get("divRate"),l=r.divideEdges(u);r.set("edgePoints",l);var h=r.getEdgeBundles();r.set("edgeBundles",h);for(var f=r.get("cycles"),d=r.get("iterations"),p=r.get("iterRate"),g=r.get("lambda"),v=0;v<f;v++){for(var m=function(b){var x=[];i.forEach(function(w,E){if(w.source!==w.target){var M=a[w.source],_=a[w.target];x[E]=r.getEdgeForces({source:M,target:_},E,u,g);for(var k=0;k<u+1;k++)l[E][k].x+=x[E][k].x,l[E][k].y+=x[E][k].y}})},y=0;y<d;y++)m();g/=2,u*=c,d*=p,l=r.divideEdges(u),r.set("edgePoints",l)}i.forEach(function(b,x){b.source!==b.target&&(b.type="polyline",b.controlPoints=l[x].slice(1,l[x].length-1))}),r.get("graph").refresh()}},n.prototype.updateBundling=function(t){var r=this,i=t.data;if(i&&r.set("data",i),r.get("ticking")&&r.set("ticking",!1),Object.keys(t).forEach(function(a){r.set(a,t[a])}),t.onTick){var o=this.get("graph");r.set("tick",function(){t.onTick(),o.refresh()})}r.bundling(i)},n.prototype.divideEdges=function(t){var r=this,i=r.get("data").edges,o=r.get("nodeIdMap"),a=r.get("edgePoints");return a&&a!==void 0||(a=[]),i.forEach(function(s,u){var c;a[u]&&a[u]!==void 0||(a[u]=[]);var l=o[s.source],h=o[s.target];if(t===1)a[u].push({x:l.x,y:l.y}),a[u].push({x:.5*(l.x+h.x),y:.5*(l.y+h.y)}),a[u].push({x:h.x,y:h.y});else{var f=(!((c=a[u])===null||c===void 0)&&c.length?r.getEdgeLength(a[u]):ao({x:l.x,y:l.y},{x:h.x,y:h.y}))/(t+1),d=f,p=[{x:l.x,y:l.y}];a[u].forEach(function(g,v){if(v!==0){for(var m=ao(g,a[u][v-1]);m>d;){var y=d/m,b={x:a[u][v-1].x,y:a[u][v-1].y};b.x+=y*(g.x-a[u][v-1].x),b.y+=y*(g.y-a[u][v-1].y),p.push(b),m-=d,d=f}d-=m}}),p.push({x:h.x,y:h.y}),a[u]=p}}),a},n.prototype.getEdgeLength=function(t){var r=0;return t.forEach(function(i,o){o!==0&&(r+=ao(i,t[o-1]))}),r},n.prototype.getEdgeBundles=function(){var t=this,r=t.get("data").edges||[],i=t.get("bundleThreshold"),o=t.get("nodeIdMap"),a=t.get("edgeBundles");return a||(a=[]),r.forEach(function(s,u){a[u]&&a[u]!==void 0||(a[u]=[])}),r.forEach(function(s,u){var c=o[s.source],l=o[s.target];r.forEach(function(h,f){if(!(f<=u)){var d=o[h.source],p=o[h.target];t.getBundleScore({source:c,target:l},{source:d,target:p})>=i&&(a[u].push(f),a[f].push(u))}})}),a},n.prototype.getBundleScore=function(t,r){var i=this;return t.vx=t.target.x-t.source.x,t.vy=t.target.y-t.source.y,r.vx=r.target.x-r.source.x,r.vy=r.target.y-r.source.y,t.length=ao({x:t.source.x,y:t.source.y},{x:t.target.x,y:t.target.y}),r.length=ao({x:r.source.x,y:r.source.y},{x:r.target.x,y:r.target.y}),i.getAngleScore(t,r)*i.getScaleScore(t,r)*i.getPositionScore(t,r)*i.getVisibilityScore(t,r)},n.prototype.getAngleScore=function(t,r){var i=function(o,a){return o.x*a.x+o.y*a.y}({x:t.vx,y:t.vy},{x:r.vx,y:r.vy});return i/(t.length*r.length)},n.prototype.getScaleScore=function(t,r){var i=(t.length+r.length)/2;return 2/(i/Math.min(t.length,r.length)+Math.max(t.length,r.length)/i)},n.prototype.getPositionScore=function(t,r){var i=(t.length+r.length)/2;return i/(i+ao({x:(t.source.x+t.target.x)/2,y:(t.source.y+t.target.y)/2},{x:(r.source.x+r.target.x)/2,y:(r.source.y+r.target.y)/2}))},n.prototype.getVisibilityScore=function(t,r){var i=this.getEdgeVisibility(t,r),o=this.getEdgeVisibility(r,t);return i<o?i:o},n.prototype.getEdgeVisibility=function(t,r){var i=SO(r.source,t),o=SO(r.target,t),a={x:(i.x+o.x)/2,y:(i.y+o.y)/2},s={x:(t.source.x+t.target.x)/2,y:(t.source.y+t.target.y)/2};return Math.max(0,1-2*ao(a,s)/ao(i,o))},n.prototype.getEdgeForces=function(t,r,i,o){for(var a=this,s=a.get("edgePoints"),u=a.get("K")/(ao(t.source,t.target)*(i+1)),c=[{x:0,y:0}],l=1;l<i;l++){var h={x:0,y:0},f=a.getSpringForce({pre:s[r][l-1],cur:s[r][l],next:s[r][l+1]},u),d=a.getElectrostaticForce(l,r);h.x=o*(f.x+d.x),h.y=o*(f.y+d.y),c.push(h)}return c.push({x:0,y:0}),c},n.prototype.getSpringForce=function(t,r){var i=t.pre.x+t.next.x-2*t.cur.x,o=t.pre.y+t.next.y-2*t.cur.y;return{x:i*=r,y:o*=r}},n.prototype.getElectrostaticForce=function(t,r){var i=this,o=i.get("eps"),a=i.get("edgeBundles"),s=i.get("edgePoints"),u=a[r],c={x:0,y:0};return u.forEach(function(l){var h={x:s[l][t].x-s[r][t].x,y:s[l][t].y-s[r][t].y};if(Math.abs(h.x)>o||Math.abs(h.y)>o){var f=1/ao(s[l][t],s[r][t]);c.x+=h.x*f,c.y+=h.y*f}}),c},n.prototype.isTicking=function(){return this.get("ticking")},n.prototype.getSimulation=function(){return this.get("forceSimulation")},n.prototype.destroy=function(){this.get("ticking")&&this.getSimulation().stop(),e.prototype.destroy.call(this)},n}(qr),OW=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),X1=function(){return X1=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},X1.apply(this,arguments)},_O={stroke:"#000",strokeOpacity:.8,lineWidth:2,fillOpacity:.1,fill:"#ccc"},NW=function(e){function n(t){return e.call(this,t)||this}return OW(n,e),n.prototype.getDefaultCfgs=function(){return{trigger:"mousemove",d:1.5,r:300,delegateStyle:Kt(_O),showLabel:!1,maxD:5,minD:0,scaleRBy:"unset",scaleDBy:"unset",showDPercent:!0}},n.prototype.getEvents=function(){var t;switch(this.get("trigger")){case"click":t={click:"magnify"};break;case"drag":t={click:"createDelegate"};break;default:t={mousemove:"magnify"}}return t},n.prototype.init=function(){var t=this,r=t.get("r");t.set("cachedMagnifiedModels",[]),t.set("cachedOriginPositions",{}),t.set("r2",r*r);var i=t.get("d");t.set("molecularParam",(i+1)*r)},n.prototype.createDelegate=function(t){var r=this,i=this,o=i.get("delegate");o&&!o.destroyed||(i.magnify(t),(o=i.get("delegate")).on("dragstart",function(a){i.set("delegateCenterDiff",{x:o.attr("x")-a.x,y:o.attr("y")-a.y})}),o.on("drag",function(a){i.magnify(a)}),this.get("scaleDBy")==="wheel"&&o.on("mousewheel",function(a){r.scaleDByWheel(a)}),this.get("scaleRBy")==="wheel"&&o.on("mousewheel",function(a){i.scaleRByWheel(a)}))},n.prototype.scaleRByWheel=function(t){var r=this;if(t&&t.originalEvent){t.preventDefault&&t.preventDefault();var i,o=r.get("graph"),a=r.get("delegate"),s=(a?{x:a.attr("x"),y:a.attr("y")}:void 0)||o.getPointByClient(t.clientX,t.clientY);i=t.originalEvent.wheelDelta<0?.95:1/.95;var u=r.get("maxR"),c=r.get("minR"),l=r.get("r");(l>(u||o.get("height"))&&i>1||l<(c||.05*o.get("height"))&&i<1)&&(i=1),l*=i,r.set("r",l),r.set("r2",l*l);var h=r.get("d");r.set("molecularParam",(h+1)*l),r.set("delegateCenterDiff",void 0),r.magnify(t,s)}},n.prototype.scaleRByDrag=function(t){var r=this;if(t){var i,o=r.get("dragPrePos"),a=r.get("graph"),s=a.getPointByClient(t.clientX,t.clientY);i=t.x-o.x<0?.95:1/.95;var u=r.get("maxR"),c=r.get("minR"),l=r.get("r");(l>(u||a.get("height"))&&i>1||l<(c||.05*a.get("height"))&&i<1)&&(i=1),l*=i,r.set("r",l),r.set("r2",l*l);var h=r.get("d");r.set("molecularParam",(h+1)*l),r.magnify(t,s),r.set("dragPrePos",{x:t.x,y:t.y})}},n.prototype.scaleDByWheel=function(t){var r=this;if(t||t.originalEvent){t.preventDefault&&t.preventDefault();var i=0;i=t.originalEvent.wheelDelta<0?-.1:.1;var o=r.get("d")+i,a=r.get("maxD"),s=r.get("minD");if(o<a&&o>s){r.set("d",o);var u=r.get("r");r.set("molecularParam",(o+1)*u);var c=r.get("delegate"),l=c?{x:c.attr("x"),y:c.attr("y")}:void 0;r.set("delegateCenterDiff",void 0),r.magnify(t,l)}}},n.prototype.scaleDByDrag=function(t){var r=this,i=r.get("dragPrePos"),o=t.x-i.x>0?.1:-.1,a=r.get("d")+o,s=r.get("maxD"),u=r.get("minD");if(a<s&&a>u){r.set("d",a);var c=r.get("r");r.set("molecularParam",(a+1)*c),r.magnify(t)}r.set("dragPrePos",{x:t.x,y:t.y})},n.prototype.magnify=function(t,r){var i=this;i.restoreCache();var o=i.get("graph"),a=i.get("cachedMagnifiedModels"),s=i.get("cachedOriginPositions"),u=i.get("showLabel"),c=i.get("r"),l=i.get("r2"),h=i.get("d"),f=i.get("molecularParam"),d=o.getNodes(),p=d.length,g=r?{x:r.x,y:r.y}:{x:t.x,y:t.y};!i.get("dragging")||i.get("trigger")!=="mousemove"&&i.get("trigger")!=="click"||(g=i.get("cacheCenter"));var v=i.get("delegateCenterDiff");v&&(g.x+=v.x,g.y+=v.y),i.updateDelegate(g,c);for(var m=0;m<p;m++){var y=d[m].getModel(),b=y.x,x=y.y;if(!isNaN(b)&&!isNaN(x)){var w=(b-g.x)*(b-g.x)+(x-g.y)*(x-g.y);if(!isNaN(w)&&w<l&&w!==0){var E=Math.sqrt(w),M=f*E/(h*E+c),_=(b-g.x)/E,k=(x-g.y)/E;if(y.x=_*M+g.x,y.y=k*M+g.y,s[y.id]||(s[y.id]={x:b,y:x,texts:[]}),a.push(y),u&&2*E<c)for(var S=d[m].getContainer().getChildren(),C=S.length,T=0;T<C;T++){var A=S[T];A.get("type")==="text"&&(s[y.id].texts.push({visible:A.get("visible"),shape:A}),A.set("visible",!0))}}}}o.refreshPositions()},n.prototype.restoreCache=function(){for(var t=this,r=t.get("cachedMagnifiedModels"),i=t.get("cachedOriginPositions"),o=r.length,a=0;a<o;a++){var s=r[a],u=i[s.id];s.x=u.x,s.y=u.y;for(var c=u.texts.length,l=0;l<c;l++){var h=u.texts[l];h.shape.set("visible",h.visible)}}t.set("cachedMagnifiedModels",[]),t.set("cachedOriginPositions",{})},n.prototype.updateParams=function(t){var r=this,i=t.r,o=t.d,a=t.trigger,s=t.minD,u=t.maxD,c=t.minR,l=t.maxR,h=t.scaleDBy,f=t.scaleRBy;isNaN(t.r)||(r.set("r",i),r.set("r2",i*i)),isNaN(o)||r.set("d",o),isNaN(u)||r.set("maxD",u),isNaN(s)||r.set("minD",s),isNaN(l)||r.set("maxR",l),isNaN(c)||r.set("minR",c);var d,p=r.get("d"),g=r.get("r");r.set("molecularParam",(p+1)*g),a!=="mousemove"&&a!=="click"&&a!=="drag"||r.set("trigger",a),(h==="drag"||h==="wheel"||h==="unset")&&(r.set("scaleDBy",h),r.get("delegate").remove(),r.get("delegate").destroy(),(d=r.get("dPercentText"))&&(d.remove(),d.destroy())),f!=="drag"&&f!=="wheel"&&f!=="unset"||(r.set("scaleRBy",f),r.get("delegate").remove(),r.get("delegate").destroy(),(d=r.get("dPercentText"))&&(d.remove(),d.destroy()))},n.prototype.updateDelegate=function(t,r){var i=this,o=this,a=o.get("graph"),s=o.get("delegate");if(!s||s.destroyed){var u=a.get("group"),c=o.get("delegateStyle")||_O;s=u.addShape("circle",{attrs:X1({r:r/1.5,x:t.x,y:t.y},c),name:"lens-shape",draggable:!0}),this.get("trigger")!=="drag"&&(this.get("scaleRBy")==="wheel"?s.on("mousewheel",function(d){o.scaleRByWheel(d)}):this.get("scaleRBy")==="drag"&&(s.on("dragstart",function(d){o.set("dragging",!0),o.set("cacheCenter",{x:d.x,y:d.y}),o.set("dragPrePos",{x:d.x,y:d.y})}),s.on("drag",function(d){o.scaleRByDrag(d)}),s.on("dragend",function(d){o.set("dragging",!1)})),this.get("scaleDBy")==="wheel"?s.on("mousewheel",function(d){i.scaleDByWheel(d)}):this.get("scaleDBy")==="drag"&&(s.on("dragstart",function(d){o.set("dragging",!0),o.set("cacheCenter",{x:d.x,y:d.y}),o.set("dragPrePos",{x:d.x,y:d.y})}),s.on("drag",function(d){i.scaleDByDrag(d)}),s.on("dragend",function(d){o.set("dragging",!1)})))}else s.attr({x:t.x,y:t.y,r:r/1.5});if(o.get("showDPercent")){var l=Math.round((o.get("d")-o.get("minD"))/(o.get("maxD")-o.get("minD"))*100),h=o.get("dPercentText"),f=t.y+r/1.5+16;!h||h.destroyed?(h=a.get("group").addShape("text",{attrs:{text:"".concat(l,"%"),x:t.x,y:f,fill:"#aaa",stroke:"#fff",lineWidth:1,fontSize:12}}),o.set("dPercentText",h)):h.attr({text:"".concat(l,"%"),x:t.x,y:f})}o.set("delegate",s)},n.prototype.clear=function(){var t=this.get("graph");this.restoreCache(),t.refreshPositions();var r=this.get("delegate");r&&!r.destroyed&&(r.remove(),r.destroy());var i=this.get("dPercentText");i&&!i.destroyed&&(i.remove(),i.destroy())},n.prototype.destroy=function(){this.clear()},n}(qr),DW=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();typeof document<"u"&&Rp(`
  .g6-component-toolbar {
    position: absolute;
    list-style-type: none;
    padding: 6px;
    left: 0px;
    top: 0px;
    background-color: rgba(255, 255, 255, 0.9);
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    margin: 0;
  }
  .g6-component-toolbar li {
    float: left;
    text-align: center;
    width: 35px;
    height: 24px;
    cursor: pointer;
		list-style-type:none;
    list-style: none;
    margin-left: 0px;
  }
  .g6-component-toolbar li .icon {
    opacity: 0.7;
  }
  .g6-component-toolbar li .icon:hover {
    opacity: 1;
  }
`);var PW=function(e){function n(t){return e.call(this,t)||this}return DW(n,e),n.prototype.getDefaultCfgs=function(){return{handleClick:void 0,getContent:function(t){return`
          <ul class='g6-component-toolbar'>
            <li code='redo'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M256 682.666667c0-102.741333 66.730667-213.333333 213.333333-213.333334 107.008 0 190.762667 56.576 230.570667 125.354667L611.968 682.666667H853.333333v-241.365334l-91.562666 91.562667C704.768 448.469333 601.130667 384 469.333333 384c-196.096 0-298.666667 150.229333-298.666666 298.666667h85.333333z" fill="" p-id="2041"></path>
              </svg>
            </li>
            <li code='undo'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M170.666667 682.666667h241.365333l-87.936-87.978667C363.904 525.909333 447.658667 469.333333 554.666667 469.333333c146.602667 0 213.333333 110.592 213.333333 213.333334h85.333333c0-148.437333-102.570667-298.666667-298.666666-298.666667-131.797333 0-235.392 64.469333-292.48 148.821333L170.666667 441.301333V682.666667z" fill="" p-id="2764"></path>
              </svg>
            </li>
            <li  code='zoomOut'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M658.432 428.736a33.216 33.216 0 0 1-33.152 33.152H525.824v99.456a33.216 33.216 0 0 1-66.304 0V461.888H360.064a33.152 33.152 0 0 1 0-66.304H459.52V296.128a33.152 33.152 0 0 1 66.304 0V395.52H625.28c18.24 0 33.152 14.848 33.152 33.152z m299.776 521.792a43.328 43.328 0 0 1-60.864-6.912l-189.248-220.992a362.368 362.368 0 0 1-215.36 70.848 364.8 364.8 0 1 1 364.8-364.736 363.072 363.072 0 0 1-86.912 235.968l192.384 224.64a43.392 43.392 0 0 1-4.8 61.184z m-465.536-223.36a298.816 298.816 0 0 0 298.432-298.432 298.816 298.816 0 0 0-298.432-298.432A298.816 298.816 0 0 0 194.24 428.8a298.816 298.816 0 0 0 298.432 298.432z"></path>
              </svg>
            </li>
            <li code='zoomIn'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M639.936 416a32 32 0 0 1-32 32h-256a32 32 0 0 1 0-64h256a32 32 0 0 1 32 32z m289.28 503.552a41.792 41.792 0 0 1-58.752-6.656l-182.656-213.248A349.76 349.76 0 0 1 480 768 352 352 0 1 1 832 416a350.4 350.4 0 0 1-83.84 227.712l185.664 216.768a41.856 41.856 0 0 1-4.608 59.072zM479.936 704c158.784 0 288-129.216 288-288S638.72 128 479.936 128a288.32 288.32 0 0 0-288 288c0 158.784 129.216 288 288 288z" p-id="3853"></path>
              </svg>
            </li>
            <li code='realZoom'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="24">
                <path d="M384 320v384H320V320h64z m256 0v384H576V320h64zM512 576v64H448V576h64z m0-192v64H448V384h64z m355.968 576H92.032A28.16 28.16 0 0 1 64 931.968V28.032C64 12.608 76.608 0 95.168 0h610.368L896 192v739.968a28.16 28.16 0 0 1-28.032 28.032zM704 64v128h128l-128-128z m128 192h-190.464V64H128v832h704V256z"></path>
              </svg>
            </li>
            <li code='autoZoom'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="24">
                <path d="M684.288 305.28l0.128-0.64-0.128-0.64V99.712c0-19.84 15.552-35.904 34.496-35.712a35.072 35.072 0 0 1 34.56 35.776v171.008h170.944c19.648 0 35.84 15.488 35.712 34.432a35.072 35.072 0 0 1-35.84 34.496h-204.16l-0.64-0.128a32.768 32.768 0 0 1-20.864-7.552c-1.344-1.024-2.816-1.664-3.968-2.816-0.384-0.32-0.512-0.768-0.832-1.088a33.472 33.472 0 0 1-9.408-22.848zM305.28 64a35.072 35.072 0 0 0-34.56 35.776v171.008H99.776A35.072 35.072 0 0 0 64 305.216c0 18.944 15.872 34.496 35.84 34.496h204.16l0.64-0.128a32.896 32.896 0 0 0 20.864-7.552c1.344-1.024 2.816-1.664 3.904-2.816 0.384-0.32 0.512-0.768 0.768-1.088a33.024 33.024 0 0 0 9.536-22.848l-0.128-0.64 0.128-0.704V99.712A35.008 35.008 0 0 0 305.216 64z m618.944 620.288h-204.16l-0.64 0.128-0.512-0.128c-7.808 0-14.72 3.2-20.48 7.68-1.28 1.024-2.752 1.664-3.84 2.752-0.384 0.32-0.512 0.768-0.832 1.088a33.664 33.664 0 0 0-9.408 22.912l0.128 0.64-0.128 0.704v204.288c0 19.712 15.552 35.904 34.496 35.712a35.072 35.072 0 0 0 34.56-35.776V753.28h170.944c19.648 0 35.84-15.488 35.712-34.432a35.072 35.072 0 0 0-35.84-34.496z m-593.92 11.52c-0.256-0.32-0.384-0.768-0.768-1.088-1.088-1.088-2.56-1.728-3.84-2.688a33.088 33.088 0 0 0-20.48-7.68l-0.512 0.064-0.64-0.128H99.84a35.072 35.072 0 0 0-35.84 34.496 35.072 35.072 0 0 0 35.712 34.432H270.72v171.008c0 19.84 15.552 35.84 34.56 35.776a35.008 35.008 0 0 0 34.432-35.712V720l-0.128-0.64 0.128-0.704a33.344 33.344 0 0 0-9.472-22.848zM512 374.144a137.92 137.92 0 1 0 0.128 275.84A137.92 137.92 0 0 0 512 374.08z"></path>
              </svg>
            </li>
          </ul>
        `},zoomSensitivity:2}},n.prototype.init=function(){var t=this,r=this.get("graph"),i=this.get("getContent")(r),o=i;Re(i)&&(o=gn(i));var a=this.get("className");o.setAttribute("class",a||"g6-component-toolbar");var s=this.get("container");s||(s=this.get("graph").get("container")),Re(s)&&(s=document.getElementById(s)),s.appendChild(o),this.set("toolBar",o);var u=this.get("handleClick");o.addEventListener("click",function(l){var h=function(d){if(!d)return[];if(d.composedPath)return d.composedPath();for(var p=[],g=d.target;g;){if(p.push(g),g.tagName==="HTML")return p.push(document,window),p;g=g.parentElement}return p}(l).filter(function(d){return d.nodeName==="LI"});if(h.length!==0){var f=h[0].getAttribute("code");f&&(u?u(f,r):t.handleDefaultOperator(f))}});var c=this.get("position");c&&qt(o,{top:"".concat(c.y,"px"),left:"".concat(c.x,"px")}),this.bindUndoRedo()},n.prototype.bindUndoRedo=function(){var t=this.get("graph"),r=document.querySelector('.g6-component-toolbar li[code="undo"]'),i=document.querySelector('.g6-component-toolbar li[code="undo"] svg'),o=document.querySelector('.g6-component-toolbar li[code="redo"]'),a=document.querySelector('.g6-component-toolbar li[code="redo"] svg');r&&i&&o&&a&&(r.setAttribute("style","cursor: not-allowed"),i.setAttribute("style","opacity: 0.4"),o.setAttribute("style","cursor: not-allowed"),a.setAttribute("style","opacity: 0.4"),t.on("stackchange",function(s){var u=s.undoStack,c=s.redoStack,l=u.length,h=c.length;l===0?(r.setAttribute("style","cursor: not-allowed"),i.setAttribute("style","opacity: 0.4")):(r.removeAttribute("style"),i.removeAttribute("style")),h===0?(o.setAttribute("style","cursor: not-allowed"),a.setAttribute("style","opacity: 0.4")):(o.removeAttribute("style"),a.removeAttribute("style"))}))},n.prototype.undo=function(){var t=this.get("graph"),r=t.getUndoStack();if(r&&r.length!==0){var i=r.pop();if(i){var o=i.action;t.pushStack(o,Kt(i.data),"redo");var a=i.data.before;if(o==="add"&&(a=i.data.after),!a)return;switch(o){case"visible":Object.keys(a).forEach(function(h){var f=a[h];f&&f.forEach(function(d){var p=t.findById(d.id);d.visible?t.showItem(p,!1):t.hideItem(p,!1)})});break;case"render":case"update":Object.keys(a).forEach(function(h){var f=a[h];f&&f.forEach(function(d){var p=t.findById(d.id);delete d.id,t.updateItem(p,d,!1),p.getType()==="combo"&&t.updateCombo(p)})});break;case"changedata":t.changeData(a,!1);break;case"delete":Object.keys(a).forEach(function(h){var f=a[h];f&&f.forEach(function(d){var p=d.itemType;delete d.itemType,t.addItem(p,d,!1)})});break;case"add":Object.keys(a).forEach(function(h){var f=a[h];f&&f.forEach(function(d){t.removeItem(d.id,!1)})});break;case"updateComboTree":Object.keys(a).forEach(function(h){var f=a[h];f&&f.forEach(function(d){t.updateComboTree(d.id,d.parentId,!1)})});break;case"createCombo":var s=i.data.after.combos,u=s[s.length-1];Object.keys(a).forEach(function(h){var f=a[h];f&&f.forEach(function(d){t.updateComboTree(d.id,d.parentId,!1)})}),t.removeItem(u.id,!1);break;case"uncombo":var c=a.combos[a.combos.length-1],l=a.nodes.concat(a.combos).map(function(h){return h.id}).filter(function(h){return h!==c.id});t.createCombo(c,l,!1);break;case"layout":t.updateLayout(a,void 0,void 0,!1)}}}},n.prototype.redo=function(){var t=this.get("graph"),r=t.getRedoStack();if(r&&r.length!==0){var i=r.pop();if(i){var o=i.action,a=i.data.after;if(t.pushStack(o,Kt(i.data)),o==="delete"&&(a=i.data.before),!a)return;switch(o){case"visible":Object.keys(a).forEach(function(l){var h=a[l];h&&h.forEach(function(f){var d=t.findById(f.id);f.visible?t.showItem(d,!1):t.hideItem(d,!1)})});break;case"render":case"update":Object.keys(a).forEach(function(l){var h=a[l];h&&h.forEach(function(f){var d=t.findById(f.id);delete f.id,t.updateItem(d,f,!1),d.getType()==="combo"&&t.updateCombo(d)})});break;case"changedata":t.changeData(a,!1);break;case"delete":a.edges&&a.edges.forEach(function(l){t.removeItem(l.id,!1)}),a.nodes&&a.nodes.forEach(function(l){t.removeItem(l.id,!1)}),a.combos&&a.combos.forEach(function(l){t.removeItem(l.id,!1)});break;case"add":Object.keys(a).forEach(function(l){var h=a[l];h&&h.forEach(function(f){var d=f.itemType;delete f.itemType,t.addItem(d,f,!1)})});break;case"updateComboTree":Object.keys(a).forEach(function(l){var h=a[l];h&&h.forEach(function(f){t.updateComboTree(f.id,f.parentId,!1)})});break;case"createCombo":var s=a.combos[a.combos.length-1];t.createCombo(s,s.children.map(function(l){return l.id}),!1);break;case"uncombo":var u=i.data.before.combos,c=u[u.length-1];t.uncombo(c.id,!1);break;case"layout":t.updateLayout(a,void 0,void 0,!1)}}}},n.prototype.zoomOut=function(){var t=this.get("graph"),r=t.getZoom(),i=1/(1-.05*this.get("zoomSensitivity"));i*r>(this.get("maxZoom")||t.get("maxZoom"))||t.zoomTo(r*i)},n.prototype.zoomIn=function(){var t=this.get("graph"),r=t.getZoom(),i=1-.05*this.get("zoomSensitivity");i*r<(this.get("minZoom")||t.get("minZoom"))||t.zoomTo(r*i)},n.prototype.realZoom=function(){this.get("graph").zoomTo(1)},n.prototype.autoZoom=function(){this.get("graph").fitView([20,20])},n.prototype.handleDefaultOperator=function(t){switch(t){case"redo":this.redo();break;case"undo":this.undo();break;case"zoomOut":this.zoomOut();break;case"zoomIn":this.zoomIn();break;case"realZoom":this.realZoom();break;case"autoZoom":this.autoZoom()}},n.prototype.destroy=function(){var t=this.get("toolBar");if(t){var r=this.get("container");r||(r=this.get("graph").get("container")),Re(r)&&(r=document.getElementById(r)),r.removeChild(t)}var i=this.get("handleClick");i&&t.removeEventListener("click",i)},n}(qr),LW=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();typeof document<"u"&&Rp(`
  .g6-component-tooltip {
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 10px 8px;
    box-shadow: rgb(174, 174, 174) 0px 0px 10px;
  }
  .tooltip-type {
    padding: 0;
    margin: 0;
  }
  .tooltip-id {
    color: #531dab;
  }
`);var RW=function(e){function n(t){return e.call(this,t)||this}return LW(n,e),n.prototype.getDefaultCfgs=function(){return{offsetX:6,offsetY:6,getContent:function(t){return`
          <h4 class='tooltip-type'>\u7C7B\u578B\uFF1A`.concat(t.item.getType(),`</h4>
          <span class='tooltip-id'>ID\uFF1A`).concat(t.item.getID(),`</span>
        `)},shouldBegin:function(t){return!0},itemTypes:["node","edge","combo"],trigger:"mouseenter",fixToNode:void 0}},n.prototype.getEvents=function(){return this.get("trigger")==="click"?{"node:click":"onClick","edge:click":"onClick","combo:click":"onClick","canvas:click":"onMouseLeave",afterremoveitem:"onMouseLeave",contextmenu:"onMouseLeave",drag:"onMouseLeave"}:{"node:mouseenter":"onMouseEnter","node:mouseleave":"onMouseLeave","node:mousemove":"onMouseMove","edge:mouseenter":"onMouseEnter","edge:mouseleave":"onMouseLeave","edge:mousemove":"onMouseMove","combo:mouseenter":"onMouseEnter","combo:mouseleave":"onMouseLeave","combo:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave",contextmenu:"onMouseLeave","node:drag":"onMouseLeave"}},n.prototype.init=function(){var t=this,r=t.get("className")||"g6-component-tooltip",i=gn("<div class='".concat(r,"'></div>")),o=t.get("container");o||(o=t.get("graph").get("container")),Re(o)&&(o=document.getElementById(o)),qt(i,{position:"absolute",visibility:"hidden",display:"none"}),o.appendChild(i),t.get("trigger")!=="click"&&(i.addEventListener("mouseenter",function(a){qt(i,{visibility:"visible",display:"unset"})}),i.addEventListener("mouseleave",function(a){t.hideTooltip()})),t.set("tooltip",i)},n.prototype.onClick=function(t){var r=this.get("itemTypes");if(!t.item||!t.item.getType||r.indexOf(t.item.getType())!==-1){var i=t.item,o=this.get("graph");this.currentTarget===i?(this.currentTarget=null,this.hideTooltip(),o.emit("tooltipchange",{item:t.item,action:"hide"})):(this.currentTarget=i,this.showTooltip(t),o.emit("tooltipchange",{item:t.item,action:"show"}))}},n.prototype.onMouseEnter=function(t){var r=this.get("itemTypes");if(!t.item||!t.item.getType||r.indexOf(t.item.getType())!==-1){var i=t.item,o=this.get("graph");this.currentTarget=i,this.showTooltip(t),o.emit("tooltipchange",{item:t.item,action:"show"})}},n.prototype.onMouseMove=function(t){var r=this.get("itemTypes");t.item&&t.item.getType&&r.indexOf(t.item.getType())===-1||this.currentTarget&&t.item===this.currentTarget&&this.showTooltip(t)},n.prototype.onMouseLeave=function(){this.hideTooltip(),this.get("graph").emit("tooltipchange",{item:this.currentTarget,action:"hide"}),this.currentTarget=null},n.prototype.clearContainer=function(){var t=this.get("tooltip");t&&(t.innerHTML="")},n.prototype.showTooltip=function(t){if(t.item){var r=this.get("itemTypes");if(!t.item.getType||r.indexOf(t.item.getType())!==-1){var i=this.get("tooltip"),o=this.get("getContent")(t);Re(o)?i.innerHTML=o:(this.clearContainer(),i.appendChild(o)),this.updatePosition(t)}}},n.prototype.hideTooltip=function(){var t=this.get("tooltip");t&&qt(t,{visibility:"hidden",display:"none"})},n.prototype.updatePosition=function(t){var r=this.get("shouldBegin"),i=this.get("tooltip");if(r(t)){var o=this.get("graph"),a=o.get("width"),s=o.get("height"),u=this.get("offsetX")||0,c=this.get("offsetY")||0,l=o.getPointByClient(t.clientX,t.clientY),h=this.get("fixToNode"),f=t.item;if(f.getType&&f.getType()==="node"&&h&&Mt(h)&&h.length>=2){var d=f.getBBox();l={x:d.minX+d.width*h[0],y:d.minY+d.height*h[1]}}var p=o.getCanvasByPoint(l.x,l.y),g=p.x,v=p.y,m=o.getContainer(),y={x:g+m.offsetLeft+u,y:v+m.offsetTop+c};qt(i,{visibility:"visible",display:"unset"});var b=i.getBoundingClientRect();g+b.width+u>a&&(y.x-=b.width+u),v+b.height+c>s&&(y.y-=b.height+c,y.y<0&&(y.y=0)),qt(i,{left:"".concat(y.x,"px"),top:"".concat(y.y,"px")})}else qt(i,{visibility:"hidden",display:"none"})},n.prototype.hide=function(){this.onMouseLeave()},n.prototype.destroy=function(){var t=this.get("tooltip");if(t){var r=this.get("container");r||(r=this.get("graph").get("container")),Re(r)&&(r=document.getElementById(r)),r.removeChild(t)}},n}(qr),kO="timebarstartplay",CO="timebarendplay",so="valuechange",Es="timebarConfigChanged",Ma="playPauseBtn",Ul="nextStepBtn",Xl="preStepBtn",jW=function(){function e(n){var t=n.x,r=t===void 0?0:t,i=n.y,o=i===void 0?0:i,a=n.container,s=n.text,u=n.padding,c=u===void 0?[4,4,4,4]:u,l=n.className,h=l===void 0?"g6-component-timebar-tooltip":l,f=n.backgroundColor,d=f===void 0?"#000":f,p=n.textColor,g=p===void 0?"#fff":p,v=n.opacity,m=v===void 0?.8:v,y=n.fontSize,b=y===void 0?12:y;this.container=a,this.className=h,this.backgroundColor=d,this.textColor=g,this.x=r,this.y=o,this.text=s,this.padding=c,this.opacity=m,this.fontSize=b,this.render()}return e.prototype.render=function(){var n=this,t=n.className;n.x,n.y;var r=n.backgroundColor,i=n.textColor,o=n.text,a=n.padding,s=n.opacity,u=n.fontSize,c=n.container,l=gn("<div class='".concat(t,`' style="position: absolute; width: fit-content; height: fit-content; opacity: `).concat(s,'"></div>'));Re(c)&&(c=document.getElementById(c)),c.appendChild(l),n.parentHeight=c.offsetHeight,n.parentWidth=c.offsetWidth,qt(l,{visibility:"hidden",top:0,left:0});var h=gn(`
      <div style='position: absolute; white-space:nowrap; background-color: `.concat(r,"; font-size: ").concat(u,"px; border-radius: 4px; width: fit-content; height: fit-content; color: ").concat(i,"; padding: ").concat(a[0],"px ").concat(a[1],"px ").concat(a[2],"px ").concat(a[3],"px'></div>"));h.innerHTML=o,l.appendChild(h),n.backgroundDOM=h;var f=gn("<div style='position: absolute; width: 0px; height: 0px; border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 10px solid ".concat(r,"'></div>"));l.appendChild(f),n.arrowDOM=f,n.container=l},e.prototype.show=function(n){var t=this,r=n.text,i=n.x;n.y,n.clientX,n.clientY,t.backgroundDOM.innerHTML=r;var o=t.backgroundDOM.offsetWidth,a=t.backgroundDOM.offsetHeight,s=t.arrowDOM.offsetWidth,u=t.arrowDOM.offsetHeight;qt(t.container,{top:"".concat(-a-u,"px"),left:"".concat(i,"px"),visibility:"visible"}),qt(t.backgroundDOM,{marginLeft:"".concat(-o/2,"px")}),qt(t.arrowDOM,{marginLeft:"".concat(-s/2,"px"),top:"".concat(a,"px")});var c=i-o/2,l=i+o/2;c<0?qt(t.backgroundDOM,{marginLeft:"".concat(-o/2-c,"px")}):l>t.parentWidth&&qt(t.backgroundDOM,{marginLeft:"".concat(-o/2-l+t.parentWidth+12,"px")})},e.prototype.hide=function(){qt(this.container,{top:0,left:0,visibility:"hidden"})},e}(),Y1=function(){return Y1=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},Y1.apply(this,arguments)},BW=function(){function e(n){this.config=fn({},n),this.init()}return e.prototype.update=function(n){this.config=fn({},this.config,n),this.updateElement(),this.renderMarker()},e.prototype.init=function(){this.initElement(),this.renderMarker()},e.prototype.initElement=function(){var n=this.config,t=n.group,r=n.style,i=r.scale,o=i===void 0?1:i,a=r.offsetX,s=a===void 0?0:a,u=r.offsetY,c=u===void 0?0:u,l=this.config.x+s,h=this.config.y+c,f=t.addGroup({name:Ma});this.startMarkerGroup=f.addGroup({name:Ma}),this.circle=t.addShape("circle",{attrs:Y1({x:l,y:h,r:this.config.r*o},r),name:Ma}),this.startMarker=this.startMarkerGroup.addShape("path",{attrs:{path:this.getStartMarkerPath(l,h,o),fill:r.stroke||"#aaa"},name:"start-marker"}),this.pauseMarkerGroup=f.addGroup({name:Ma});var d=.25*this.config.r*o,p=.5*this.config.r*Math.sqrt(3)*o;this.pauseLeftMarker=this.pauseMarkerGroup.addShape("rect",{attrs:{x:l-.375*this.config.r*o,y:h-p/2,width:d,height:p,fill:r.stroke||"#aaa",lineWidth:0}}),this.pauseRightMarker=this.pauseMarkerGroup.addShape("rect",{attrs:{x:l+1/8*this.config.r*o,y:h-p/2,width:d,height:p,fill:r.stroke||"#aaa",lineWidth:0}})},e.prototype.updateElement=function(){var n=this.config.style,t=n.scale,r=t===void 0?1:t,i=n.offsetX,o=i===void 0?0:i,a=n.offsetY,s=a===void 0?0:a,u=this.config.x+o,c=this.config.y+s;this.circle.attr("x",u),this.circle.attr("y",c),this.circle.attr("r",this.config.r*r),this.startMarker.attr("path",this.getStartMarkerPath(u,c,r));var l=.25*this.config.r*r,h=.5*this.config.r*Math.sqrt(3)*r;this.pauseLeftMarker.attr("x",u-.375*this.config.r*r),this.pauseLeftMarker.attr("y",c-h/2),this.pauseLeftMarker.attr("width",l),this.pauseLeftMarker.attr("height",h),this.pauseRightMarker.attr("x",u+1/8*this.config.r*r),this.pauseRightMarker.attr("y",c-h/2),this.pauseRightMarker.attr("width",l),this.pauseRightMarker.attr("height",h)},e.prototype.renderMarker=function(){this.config.isPlay?(this.startMarkerGroup.hide(),this.pauseMarkerGroup.show()):(this.startMarkerGroup.show(),this.pauseMarkerGroup.hide())},e.prototype.getStartMarkerPath=function(n,t,r){var i=.5*this.config.r*Math.sqrt(3)*r;return[["M",n-i/Math.sqrt(3)/2,t-i/2],["L",n+i/Math.sqrt(3),t],["L",n-i/Math.sqrt(3)/2,t+i/2]]},e}(),jn=function(){return jn=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},jn.apply(this,arguments)},Yl=Qr,zW={fill:"#aaa",fillOpacity:.35,stroke:"#aaa"},FW={fill:"#fff"},GW={fill:"green"},AO={pointer:{fill:"#aaa",lineWidth:0},scroller:{stroke:"#aaa",fill:"#aaa",lineWidth:1,lineAppendWidth:5,cursor:"pointer"},text:{fill:"#aaa",textBaseline:"top"}},IO={check:{stroke:"green",lineWidth:3},box:{fill:"#fff",stroke:"#aaa",lineWidth:2,radius:3,width:12,height:12},text:{fill:"#aaa",fontSize:12,textBaseline:"top"}},UW={speed:1,loop:!1,fill:"#fff",stroke:"#fff",hideTimeTypeController:!1,preBtnStyle:{fill:"#aaa",stroke:"#aaa"},nextBtnStyle:{fill:"#aaa",stroke:"#aaa"},playBtnStyle:{fill:"#aaa",stroke:"#aaa",fillOpacity:.05},speedControllerStyle:AO,timeTypeControllerStyle:IO},Sa=50,Wl="single",Vl="range",TO=function(){function e(n){this.controllerCfg=fn({},UW,n),this.group=n.group,this.controllerGroup=this.group.addGroup({name:"controller-group"}),this.speedAxisY=[],this.currentSpeed=this.controllerCfg.speed,this.currentType=this.controllerCfg.defaultTimeType||Vl,this.fontFamily=n.fontFamily||"Arial, sans-serif",this.init()}return e.prototype.init=function(){this.renderPlayButton()},e.prototype.getNextMarkerPath=function(n,t,r){return[["M",n,t-r],["L",n+r,t],["L",n,t+r],["Z",n,t-r],["M",n,t],["L",n-r,t-r],["L",n-r,t+r],["Z"]]},e.prototype.getPreMarkerPath=function(n,t,r){return[["M",n,t-r],["L",n-r,t],["L",n,t+r],["L",n,t-r],["M",n,t],["L",n+r,t-r],["L",n+r,t+r],["Z"]]},e.prototype.renderPlayButton=function(){var n=this.controllerCfg,t=n.width,r=n.height,i=n.x,o=n.y,a=n.hideTimeTypeController,s=n.fill,u=s===void 0?"#aaa":s,c=n.stroke,l=c===void 0?"green":c,h=n.containerStyle,f=h===void 0?{}:h,d=jn(jn({},zW),n.playBtnStyle||{}),p=jn(jn({},FW),n.preBtnStyle||{}),g=jn(jn({},GW),n.nextBtnStyle||{}),v=r/2-5,m=o+10,y=this.controllerGroup.addShape("rect",{attrs:jn({x:i,y:m,width:t,height:r,stroke:l,fill:u},f),name:"container-rect"});this.playButton?this.playButton.update({x:t/2,y:m,r:v}):this.playButton=new BW({group:this.controllerGroup,x:t/2,y:m+v+5,r:v,isPlay:this.isPlay,style:d});var b=p.offsetX||0,x=p.offsetY||0,w=(p.scale||1)*v;this.controllerGroup.addShape("path",{attrs:jn({path:this.getPreMarkerPath(t/2-5*v+b,m+v+5+x,.5*w)},p),name:Xl});var E=g.offsetX||0,M=g.offsetY||0,_=(g.scale||1)*v;this.controllerGroup.addShape("path",{attrs:jn({path:this.getNextMarkerPath(t/2+5*v+E,m+v+5+M,.5*_)},g),name:Ul}),y.toBack(),this.renderSpeedBtn(),a||this.renderToggleTime(),this.bindEvent();var k=this.controllerCfg.scale,S=k===void 0?1:k,C=this.controllerGroup.getCanvasBBox(),T=(C.maxX+C.minX)/2,A=(C.maxY+C.minY)/2,D=Yl([1,0,0,0,1,0,0,0,1],[["t",-T,-A],["s",S,S],["t",T,A]]);this.controllerGroup.setMatrix(D)},e.prototype.renderSpeedBtn=function(){var n=this.controllerCfg,t=n.y,r=n.width,i=n.hideTimeTypeController,o=jn(jn({},AO),this.controllerCfg.speedControllerStyle||{}),a=o.scroller,s=a===void 0?{}:a,u=o.text,c=u===void 0?{}:u,l=o.pointer,h=l===void 0?{}:l,f=o.scale,d=f===void 0?1:f,p=o.offsetX,g=p===void 0?0:p,v=o.offsetY,m=v===void 0?0:v,y=this.controllerGroup.addGroup({name:"speed-group"});this.speedGroup=y;var b=5;this.speedAxisY=[19,22,26,32,39];for(var x=0;x<5;x++){var w=t+this.speedAxisY[x],E=r-(i?Sa:110);y.addShape("line",{attrs:jn({x1:E,x2:E+15,y1:w,y2:w},s),speed:b,name:"speed-rect"}),this.speedAxisY[x]=w,b-=1}this.speedText=y.addShape("text",{attrs:jn({x:r-(i?Sa:110)+20,y:this.speedAxisY[0]+4,text:"1.0X",fontFamily:this.fontFamily||"Arial, sans-serif"},c),name:"speed-text"}),this.speedPoint=y.addShape("path",{attrs:jn({path:this.getPointerPath(r-(i?Sa:110),0),matrix:[1,0,0,0,1,0,0,this.speedAxisY[4],1]},h),name:"speed-pointer"});var M=this.speedGroup.getCanvasBBox(),_=(M.maxX+M.minX)/2,k=(M.maxY+M.minY)/2,S=this.speedGroup.getMatrix()||[1,0,0,0,1,0,0,0,1];S=Yl(S,[["t",-_,-k],["s",d,d],["t",_+g*d,k+m*d]]),this.speedGroup.setMatrix(S)},e.prototype.getPointerPath=function(n,t){return[["M",n,t],["L",n-10,t-4],["L",n-10,t+4],["Z"]]},e.prototype.renderToggleTime=function(){var n,t,r=this.controllerCfg,i=r.width,o=r.defaultTimeType,a=jn(jn({},IO),this.controllerCfg.timeTypeControllerStyle||{}),s=a.scale,u=s===void 0?1:s,c=a.offsetX,l=c===void 0?0:c,h=a.offsetY,f=h===void 0?0:h,d=a.box,p=d===void 0?{}:d,g=a.check,v=g===void 0?{}:g,m=a.text,y=m===void 0?{}:m;this.toggleGroup=this.controllerGroup.addGroup({name:"toggle-group"});var b=o===Wl;this.toggleGroup.addShape("rect",{attrs:jn({x:i-Sa,y:this.speedAxisY[0]+3.5},p),isChecked:b,name:"toggle-model"}),this.checkedIcon=this.toggleGroup.addShape("path",{attrs:jn({path:[["M",i-Sa+3,this.speedAxisY[1]+6],["L",i-Sa+7,this.speedAxisY[1]+10],["L",i-Sa+12,this.speedAxisY[1]+4]]},v),capture:!1,name:"check-icon"}),b||this.checkedIcon.hide(),this.checkedText=this.toggleGroup.addShape("text",{attrs:jn({text:b?((n=this.controllerCfg)===null||n===void 0?void 0:n.timeRangeControllerText)||"\u65F6\u95F4\u8303\u56F4":((t=this.controllerCfg)===null||t===void 0?void 0:t.timePointControllerText)||"\u5355\u4E00\u65F6\u95F4",x:i-Sa+15,y:this.speedAxisY[0]+4,fontFamily:typeof window<"u"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif"},y),name:"checked-text"});var x=this.toggleGroup.getCanvasBBox(),w=(x.maxX+x.minX)/2,E=(x.maxY+x.minY)/2,M=this.toggleGroup.getMatrix()||[1,0,0,0,1,0,0,0,1];M=Yl(M,[["t",-w,-E],["s",u,u],["t",w+l*u,E+f*u]]),this.toggleGroup.setMatrix(M)},e.prototype.bindEvent=function(){var n=this;this.speedGroup.on("speed-rect:click",function(t){var r=t.target.attr("y1"),i=n.speedPoint.attr("matrix"),o=n.speedAxisY.indexOf(i[7]||0),a=n.speedAxisY.indexOf(r),s=n.speedAxisY[a]-n.speedAxisY[o];i=Yl(i,[["t",0,s]]),n.speedPoint.setMatrix(i),n.currentSpeed=n.speedAxisY.length-a,n.speedText.attr("text","".concat(n.currentSpeed,".0X")),n.group.emit(Es,{speed:n.currentSpeed,type:n.currentType})}),this.speedGroup.on("mousewheel",function(t){t.preventDefault();var r=n.speedPoint.attr("matrix")||[1,0,0,0,1,0,0,0,1],i=r[7],o=n.speedAxisY.indexOf(i);if(o===-1){var a=1/0;n.speedAxisY.forEach(function(u,c){var l=Math.abs(u-i);a>l&&(a=l,o=c)})}o=t.originalEvent.deltaY>0?Math.max(0,o-1):Math.min(n.speedAxisY.length-1,o+1);var s=n.speedAxisY[o]-i;r=Yl(r,[["t",0,s]]),n.speedPoint.setMatrix(r),n.currentSpeed=n.speedAxisY.length-o,n.speedText.attr("text","".concat(n.currentSpeed,".0X")),n.group.emit(Es,{speed:n.currentSpeed,type:n.currentType})}),this.toggleGroup&&this.toggleGroup.on("toggle-model:click",function(t){var r,i,o=t.target.get("isChecked");o?(n.checkedIcon.hide(),n.checkedText.attr("text",((i=n.controllerCfg)===null||i===void 0?void 0:i.timePointControllerText)||"\u5355\u4E00\u65F6\u95F4"),n.currentType=Vl):(n.checkedIcon.show(),n.checkedText.attr("text",((r=n.controllerCfg)===null||r===void 0?void 0:r.timeRangeControllerText)||"\u65F6\u95F4\u8303\u56F4"),n.currentType=Wl),t.target.set("isChecked",!o),n.group.emit(Es,{type:n.currentType,speed:n.currentSpeed})})},e.prototype.destroy=function(){this.speedGroup.off("speed-rect:click"),this.toggleGroup&&(this.toggleGroup.off("toggle-model:click"),this.toggleGroup.destroy()),this.speedGroup.destroy()},e}(),Hl=function(){return Hl=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},Hl.apply(this,arguments)},XW=Qr,YW={fill:"#5B8FF9"},WW={fill:"#e6e8e9"},VW=function(){function e(n){this.frameCount=0,this.fontFamily="Arial, sans-serif";var t=n.graph,r=n.canvas,i=n.group,o=n.width,a=n.height,s=n.padding,u=n.data,c=n.start,l=n.end,h=n.x,f=h===void 0?0:h,d=n.y,p=d===void 0?0:d,g=n.tickLabelFormatter,v=n.selectedTickStyle,m=v===void 0?YW:v,y=n.unselectedTickStyle,b=y===void 0?WW:y,x=n.tooltipBackgroundColor,w=n.tooltipFomatter,E=n.tickLabelStyle,M=n.controllerCfg,_=M===void 0?{speed:1}:M;this.graph=t,this.group=i,this.sliceGroup=i.addGroup({name:"slice-group"}),this.canvas=r,this.width=o,this.height=a,this.padding=s,this.data=u,this.start=c,this.end=l,this.tickLabelFormatter=g,this.tickLabelStyle=E||{},this.selectedTickStyle=m,this.unselectedTickStyle=b,this.controllerCfg=_,this.currentSpeed=_.speed||1,this.x=f,this.y=p,this.tooltipBackgroundColor=x,this.tooltipFomatter=w,this.fontFamily=typeof window<"u"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif",this.renderSlices(),this.initEvent()}return e.prototype.renderSlices=function(){var n=this,t=this,r=t.width,i=t.height,o=t.padding,a=t.data,s=t.start,u=t.end,c=t.tickLabelFormatter,l=t.selectedTickStyle,h=t.unselectedTickStyle,f=t.tickLabelStyle,d=r-2*o,p=i-(3*o+4+10)-2*o,g=a.length,v=(d-2*(g-1))/g;this.tickWidth=v;var m=this.sliceGroup,y=[],b=[],x=Math.round(g*s),w=Math.round(g*u);this.startTickRectId=x,this.endTickRectId=w;var E=f.rotate;delete f.rotate,a.forEach(function(_,k){var S=k>=x&&k<=w?l:h,C=m.addShape("rect",{attrs:Hl({x:o+k*(v+2),y:o,width:v,height:p},S),draggable:!0,name:"tick-rect-".concat(k)}),T=m.addShape("rect",{attrs:{x:o+k*v+2*(2*k-1)/2,y:o,width:k===0||k===g-1?v+1:v+2,height:p,fill:"#fff",opacity:0},draggable:!0,name:"pick-rect-".concat(k)});T.toFront();var A,D=C.getBBox(),j=(D.minX+D.maxX)/2;if(y.push({rect:C,pickRect:T,value:_.date,x:j,y:D.minY}),c?(A=c(_),!Re(A)&&A&&(A=_.date)):k%Math.round(g/10)==0&&(A=_.date),A){b.push(A);var L=D.maxY+2*o;m.addShape("line",{attrs:{stroke:"#BFBFBF",x1:j,y1:L,x2:j,y2:L+4},name:"tick-line"});var B=L+4+o,N=m.addShape("text",{attrs:Hl({fill:"#8c8c8c",stroke:"#fff",lineWidth:1,x:j,y:B,textAlign:"center",text:A,textBaseline:"top",fontSize:10,fontFamily:n.fontFamily||"Arial, sans-serif"},f),capture:!1,name:"tick-label"}),R=N.getBBox();if(R.maxX>r?N.attr("textAlign","right"):R.minX<0&&N.attr("textAlign","left"),xt(E)&&b.length!==10){var P=XW([1,0,0,0,1,0,0,0,1],[["t",-j,-B],["r",E],["t",j-5,B+2]]);N.attr({textAlign:"left",matrix:P})}b.length===1?N.attr({textAlign:"left"}):b.length===10&&N.attr({textAlign:"right"})}}),this.tickRects=y;var M=this.group;this.currentSpeed=1,this.controllerBtnGroup=new TO(Hl({group:M,x:this.x,y:this.y+i+5,width:r,height:40,hideTimeTypeController:!0,speed:this.currentSpeed,fontFamily:this.fontFamily||"Arial, sans-serif"},this.controllerCfg))},e.prototype.initEvent=function(){var n=this,t=this.sliceGroup;t.on("click",function(l){var h=l.target;if(h.get("type")==="rect"&&h.get("name")){var f=parseInt(h.get("name").split("-")[2],10);if(!isNaN(f)){var d=n.tickRects,p=n.unselectedTickStyle;d.forEach(function(m){m.rect.attr(p)});var g=n.selectedTickStyle;d[f].rect.attr(g),n.startTickRectId=f,n.endTickRectId=f;var v=f/d.length;n.graph.emit(so,{value:[v,v]})}}}),t.on("dragstart",function(l){var h=n.tickRects,f=n.unselectedTickStyle;h.forEach(function(m){m.rect.attr(f)});var d=l.target,p=parseInt(d.get("name").split("-")[2],10),g=n.selectedTickStyle;h[p].rect.attr(g),n.startTickRectId=p;var v=p/h.length;n.graph.emit(so,{value:[v,v]}),n.dragging=!0}),t.on("dragover",function(l){if(n.dragging&&l.target.get("type")==="rect"){for(var h=parseInt(l.target.get("name").split("-")[2],10),f=n.startTickRectId,d=n.tickRects,p=n.selectedTickStyle,g=n.unselectedTickStyle,v=0;v<d.length;v++){var m=v>=f&&v<=h?p:g;d[v].rect.attr(m)}var y=d.length;n.endTickRectId=h;var b=f/y,x=h/y;n.graph.emit(so,{value:[b,x]})}}),t.on("drop",function(l){if(n.dragging&&(n.dragging=!1,l.target.get("type")==="rect")){var h=n.startTickRectId,f=parseInt(l.target.get("name").split("-")[2],10);if(!(f<h)){var d=n.selectedTickStyle,p=n.tickRects;p[f].rect.attr(d),n.endTickRectId=f;var g=p.length,v=h/g,m=f/g;n.graph.emit(so,{value:[v,m]})}}});var r=this,i=r.tooltipBackgroundColor,o=r.tooltipFomatter,a=r.canvas,s=new jW({container:a.get("container"),backgroundColor:i}),u=this.tickRects;u.forEach(function(l){var h=l.pickRect;h.on("mouseenter",function(f){var d=f.target;if(d.get("type")==="rect"){var p=parseInt(d.get("name").split("-")[2],10),g=a.getClientByPoint(u[p].x,u[p].y);s.show({x:u[p].x,y:u[p].y,clientX:g.x,clientY:g.y,text:o?o(u[p].value):u[p].value})}}),h.on("mouseleave",function(f){s.hide()})});var c=this.group;c.on("".concat(Ma,":click"),function(){n.isPlay=!n.isPlay,n.changePlayStatus()}),c.on("".concat(Ul,":click"),function(){n.updateStartEnd(1)}),c.on("".concat(Xl,":click"),function(){n.updateStartEnd(-1)}),c.on(Es,function(l){l.type;var h=l.speed;n.currentSpeed=h})},e.prototype.changePlayStatus=function(n){n===void 0&&(n=!0),this.controllerBtnGroup.playButton.update({isPlay:this.isPlay}),this.isPlay?(this.playHandler=this.startPlay(),this.graph.emit(kO,null)):this.playHandler&&(typeof window<"u"&&window.cancelAnimationFrame(this.playHandler),n&&this.graph.emit(CO,null))},e.prototype.startPlay=function(){var n=this;return typeof window<"u"?window.requestAnimationFrame(function(){var t=n.currentSpeed;n.frameCount%(60/t)==0&&(n.frameCount=0,n.updateStartEnd(1)),n.frameCount++,n.isPlay&&(n.playHandler=n.startPlay())}):void 0},e.prototype.updateStartEnd=function(n){var t=this,r=this.tickRects,i=r.length,o=this.unselectedTickStyle,a=this.selectedTickStyle,s=t.endTickRectId;if(n>0?t.endTickRectId++:(r[t.endTickRectId].rect.attr(o),t.endTickRectId--),s!==t.startTickRectId)t.endTickRectId<t.startTickRectId&&(t.startTickRectId=t.endTickRectId);else{for(var u=t.startTickRectId;u<=t.endTickRectId-1;u++)r[u].rect.attr(o);t.startTickRectId=t.endTickRectId}if(r[t.endTickRectId]){r[t.endTickRectId].rect.attr(a);var c=t.startTickRectId/i,l=t.endTickRectId/i;this.graph.emit(so,{value:[c,l]})}},e.prototype.destory=function(){var n=this.sliceGroup;n.off("click"),n.off("dragstart"),n.off("dragover"),n.off("drop"),this.tickRects.forEach(function(t){var r=t.pickRect;r.off("mouseenter"),r.off("mouseleave")}),this.tickRects.length=0,n.off("".concat(Ma,":click")),n.off("".concat(Ul,":click")),n.off("".concat(Xl,":click")),n.off(Es),this.sliceGroup.destroy()},e}(),OO={};function uo(e,n){OO[e]=n}var W1=function(){function e(n){this.type="base",this.isCategory=!1,this.isLinear=!1,this.isContinuous=!1,this.isIdentity=!1,this.values=[],this.range=[0,1],this.ticks=[],this.__cfg__=n,this.initCfg(),this.init()}return e.prototype.translate=function(n){return n},e.prototype.change=function(n){St(this.__cfg__,n),this.init()},e.prototype.clone=function(){return this.constructor(this.__cfg__)},e.prototype.getTicks=function(){var n=this;return Wa(this.ticks,function(t,r){return tr(t)?t:{text:n.getText(t,r),tickValue:t,value:n.scale(t)}})},e.prototype.getText=function(n,t){var r=this.formatter,i=r?r(n,t):n;return yt(i)||!mn(i.toString)?"":i.toString()},e.prototype.getConfig=function(n){return this.__cfg__[n]},e.prototype.init=function(){St(this,this.__cfg__),this.setDomain(),jw(this.getConfig("ticks"))&&(this.ticks=this.calculateTicks())},e.prototype.initCfg=function(){},e.prototype.setDomain=function(){},e.prototype.calculateTicks=function(){var n=this.tickMethod,t=[];if(Re(n)){var r=function(i){return OO[i]}(n);if(!r)throw new Error("There is no method to to calculate ticks!");t=r(this)}else mn(n)&&(t=n(this));return t},e.prototype.rangeMin=function(){return this.range[0]},e.prototype.rangeMax=function(){return this.range[1]},e.prototype.calcPercent=function(n,t,r){return xt(n)?(n-t)/(r-t):NaN},e.prototype.calcValue=function(n,t,r){return t+n*(r-t)},e}(),ql=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="cat",t.isCategory=!0,t}return Nt(n,e),n.prototype.buildIndexMap=function(){if(!this.translateIndexMap){this.translateIndexMap=new Map;for(var t=0;t<this.values.length;t++)this.translateIndexMap.set(this.values[t],t)}},n.prototype.translate=function(t){this.buildIndexMap();var r=this.translateIndexMap.get(t);return r===void 0&&(r=xt(t)?t:NaN),r},n.prototype.scale=function(t){var r=this.translate(t),i=this.calcPercent(r,this.min,this.max);return this.calcValue(i,this.rangeMin(),this.rangeMax())},n.prototype.invert=function(t){var r=this.max-this.min,i=this.calcPercent(t,this.rangeMin(),this.rangeMax()),o=Math.round(r*i)+this.min;return o<this.min||o>this.max?NaN:this.values[o]},n.prototype.getText=function(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=t;return xt(t)&&!this.values.includes(t)&&(o=this.values[o]),e.prototype.getText.apply(this,Ph([o],r))},n.prototype.initCfg=function(){this.tickMethod="cat"},n.prototype.setDomain=function(){if(yt(this.getConfig("min"))&&(this.min=0),yt(this.getConfig("max"))){var t=this.values.length;this.max=t>1?t-1:t}this.translateIndexMap&&(this.translateIndexMap=void 0)},n}(W1),NO=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,_a="\\d\\d?",ka="\\d\\d",Zl="[^\\s]+",DO=/\[([^]*?)\]/gm;function PO(e,n){for(var t=[],r=0,i=e.length;r<i;r++)t.push(e[r].substr(0,n));return t}var LO=function(e){return function(n,t){var r=t[e].map(function(o){return o.toLowerCase()}),i=r.indexOf(n.toLowerCase());return i>-1?i:null}};function Ca(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];for(var r=0,i=n;r<i.length;r++){var o=i[r];for(var a in o)e[a]=o[a]}return e}var RO=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],jO=["January","February","March","April","May","June","July","August","September","October","November","December"],HW=PO(jO,3),V1={dayNamesShort:PO(RO,3),dayNames:RO,monthNamesShort:HW,monthNames:jO,amPm:["am","pm"],DoFn:function(e){return e+["th","st","nd","rd"][e%10>3?0:(e-e%10!=10?1:0)*e%10]}},jp=Ca({},V1),BO=function(e){return jp=Ca(jp,e)},zO=function(e){return e.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},Dr=function(e,n){for(n===void 0&&(n=2),e=String(e);e.length<n;)e="0"+e;return e},qW={D:function(e){return String(e.getDate())},DD:function(e){return Dr(e.getDate())},Do:function(e,n){return n.DoFn(e.getDate())},d:function(e){return String(e.getDay())},dd:function(e){return Dr(e.getDay())},ddd:function(e,n){return n.dayNamesShort[e.getDay()]},dddd:function(e,n){return n.dayNames[e.getDay()]},M:function(e){return String(e.getMonth()+1)},MM:function(e){return Dr(e.getMonth()+1)},MMM:function(e,n){return n.monthNamesShort[e.getMonth()]},MMMM:function(e,n){return n.monthNames[e.getMonth()]},YY:function(e){return Dr(String(e.getFullYear()),4).substr(2)},YYYY:function(e){return Dr(e.getFullYear(),4)},h:function(e){return String(e.getHours()%12||12)},hh:function(e){return Dr(e.getHours()%12||12)},H:function(e){return String(e.getHours())},HH:function(e){return Dr(e.getHours())},m:function(e){return String(e.getMinutes())},mm:function(e){return Dr(e.getMinutes())},s:function(e){return String(e.getSeconds())},ss:function(e){return Dr(e.getSeconds())},S:function(e){return String(Math.round(e.getMilliseconds()/100))},SS:function(e){return Dr(Math.round(e.getMilliseconds()/10),2)},SSS:function(e){return Dr(e.getMilliseconds(),3)},a:function(e,n){return e.getHours()<12?n.amPm[0]:n.amPm[1]},A:function(e,n){return e.getHours()<12?n.amPm[0].toUpperCase():n.amPm[1].toUpperCase()},ZZ:function(e){var n=e.getTimezoneOffset();return(n>0?"-":"+")+Dr(100*Math.floor(Math.abs(n)/60)+Math.abs(n)%60,4)},Z:function(e){var n=e.getTimezoneOffset();return(n>0?"-":"+")+Dr(Math.floor(Math.abs(n)/60),2)+":"+Dr(Math.abs(n)%60,2)}},FO=function(e){return+e-1},GO=[null,_a],UO=[null,Zl],XO=["isPm",Zl,function(e,n){var t=e.toLowerCase();return t===n.amPm[0]?0:t===n.amPm[1]?1:null}],YO=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(e){var n=(e+"").match(/([+-]|\d\d)/gi);if(n){var t=60*+n[1]+parseInt(n[2],10);return n[0]==="+"?t:-t}return 0}],ZW={D:["day",_a],DD:["day",ka],Do:["day",_a+Zl,function(e){return parseInt(e,10)}],M:["month",_a,FO],MM:["month",ka,FO],YY:["year",ka,function(e){var n=+(""+new Date().getFullYear()).substr(0,2);return+(""+(+e>68?n-1:n)+e)}],h:["hour",_a,void 0,"isPm"],hh:["hour",ka,void 0,"isPm"],H:["hour",_a],HH:["hour",ka],m:["minute",_a],mm:["minute",ka],s:["second",_a],ss:["second",ka],YYYY:["year","\\d{4}"],S:["millisecond","\\d",function(e){return 100*+e}],SS:["millisecond",ka,function(e){return 10*+e}],SSS:["millisecond","\\d{3}"],d:GO,dd:GO,ddd:UO,dddd:UO,MMM:["month",Zl,LO("monthNamesShort")],MMMM:["month",Zl,LO("monthNames")],a:XO,A:XO,ZZ:YO,Z:YO},Bp={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},WO=function(e){return Ca(Bp,e)},VO=function(e,n,t){if(n===void 0&&(n=Bp.default),t===void 0&&(t={}),typeof e=="number"&&(e=new Date(e)),Object.prototype.toString.call(e)!=="[object Date]"||isNaN(e.getTime()))throw new Error("Invalid Date pass to format");var r=[];n=(n=Bp[n]||n).replace(DO,function(o,a){return r.push(a),"@@@"});var i=Ca(Ca({},jp),t);return(n=n.replace(NO,function(o){return qW[o](e,i)})).replace(/@@@/g,function(){return r.shift()})};function HO(e,n,t){if(t===void 0&&(t={}),typeof n!="string")throw new Error("Invalid format in fecha parse");if(n=Bp[n]||n,e.length>1e3)return null;var r={year:new Date().getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},i=[],o=[],a=n.replace(DO,function(b,x){return o.push(zO(x)),"@@@"}),s={},u={};a=zO(a).replace(NO,function(b){var x=ZW[b],w=x[0],E=x[1],M=x[3];if(s[w])throw new Error("Invalid format. "+w+" specified twice in format");return s[w]=!0,M&&(u[M]=!0),i.push(x),"("+E+")"}),Object.keys(u).forEach(function(b){if(!s[b])throw new Error("Invalid format. "+b+" is required in specified format")}),a=a.replace(/@@@/g,function(){return o.shift()});var c=e.match(new RegExp(a,"i"));if(!c)return null;for(var l,h=Ca(Ca({},jp),t),f=1;f<c.length;f++){var d=i[f-1],p=d[0],g=d[2],v=g?g(c[f],h):+c[f];if(v==null)return null;r[p]=v}if(r.isPm===1&&r.hour!=null&&+r.hour!=12?r.hour=+r.hour+12:r.isPm===0&&+r.hour==12&&(r.hour=0),r.timezoneOffset==null){l=new Date(r.year,r.month,r.day,r.hour,r.minute,r.second,r.millisecond);for(var m=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],y=(f=0,m.length);f<y;f++)if(s[m[f][0]]&&r[m[f][0]]!==l[m[f][1]]())return null}else if(l=new Date(Date.UTC(r.year,r.month,r.day,r.hour,r.minute-r.timezoneOffset,r.second,r.millisecond)),r.month>11||r.month<0||r.day>31||r.day<1||r.hour>23||r.hour<0||r.minute>59||r.minute<0||r.second>59||r.second<0)return null;return l}var qO={format:VO,parse:HO,defaultI18n:V1,setGlobalDateI18n:BO,setGlobalDateMasks:WO};const KW=Object.freeze(Object.defineProperty({__proto__:null,assign:Ca,default:qO,defaultI18n:V1,format:VO,parse:HO,setGlobalDateI18n:BO,setGlobalDateMasks:WO},Symbol.toStringTag,{value:"Module"}));var ZO="format";function KO(e,n){return(KW[ZO]||qO[ZO])(e,n)}function zp(e){return Re(e)&&(e=e.indexOf("T")>0?new Date(e).getTime():new Date(e.replace(/-/gi,"/")).getTime()),Jg(e)&&(e=e.getTime()),e}var Aa=1e3,Fp=6e4,Ms=36e5,jo=24*Ms,Kl=31*jo,$O=365*jo,$l=[["HH:mm:ss",Aa],["HH:mm:ss",1e4],["HH:mm:ss",3e4],["HH:mm",Fp],["HH:mm",6e5],["HH:mm",18e5],["HH",Ms],["HH",6*Ms],["HH",12*Ms],["YYYY-MM-DD",jo],["YYYY-MM-DD",4*jo],["YYYY-WW",7*jo],["YYYY-MM",Kl],["YYYY-MM",4*Kl],["YYYY-MM",6*Kl],["YYYY",380*jo]];function $W(e,n,t){var r,i=(r=function(a){return a[1]},function(a,s,u,c){for(var l=yt(u)?0:u,h=yt(c)?a.length:c;l<h;){var f=l+h>>>1;r(a[f])>s?h=f:l=f+1}return l})($l,(n-e)/t)-1,o=$l[i];return i<0?o=$l[0]:i>=$l.length&&(o=$r($l)),o}var QW=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="timeCat",t}return Nt(n,e),n.prototype.translate=function(t){t=zp(t);var r=this.values.indexOf(t);return r===-1&&(r=xt(t)&&t<this.values.length?t:NaN),r},n.prototype.getText=function(t,r){var i=this.translate(t);if(i>-1){var o=this.values[i],a=this.formatter;return o=a?a(o,r):KO(o,this.mask)}return t},n.prototype.initCfg=function(){this.tickMethod="time-cat",this.mask="YYYY-MM-DD",this.tickCount=7},n.prototype.setDomain=function(){var t=this.values;ye(t,function(r,i){t[i]=zp(r)}),t.sort(function(r,i){return r-i}),e.prototype.setDomain.call(this)},n}(ql),Gp=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.isContinuous=!0,t}return Nt(n,e),n.prototype.scale=function(t){if(yt(t))return NaN;var r=this.rangeMin(),i=this.rangeMax();return this.max===this.min?r:r+this.getScalePercent(t)*(i-r)},n.prototype.init=function(){e.prototype.init.call(this);var t=this.ticks,r=Gi(t),i=$r(t);r<this.min&&(this.min=r),i>this.max&&(this.max=i),yt(this.minLimit)||(this.min=r),yt(this.maxLimit)||(this.max=i)},n.prototype.setDomain=function(){var t=Mw(this.values),r=t.min,i=t.max;yt(this.min)&&(this.min=r),yt(this.max)&&(this.max=i),this.min>this.max&&(this.min=r,this.max=i)},n.prototype.calculateTicks=function(){var t=this,r=e.prototype.calculateTicks.call(this);return this.nice||(r=Rh(r,function(i){return i>=t.min&&i<=t.max})),r},n.prototype.getScalePercent=function(t){var r=this.max,i=this.min;return(t-i)/(r-i)},n.prototype.getInvertPercent=function(t){return(t-this.rangeMin())/(this.rangeMax()-this.rangeMin())},n}(W1),Ql=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="linear",t.isLinear=!0,t}return Nt(n,e),n.prototype.invert=function(t){var r=this.getInvertPercent(t);return this.min+r*(this.max-this.min)},n.prototype.initCfg=function(){this.tickMethod="wilkinson-extended",this.nice=!1},n}(Gp);function Ia(e,n){var t=Math.E;return n>=0?Math.pow(t,Math.log(n)/e):-1*Math.pow(t,Math.log(-n)/e)}function ci(e,n){return e===1?1:Math.log(n)/Math.log(e)}function QO(e,n,t){yt(t)&&(t=Math.max.apply(null,e));var r=t;return ye(e,function(i){i>0&&i<r&&(r=i)}),r===t&&(r=t/n),r>1&&(r=1),r}var JW=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="log",t}return Nt(n,e),n.prototype.invert=function(t){var r,i=this.base,o=ci(i,this.max),a=this.rangeMin(),s=this.rangeMax()-a,u=this.positiveMin;if(u){if(t===0)return 0;var c=1/(o-(r=ci(i,u/i)))*s;if(t<c)return t/c*u}else r=ci(i,this.min);var l=(t-a)/s*(o-r)+r;return Math.pow(i,l)},n.prototype.initCfg=function(){this.tickMethod="log",this.base=10,this.tickCount=6,this.nice=!0},n.prototype.setDomain=function(){e.prototype.setDomain.call(this);var t=this.min;if(t<0)throw new Error("When you use log scale, the minimum value must be greater than zero!");t===0&&(this.positiveMin=QO(this.values,this.base,this.max))},n.prototype.getScalePercent=function(t){var r=this.max,i=this.min;if(r===i||t<=0)return 0;var o=this.base,a=this.positiveMin;return a&&(i=1*a/o),t<a?t/a/(ci(o,r)-ci(o,i)):(ci(o,t)-ci(o,i))/(ci(o,r)-ci(o,i))},n}(Gp),eV=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="pow",t}return Nt(n,e),n.prototype.invert=function(t){var r=this.getInvertPercent(t),i=this.exponent,o=Ia(i,this.max),a=Ia(i,this.min),s=r*(o-a)+a,u=s>=0?1:-1;return Math.pow(s,i)*u},n.prototype.initCfg=function(){this.tickMethod="pow",this.exponent=2,this.tickCount=5,this.nice=!0},n.prototype.getScalePercent=function(t){var r=this.max,i=this.min;if(r===i)return 0;var o=this.exponent;return(Ia(o,t)-Ia(o,i))/(Ia(o,r)-Ia(o,i))},n}(Gp),tV=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="time",t}return Nt(n,e),n.prototype.getText=function(t,r){var i=this.translate(t),o=this.formatter;return o?o(i,r):KO(i,this.mask)},n.prototype.scale=function(t){var r=t;return(Re(r)||Jg(r))&&(r=this.translate(r)),e.prototype.scale.call(this,r)},n.prototype.translate=function(t){return zp(t)},n.prototype.initCfg=function(){this.tickMethod="time-pretty",this.mask="YYYY-MM-DD",this.tickCount=7,this.nice=!1},n.prototype.setDomain=function(){var t=this.values,r=this.getConfig("min"),i=this.getConfig("max");if(yt(r)&&xt(r)||(this.min=this.translate(this.min)),yt(i)&&xt(i)||(this.max=this.translate(this.max)),t&&t.length){var o=[],a=1/0,s=a,u=0;ye(t,function(c){var l=zp(c);if(isNaN(l))throw new TypeError("Invalid Time: "+c+" in time scale!");a>l?(s=a,a=l):s>l&&(s=l),u<l&&(u=l),o.push(l)}),t.length>1&&(this.minTickInterval=s-a),yt(r)&&(this.min=a),yt(i)&&(this.max=u)}},n}(Ql),JO=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="quantize",t}return Nt(n,e),n.prototype.invert=function(t){var r=this.ticks,i=r.length,o=this.getInvertPercent(t),a=Math.floor(o*(i-1));if(a>=i-1)return $r(r);if(a<0)return Gi(r);var s=r[a],u=a/(i-1);return s+(o-u)/((a+1)/(i-1)-u)*(r[a+1]-s)},n.prototype.initCfg=function(){this.tickMethod="r-pretty",this.tickCount=5,this.nice=!0},n.prototype.calculateTicks=function(){var t=e.prototype.calculateTicks.call(this);return this.nice||($r(t)!==this.max&&t.push(this.max),Gi(t)!==this.min&&t.unshift(this.min)),t},n.prototype.getScalePercent=function(t){var r=this.ticks;if(t<Gi(r))return 0;if(t>$r(r))return 1;var i=0;return ye(r,function(o,a){if(!(t>=o))return!1;i=a}),i/(r.length-1)},n}(Gp),nV=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="quantile",t}return Nt(n,e),n.prototype.initCfg=function(){this.tickMethod="quantile",this.tickCount=5,this.nice=!0},n}(JO),e5={};function co(e,n){if(function(t){return e5[t]}(e))throw new Error("type '"+e+"' existed.");e5[e]=n}var rV=function(e){function n(){var t=e!==null&&e.apply(this,arguments)||this;return t.type="identity",t.isIdentity=!0,t}return Nt(n,e),n.prototype.calculateTicks=function(){return this.values},n.prototype.scale=function(t){return this.values[0]!==t&&xt(t)?t:this.range[0]},n.prototype.invert=function(t){var r=this.range;return t<r[0]||t>r[1]?NaN:this.values[0]},n}(W1);function t5(e){var n=e.values,t=e.tickInterval,r=e.tickCount,i=e.showLast;if(xt(t)){var o=Rh(n,function(p,g){return g%t==0}),a=$r(n);return i&&$r(o)!==a&&o.push(a),o}var s=n.length,u=e.min,c=e.max;if(yt(u)&&(u=0),yt(c)&&(c=n.length-1),!xt(r)||r>=s)return n.slice(u,c+1);if(r<=0||c<=0)return[];for(var l=r===1?s:Math.floor(s/(r-1)),h=[],f=u,d=0;d<r&&!(f>=c);d++)f=Math.min(u+d*l,c),d===r-1&&i?h.push(n[c]):h.push(n[f]);return h}var n5=Math.sqrt(50),r5=Math.sqrt(10),i5=Math.sqrt(2),iV=function(){function e(){this._domain=[0,1]}return e.prototype.domain=function(n){return n?(this._domain=Array.from(n,Number),this):this._domain.slice()},e.prototype.nice=function(n){var t,r;n===void 0&&(n=5);var i,o=this._domain.slice(),a=0,s=this._domain.length-1,u=this._domain[a],c=this._domain[s];return c<u&&(u=(t=[c,u])[0],c=t[1],a=(r=[s,a])[0],s=r[1]),(i=Up(u,c,n))>0?i=Up(u=Math.floor(u/i)*i,c=Math.ceil(c/i)*i,n):i<0&&(i=Up(u=Math.ceil(u*i)/i,c=Math.floor(c*i)/i,n)),i>0?(o[a]=Math.floor(u/i)*i,o[s]=Math.ceil(c/i)*i,this.domain(o)):i<0&&(o[a]=Math.ceil(u*i)/i,o[s]=Math.floor(c*i)/i,this.domain(o)),this},e.prototype.ticks=function(n){return n===void 0&&(n=5),function(t,r,i){var o,a,s,u,c=-1;if(i=+i,(t=+t)==(r=+r)&&i>0)return[t];if((o=r<t)&&(a=t,t=r,r=a),(u=Up(t,r,i))===0||!isFinite(u))return[];if(u>0)for(t=Math.ceil(t/u),r=Math.floor(r/u),s=new Array(a=Math.ceil(r-t+1));++c<a;)s[c]=(t+c)*u;else for(t=Math.floor(t*u),r=Math.ceil(r*u),s=new Array(a=Math.ceil(t-r+1));++c<a;)s[c]=(t-c)/u;return o&&s.reverse(),s}(this._domain[0],this._domain[this._domain.length-1],n||5)},e}();function Up(e,n,t){var r=(n-e)/Math.max(0,t),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=n5?10:o>=r5?5:o>=i5?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=n5?10:o>=r5?5:o>=i5?2:1)}function o5(e,n,t){return(t==="ceil"?Math.ceil(e/n):t==="floor"?Math.floor(e/n):Math.round(e/n))*n}function H1(e,n,t){var r=o5(e,t,"floor"),i=o5(n,t,"ceil");r=zh(r,t),i=zh(i,t);for(var o=[],a=Math.max((i-r)/(Math.pow(2,12)-1),t),s=r;s<=i;s+=a){var u=zh(s,a);o.push(u)}return{min:r,max:i,ticks:o}}function q1(e,n,t){var r,i=e.minLimit,o=e.maxLimit,a=e.min,s=e.max,u=e.tickCount,c=u===void 0?5:u,l=yt(i)?yt(n)?a:n:i,h=yt(o)?yt(t)?s:t:o;if(l>h&&(h=(r=[l,h])[0],l=r[1]),c<=2)return[l,h];for(var f=(h-l)/(c-1),d=[],p=0;p<c;p++)d.push(l+f*p);return d}function Ss(e){return Math.abs(e)<1e-15?e:parseFloat(e.toFixed(15))}var oV=[1,5,2,2.5,4,3],a5=100*Number.EPSILON;function aV(e,n,t,r,i,o){var a=Xh(n),s=t0(n,e),u=0,c=function(l,h){return(l%h+h)%h}(r,o);return(c<a5||o-c<a5)&&r<=0&&i>=0&&(u=1),1-s/(a-1)-t+u}function sV(e,n,t){var r=Xh(n);return 1-t0(n,e)/(r-1)-t+1}function uV(e,n,t,r,i,o){var a=(e-1)/(o-i),s=(n-1)/(Math.max(o,r)-Math.min(t,i));return 2-Math.max(a/s,s/a)}function cV(e,n){return e>=n?2-(e-1)/(n-1):1}function lV(e,n,t,r){var i=n-e;return 1-.5*(Math.pow(n-r,2)+Math.pow(e-t,2))/Math.pow(.1*i,2)}function hV(e,n,t){var r=n-e;if(t>r){var i=(t-r)/2;return 1-Math.pow(i,2)/Math.pow(.1*r,2)}return 1}function fV(e,n,t,r,i,o){t===void 0&&(t=5),r===void 0&&(r=!0),i===void 0&&(i=oV),o===void 0&&(o=[.25,.2,.5,.05]);var a=t<0?0:Math.round(t);if(Number.isNaN(e)||Number.isNaN(n)||typeof e!="number"||typeof n!="number"||!a)return{min:0,max:0,ticks:[]};if(n-e<1e-15||a===1)return{min:e,max:n,ticks:[e]};if(n-e>1e148){var s=(n-e)/(w=t||5);return{min:e,max:n,ticks:Array(w).fill(null).map(function(R,P){return Ss(e+s*P)})}}for(var u={score:-2,lmin:0,lmax:0,lstep:0},c=1;c<1/0;){for(var l=0;l<i.length;l+=1){var h=i[l],f=sV(h,i,c);if(o[0]*f+o[1]+o[2]+o[3]<u.score){c=1/0;break}for(var d=2;d<1/0;){var p=cV(d,a);if(o[0]*f+o[1]+o[2]*p+o[3]<u.score)break;for(var g=(n-e)/(d+1)/c/h,v=Math.ceil(Math.log10(g));v<1/0;){var m=c*h*Math.pow(10,v),y=hV(e,n,m*(d-1));if(o[0]*f+o[1]*y+o[2]*p+o[3]<u.score)break;var b=Math.floor(n/m)*c-(d-1)*c,x=Math.ceil(e/m)*c;if(b<=x)for(var w=x-b,E=0;E<=w;E+=1){var M=(b+E)*(m/c),_=M+m*(d-1),k=m,S=aV(h,i,c,M,_,k),C=lV(e,n,M,_),T=uV(d,a,e,n,M,_),A=o[0]*S+o[1]*C+o[2]*T+1*o[3];A>u.score&&(!r||M<=e&&_>=n)&&(u.lmin=M,u.lmax=_,u.lstep=k,u.score=A)}v+=1}d+=1}}c+=1}var D=Ss(u.lmax),j=Ss(u.lmin),L=Ss(u.lstep),B=Math.floor(function(R){return Math.round(1e12*R)/1e12}((D-j)/L))+1,N=new Array(B);for(N[0]=Ss(j),l=1;l<B;l++)N[l]=Ss(N[l-1]+L);return{min:Math.min(e,Gi(N)),max:Math.max(n,$r(N)),ticks:N}}function s5(e,n,t){if(t===void 0&&(t=5),e===n)return{max:n,min:e,ticks:[e]};var r=t<0?0:Math.round(t);if(r===0)return{max:n,min:e,ticks:[]};var i=(n-e)/r,o=Math.pow(10,Math.floor(Math.log10(i))),a=o;2*o-i<1.5*(i-a)&&5*o-i<2.75*(i-(a=2*o))&&10*o-i<1.5*(i-(a=5*o))&&(a=10*o);for(var s=Math.ceil(n/a),u=Math.floor(e/a),c=Math.max(s*a,n),l=Math.min(u*a,e),h=Math.floor((c-l)/a)+1,f=new Array(h),d=0;d<h;d++)f[d]=Ss(l+d*a);return{min:l,max:c,ticks:f}}function dV(e,n){var t=e.length*n;return n===1?e[e.length-1]:n===0?e[0]:t%1!=0?e[Math.ceil(t)-1]:e.length%2==0?(e[t-1]+e[t])/2:e[t]}function Xp(e){return new Date(e).getFullYear()}function pV(e){return new Date(e,0,1).getTime()}function Z1(e){return new Date(e).getMonth()}function gV(e,n){return new Date(e,n,1).getTime()}uo("cat",t5),uo("time-cat",function(e){return t5(F({showLast:!0},e))}),uo("wilkinson-extended",function(e){var n=e.min,t=e.max,r=e.tickCount,i=e.nice,o=e.tickInterval,a=e.minLimit,s=e.maxLimit,u=fV(n,t,r,i).ticks;return yt(a)&&yt(s)?o?H1(n,t,o).ticks:u:q1(e,Gi(u),$r(u))}),uo("r-pretty",function(e){var n=e.min,t=e.max,r=e.tickCount,i=e.tickInterval,o=e.minLimit,a=e.maxLimit,s=s5(n,t,r).ticks;return yt(o)&&yt(a)?i?H1(n,t,i).ticks:s:q1(e,Gi(s),$r(s))}),uo("time",function(e){var n=e.min,t=e.max,r=e.minTickInterval,i=e.tickInterval,o=e.tickCount;if(i)o=Math.ceil((t-n)/i);else{var a=(t-n)/(i=$W(n,t,o)[1])/o;a>1&&(i*=Math.ceil(a)),r&&i<r&&(i=r)}i=Math.max(Math.floor((t-n)/(Math.pow(2,12)-1)),i);for(var s=[],u=n;u<t+i;u+=i)s.push(u);return s}),uo("time-pretty",function(e){var n=e.min,t=e.max,r=e.minTickInterval,i=e.tickCount,o=e.tickInterval,a=[];o||(o=(t-n)/i,r&&o<r&&(o=r)),o=Math.max(Math.floor((t-n)/(Math.pow(2,12)-1)),o);var s=Xp(n);if(o>$O)for(var u=Xp(t),c=Math.ceil(o/$O),l=s;l<=u+c;l+=c)a.push(pV(l));else if(o>Kl){var h=Math.ceil(o/Kl),f=Z1(n),d=function(A,D){var j=Xp(A),L=Xp(D),B=Z1(A);return 12*(L-j)+(Z1(D)-B)%12}(n,t);for(l=0;l<=d+h;l+=h)a.push(gV(s,l+f))}else if(o>jo){var p=(b=new Date(n)).getFullYear(),g=b.getMonth(),v=b.getDate(),m=Math.ceil(o/jo),y=function(A,D){return Math.ceil((D-A)/jo)}(n,t);for(l=0;l<y+m;l+=m)a.push(new Date(p,g,v+l).getTime())}else if(o>Ms){p=(b=new Date(n)).getFullYear(),g=b.getMonth(),m=b.getDate();var b,x=b.getHours(),w=Math.ceil(o/Ms),E=function(A,D){return Math.ceil((D-A)/Ms)}(n,t);for(l=0;l<=E+w;l+=w)a.push(new Date(p,g,m,x+l).getTime())}else if(o>Fp){var M=function(A,D){return Math.ceil((D-A)/6e4)}(n,t),_=Math.ceil(o/Fp);for(l=0;l<=M+_;l+=_)a.push(n+l*Fp)}else{var k=o;k<Aa&&(k=Aa);var S=Math.floor(n/Aa)*Aa,C=Math.ceil((t-n)/Aa),T=Math.ceil(k/Aa);for(l=0;l<C+T;l+=T)a.push(S+l*Aa)}return a.length,a}),uo("log",function(e){var n,t=e.base,r=e.tickCount,i=e.min,o=e.max,a=e.values,s=ci(t,o);if(i>0)n=Math.floor(ci(t,i));else{var u=QO(a,t,o);n=Math.floor(ci(t,u))}for(var c=s-n,l=Math.ceil(c/r),h=[],f=n;f<s+l;f+=l)h.push(Math.pow(t,f));return i<=0&&h.unshift(0),h}),uo("pow",function(e){var n=e.exponent,t=e.tickCount,r=Math.ceil(Ia(n,e.max));return s5(Math.floor(Ia(n,e.min)),r,t).ticks.map(function(i){var o=i>=0?1:-1;return Math.pow(i,n)*o})}),uo("quantile",function(e){var n=e.tickCount,t=e.values;if(!t||!t.length)return[];for(var r=t.slice().sort(function(s,u){return s-u}),i=[],o=0;o<n;o++){var a=o/(n-1);i.push(dV(r,a))}return i}),uo("d3-linear",function(e){var n=e.min,t=e.max,r=e.tickInterval,i=e.minLimit,o=e.maxLimit,a=function(s){var u=s.min,c=s.max,l=s.nice,h=s.tickCount,f=new iV;return f.domain([u,c]),l&&f.nice(h),f.ticks(h)}(e);return yt(i)&&yt(o)?r?H1(n,t,r).ticks:a:q1(e,Gi(a),$r(a))}),co("cat",ql),co("category",ql),co("identity",rV),co("linear",Ql),co("log",JW),co("pow",eV),co("time",tV),co("timeCat",QW),co("quantize",JO),co("quantile",nV);var vV=function(e,n,t){if(t||arguments.length===2)for(var r,i=0,o=n.length;i<o;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))};function u5(e){return function(n){return Wa(n,function(t,r){return[r===0?"M":"L",t[0],t[1]]})}(e)}function mV(e,n,t,r){r===void 0&&(r=!0);var i=new Ql({values:e}),o=new ql({values:Wa(e,function(s,u){return u})}),a=Wa(e,function(s,u){return[o.scale(u)*n,t-i.scale(s)*t]});return r?function(s){if(s.length<=2)return u5(s);var u=[];ye(s,function(d){qo(d,u.slice(u.length-2))||u.push(d[0],d[1])});var c=SS(u,!1),l=Gi(s),h=l[0],f=l[1];return c.unshift(["M",h,f]),c}(a):u5(a)}function yV(e,n,t,r){r===void 0&&(r=5);for(var i=new Ql({values:e}),o=new ql({values:Wa(e,function(h,f){return f})}),a=Wa(e,function(h,f){return[o.scale(f)*n,t-i.scale(h)*t]}),s=[],u=0;u<a.length;u++){var c=a[u],l=xV({x:c[0],y:c[1],y0:t,size:r});s.push.apply(s,l)}return function(h,f){f===void 0&&(f=!0);var d=[],p=h[0];d.push(["M",p.x,p.y]);for(var g=1,v=h.length;g<v;g++)d.push(["L",h[g].x,h[g].y]);return f&&(d.push(["L",p.x,p.y]),d.push(["z"])),d}(s)}function bV(e,n,t,r){var i=vV([],e,!0),o=function(a,s){var u=new Ql({values:a}),c=Math.max(0,u.min);return s-u.scale(c)*s}(r,t);return i.push(["L",n,o]),i.push(["L",0,o]),i.push(["Z"]),i}function xV(e){var n,t,r,i,o=e.x,a=e.y,s=e.y0,u=e.size;Mt(a)?(n=a[0],t=a[1]):(n=s,t=a),Mt(o)?(r=o[0],i=o[1]):(r=o-u/2,i=o+u/2);var c=[{x:r,y:n},{x:r,y:t}];return c.push({x:i,y:t},{x:i,y:n}),c}var Jl=function(){return Jl=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},Jl.apply(this,arguments)},wV={stroke:"#C5C5C5",strokeOpacity:.85},EV={fill:"#CACED4",opacity:.85},MV=function(){function e(n){var t=n.x,r=t===void 0?0:t,i=n.y,o=i===void 0?0:i,a=n.width,s=a===void 0?200:a,u=n.height,c=u===void 0?26:u,l=n.smooth,h=l===void 0||l,f=n.isArea,d=f!==void 0&&f,p=n.data,g=p===void 0?[]:p,v=n.lineStyle,m=n.areaStyle,y=n.group,b=n.interval,x=b===void 0?null:b;this.group=y,this.x=r,this.y=o,this.width=s,this.height=c,this.data=g,this.smooth=h,this.isArea=d,this.lineStyle=Object.assign({},wV,v),this.areaStyle=Object.assign({},EV,m),this.intervalConfig=x,this.renderLine()}return e.prototype.renderLine=function(){var n=this,t=n.x,r=n.y,i=n.width,o=n.height;n.barWidth;var a=n.data,s=n.smooth,u=n.isArea,c=n.lineStyle,l=n.areaStyle,h=this.group.addGroup({name:"trend-group"});if(a){var f=mV(a,i,o,s);if(h.addShape("path",{attrs:Jl({path:f},c),name:"trend-line"}),u){var d=bV(f,i,o,a);h.addShape("path",{attrs:Jl({path:d},l),name:"trend-area"})}}this.intervalConfig&&h.addShape("path",{attrs:Jl({path:yV(this.intervalConfig.data,i,o,this.intervalConfig.style.barWidth)},this.intervalConfig.style),name:"trend-interval"}),h.move(t,r)},e.prototype.destory=function(){this.group.destroy()},e}(),Wu=function(){return Wu=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},Wu.apply(this,arguments)},SV={fill:"#1890ff",stroke:"#1890ff",type:"trend",radius:2,opacity:1,cursor:"ew-resize",highLightFill:"#0050b3"},_V={fill:"#fff",stroke:"#1890ff",radius:2,opacity:1,cursor:"ew-resize",highLightFill:"#0050b3"},c5=function(){function e(n){var t=n.group,r=n.name,i=n.type,o=n.x,a=o===void 0?0:o,s=n.y,u=s===void 0?0:s,c=n.width,l=c===void 0?2:c,h=n.height,f=h===void 0?24:h,d=n.style,p=d===void 0?{}:d;this.group=t,this.name=r,this.handleType=i,this.x=a,this.y=u,this.width=l,this.height=f,i==="trend"?this.style=Wu(Wu({},SV),p):i==="simple"&&(this.style=Wu(Wu({},_V),p)),this.renderHandle()}return e.prototype.setX=function(n){this.setXY(n,void 0)},e.prototype.setY=function(n){this.setXY(void 0,n)},e.prototype.setXY=function(n,t){xt(n)&&(this.x=n),xt(t)&&(this.y=t),this.updateXY()},e.prototype.renderHandle=function(){var n=this,t=n.width,r=n.height,i=n.style,o=n.name,a=i.fill,s=i.stroke,u=i.radius,c=i.opacity,l=i.cursor;this.handleGroup=this.group.addGroup(),this.handleType==="trend"?(this.verticalLine=this.handleGroup.addShape("rect",{attrs:{x:0,y:0,width:t,height:r,fill:a,stroke:s,radius:u,opacity:c,cursor:l},name:"".concat(o,"-handler")}),this.topCircle=this.handleGroup.addShape("circle",{attrs:{x:t/2,y:0,r:2*t,fill:a,stroke:s,radius:u,opacity:c,cursor:l,lineAppendWidth:12},name:"".concat(o,"-handler")}),this.bottomCircle=this.handleGroup.addShape("circle",{attrs:{x:t/2,y:r,r:2*t,fill:a,stroke:s,radius:u,opacity:c,cursor:l},name:"".concat(o,"-handler")})):this.handleType==="simple"&&(this.topCircle=this.handleGroup.addShape("circle",{attrs:{x:t/2,y:r/2,r:2*t,fill:a,stroke:s,radius:u,opacity:c,cursor:l,lineWidth:2},name:"".concat(o,"-handler")})),this.updateXY(),this.handleType==="trend"?this.bindTrendEvents():this.handleType==="simple"&&this.bindSimpleEvents()},e.prototype.bindSimpleEvents=function(){var n=this,t=this.name;this.handleGroup.on("".concat(t,"-handler:mouseenter"),function(){var r=n.style.highLightFill;n.topCircle.attr("fill",r)}),this.handleGroup.on("".concat(t,"-handler:mouseleave"),function(){var r=n.style.fill;n.topCircle.attr("fill",r)})},e.prototype.bindTrendEvents=function(){var n=this,t=this.name;this.handleGroup.on("".concat(t,"-handler:mouseenter"),function(){var r=n.style.highLightFill;n.verticalLine.attr("fill",r),n.topCircle.attr("fill",r),n.bottomCircle.attr("fill",r)}),this.handleGroup.on("".concat(t,"-handler:mouseleave"),function(){var r=n.style.fill;n.verticalLine.attr("fill",r),n.topCircle.attr("fill",r),n.bottomCircle.attr("fill",r)})},e.prototype.show=function(){this.handleGroup.show()},e.prototype.hide=function(){this.handleGroup.hide()},e.prototype.updateXY=function(){this.handleGroup.setMatrix([1,0,0,0,1,0,this.x,this.y,1])},e}(),pn=function(){return pn=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},pn.apply(this,arguments)},kV=Qr,CV={fill:"#416180",opacity:.05},AV={fill:"#416180",opacity:.15,radius:5},IV={fill:"#5B8FF9",opacity:.3,cursor:"grab"},TV={width:2,height:24},OV={textBaseline:"middle",fill:"#000",opacity:.45},NV={textAlign:"center",textBaseline:"top",fill:"#607889",opacity:.35},DV={lineWidth:1,stroke:"#ccc"},PV=function(){function e(n){var t=this;this.prevX=0,this.onMouseDown=function(H){return function(ne){t.currentHandler=H;var Z=ne.originalEvent;Z.stopPropagation(),Z.preventDefault(),t.prevX=fo(Z,"touches.0.pageX",Z.pageX);var q=t.canvas.get("container");q.addEventListener("mousemove",t.onMouseMove),q.addEventListener("mouseup",t.onMouseUp),q.addEventListener("mouseleave",t.onMouseUp),q.addEventListener("touchmove",t.onMouseMove),q.addEventListener("touchend",t.onMouseUp),q.addEventListener("touchcancel",t.onMouseUp)}},this.onMouseMove=function(H){H.stopPropagation(),H.preventDefault();var ne=fo(H,"touches.0.pageX",H.pageX),Z=ne-t.prevX,q=t.adjustOffsetRange(Z/t.width);t.updateStartEnd(q),t.updateUI(),t.prevX=ne},this.onMouseUp=function(){t.currentHandler&&(t.currentHandler=void 0);var H=t.canvas.get("container");H&&(H.removeEventListener("mousemove",t.onMouseMove),H.removeEventListener("mouseup",t.onMouseUp),H.removeEventListener("mouseleave",t.onMouseUp),H.removeEventListener("touchmove",t.onMouseMove),H.removeEventListener("touchend",t.onMouseUp),H.removeEventListener("touchcancel",t.onMouseUp))};var r=n.x,i=r===void 0?0:r,o=n.y,a=o===void 0?0:o,s=n.width,u=s===void 0?100:s,c=n.height,l=n.padding,h=l===void 0?10:l,f=n.trendCfg,d=n.controllerCfg,p=d===void 0?{speed:1}:d,g=n.backgroundStyle,v=g===void 0?{}:g,m=n.foregroundStyle,y=m===void 0?{}:m,b=n.handlerStyle,x=b===void 0?{}:b,w=n.textStyle,E=w===void 0?{}:w,M=n.start,_=M===void 0?0:M,k=n.end,S=k===void 0?1:k,C=n.minText,T=C===void 0?"":C,A=n.maxText,D=A===void 0?"":A,j=n.group,L=n.graph,B=n.canvas,N=n.tick,R=N===void 0?{tickLabelStyle:{},tickLineStyle:{},tickLabelFormatter:function(H){return H},ticks:[]}:N,P=n.type;this.graph=L,this.canvas=B,this.group=j,this.timeBarType=P,this.x=i,this.y=a,this.width=u,this.height=c,this.padding=h,this.ticks=R.ticks,this.trendCfg=f,this.controllerCfg=p,this.currentSpeed=p.speed||1,this.tickLabelFormatter=R.tickLabelFormatter,P==="trend"?this.backgroundStyle=pn(pn({},CV),v):P==="simple"&&(this.backgroundStyle=pn(pn({},AV),v)),this.foregroundStyle=pn(pn({},IV),y),this.handlerStyle=pn(pn({},TV),x),this.textStyle=pn(pn({},OV),E),this.tickLabelStyle=pn(pn({},NV),R.tickLabelStyle),this.tickLineStyle=pn(pn({},DV),R.tickLineStyle),this.currentMode=p.defaultTimeType||Vl,this.start=_,this.end=S,this.minText=T,this.maxText=D,this.fontFamily=typeof window<"u"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif",this.renderSlider()}return e.prototype.update=function(n){var t=n.x,r=n.y,i=n.width,o=n.height,a=n.minText,s=n.maxText,u=n.start,c=n.end;this.start=Math.min(1,Math.max(u,0)),this.end=Math.min(1,Math.max(c,0)),St(this,{x:t,y:r,width:i,height:o,minText:a,maxText:s}),this.updateUI()},e.prototype.setText=function(n,t){this.minTextShape.attr("text",n),this.maxTextShape.attr("text",t)},e.prototype.renderSlider=function(){var n=this,t=this,r=t.width,i=t.height,o=t.timeBarType;if(o==="trend"&&Xh(fo(this.trendCfg,"data"))){var a=new MV(pn(pn({x:this.x,y:this.y,width:r,height:i},this.trendCfg),{group:this.group}));this.trendComponent=a}var s=this.group.addGroup({name:"slider-group"});s.addShape("rect",{attrs:pn({x:0,y:0,width:r,height:i},this.backgroundStyle),name:"background"});var u=this.group.addGroup();o==="trend"?(this.minTextShape=u.addShape("text",{attrs:pn({x:0,y:i/2+this.y,textAlign:"right",text:this.minText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"min-text-shape"}),this.maxTextShape=u.addShape("text",{attrs:pn({y:i/2+this.y,textAlign:"left",text:this.maxText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"max-text-shape"})):(this.minTextShape=u.addShape("text",{attrs:pn({x:0,y:this.y-10,textAlign:"center",text:this.minText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"min-text-shape"}),this.maxTextShape=u.addShape("text",{attrs:pn({y:this.y-10,textAlign:"center",text:this.maxText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"max-text-shape"})),this.foregroundShape=this.group.addGroup().addShape("rect",{attrs:pn({x:0,y:this.y,height:i},this.foregroundStyle),name:"foreground-shape"}),this.foregroundShape.on("mousedown",function(m){m.target.attr("cursor","grabbing")}),this.foregroundShape.on("mouseup",function(m){m.target.attr("cursor",n.foregroundStyle.cursor||"grab")});var c=fo(this.handlerStyle,"width",2),l=fo(this.handlerStyle,"height",24),h=this.group.addGroup({name:"minHandlerShape"});this.minHandlerShape=new c5({name:"minHandlerShape",group:h,type:o,x:this.x,y:this.y,width:c,height:l,style:this.handlerStyle});var f=this.group.addGroup({name:"maxHandlerShape"});this.maxHandlerShape=new c5({name:"maxHandlerShape",group:f,type:o,x:this.x,y:this.y,width:c,height:l,style:this.handlerStyle});var d=this.ticks,p=r/(d.length-1);this.tickPosList=[],this.textList&&this.textList.length&&this.textList.forEach(function(m){m.destroy()});var g=-1/0,v=this.tickLabelStyle.rotate;delete this.tickLabelStyle.rotate,this.textList=d.map(function(m,y){var b;n.tickPosList.push(n.x+y*p),n.tickLabelFormatter?(b=n.tickLabelFormatter(m),!Re(b)&&b&&(b=m.date)):b=m.date;var x=n.x+y*p,w=n.y+i+5,E=n.group.addShape("text",{attrs:pn({x,y:w,text:b,fontFamily:n.fontFamily||"Arial, sans-serif"},n.tickLabelStyle),name:"tick-label"});if(xt(v)&&y!==d.length-1){var M=kV([1,0,0,0,1,0,0,0,1],[["t",-x,-w],["r",v],["t",x-5,w+2]]);E.attr({textAlign:"left",matrix:M})}y===0?E.attr({textAlign:"left"}):y!==d.length-1&&E.attr({textAlign:"right"});var _=n.group.addShape("line",{attrs:pn({x1:n.x+y*p,y1:n.y+i+2,x2:n.x+y*p,y2:n.y+i+6},n.tickLineStyle),name:"tick-line"});_.toBack();var k=E.getBBox();return k.minX>g?(E.show(),_.show(),g=k.minX+k.width+10):(E.hide(),_.hide()),E}),this.controllerBtnGroup=new TO(pn({group:this.group,x:this.x,y:this.y+i+25,width:r,height:35},this.controllerCfg)),this.updateStartEnd(0),this.updateUI(),s.move(this.x,this.y),this.bindEvents(),this.currentMode===Wl&&(this.minHandlerShape.hide(),this.foregroundShape.hide(),this.minTextShape.hide())},e.prototype.bindEvents=function(){var n=this,t=this.group.find(function(i){return i.get("name")==="minHandlerShape"});t&&(t.on("minHandlerShape-handler:mousedown",this.onMouseDown(this.minHandlerShape)),t.on("minHandlerShape-handler:touchstart",this.onMouseDown(this.minHandlerShape)));var r=this.group.find(function(i){return i.get("name")==="maxHandlerShape"});r&&(r.on("maxHandlerShape-handler:mousedown",this.onMouseDown(this.maxHandlerShape)),r.on("maxHandlerShape-handler:touchstart",this.onMouseDown(this.maxHandlerShape))),this.foregroundShape.on("mousedown",this.onMouseDown(this.foregroundShape)),this.foregroundShape.on("touchstart",this.onMouseDown(this.foregroundShape)),this.group.on("".concat(Ma,":click"),function(){n.isPlay=!n.isPlay,n.currentHandler=n.maxHandlerShape,n.changePlayStatus()}),this.group.on("".concat(Ul,":click"),function(){n.currentHandler=n.maxHandlerShape,n.updateStartEnd(.01),n.updateUI()}),this.group.on("".concat(Xl,":click"),function(){n.currentHandler=n.maxHandlerShape,n.updateStartEnd(-.01),n.updateUI()}),this.group.on(Es,function(i){var o=i.type,a=i.speed;n.currentSpeed=a,n.currentMode=o,o===Wl?(n.minHandlerShape.hide(),n.foregroundShape.hide(),n.minTextShape.hide()):o===Vl&&(n.minHandlerShape.show(),n.foregroundShape.show(),n.minTextShape.show())})},e.prototype.adjustTickIndex=function(n){for(var t=0;t<this.tickPosList.length-1;t++)if(this.tickPosList[t]<=n&&n<=this.tickPosList[t+1])return Math.abs(this.tickPosList[t]-n)<Math.abs(n-this.tickPosList[t+1])?t:t+1;return 0},e.prototype.adjustOffsetRange=function(n){switch(this.currentHandler){case this.minHandlerShape:var t=0-this.start,r=1-this.start;return Math.min(r,Math.max(t,n));case this.maxHandlerShape:return t=0-this.end,r=1-this.end,Math.min(r,Math.max(t,n));case this.foregroundShape:return t=0-this.start,r=1-this.end,Math.min(r,Math.max(t,n));default:return 0}},e.prototype.updateStartEnd=function(n){var t=this.ticks[this.adjustTickIndex(this.start*this.width)],r=this.ticks[this.adjustTickIndex(this.end*this.width)];if(!this.currentHandler)return this.minText=this.tickLabelFormatter?this.tickLabelFormatter(t):t==null?void 0:t.date,void(this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(r):r==null?void 0:r.date);switch(this.currentHandler){case this.minHandlerShape:this.maxText=this.maxTextShape.attr("text"),this.start+=n,this.minText=this.tickLabelFormatter?this.tickLabelFormatter(t):t.date;break;case this.maxHandlerShape:this.minText=this.minTextShape.attr("text"),this.end+=n,this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(r):r.date;break;case this.foregroundShape:this.start+=n,this.end+=n,this.minText=this.tickLabelFormatter?this.tickLabelFormatter(t):t.date,this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(r):r.date}},e.prototype.updateUI=function(){var n=this;this.start<0&&(this.start=0),this.start>1&&(this.start=1),this.end>1&&(this.end=1),this.end<0&&(this.end=0);var t=this.x+this.start*this.width,r=this.x+this.end*this.width;this.foregroundShape.attr("x",t),this.foregroundShape.attr("width",r-t);var i=fo(this.handlerStyle,"width",2);this.setText(this.minText,this.maxText);var o=this.dodgeText([t,r]),a=o[0],s=o[1];this.minHandlerShape.setX(t-i/2),ye(a,function(u,c){return n.minTextShape.attr(c,u)}),this.maxHandlerShape.setX(r-i/2),ye(s,function(u,c){return n.maxTextShape.attr(c,u)}),this.currentMode===Vl?this.graph.emit(so,{value:[this.start,this.end].sort()}):this.currentMode===Wl&&this.graph.emit(so,{value:[this.end,this.end]})},e.prototype.dodgeText=function(n){var t,r,i=fo(this.handlerStyle,"width",2),o=this.minTextShape,a=this.maxTextShape,s=n[0],u=n[1],c=!1;s>u&&(s=(t=[u,s])[0],u=t[1],o=(r=[a,o])[0],a=r[1],c=!0);var l=o.getBBox(),h=a.getBBox(),f=null,d=null;return this.timeBarType==="trend"?(f=s-l.width<this.x+2?{x:s+i/2+2,textAlign:"left"}:{x:s-i/2-2,textAlign:"right"},d=u+h.width>this.x+this.width?{x:u-i/2-2,textAlign:"right"}:{x:u+i/2+2,textAlign:"left"}):this.timeBarType==="simple"&&(f=o.attr("x")>l.width?{x:s,textAlign:"center"}:{x:s,textAlign:"left"},d=a.attr("x")>this.width-h.width?{x:u,textAlign:"right"}:{x:u,textAlign:"center"}),c?[d,f]:[f,d]},e.prototype.startPlay=function(){var n=this;return typeof window<"u"?window.requestAnimationFrame(function(){var t=n,r=t.ticks,i=t.width,o=n.currentSpeed,a=i/r.length/(1e3*(10-o)/60),s=n.adjustOffsetRange(a/n.width);n.updateStartEnd(s),n.updateUI(),n.isPlay&&(n.playHandler=n.startPlay())}):void 0},e.prototype.changePlayStatus=function(n){n===void 0&&(n=!0),this.controllerBtnGroup.playButton.update({isPlay:this.isPlay}),this.isPlay?(this.playHandler=this.startPlay(),this.graph.emit(kO,null)):this.playHandler&&(typeof window<"u"&&window.cancelAnimationFrame(this.playHandler),n&&this.graph.emit(CO,null))},e.prototype.destory=function(){this.graph.off(so,function(){});var n=this.group,t=n.find(function(i){return i.get("name")==="minHandlerShape"});t&&(t.off("minHandlerShape-handler:mousedown"),t.off("minHandlerShape-handler:touchstart"),t.destroy());var r=n.find(function(i){return i.get("name")==="maxHandlerShape"});r&&(r.off("maxHandlerShape-handler:mousedown"),r.off("maxHandlerShape-handler:touchstart"),r.destroy()),this.foregroundShape.off("mousedown"),this.foregroundShape.off("touchstart"),this.foregroundShape.destroy(),n.off("".concat(Ma,":click")),n.off("".concat(Ul,":click")),n.off("".concat(Xl,":click")),n.off(Es),n.destroy(),this.trendComponent&&this.trendComponent.destory()},e}(),LV=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Bo=function(){return Bo=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},Bo.apply(this,arguments)},RV=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function"){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(t[r[i]]=e[r[i]])}return t},jV=function(e){function n(t){var r=e.call(this,t)||this;return r.afterrenderListener=function(i){return r.filterData({})},r.valueChangeListener=dc(function(i){return r.filterData(i)},200,{trailing:!0,leading:!0}),r.changeData=function(i){var o=r.get("graph");r.cacheGraphData=o.get("data"),r.filterData({})},r}return LV(n,e),n.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-component-timebar",padding:10,type:"trend",trend:{data:[],isArea:!1,smooth:!0},controllerCfg:{speed:1,loop:!1},slider:{start:.1,end:.9,minText:"min",maxText:"max"},tick:{start:.1,end:.9,data:[]},textStyle:{},filterEdge:!1,filterItemTypes:["node"],containerCSS:{},putInGraphContainer:!0}},n.prototype.initContainer=function(){var t,r,i=this.get("graph"),o=this._cfgs,a=o.width,s=o.height,u=o.putInGraphContainer,c=this.get("className")||"g6-component-timebar",l=this.get("container");l?(Re(l)&&(l=document.getElementById(l)),t=l):qt(t=gn("<div class='".concat(c,"'></div>")),{position:"relative"}),u&&this.get("graph").get("container").appendChild(t),this.set("timeBarContainer",t),r=i.get("renderer")==="SVG"?new Hc({container:t,width:a,height:s}):new bo({container:t,width:a,height:s}),this.get("containerCSS")&&qt(t,this.get("containerCSS")),this.set("canvas",r)},n.prototype.init=function(){this.initContainer();var t=this.get("canvas").addGroup({name:"timebar-group"});this.set("timeBarGroup",t),this.renderTrend(),this.initEvent();var r=typeof window<"u"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif";this.set("fontFamily",r)},n.prototype.play=function(){this.togglePlay(!0)},n.prototype.pause=function(){this.togglePlay(!1)},n.prototype.togglePlay=function(t){var r=this.get("timebar");r&&(r.isPlay=!!t,r.changePlayStatus())},n.prototype.renderTrend=function(){var t=this,r=this._cfgs,i=r.width,o=r.x,a=r.y,s=r.padding,u=r.type,c=r.trend,l=r.slider,h=r.controllerCfg,f=r.textStyle,d=r.tick,p=r.backgroundStyle,g=r.foregroundStyle,v=c.data,m=RV(c,["data"]),y=i-2*s,b=u==="trend"?26:4,x=this.get("graph"),w=this.get("timeBarGroup"),E=this.get("canvas"),M=null;if(u==="trend"||u==="simple"){var _=this.get("getValue");M=new PV(Bo(Bo({graph:x,canvas:E,group:w,type:u,x:o+s,y:u==="trend"?a+s:a+s+15,width:y,height:b,padding:s,backgroundStyle:p,foregroundStyle:g,trendCfg:Bo(Bo({},m),{data:v.map(function(S){return(_==null?void 0:_(S))||S.value})})},l),{tick:{ticks:v,tickLabelFormatter:d.tickLabelFormatter,tickLabelStyle:d.tickLabelStyle,tickLineStyle:d.tickLineStyle},handlerStyle:Bo(Bo({},l.handlerStyle),{height:l.height||b}),controllerCfg:h,textStyle:f}))}else u==="tick"&&(M=new VW(Bo({graph:x,canvas:E,group:w,x:o+s,y:a+s,width:i,height:42,padding:2,controllerCfg:h},d)));var k=function S(){var C=t.get("timebar");C.draggingHandler=!1,C.isPlay&&(C.isPlay=!1,C.currentHandler=C.maxHandlerShape,C.changePlayStatus()),document.removeEventListener("mouseup",S)};E.on("mousedown",function(S){S.target.get("name")!=="maxHandlerShape-handler"&&S.target.get("name")!=="minHandlerShape-handler"&&S.target!==M.foregroundShape||document.addEventListener("mouseup",k)}),this.set("timebar",M)},n.prototype.filterData=function(t){var r,i=t.value;if(!i){i=[];var o=this._cfgs.type;o&&o!=="trend"&&o!=="simple"?o==="tick"&&(i[0]=this._cfgs.tick.start,i[1]=this._cfgs.tick.end):(i[0]=this._cfgs.slider.start,i[1]=this._cfgs.slider.end)}var a=null,s=this._cfgs.type;if(s==="trend"||s==="simple"?a=this._cfgs.trend.data:s==="tick"&&(a=this._cfgs.tick.data),a&&a.length!==0){var u=this.get("rangeChange"),c=this.get("graph"),l=Math.round(a.length*i[0]),h=Math.round(a.length*i[1]);h=h>=a.length?a.length-1:h,l=l>=a.length?a.length-1:l;var f=(r=this._cfgs.tick)===null||r===void 0?void 0:r.tickLabelFormatter,d=f?f(a[l]):a[l].date,p=f?f(a[h]):a[h].date;if(s!=="tick"&&this.get("timebar").setText(d,p),u)u(c,d,p);else{(!this.cacheGraphData||this.cacheGraphData.nodes&&this.cacheGraphData.nodes.length===0)&&(this.cacheGraphData=c.get("data"));var g=this.get("filterItemTypes"),v=this.get("changeData"),m=this.get("getDate"),y=this.get("shouldIgnore"),b=a[l].date,x=a[h].date;if(v||v===void 0){var w=this.cacheGraphData.nodes,E=this.cacheGraphData.edges,M={},_={};c.getNodes().forEach(function(k){return M[k.getID()]=!0}),c.getEdges().forEach(function(k){return _[k.getID()]=!0}),g.includes("node")&&(w==null||w.forEach(function(k){var S=+((m==null?void 0:m(k))||k.date),C=S>=b&&S<=x||(y==null?void 0:y("node",k,{min:b,max:x})),T=M[k.id];T&&!C?(c.removeItem(k.id),M[k.id]=!1):!T&&C&&(c.addItem("node",k),M[k.id]=!0)}),E==null||E.forEach(function(k){var S=M[k.source]&&M[k.target]||(y==null?void 0:y("edge",k,{min:b,max:x})),C=!!c.findById(k.id);C&&!S?(c.removeItem(k.id),_[k.id]=!1):!C&&S?(c.addItem("edge",k),_[k.id]=!0):C||(_[k.id]=!1)})),(this.get("filterEdge")||g.includes("edge"))&&(E==null||E.filter(function(k){var S=+((m==null?void 0:m(k))||k.date),C=S>=b&&S<=x||(y==null?void 0:y("edge",k,{min:b,max:x})),T=M[k.source]&&M[k.target],A=C&&T,D=_[k.id];D&&!A?(_[k.id]=!1,c.removeItem(k.id)):!D&&A&&(_[k.id]=!0,c.addItem("edge",k))}))}else g.includes("node")&&c.getNodes().forEach(function(k){var S=k.getModel();if(!(y!=null&&y("node",S,{min:b,max:x}))){var C=+((m==null?void 0:m(S))||S.date);C<b||C>x?c.hideItem(k):c.showItem(k)}}),(this.get("filterEdge")||g.includes("edge"))&&c.getEdges().forEach(function(k){var S=k.getModel();if(!(y!=null&&y("edge",S,{min:a[l].date,max:a[h].date}))){var C=+((m==null?void 0:m(S))||S.date);if(C<a[l].date||C>a[h].date)c.hideItem(k);else{var T=k.getSource().isVisible(),A=k.getTarget().isVisible();T&&A&&c.showItem(k)}}})}}},n.prototype.initEvent=function(){var t=this.get("graph");t.on("afterchangedata",this.changeData),t.on("afterrender",this.afterrenderListener),t.on(so,this.valueChangeListener)},n.prototype.destroy=function(){var t=this.get("graph");t.off("afterchangedata",this.changeData),t.off("afterrender",this.afterrenderListener),t.off(so,this.valueChangeListener);var r=this.get("timebar");r&&r.destory&&r.destory(),e.prototype.destroy.call(this);var i=this.get("timeBarContainer");if(i){var o=this.get("container");o||(o=this.get("graph").get("container")),Re(o)&&(o=document.getElementById(o)),o===i&&(o=o.parentElement),o.removeChild(i)}},n}(qr),BV=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),zV=gr.applyMatrix,FV=function(e){function n(t){return e.call(this,t)||this}return BV(n,e),n.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-minimap",viewportClassName:"g6-minimap-viewport",width:200,delegateStyle:{fill:"#40a9ff",stroke:"#096dd9"},refresh:!0}},n.prototype.getEvents=function(){return{beforepaint:"updateViewport",beforeanimate:"disableRefresh",afteranimate:"enableRefresh",viewportchange:"disableOneRefresh"}},n.prototype.disableRefresh=function(){this.set("refresh",!1)},n.prototype.enableRefresh=function(){this.set("refresh",!0),this.updateCanvas()},n.prototype.disableOneRefresh=function(){this.set("viewportChange",!0)},n.prototype.initViewport=function(){var t=this,r=this._cfgs,i=r.graph;if(!this.destroyed){var o=this.get("container");Re(o)&&(o=document.getElementById(o));var a=gn("<div class=".concat(r.viewportClassName,`
      style='position:absolute;
        left:0;
        top:0;
        box-sizing:border-box;
        border: 2px solid #1980ff;
        cursor:move'
      </div>`)),s=0,u=0,c=!1,l=0,h=0,f=0,d=0,p=0,g=0;o.addEventListener("mousedown",function(v){if(r.refresh=!1,v.target===a){var m=a.style;f=parseInt(m.width,10),d=parseInt(m.height,10);var y=t.get("width"),b=t.get("height");f>y||d>b||(g=i.getZoom(),p=t.get("ratio"),c=!0,s=v.clientX,u=v.clientY)}},!1),o.addEventListener("mousemove",function(v){if(c&&!yt(v.clientX)&&!yt(v.clientY)){var m=t.get("width"),y=t.get("height"),b=a.style;l=parseInt(b.left,10),h=parseInt(b.top,10),f=parseInt(b.width,10),d=parseInt(b.height,10);var x=s-v.clientX,w=u-v.clientY;l-x<0?x=l:l-x+f>=m&&(x=0),h-w<0?w=h:h-w+d>=y&&(w=0),h-=w,qt(a,{left:"".concat(l-=x,"px"),top:"".concat(h,"px")}),i.translate(x*g/p,w*g/p),s=v.clientX,u=v.clientY}},!1),o.addEventListener("mouseleave",function(){c=!1,r.refresh=!0},!1),o.addEventListener("mouseup",function(){c=!1,r.refresh=!0},!1),this.set("viewport",a),o.appendChild(a)}},n.prototype.updateViewport=function(){if(!this.destroyed){var t=this.get("ratio"),r=this.get("width"),i=this.get("height"),o=this.get("graph"),a=o.get("width"),s=a/o.get("height"),u=o.getGroup(),c=u.getCanvasBBox(),l=[(c.minX+c.maxX)/2,(c.minY+c.maxY)/2],h=[c.maxX-c.minX,c.maxY-c.minY],f={width:0,height:0,minX:0,minY:0};c[0]/c[1]>s?(f.width=h[0],f.height=f.width/s):(f.height=h[1],f.width=f.height*s),f.minX=l[0]-f.width/2,f.minY=l[1]-f.height/2;var d=u.getMatrix();d||(d=[1,0,0,0,1,0,0,0,1]);var p=r0([1,0,0,0,1,0,0,0,1],d),g=zV({x:f.minX,y:f.minY},p),v=o.getCanvasByPoint(g.x,g.y),m=this.get("viewport");m||this.initViewport();var y=a/f.width,b=y*r,x=y*i,w=r*-v.x/f.width,E=i*-v.y/f.height,M=w+b,_=E+x;w<0&&(b+=w,w=0),M>r&&(b-=M-r),E<0&&(x+=E,E=0),_>i&&(x-=_-i),this.set("ratio",t),qt(m,{left:"".concat(w,"px"),top:"".concat(E,"px"),width:"".concat(b,"px"),height:"".concat(x,"px")})}},n.prototype.init=function(){this.initContainer()},n.prototype.initContainer=function(){var t=this,r=t.get("graph"),i=r.get("width"),o=r.get("height")/i,a=t.get("className"),s=t.get("container"),u=t.get("width"),c=t.get("height");u||c||(u=200),u?(c=o*u,t.set("height",c)):(u=1/o*c,t.set("width",u));var l=gn("<div class='".concat(a,"' style='width: ").concat(u,"px; height: ").concat(c,"px; overflow: hidden; position: relative;'></div>"));Re(s)&&(s=document.getElementById(s)),s?s.appendChild(l):r.get("container").appendChild(l),t.set("container",l);var h=gn('<div class="g6-minimap-container" style="position: relative; width: 100%; height: 100%; text-align: center; display: table;"></div>');l.appendChild(h);var f=gn('<span style="display: table-cell; vertical-align: middle; "></span>');h.appendChild(f),t.set("containerDOM",h),t.set("containerSpan",f);var d=gn('<img alt="" src="'.concat(this.get("graphImg"),'" style="display: inline-block; user-select: none;" draggable="false" />'));t.set("imgDOM",d),t.updateImgSize(),f.appendChild(d),t.updateCanvas()},n.prototype.updateImgSize=function(){var t=this,r=t.get("imgDOM"),i=t.get("width"),o=t.get("height");r.onload=function(){var a=function(s){var u,c;if(s.naturalWidth)u=s.naturalWidth,c=s.naturalHeight;else{var l=new Image;l.src=s.src,l.onload=function(){}}return[u,c]}(r);a[0]>a[1]?r.width=i:r.height=o}},n.prototype.updateCanvas=function(){if(this.get("refresh")){var t=this.get("graph");if(!t.get("destroyed")){this.get("viewportChange")&&(this.set("viewportChange",!1),this.updateViewport());var r=this.get("width")/t.get("canvas").getCanvasBBox().width;this.set("ratio",r),this.updateViewport()}}},n.prototype.getViewport=function(){return this.get("viewport")},n.prototype.getContainer=function(){return this.get("container")},n.prototype.updateGraphImg=function(t){var r=this;r.get("imgDOM").remove(),r.set("graphImg",t);var i=gn('<img alt="" src="'.concat(t,'" style="display: inline-block;" ondragstart="return false;" onselectstart="return false;"/>'));r.set("imgDOM",i),i.src=t,r.updateImgSize(),r.get("containerSpan").appendChild(i),r.updateCanvas()},n.prototype.destroy=function(){var t=this.get("container");t.parentNode.removeChild(t)},n}(qr),GV=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),K1=function(){return K1=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},K1.apply(this,arguments)},UV=gr.distance,l5={stroke:"#000",strokeOpacity:.8,lineWidth:2,fillOpacity:1,fill:"#fff"},XV=function(e){function n(t){return e.call(this,t)||this}return GV(n,e),n.prototype.getDefaultCfgs=function(){return{type:"both",trigger:"mousemove",r:60,delegateStyle:Kt(l5),showLabel:"edge",scaleRBy:"wheel"}},n.prototype.getEvents=function(){var t;switch(this.get("trigger")){case"click":t={click:"filter"};break;case"drag":t={click:"createDelegate"};break;default:t={mousemove:"filter"}}return t},n.prototype.init=function(){var t=this,r=t.get("showLabel"),i=r==="node"||r==="both",o=r==="edge"||r==="both";t.set("showNodeLabel",i),t.set("showEdgeLabel",o),t.get("shouldShow")||t.set("shouldShow",function(){return!0})},n.prototype.createDelegate=function(t){var r=this,i=r.get("delegate");i&&!i.destroyed||(r.filter(t),(i=r.get("delegate")).on("dragstart",function(o){}),i.on("drag",function(o){r.filter(o)}),this.get("scaleRBy")==="wheel"&&i.on("mousewheel",function(o){r.scaleRByWheel(o)}))},n.prototype.scaleRByWheel=function(t){var r=this;if(t&&t.originalEvent){t.preventDefault&&t.preventDefault();var i,o=r.get("graph"),a=r.get("delegate");a&&{x:a.attr("x"),y:a.attr("y")}||o.getPointByClient(t.clientX,t.clientY),i=t.originalEvent.wheelDelta<0?.95:1/.95;var s=r.get("maxR"),u=r.get("minR"),c=r.get("r");(c>(s||o.get("height"))&&i>1||c<(u||.05*o.get("height"))&&i<1)&&(i=1),c*=i,r.set("r",c),r.filter(t)}},n.prototype.filter=function(t){var r=this,i=r.get("graph"),o=i.getNodes(),a={},s=r.get("r"),u=r.get("type"),c={x:t.x,y:t.y};r.updateDelegate(c,s);var l=r.get("shouldShow"),h=r.get("vShapes");h&&h.forEach(function(m){m.remove(),m.destroy()}),h=[],o.forEach(function(m){var y=m.getModel(),b=y.x,x=y.y;UV({x:b,y:x},c)<s&&(a[y.id]=m)});var f=i.getEdges(),d=[];f.forEach(function(m){var y=m.getModel(),b=y.source,x=y.target;l(y)&&(u==="only-source"||u==="one"?a[b]&&!a[x]&&d.push(m):u==="only-target"||u==="one"?a[x]&&!a[b]&&d.push(m):u==="both"&&a[b]&&a[x]&&d.push(m))});var p=r.get("showNodeLabel"),g=r.get("showEdgelabel"),v=i.get("group");d.forEach(function(m){m.get("group").get("children").forEach(function(y){var b=y.get("type"),x=v.addShape(b,{attrs:y.attr()});h.push(x),p&&b==="text"&&x.set("visible",!0)})}),Object.keys(a).forEach(function(m){var y=a[m].get("group").clone();if(v.add(y),h.push(y),g)for(var b=y.get("children"),x=0;x<b.length;x++){var w=b[x];w.get("type")==="text"&&w.set("visible",!0)}}),r.set("vShapes",h)},n.prototype.updateParams=function(t){var r=this,i=t.r,o=t.trigger,a=t.minR,s=t.maxR,u=t.scaleRBy,c=t.showLabel,l=t.shouldShow;if(isNaN(t.r)||r.set("r",i),isNaN(s)||r.set("maxR",s),isNaN(a)||r.set("minR",a),o!=="mousemove"&&o!=="click"||r.set("trigger",o),u==="wheel"||u==="unset"){r.set("scaleRBy",u),r.get("delegate").remove(),r.get("delegate").destroy();var h=r.get("dPercentText");h&&(h.remove(),h.destroy())}c!=="node"&&c!=="both"||r.set("showNodeLabel",!0),c!=="edge"&&c!=="both"||r.set("showEdgeLabel",!0),l&&r.set("shouldShow",l)},n.prototype.updateDelegate=function(t,r){var i=this,o=i.get("graph"),a=i.get("delegate");if(!a||a.destroyed){var s=o.get("group"),u=i.get("delegateStyle")||l5;a=s.addShape("circle",{attrs:K1({r,x:t.x,y:t.y},u),name:"lens-shape",draggable:!0}),this.get("trigger")!=="drag"&&this.get("scaleRBy")==="wheel"&&a.on("mousewheel",function(c){i.scaleRByWheel(c)})}else a.attr({x:t.x,y:t.y,r});i.set("delegate",a)},n.prototype.clear=function(){var t=this,r=t.get("vShapes");r&&r.forEach(function(o){o.remove(),o.destroy()}),r=[],t.set("vShapes",r);var i=t.get("delegate");i&&!i.destroyed&&(i.remove(),i.destroy())},n.prototype.destroy=function(){this.clear()},n}(qr),YV=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),WV=gr.pointLineDistance,VV={stroke:"#FA8C16",lineWidth:1},HV=function(e){function n(t){return e.call(this,t)||this}return YV(n,e),n.prototype.getDefaultCfgs=function(){return{line:VV,itemAlignType:"center",tolerance:5,horizontalLines:{},verticalLines:{},alignLines:[]}},n.prototype.init=function(){},n.prototype.getEvents=function(){return{"node:dragstart":"onDragStart","node:drag":"onDrag","node:dragend":"onDragEnd"}},n.prototype.onDragStart=function(){this.initBoxLine()},n.prototype.onDrag=function(t){var r=t.item,i=(r.get("delegateShape")||r).getBBox(),o=r.getModel(),a=o.x-i.x,s=o.y-i.y;this.show({x:i.minX+a,y:i.minY+s},{width:i.width,height:i.height})},n.prototype.onDragEnd=function(){this.destory()},n.prototype.initBoxLine=function(){var t=this._cfgs,r=t.horizontalLines,i=t.verticalLines,o=t.itemAlignType;this.get("graph").getNodes().forEach(function(a){var s=a.getBBox(),u=a.get("id");o===!0||o==="horizontal"?(r["".concat(u,"tltr")]=[s.minX,s.minY,s.maxX,s.minY,a],r["".concat(u,"lcrc")]=[s.minX,s.centerY,s.maxX,s.centerY,a],r["".concat(u,"blbr")]=[s.minX,s.maxY,s.maxX,s.maxY,a]):o==="center"&&(r["".concat(u,"lcrc")]=[s.minX,s.centerY,s.maxX,s.centerY,a]),o===!0||o==="vertical"?(i["".concat(u,"tlbl")]=[s.minX,s.minY,s.minX,s.maxY,a],i["".concat(u,"tcbc")]=[s.centerX,s.minY,s.centerX,s.maxY,a],i["".concat(u,"trbr")]=[s.maxX,s.minY,s.maxX,s.maxY,a]):o==="center"&&(i["".concat(u,"tcbc")]=[s.centerX,s.minY,s.centerX,s.maxY,a])})},n.prototype.show=function(t,r){var i=St({},t);return this.itemAlign(t,r,i),t},n.prototype.itemAlign=function(t,r,i){var o=this,a=this._cfgs,s=a.horizontalLines,u=a.verticalLines,c=a.tolerance,l={x:i.x+r.width/2,y:i.y},h={x:i.x+r.width/2,y:i.y+r.height/2},f={x:i.x+r.width/2,y:i.y+r.height},d={x:i.x,y:i.y+r.height/2},p={x:i.x+r.width,y:i.y+r.height/2},g=[],v=[],m=null;if(this.clearAlignLine(),ye(s,function(b){b[4].isVisible&&(g.push(o.getLineDisObject(b,l)),g.push(o.getLineDisObject(b,h)),g.push(o.getLineDisObject(b,f)))}),ye(u,function(b){b[4].isVisible&&(v.push(o.getLineDisObject(b,d)),v.push(o.getLineDisObject(b,h)),v.push(o.getLineDisObject(b,p)))}),g.sort(function(b,x){return b.dis-x.dis}),v.sort(function(b,x){return b.dis-x.dis}),g.length!==0&&g[0].dis<c){t.y=g[0].line[1]-g[0].point.y+i.y,m={type:"item",horizontals:[g[0]]};for(var y=1;y<3;y++)g[0].dis===g[y].dis&&m.horizontals.push(g[y])}if(v.length!==0&&v[0].dis<c)for(t.x=v[0].line[0]-v[0].point.x+i.x,m?m.verticals=[v[0]]:m={type:"item",verticals:[v[0]]},y=1;y<3;y++)v[0].dis===v[y].dis&&m.verticals.push(v[y]);m&&(m.bbox=r,this.addAlignLine(m))},n.prototype.addAlignLine=function(t){var r=t.bbox,i=t.type,o=t.horizontals,a=t.verticals,s=this._cfgs,u=s.line,c=s.alignLines,l=this.get("graph").get("group");i==="item"&&(o&&ye(o,function(h){var f,d,p=h.line,g=h.point,v=(p[0]+p[2])/2;g.x<v?(f=g.x-r.width/2,d=Math.max(p[0],p[2])):(f=g.x+r.width/2,d=Math.min(p[0],p[2]));var m=St({x1:f,y1:p[1],x2:d,y2:p[1]},u),y=l.addShape("line",{attrs:m,capture:!1});c.push(y)}),a&&ye(a,function(h){var f,d,p=h.line,g=h.point,v=(p[1]+p[3])/2;g.y<v?(f=g.y-r.height/2,d=Math.max(p[1],p[3])):(f=g.y+r.height/2,d=Math.min(p[1],p[3]));var m=St({x1:p[0],y1:f,x2:p[0],y2:d},u),y=l.addShape("line",{attrs:m,capture:!1});c.push(y)}))},n.prototype.getLineDisObject=function(t,r){return{line:t,point:r,dis:WV(t,r)}},n.prototype.getContainer=function(){return this.get("container")},n.prototype.clearAlignLine=function(){var t=this._cfgs.alignLines;ye(t,function(r){r.remove()}),t.length=0},n.prototype.destory=function(){var t=this._cfgs,r=t.horizontalLines,i=t.verticalLines;this.get("graph").getNodes().forEach(function(o){var a=o.get("id");delete r["".concat(a,"tltr")],delete r["".concat(a,"lcrc")],delete r["".concat(a,"blbr")],delete i["".concat(a,"tlbl")],delete i["".concat(a,"tcbc")],delete i["".concat(a,"trbr")]}),this.clearAlignLine()},n}(qr),qV=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),En=function(){return En=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},En.apply(this,arguments)},ZV=["click","mouseenter"],KV=function(e){function n(t){return e.call(this,t)||this}return qV(n,e),n.prototype.getDefaultCfgs=function(){return{data:{},position:"top",padding:8,margin:8,offsetX:0,offsetY:0,layout:"horizontal",flipPage:!1,containerStyle:{},align:void 0,horiSep:8,vertiSep:8,filter:{enable:!1,trigger:"click"}}},n.prototype.init=function(){this.formatArray("padding"),this.formatArray("margin");var t=this.get("filter")||{};t.multiple&&t.trigger==="mouseenter"&&this.set("multiple",!1);var r=this.get("align");if(!r){var i=this.get("position").split("-");i.includes("left")&&(r="left"),r=i.includes("right")?"right":"center",this.set("align",r)}var o=this.get("graph").get("container"),a=gn(`<div class='g6-legend-container' style="position: absolute;"></div>`);o.appendChild(a),this.set("container",a);var s=this.render();qt(a,this.getContainerPos(s)),this.bindEvents()},n.prototype.getContainerPos=function(t){t===void 0&&(t=[0,0]);var r=this.get("graph"),i=this.get("offsetX"),o=this.get("offsetY"),a=this.get("margin"),s=this.get("position").split("-"),u={top:0,right:1,bottom:2,left:3},c={left:(r.getWidth()-t[0])/2+0,top:(r.getHeight()-t[1])/2+0};return s.forEach(function(l){var h=a[u[l]],f=l;switch(l){case"top":case"left":h+=0;break;case"bottom":h=r.getHeight()-t[1]-h+0,f="top";break;default:h=r.getWidth()-t[0]-h+0,f="left"}c[f]=h}),c.top+=o+r.getContainer().offsetTop,c.left+=i+r.getContainer().offsetLeft,Object.keys(c).forEach(function(l){c[l]="".concat(c[l],"px")}),c},n.prototype.bindEvents=function(){var t=this,r=t.get("filter");if(r&&r.enable){var i=r.trigger||"click";ZV.includes(i)||(i="click");var o=t.get("legendCanvas");i==="mouseenter"?(o.on("node-container:mouseenter",function(a){return t.filterData(a)}),o.on("node-container:mouseleave",function(a){t.clearFilter(),t.clearActiveLegend()})):(o.on("node-container:click",function(a){return t.filterData(a)}),o.on("click",function(a){a.target&&a.target.isCanvas&&a.target.isCanvas()&&(t.clearFilter(),t.clearActiveLegend())}))}},n.prototype.changeData=function(t){this.set("data",t);var r=this.render();qt(this.get("container"),this.getContainerPos(r))},n.prototype.activateLegend=function(t){var r=this.get("filter");r!=null&&r.multiple||this.clearActiveLegend();var i=t.get("parent");i.get("active")?(i.set("active",!1),this.findLegendItemsByState("active").length&&i.set("inactive",!0)):(i.set("inactive",!1),i.set("active",!0)),this.findLegendItemsByState("active").length?this.findLegendItemsByState("active","all",!1).forEach(function(l){l.set("inactive",!0)}):this.clearActiveLegend();var o=(r==null?void 0:r.legendStateStyles)||{},a=(o==null?void 0:o.inactive)||{opacity:.5,"text-shape":{opacity:.5}},s=a["text-shape"]||{};this.findLegendItemsByState("inactive").forEach(function(l){var h=l.get("children"),f=h[0],d=h[1];f.attr(En(En({},f.get("oriAttrs")),a)),d.attr(En(En({},d.get("oriAttrs")),s))});var u=(o==null?void 0:o.active)||{stroke:"#000",lineWidth:2,"text-shape":{fontWeight:"bold"}},c=u["text-shape"]||{};this.findLegendItemsByState("active").forEach(function(l){var h=l.get("children"),f=h[0],d=h[1];f.attr(En(En({},f.get("oriAttrs")),u)),d.attr(En(En({},d.get("oriAttrs")),c))})},n.prototype.findLegendItemsByState=function(t,r,i){r===void 0&&(r="all"),i===void 0&&(i=!0);var o=this.get("legendCanvas").find(function(u){return u.get("name")==="root"}),a=o.find(function(u){return u.get("name")==="node-group"}),s=o.find(function(u){return u.get("name")==="edge-group"});return r==="node"?a.get("children").filter(function(u){return!!u.get(t)===i}):r==="edge"?s.get("children").filter(function(u){return!!u.get(t)===i}):a.get("children").filter(function(u){return!!u.get(t)===i}).concat(s.get("children").filter(function(u){return!!u.get(t)===i}))},n.prototype.clearActiveLegend=function(){var t=this.get("legendCanvas").find(function(i){return i.get("name")==="root"}),r=[t.find(function(i){return i.get("name")==="node-group"}),t.find(function(i){return i.get("name")==="edge-group"})];r.forEach(function(i){i.get("children").forEach(function(o){o.set("active",!1),o.set("inactive",!1);var a=o.get("children"),s=a[0],u=a[1];s.attr(s.get("oriAttrs")),u.attr(u.get("oriAttrs"))})})},n.prototype.filterData=function(t){var r=this.get("filter"),i=r==null?void 0:r.filterFunctions;if(r&&i){var o=this.get("legendCanvas"),a=this.get("graph"),s=r.graphActiveState||"active",u=r.graphInactiveState||"inactive",c=r.multiple;this.clearFilter(),c||this.clearActiveLegend(),this.activateLegend(t.target);var l=o.find(function(m){return m.get("name")==="root"}),h=l.find(function(m){return m.get("name")==="node-group"}),f=l.find(function(m){return m.get("name")==="edge-group"}),d=h.get("children").filter(function(m){return m.get("active")}),p=f.get("children").filter(function(m){return m.get("active")}),g=0,v=["getNodes","getEdges"];v.forEach(function(m){a[m]().forEach(function(y){var b=!1;(m==="getNodes"?d:p).forEach(function(x){var w=i[x.get("id")];b=b||w(y.getModel())}),b?(a.setItemState(y,u,!1),a.setItemState(y,s,!0),g++):(a.setItemState(y,s,!1),a.setItemState(y,u,!0))})}),g||v.forEach(function(m){a[m]().forEach(function(y){a.clearItemStates(y,[u])})})}},n.prototype.clearFilter=function(){var t=this.get("graph"),r=this.get("filter");if(r){var i=r.graphActiveState||"active",o=r.graphInactiveState||"inactive";t.getNodes().forEach(function(a){t.clearItemStates(a,[i,o])}),t.getEdges().forEach(function(a){t.clearItemStates(a,[i,o])})}},n.prototype.render=function(){var t=this;this.processData();var r=this.get("legendCanvas");r?r.clear():r=new bo({container:this.get("container"),width:200,height:200});var i=r.addGroup({name:"root"}),o=i.addGroup({name:"node-group"}),a=i.addGroup({name:"edge-group"});this.set("legendCanvas",r);var s=this.get("itemsData"),u=[o,a];["nodes","edges"].forEach(function(D,j){s[D].forEach(function(L){var B,N,R=u[j].addGroup({id:L.id,name:"node-container"}),P=L.type,H=t.getShapeSize(L),ne=H.width,Z=H.height,q=H.r,te=t.getStyle(D.substr(0,4),L);switch(L.type){case"circle":default:N={r:q,x:0,y:0};break;case"rect":N={width:ne,height:Z,x:-ne/2,y:-Z/2};break;case"ellipse":N={rx:ne,ry:Z,x:0,y:0},P="ellipse";break;case"line":N={x1:-ne/2,y1:0,x2:ne/2,y2:0},P="line";break;case"quadratic":N={path:[["M",-ne/2,0],["Q",0,ne/2,ne/2,0]]},P="path";break;case"cubic":N={path:[["M",-ne/2,0],["C",-ne/6,ne/2,ne/6,-ne/2,ne/2,0]]},P="path";break;case"diamond":N={path:[["M",0,-Z],["L",ne,0],["L",0,Z],["L",-ne,0],["Z"]]},P="path";break;case"triangle":N={path:[["M",-ne,Z],["L",0,-Z],["L",ne,Z],["Z"]]},P="path";break;case"star":N={path:gr.getStarPath(3*q,1.2*q)},P="path"}var we=R.addShape(P,{attrs:En(En({},N),te),name:"".concat(L.type,"-node-keyShape"),oriAttrs:En({opacity:1},te)});if(L.label){var pe=we.getBBox(),Me=((B=L.labelCfg)===null||B===void 0?void 0:B.style)||{},Be=En({textAlign:"begin",fontSize:12,textBaseline:"middle",fill:"#000",opacity:1,fontWeight:"normal"},Me);R.addShape("text",{attrs:En({x:pe.maxX+4,y:0,text:L.label},Be),className:"legend-label",name:"".concat(L.type,"-node-text"),oriAttrs:Be})}})});var c,l=this.get("padding"),h=i.find(function(D){return D.get("name")==="title-container"}),f={maxY:0};if(this.get("title")){h||(h=i.addGroup({name:"title-container"}));var d={fontSize:20,fontFamily:"Arial",fontWeight:300,textBaseline:"top",textAlign:"center",fill:"#000",x:0,y:l[0]},p=this.get("titleConfig")||{},g=Object.assign(d,p.style||{});c=h.addShape("text",{attrs:En({text:this.get("title")},g)}),f=h.getCanvasBBox(),h.setMatrix([1,0,0,0,1,0,p.offsetX,p.offsetY,1])}this.layoutItems();var v=i.getCanvasBBox(),m=o.getCanvasBBox(),y=m.minX<0?Math.abs(m.minX)+l[3]:l[3],b=f.maxY<m.minY?Math.abs(f.maxY-m.minY)+l[0]:f.maxY+l[0],x=[1,0,0,0,1,0,y,b,1];o.setMatrix(x);var w=[(v=i.getCanvasBBox()).minX+v.width+l[1],v.minY+v.height+l[2]];if(c){p=En({position:"center",offsetX:0,offsetY:0},this.get("titleConfig")),f=h.getCanvasBBox();var E=h.getMatrix()||[1,0,0,0,1,0,0,0,1];p.position==="center"?E[6]=w[0]/2+p.offsetX:p.position==="right"?(E[6]=w[0]-l[3]+p.offsetX,c.attr({textAlign:"right"})):(E[6]=l[3]+p.offsetX,c.attr({textAlign:"left"})),h.setMatrix(E),f=h.getCanvasBBox(),x=[1,0,0,0,1,0,y=m.minX<0?Math.abs(m.minX)+l[3]:l[3],b=m.minY<f.maxY?Math.abs(f.maxY-m.minY)+l[0]:f.maxY+l[0],1],o.setMatrix(x);var M=[1,0,0,0,1,0,y,b,1];this.get("layout")==="vertical"?M[6]+=m.maxX+this.get("horiSep"):M[7]+=m.maxY+this.get("vertiSep"),a.setMatrix(M)}else{m=o.getCanvasBBox();var _=[1,0,0,0,1,0,0,0,1];this.get("layout")==="vertical"?_[6]+=x[6]+m.maxX+this.get("horiSep"):_[7]+=x[7]+m.maxY+this.get("vertiSep"),a.setMatrix(_)}v=i.getCanvasBBox(),m=o.getCanvasBBox(),x=o.getMatrix()||[1,0,0,0,1,0,0,0,1];var k=a.getMatrix()||[1,0,0,0,1,0,0,0,1],S=a.getCanvasBBox();w=[Math.max(m.width+x[6],S.width+k[6])+l[1],Math.max(m.height+x[7],S.height+k[7])+l[2]],r.changeSize(w[0],w[1]);var C=this.get("containerStyle"),T=i.getMatrix()||[1,0,0,0,1,0,0,0,1],A=gr.invertMatrix({x:0,y:0},T);return i.addShape("rect",{attrs:En({x:A.x+(C.lineWidth||1),y:A.y+(C.lineWidth||1),width:w[0]-2*(C.lineWidth||1),height:w[1]-2*(C.lineWidth||1),fill:"#f00",stroke:"#000",lineWidth:1,opacity:.5},C),name:"legend-back-rect",capture:!1}).toBack(),w},n.prototype.layoutItems=function(){var t=this.get("legendCanvas"),r=this.get("horiSep"),i=this.get("vertiSep"),o=this.get("layout"),a=this.get("align"),s=[0,0],u=t.find(function(y){return y.get("name")==="root"}),c=u.find(function(y){return y.get("name")==="node-group"}),l=u.find(function(y){return y.get("name")==="edge-group"}),h={min:0,max:-1/0};c.get("children").forEach(function(y,b){b===0&&(h.min=s[0]);var x=y.get("children")[0],w=y.getCanvasBBox(),E=x.getBBox(),M=E.width,_=(E.height,0),k=0;o==="vertical"?(_=s[1],k=s[0]+M/2,s[0]=k+w.height+i,w.maxX):(_=s[0]+M/2,k=s[1],s[0]=_+w.width+r,w.maxY),s[0]>h.max&&(h.max=s[0]),y.setMatrix([1,0,0,0,1,0,_,k,1])});var f=h.max-h.min,d={min:0,max:-1/0},p=c.getCanvasBBox();s[0]=0,s[1]=o==="vertical"?p.maxX+r:p.maxY+i,l.get("children").forEach(function(y,b){b===0&&(d.min=s[0]);var x=y.get("children")[0],w=y.getCanvasBBox(),E=x.getBBox(),M=E.width,_=E.height,k=0,S=0;o==="vertical"?(k=s[1],S=s[0],s[0]=S+w.height+i,y.setMatrix([1,0,0,0,1,0,0,S+_/2,1])):(k=s[0],S=s[1],s[0]=k+w.width+r,y.setMatrix([1,0,0,0,1,0,k+M/2,0,1])),s[0]>d.max&&(d.max=s[0])});var g=d.max-d.min;if(a&&a!==""&&a!=="left"){var v=f-g,m=a==="center"?Math.abs(v)/2:Math.abs(v);(v<0?c:l).get("children").forEach(function(y){var b=y.getMatrix()||[1,0,0,0,1,0,0,0,1];o==="vertical"?b[7]+=m:b[6]+=m,y.setMatrix(b)})}},n.prototype.processData=function(){var t=this.get("data"),r={nodes:[],edges:[]};t.nodes&&(t.nodes.sort(function(i,o){return i.order-o.order}),t.nodes.forEach(function(i){var o,a,s,u,c,l=i.size||[((o=i.style)===null||o===void 0?void 0:o.width)||((a=i.style)===null||a===void 0?void 0:a.r)||8,((s=i.style)===null||s===void 0?void 0:s.height)||((u=i.style)===null||u===void 0?void 0:u.r)||8],h=((c=i.labelCfg)===null||c===void 0?void 0:c.style)||{};r.nodes.push({id:i.id||Ui(),type:i.type||"circle",style:En({},i.style),order:i.order,label:i.label,itemType:"node",size:l,labelCfg:{position:"right",style:En({fontFamily:"Arial"},h)}})})),t.edges&&(t.edges.sort(function(i,o){return i.order-o.order}),t.edges.forEach(function(i){var o,a,s=i.type||"line";i.type==="cubic-horizontal"&&(s="cubic");var u=((o=i.labelCfg)===null||o===void 0?void 0:o.style)||{},c=i.size||[((a=i.style)===null||a===void 0?void 0:a.width)||8,1];r.edges.push({id:i.id||Ui(),type:s,size:c,style:En({lineWidth:Mt(c)?c[1]:1},i.style),order:i.order,label:i.label,itemType:"edge",labelCfg:{position:"right",style:En({fontFamily:"Arial"},u)}})})),this.set("itemsData",r)},n.prototype.getContainer=function(){return this.get("container")},n.prototype.formatArray=function(t){var r=this.get(t);if(xt(r))this.set(t,[r,r,r,r]);else if(Mt(r))switch(r.length){case 0:this.set(t,[0,0,0,0]);break;case 1:this.set(t,[r[0],r[0],r[0],r[0]]);break;case 2:this.set(t,[r[0],r[1],r[0],r[1]]);break;case 3:this.set(t,[r[0],r[1],r[2],r[1]])}return this.get(t)},n.prototype.getShapeSize=function(t){var r,i,o;return t.size&&(Mt(t.size)?(r=t.size[0],i=t.size[1]||t.size[0],o=t.size[0]/2):xt(t.size)&&(r=t.size,i=t.size,o=t.size/2)),t.style&&(t.style.width&&(r=t.style.width),t.style.height&&(i=t.style.height),t.style.r&&(o=t.style.r)),o||(o=5),r||(r=o),i||(i=o),{width:r,height:i,r:o}},n.prototype.getStyle=function(t,r){return En(En({},t==="node"?{fill:"#ccc",lineWidth:0}:{stroke:"#000",lineWidth:1}),r.style||{})},n.prototype.destroy=function(){var t=this.get("legendCanvas");t==null||t.destroy();var r=this.get("graph").get("container"),i=this.get("container");r.removeChild(i)},n}(qr),$V=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),li=function(){return li=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},li.apply(this,arguments)},h5=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function"){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(t[r[i]]=e[r[i]])}return t};typeof document<"u"&&Rp(`
  .g6-annotation-container {
    background-color: rgba(255, 255, 255, 0.3);
    padding: 8px;
  }
  .g6-annotation-wrapper {
    background-color: #fff;
    box-shadow: 0 0 8px rgba(0, 0, 0, 0.85);
  }
  .g6-annotation-header-wapper {
    height: fit-content;
    width: 100%;
    background-color: #5B8FF9;
    display: inline-flex;
    cursor: move;
  }
  .g6-annotation-title {
    margin: 4px 40px 4px 8px;
    cursor: text;
    min-width: 32px;
  }
  .g6-annotation-collapse {
    margin: 4px;
    cursor: pointer;
  }
  .g6-annotation-expand {
    margin: 4px;
    cursor: pointer;
  }
  .g6-annotation-close {
    margin: 4px 8px 4px 0;
    cursor: pointer;
  }
  .g6-annotation-content {
    padding: 8px;
    width: fit-content;
    cursor: text;
    word-break: break-all;
    min-width: 32px;
  }
  .g6-annotation-title-input-wrapper {
    margin: 4px 40px 4px 8px;
  }
  .g6-annotation-content-input {
    height: 100%;
    word-break: break-all;
  }
  .g6-annotation-content-input-wrapper {
    margin: 8px;
    height: 100%;
  }
`);var f5="canvas-annotation",QV=function(e){function n(t){return e.call(this,t)||this}return $V(n,e),n.prototype.getDefaultCfgs=function(){return{trigger:"click",editable:!0,itemHighlightState:"highlight",linkHighlightStyle:{shadowColor:"#5B8FF9",shadowBlur:10},cardCfg:{minHeight:60,width:"fit-content",height:"fit-content",collapseType:"minimize",closeType:"hide",borderRadius:5,maxTitleLength:20}}},n.prototype.getEvents=function(){var t={viewportchange:"updateLinks",afterlayout:"updateLinks",aftergraphrefreshposition:"updateLinks",afterupdateitem:"updateLink",afterchangedata:"onGraphDataChange",afteritemvisibilitychange:"onGraphItemVisibilityChange"};return this.get("trigger")==="click"&&(t=li(li({},t),{"node:click":"showAnnotation","edge:click":"showAnnotation"})),t},n.prototype.getDOMContent=function(t){if(!this.destroyed){var r=t.collapsed,i=t.maxWidth,o=t.title,a=o===void 0?"":o,s=t.content,u=s===void 0?"":s,c=t.borderRadius,l=c===void 0?5:c,h=r?"<p class='g6-annotation-expand'>+</p>":"<p class='g6-annotation-collapse'>-</p>",f=r?"":" <p class='g6-annotation-content'>".concat(u,"</p>"),d=r?"".concat(l,"px"):"".concat(l,"px ").concat(l,"px 0 0");return'<div class="g6-annotation-wrapper" style="border-radius: '.concat(l,"px; max-width: ").concat(i,`px">
        <div
          class="g6-annotation-header-wapper"
          style="border-radius: `).concat(d,`;"
        >
          <h4 class='g6-annotation-title'>`).concat(a,`</h4>
          `).concat(h,`
          `).concat("<p class='g6-annotation-close'>x</p>",`
        </div>
        `).concat(f,`
      </div>`)}},n.prototype.init=function(){var t=this;if(!t.destroyed){var r=t.get("graph").getContainer(),i=t.get("container");this.get("containerCfg")?(i=this.createContainer(),r.appendChild(i)):i=r,this.set("container",i);var o=r.getBoundingClientRect(),a=new bo({container:r,width:o.right-o.left,height:o.bottom-o.top});qt(a.get("el"),{position:"absolute",top:0,left:0,pointerEvents:"none"}),window.addEventListener("resize",fc(function(){return t.resizeCanvas(t)},100));var s=a.addGroup({id:"annotation-link-group"});t.set("linkGroup",s),t.set("canvas",a),t.get("getTitle")||t.set("getTitle",function(c){var l,h=((l=c==null?void 0:c.getModel)===null||l===void 0?void 0:l.call(c))||{},f=h.label,d=h.id;return f||d||"-"}),t.get("getContent")||t.set("getContent",function(c){var l,h;if(!c)return"-";var f=((l=c.getModel)===null||l===void 0?void 0:l.call(c))||{},d=f.label,p=f.id,g=(h=c.getType)===null||h===void 0?void 0:h.call(c),v=g?"".concat(g,": "):"";return"".concat(v).concat(d||p||"")});var u=t.get("defaultData");u&&this.readData(u)}},n.prototype.createContainer=function(){var t=this;if(!this.destroyed){var r=this.get("containerCfg"),i=this.get("graph"),o=i.getContainer(),a=o.getBoundingClientRect(),s=a.left,u=a.right,c=a.top,l=a.bottom-c,h=u-s,f=r.position,d=f===void 0?"top":f,p=r.offsetX,g=p===void 0?0:p,v=r.offsetY,m=v===void 0?0:v,y=h5(r,["position","offsetX","offsetY"]),b=r.height,x=b===void 0?"fit-content":b,w=r.width,E=w===void 0?i.getWidth():w;x==="100%"&&(x=l),E==="100%"&&(E=h);var M="unset",_="unset",k={};switch(d){case"right":M="".concat(l,"px"),(k={top:0,right:0}).right+=s+g,k.top+=c+m;break;case"bottom":_="".concat(h,"px"),(k={bottom:0,left:0}).left+=s+g,k.bottom+=c+m;break;case"top":_="".concat(h,"px");case"left":M="".concat(l,"px");default:(k={top:0,left:0}).left+=s+g,k.top+=c+m}Object.keys(k).forEach(function(C){k[C]="".concat(k[C],"px")});var S=gn("<div class='".concat(r.className," g6-annotation-container'></div>"));return qt(S,li(li({position:"absolute",display:d==="top"||d==="bottom"?"inline-flex":"unset",width:xt(E)?"".concat(E,"px"):E,height:xt(x)?"".concat(x,"px"):x,maxHeight:M,maxWidth:_,overflow:"scroll"},k),y)),o.appendChild(S),S.addEventListener("scroll",function(C){t.updateLinks()}),S}},n.prototype.resizeCanvas=function(t){clearTimeout(t.resizeTimer),t.resizeTimer=setTimeout(function(){if(t&&!t.destroyed){var r=t.get("container").getBoundingClientRect(),i=r.right-r.left,o=r.bottom-r.top;t.get("canvas").changeSize(i,o),t.updateOutsideCards(t)}},250)},n.prototype.updateOutsideCards=function(t){var r=t||this,i=r.get("cardInfoMap")||{},o=r.get("graph"),a=o.getPointByCanvas(0,0),s=o.getPointByCanvas(o.getWidth(),o.getHeight()),u=o.getClientByPoint(a.x,a.y),c=u.x,l=u.y,h=o.getClientByPoint(s.x,s.y),f=h.x,d=h.y;Object.values(i).forEach(function(p){var g=p.card;if(g){var v=g.style,m=_s(v.left),y=_s(v.top),b=g.getBoundingClientRect(),x=b.width,w=b.height,E=m,M=y;m+x>f-c&&(E=f-c-x),m<0&&(E=0),y+w>d-l&&(M=d-l-w),y<0&&(M=0),qt(g,{left:"".concat(E,"px"),top:"".concat(M,"px")})}}),r.updateLinks()},n.prototype.showAnnotation=function(t){if(!this.destroyed){var r=t.item;this.toggleAnnotation(r)}},n.prototype.hideCards=function(){var t=this;if(!t.destroyed){var r=t.get("cardInfoMap")||{};Object.keys(r).forEach(function(i){t.hideCard(i)})}},n.prototype.toggleAnnotation=function(t,r){var i,o;r===void 0&&(r={});var a=this;if(!a.destroyed){var s=a.get("cardInfoMap")||{},u=a.get("graph"),c=a.get("container"),l=a.get("containerCfg"),h=Object.assign({},a.get("cardCfg")||{},r),f=h.minHeight,d=h.minWidth,p=h.width,g=h.height,v=h.collapsed,m=v!==void 0&&v,y=h.x,b=h.y,x=h.title,w=h.content,E=h.maxTitleLength,M=h.defaultBegin,_=h5(h,["minHeight","minWidth","width","height","collapsed","x","y","title","content","maxTitleLength","defaultBegin"]),k=a.get("linkGroup"),S=this.get("rows")||[[]],C=(i=t.isCanvas)===null||i===void 0?void 0:i.call(t),T=C?f5:t.getID(),A=s[T]||{},D=A.card,j=A.link,L=A.x,B=A.y,N=A.title,R=A.content,P=this.get("getTitle"),H=this.get("getContent"),ne=this.get("getContentPlaceholder")||function(){return""},Z=this.get("getTitlePlaceHolder")||function(){return""},q=ne(t),te=Z(t),we=gn(this.getDOMContent(li({itemId:T,collapsed:m,title:((o=N||x||(P==null?void 0:P(t)))===null||o===void 0?void 0:o.substr(0,E))||te,content:R||w||(H==null?void 0:H(t))||q},_))),pe=xt(f)?"".concat(f,"px"):f;qt(we,{minHeight:m?"unset":pe,minWidth:xt(d)?"".concat(d,"px"):d,height:g,width:p});var Me,Be=!!D;if(Be?(j==null||j.remove(!0),c.replaceChild(we,D)):c.appendChild(we),!l){if(Me=c.getBoundingClientRect()||{},y!==void 0&&b!==void 0)L=y,B=b;else if(!Be&&!C){var dt=Me.top,It=M||{},at=It.left,Ue=It.right,Te=Ue===void 0?16:Ue,Xe=It.top,Oe=Xe===void 0?8:Xe,Se=It.bottom,We=Te,Ve=Oe;isNaN(at)||(We=c.scrollWidth-at),isNaN(Se)||(Ve=c.scrollHeight-Se);var O=xt(d)?d:100;L=c.scrollWidth-we.scrollWidth-(S.length-1)*O-We;var he=S[S.length-1],_e=(he[he.length-1]||{}).bbox;B=(_e==null?void 0:_e.bottom)-dt||Ve}qt(we,{position:"absolute",left:"".concat(L,"px"),top:"".concat(B,"px"),cusor:l?"unset":"move"})}this.bindListener(we,T);var Ze=we.getBoundingClientRect();if(!C){var Je=$1(t,Ze,u,this.get("canvas")),qe=this.get("linkStyle");j=k.addShape("path",{attrs:li({lineWidth:1,lineDash:[5,5],stroke:"#ccc",path:Je},qe)})}if(s[T]=li(li({},s[T]||{}),{id:T,collapsed:m,card:we,link:j,x:L,y:B,cardBBox:Ze,content:R||w,title:N||x,contentPlaceholder:q,titlePlaceholder:te,isCanvas:C}),a.set("cardInfoMap",s),l)this.updateCardPositionsInConatainer(),this.updateLinks();else{var vt=!isNaN(y)&&!isNaN(b);if(!Be&&!C&&!vt){var pt=Me.bottom,Et=pt===void 0?0:pt;dt=Me.top,S[S.length-1].push({id:T,bbox:Ze}),Ze.top>Et-dt-Ze.height-16&&S.push([]),this.set("rows",S)}}this.updateCardSize(T);var Tt=this.get("onAnnotationChange");Tt==null||Tt(s[T],Be?"update":"create")}},n.prototype.updateCardPositionsInConatainer=function(){if(!this.destroyed){var t=this.get("cardInfoMap");if(t){var r=this.get("container"),i=this.get("containerCfg").position,o=r.getBoundingClientRect().width,a=getComputedStyle(r),s=_s(a.paddingLeft)+_s(a.paddingRight);o-=s,Object.values(t).forEach(function(u){var c=u.card,l=c.getBoundingClientRect().width;switch(i){case"right":qt(c,{marginLeft:o?"".concat(o-l,"px"):"0px"});break;case"top":case"bottom":qt(c,{marginLeft:"8px"})}})}}},n.prototype.handleExpandCollapseCard=function(t){if(!this.destroyed){var r=this.get("graph"),i=this.get("cardInfoMap");if(i){var o=i[t].collapsed,a=r.findById(t);a&&(this.get("cardCfg").collapseType!=="hide"||o?this.toggleAnnotation(a,{collapsed:!o}):this.hideCard(t),i[t]=li(li({},i[t]),{collapsed:!o}))}}},n.prototype.hideCard=function(t){if(!this.destroyed){var r=this.get("cardInfoMap");if(r&&r[t]){var i=r[t],o=i.card,a=i.link;qt(o,{display:"none"}),a==null||a.hide(),this.get("onAnnotationChange")(r[t],"hide")}}},n.prototype.removeCard=function(t){if(!this.destroyed){var r=this.get("cardInfoMap");if(r){var i=r[t],o=i.card,a=i.link;this.get("container").removeChild(o),a==null||a.remove(!0),delete r[t],this.get("onAnnotationChange")(i,"remove")}}},n.prototype.bindListener=function(t,r){var i=this;if(!this.destroyed){t.addEventListener("mousemove",function(a){var s;if(a.target.className==="g6-annotation-collapse"?s="collapse":a.target.className==="g6-annotation-expand"?s="expand":a.target.className==="g6-annotation-close"&&(s="close"),s){var u=i.get("cardCfg").onMouseEnterIcon;(u===void 0?function(){}:u)(a,r,s)}}),t.addEventListener("mouseout",function(a){var s;if(a.target.className==="g6-annotation-collapse"?s="collapse":a.target.className==="g6-annotation-expand"?s="expand":a.target.className==="g6-annotation-close"&&(s="close"),s){var u=i.get("cardCfg").onMouseLeaveIcon;(u===void 0?function(){}:u)(a,r,s)}}),t.addEventListener("mouseenter",function(a){var s=i.get("cardInfoMap");if(s){var u=i.get("graph"),c=u.findById(r);if(c){var l=i.get("itemHighlightState");u.setItemState(c,l,!0)}var h=s[r].link;if(h){var f=i.get("linkHighlightStyle")||{};h.attr(f)}}}),t.addEventListener("mouseleave",function(a){var s=i.get("cardInfoMap");if(s){var u=i.get("graph"),c=u.findById(r);if(c){var l=i.get("itemHighlightState");u.setItemState(c,l,!1)}var h=s[r].link;if(h){var f=i.get("linkHighlightStyle")||{};Object.keys(f).forEach(function(p){h.attr(p,void 0),h.attr(p,void 0)});var d=i.get("linkStyle");h.attr(d)}}}),t.addEventListener("click",function(a){var s=(i.get("cardCfg")||{}).onClickIcon;a.target.className==="g6-annotation-collapse"||a.target.className==="g6-annotation-expand"?(i.get("cardCfg").collapseType==="hide"?i.hideCard(r):i.handleExpandCollapseCard(r),s==null||s(a,r,a.target.className==="g6-annotation-collapse"?"collapse":"expand")):a.target.className==="g6-annotation-close"&&(i.get("cardCfg").closeType==="remove"?i.removeCard(r):i.hideCard(r),s==null||s(a,r,"close"))}),this.get("editable")&&t.addEventListener("dblclick",function(a){var s=i.get("cardInfoMap"),u=(i.get("cardCfg")||{}).maxTitleLength,c=u===void 0?20:u;if(s){var l=a.target,h=l.className;if(h==="g6-annotation-title"||h==="g6-annotation-content"){var f=h==="g6-annotation-title"?l.getBoundingClientRect():l.parentNode.getBoundingClientRect(),d=f.width,p=f.height,g=getComputedStyle(l),v=gn("<".concat(h==="g6-annotation-title"?"input":"textarea",' class="').concat(h,'-input" type="textarea" style="width:').concat(d,"px; height: ").concat(p,'px; min-width: 16px;"/>')),m=gn('<div class="'.concat(h,'-input-wrapper" style="width: ').concat(d,"px; height: ").concat(p,"px; min-width: 16px; margin-right: ").concat(g.marginRight,'" />'));m.appendChild(v),l.parentNode.replaceChild(m,l);var y=s[r],b=y.contentPlaceholder,x=y.titlePlaceholder,w=y.content,E=y.title,M=w;h==="g6-annotation-title"?(v.name="title",v.maxLength=c,M=E):v.name="content",M?(v.innerHTML=l.innerHTML,v.value=l.innerHTML):v.placeholder=h==="g6-annotation-title"?x:b,v.focus(),v.addEventListener("blur",function(_){v.value&&(l.innerHTML=v.value,y[v.name||"title"]=v.value),m.parentNode.replaceChild(l,m),i.updateCardSize(r);var k=i.get("onAnnotationChange");k==null||k(y,"update")})}}});var o=["g6-annotation-title","g6-annotation-content","g6-annotation-title-input","g6-annotation-content-input"];t.draggable=!0,t.addEventListener("dragstart",function(a){var s=a.target.className;if(!o.includes(s)){var u=t.style;i.set("dragging",{card:t,x:a.clientX,y:a.clientY,left:_s(u.left),top:_s(u.top)})}}),t.addEventListener("drag",function(a){a.preventDefault();var s=i.get("cardInfoMap");if(s){var u=a.clientX,c=a.clientY,l=i.get("dragging");if(!isNaN(u)&&!isNaN(c)&&l){var h=l.x,f=l.y,d=l.left,p=l.top,g=l.card,v=u-h,m=c-f;d+=v,p+=m;var y=i.get("graph"),b=y.getPointByCanvas(0,0),x=y.getPointByCanvas(y.getWidth(),y.getHeight()),w=y.getClientByPoint(b.x,b.y),E=w.x,M=w.y,_=y.getClientByPoint(x.x,x.y),k=_.x,S=_.y,C=g.getBoundingClientRect();(d>k-E-(C.right-C.left)&&v>0||d<0&&v<0)&&(d-=v),(p>S-M-(C.bottom-C.top)&&m>0||p<0&&m<0)&&(p-=m),qt(g,{left:"".concat(d,"px"),top:"".concat(p,"px"),visibility:"hidden"}),h=u,f=c;var T=(s[r]||{}).link;if(T){var A=y.findById(r);T.attr("path",$1(A,C,y,i.get("canvas")))}i.set("dragging",{x:h,y:f,left:d,top:p,card:g})}}}),t.addEventListener("dragend",function(a){var s=i.get("cardInfoMap");if(s){var u=i.get("dragging");if(u){var c=u.left,l=u.top,h=u.card;s[r].x=c,s[r].y=l,qt(h,{visibility:"visible"}),i.set("dragging",!1);var f=i.get("rows");f==null||f.forEach(function(p){for(var g=p.length-1;g>=0;g--)p[g].id===r&&p.splice(g,1)});var d=i.get("onAnnotationChange");d==null||d(s[r],"update")}}})}},n.prototype.updateCardSize=function(t){var r=this.get("cardInfoMap");if(r){var i=r[t].card,o=i.getBoundingClientRect().width,a=i.getElementsByClassName("g6-annotation-title")[0];if(a){var s=getComputedStyle(a),u=_s(s.marginLeft),c=a.getBoundingClientRect().width;qt(a,{marginRight:"".concat(o-u-24-16-c,"px")})}}},n.prototype.updateLink=function(t){var r=t.item;if(r){var i=this.get("cardInfoMap");if(i){var o=this.get("canvas"),a=this.get("graph"),s=i[r.getID()]||{},u=s.link,c=s.card;if(u){var l=$1(r,c.getBoundingClientRect(),a,o);u.attr("path",l)}}}},n.prototype.updateLinks=function(){var t=this;if(!this.destroyed){var r=this.get("cardInfoMap");if(r){var i=this.get("graph");Object.values(r).forEach(function(o){var a=o.id,s=i.findById(a);t.updateLink({item:s})})}}},n.prototype.onGraphDataChange=function(){var t=this,r=this.get("cardInfoMap");if(r){var i=this.get("graph");Object.values(r).forEach(function(o){var a=o.id,s=o.card,u=o.isCanvas;if(s&&!u&&s.style.display!=="none"){var c=i.findById(a);c&&c.isVisible()?t.toggleAnnotation(c):t.hideCard(a)}})}},n.prototype.onGraphItemVisibilityChange=function(t){var r=t.item,i=t.visible;if(r&&!r.destroyed){var o=this.get("cardInfoMap");if(o){var a=r.getID();o[a]&&(i||this.hideCard(a))}}},n.prototype.saveData=function(t){t===void 0&&(t=!1);var r=this.get("cardInfoMap");if(r){var i=this.get("graph"),o=this.get("getTitle"),a=this.get("getContent"),s=[];return Object.values(r).forEach(function(u){var c=u.title,l=u.content,h=u.x,f=u.y,d=u.id,p=u.collapsed,g=u.card;if(!g||g.style.display!=="none"||t){var v=i.findById(d)||i.get("canvas");s.push({id:d,x:h,y:f,collapsed:p,title:c||(o==null?void 0:o(v)),content:l||(a==null?void 0:a(v)),visible:g&&g.style.display!=="none"})}}),s}},n.prototype.readData=function(t){var r=this,i=this.get("graph");t.forEach(function(o){var a=o.id,s=o.x,u=o.y,c=o.title,l=o.content,h=o.collapsed,f=o.visible,d=i.findById(a);if(d||a!==f5||(d=i.get("canvas")),!d){var p=r.get("cardInfoMap")||{};return p[a]=o,void r.set("cardInfoMap",p)}r.toggleAnnotation(d,{x:s,y:u,title:c,content:l,collapsed:h}),f||r.hideCard(a)})},n.prototype.clear=function(){var t=this.get("cardInfoMap");if(t){var r=this.get("container");Object.values(t).forEach(function(i){var o=i.card,a=i.link;r.removeChild(o),a==null||a.remove(!0)}),this.set("cardInfoMap",{})}},n.prototype.destroy=function(){var t;this.clear(),(t=this.get("canvas"))===null||t===void 0||t.destroy();var r=this.get("graph");r&&!r.destroyed&&(this.get("containerCfg")&&r.getContainer().removeChild(this.get("container")),this.destroyed=!0)},n}(qr),$1=function(e,n,t,r){var i,o;if(e.getType()==="edge")o=[e.getKeyShape().getPoint(.5)];else{var a=(i=e.getKeyShape)===null||i===void 0?void 0:i.call(e).getBBox(),s=a.minX,u=a.minY,c=a.maxX,l=a.maxY,h=e.getModel(),f=h.x,d=h.y;o={left:{x:s+=f,y:((u+=d)+(l+=d))/2},right:{x:c+=f,y:(u+l)/2},top:{x:(s+c)/2,y:u},bottom:{x:(s+c)/2,y:l}}}Object.keys(o).forEach(function(M){var _=o[M],k=_.x,S=_.y,C=t.getClientByPoint(k,S);o[M]=r.getPointByClient(C.x,C.y)});var p=n.top,g=p===void 0?0:p,v=n.left,m=v===void 0?0:v,y=n.right,b=y===void 0?0:y,x=n.bottom,w=x===void 0?0:x,E={left:r.getPointByClient(m,(g+w)/2),right:r.getPointByClient(b,(g+w)/2),top:r.getPointByClient((m+b)/2,g),bottom:r.getPointByClient((m+b)/2,w)};return function(M,_){var k,S,C=1/0;Object.keys(M).forEach(function(A){var D=M[A];Object.keys(_).forEach(function(j){var L=_[j],B=D.x-L.x,N=D.y-L.y,R=B*B+N*N;C>R&&(C=R,k=D,S=L)})});var T=gr.getControlPoint(k,S,.5,20);return[["M",k.x,k.y],["Q",T.x,T.y,S.x,S.y]]}(o,E)},_s=function(e){return Number(e.replace(/\s+|px/gi,""))||0},Zr={Menu:_W,Grid:MW,Minimap:AW,Bundling:TW,ToolBar:PW,Tooltip:RW,Fisheye:NW,TimeBar:jV,ImageMinimap:FV,EdgeFilterLens:XV,SnapLine:HV,Legend:KV,Annotation:QV};mo("circle",{options:{size:it.defaultNode.size,style:{x:0,y:0,stroke:it.defaultNode.style.stroke,fill:it.defaultNode.style.fill,lineWidth:it.defaultNode.style.lineWidth},labelCfg:{style:{fill:it.nodeLabel.style.fill,fontSize:it.nodeLabel.style.fontSize,fontFamily:it.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:it.defaultNode.linkPoints.size,lineWidth:it.defaultNode.linkPoints.lineWidth,fill:it.defaultNode.linkPoints.fill,stroke:it.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:F({},it.nodeStateStyles)},shapeType:"circle",labelPosition:"center",drawShape:function(e,n){var t=(this.mergeStyle||this.getOptions(e)).icon,r=t===void 0?{}:t,i=this.getShapeStyle(e),o=fn({},r,e.icon),a="".concat(this.type,"-keyShape"),s=n.addShape("circle",{attrs:i,className:a,name:a,draggable:!0});n.shapeMap[a]=s;var u=o.width,c=o.height,l=o.show,h=o.text;if(l){var f="".concat(this.type,"-icon");n.shapeMap[f]=h?n.addShape("text",{attrs:F({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},o),className:f,name:f,draggable:!0}):n.addShape("image",{attrs:F({x:-u/2,y:-c/2},o),className:f,name:f,draggable:!0})}return this.drawLinkPoints(e,n),s},drawLinkPoints:function(e,n){var t=(this.mergeStyle||this.getOptions(e)).linkPoints;if(t){var r=t||{},i=r.top,o=r.left,a=r.right,s=r.bottom,u=r.size,c=r.r,l=Yn(r,["top","left","right","bottom","size","r"]),h=this.getSize(e)[0]/2;if(o){var f="link-point-left";n.shapeMap[f]=n.addShape("circle",{attrs:F(F({},l),{x:-h,y:0,r:u/2||c||5}),className:f,name:f,isAnchorPoint:!0})}if(a){var d="link-point-right";n.shapeMap[d]=n.addShape("circle",{attrs:F(F({},l),{x:h,y:0,r:u/2||c||5}),className:d,name:d,isAnchorPoint:!0})}if(i){var p="link-point-top";n.shapeMap[p]=n.addShape("circle",{attrs:F(F({},l),{x:0,y:-h,r:u/2||c||5}),className:p,name:p,isAnchorPoint:!0})}if(s){var g="link-point-bottom";n.shapeMap[g]=n.addShape("circle",{attrs:F(F({},l),{x:0,y:h,r:u/2||c||5}),className:g,name:g,isAnchorPoint:!0})}}},getShapeStyle:function(e){var n=(this.mergeStyle||this.getOptions(e)).style,t={stroke:e.color},r=fn({},n,t),i=this.getSize(e)[0]/2;return F({x:0,y:0,r:i},r)},update:function(e,n,t){var r=n.getContainer(),i=this.getSize(e),o=F({},e.style);e.style.stroke===void 0&&e.color&&(o.stroke=e.color),e.style.r!==void 0||isNaN(i[0])||(o.r=i[0]/2),this.updateShape(e,n,o,!0,t),this.updateLinkPoints(e,r)}},"single-node"),mo("rect",{options:{size:[100,30],style:{radius:0,stroke:it.defaultNode.style.stroke,fill:it.defaultNode.style.fill,lineWidth:it.defaultNode.style.lineWidth},labelCfg:{style:{fill:it.nodeLabel.style.fill,fontSize:it.nodeLabel.style.fontSize,fontFamily:it.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:it.defaultNode.linkPoints.size,lineWidth:it.defaultNode.linkPoints.lineWidth,fill:it.defaultNode.linkPoints.fill,stroke:it.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},anchorPoints:[[0,.5],[1,.5]],stateStyles:F({},it.nodeStateStyles)},shapeType:"rect",labelPosition:"center",drawShape:function(e,n){var t=this.getShapeStyle(e),r=n.addShape("rect",{attrs:t,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});return n.shapeMap["".concat(this.type,"-keyShape")]=r,this.drawLinkPoints(e,n),r},drawLinkPoints:function(e,n){var t=(this.mergeStyle||this.getOptions(e)).linkPoints,r=t===void 0?{}:t,i=r.top,o=r.left,a=r.right,s=r.bottom,u=r.size,c=r.r,l=Yn(r,["top","left","right","bottom","size","r"]),h=this.getSize(e),f=h[0],d=h[1];o&&(n.shapeMap["link-point-left"]=n.addShape("circle",{attrs:F(F({},l),{x:-f/2,y:0,r:u/2||c||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),a&&(n.shapeMap["link-point-right"]=n.addShape("circle",{attrs:F(F({},l),{x:f/2,y:0,r:u/2||c||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),i&&(n.shapeMap["link-point-top"]=n.addShape("circle",{attrs:F(F({},l),{x:0,y:-d/2,r:u/2||c||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),s&&(n.shapeMap["link-point-bottom"]=n.addShape("circle",{attrs:F(F({},l),{x:0,y:d/2,r:u/2||c||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getShapeStyle:function(e){var n=St({},(this.mergeStyle||this.getOptions(e)).style,{stroke:e.color}),t=this.getSize(e),r=n.width||t[0],i=n.height||t[1];return F({x:-r/2,y:-i/2,width:r,height:i},n)},update:function(e,n,t){var r=n.getContainer(),i=this.getOptions({}).style,o=this.getSize(e),a=n.get("keyShape");e.size||(o[0]=a.attr("width")||i.width,o[1]=a.attr("height")||i.height);var s={stroke:e.color,x:-o[0]/2,y:-o[1]/2,width:o[0],height:o[1]},u=St({},i,a.attr(),s);u=St(u,e.style),this.updateShape(e,n,u,!1,t),this.updateLinkPoints(e,r)}},"single-node"),mo("ellipse",{options:{size:[80,40],style:{x:0,y:0,stroke:it.defaultNode.style.stroke,fill:it.defaultNode.style.fill,lineWidth:it.defaultNode.style.lineWidth},labelCfg:{style:{fill:it.nodeLabel.style.fill,fontSize:it.nodeLabel.style.fontSize,fontFamily:it.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:it.defaultNode.linkPoints.size,lineWidth:it.defaultNode.linkPoints.lineWidth,fill:it.defaultNode.linkPoints.fill,stroke:it.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:F({},it.nodeStateStyles)},shapeType:"ellipse",labelPosition:"center",drawShape:function(e,n){var t=(this.mergeStyle||this.getOptions(e)).icon,r=t===void 0?{}:t,i=this.getShapeStyle(e),o=n.addShape("ellipse",{attrs:i,className:"ellipse-keyShape",name:"ellipse-keyShape",draggable:!0});n.shapeMap["ellipse-keyShape"]=o;var a=r.width,s=r.height,u=r.show,c=r.text;return u&&(n.shapeMap["".concat(this.type,"-icon")]=c?n.addShape("text",{attrs:F({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},r),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):n.addShape("image",{attrs:F({x:-a/2,y:-s/2},r),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(e,n),o},drawLinkPoints:function(e,n){var t=(this.mergeStyle||this.getOptions(e)).linkPoints,r=t===void 0?{}:t,i=r.top,o=r.left,a=r.right,s=r.bottom,u=r.size,c=r.r,l=Yn(r,["top","left","right","bottom","size","r"]),h=this.getSize(e),f=h[0]/2,d=h[1]/2;o&&(n.shapeMap["link-point-left"]=n.addShape("circle",{attrs:F(F({},l),{x:-f,y:0,r:u/2||c||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),a&&(n.shapeMap["link-point-right"]=n.addShape("circle",{attrs:F(F({},l),{x:f,y:0,r:u/2||c||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),i&&(n.shapeMap["link-point-top"]=n.addShape("circle",{attrs:F(F({},l),{x:0,y:-d,r:u/2||c||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),s&&(n.shapeMap["link-point-bottom"]=n.addShape("circle",{attrs:F(F({},l),{x:0,y:d,r:u/2||c||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getShapeStyle:function(e){var n=St({},(this.mergeStyle||this.getOptions(e)).style,{stroke:e.color}),t=this.getSize(e),r=t[0]/2,i=t[1]/2;return F({x:0,y:0,rx:r,ry:i},n)},update:function(e,n,t){var r=n.getContainer(),i=this.getOptions({}).style,o=this.getSize(e),a={stroke:e.color,rx:o[0]/2,ry:o[1]/2},s=St({},i,n.get("keyShape").attr(),a);s=St(s,e.style),this.updateShape(e,n,s,!0,t),this.updateLinkPoints(e,r)}},"single-node"),mo("diamond",{options:{size:[80,80],style:{stroke:it.defaultNode.style.stroke,fill:it.defaultNode.style.fill,lineWidth:it.defaultNode.style.lineWidth},labelCfg:{style:{fill:it.nodeLabel.style.fill,fontSize:it.nodeLabel.style.fontSize,fontFamily:it.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:it.defaultNode.linkPoints.size,lineWidth:it.defaultNode.linkPoints.lineWidth,fill:it.defaultNode.linkPoints.fill,stroke:it.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:F({},it.nodeStateStyles)},shapeType:"diamond",labelPosition:"center",drawShape:function(e,n){var t=(this.mergeStyle||this.getOptions(e)).icon,r=t===void 0?{}:t,i=this.getShapeStyle(e),o=n.addShape("path",{attrs:i,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});n.shapeMap["".concat(this.type,"-keyShape")]=o;var a=r.width,s=r.height,u=r.show,c=r.text;return u&&(n.shapeMap["".concat(this.type,"-icon")]=c?n.addShape("text",{attrs:F({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},r),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):n.addShape("image",{attrs:F({x:-a/2,y:-s/2},r),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(e,n),o},drawLinkPoints:function(e,n){var t=(this.mergeStyle||this.getOptions(e)).linkPoints,r=t===void 0?{}:t,i=r.top,o=r.left,a=r.right,s=r.bottom,u=r.size,c=r.r,l=Yn(r,["top","left","right","bottom","size","r"]),h=this.getSize(e),f=h[0],d=h[1];o&&(n.shapeMap["link-point-left"]=n.addShape("circle",{attrs:F(F({},l),{x:-f/2,y:0,r:u/2||c||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),a&&(n.shapeMap["link-point-right"]=n.addShape("circle",{attrs:F(F({},l),{x:f/2,y:0,r:u/2||c||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),i&&(n.shapeMap["link-point-top"]=n.addShape("circle",{attrs:F(F({},l),{x:0,y:-d/2,r:u/2||c||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),s&&(n.shapeMap["link-point-bottom"]=n.addShape("circle",{attrs:F(F({},l),{x:0,y:d/2,r:u/2||c||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getPath:function(e){var n=this.getSize(e),t=n[0],r=n[1];return[["M",0,-r/2],["L",t/2,0],["L",0,r/2],["L",-t/2,0],["Z"]]},getShapeStyle:function(e){var n=St({},(this.mergeStyle||this.getOptions(e)).style,{stroke:e.color}),t=this.getPath(e);return F({path:t},n)},update:function(e,n,t){var r=n.getContainer(),i=this.getOptions({}).style,o=this.getPath(e),a={stroke:e.color,path:o},s=St({},i,n.get("keyShape").attr(),a);s=St(s,e.style),this.updateShape(e,n,s,!0,t),this.updateLinkPoints(e,r)}},"single-node"),mo("triangle",{options:{size:40,direction:"up",style:{stroke:it.defaultNode.style.stroke,fill:it.defaultNode.style.fill,lineWidth:it.defaultNode.style.lineWidth},labelCfg:{style:{fill:it.nodeLabel.style.fill,fontSize:it.nodeLabel.style.fontSize},offset:15},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:it.defaultNode.linkPoints.size,lineWidth:it.defaultNode.linkPoints.lineWidth,fill:it.defaultNode.linkPoints.fill,stroke:it.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20,offset:6},stateStyles:F({},it.nodeStateStyles)},shapeType:"triangle",labelPosition:"bottom",drawShape:function(e,n){var t=this.mergeStyle||this.getOptions(e),r=t.icon,i=r===void 0?{}:r,o=t.direction,a=this.getShapeStyle(e),s=e.direction||o,u=n.addShape("path",{attrs:a,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});n.shapeMap["".concat(this.type,"-keyShape")]=u;var c=i.width,l=i.height,h=i.show,f=i.offset,d=i.text;if(h)if(d)n.shapeMap["".concat(this.type,"-icon")]=n.addShape("text",{attrs:F({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},i),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0});else{var p=-c/2,g=-l/2;s!=="up"&&s!=="down"||(g+=f),s!=="left"&&s!=="right"||(p+=f),n.shapeMap["".concat(this.type,"-icon")]=n.addShape("image",{attrs:F({x:p,y:g},i),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})}return this.drawLinkPoints(e,n),u},drawLinkPoints:function(e,n){var t=this.mergeStyle||this.getOptions(e),r=t.linkPoints,i=r===void 0?{}:r,o=t.direction,a=e.direction||o,s=i.top,u=i.left,c=i.right,l=i.bottom,h=i.size,f=i.r,d=Yn(i,["top","left","right","bottom","size","r"]),p=this.getSize(e)[0];if(u){var g=null,v=p*Math.sin(1/3*Math.PI),m=p*Math.sin(1/3*Math.PI);a==="up"?g=[-m,v]:a==="down"?g=[-m,-v]:a==="left"&&(g=[-m,m-v]),g&&(n.shapeMap["link-point-left"]=n.addShape("circle",{attrs:F(F({},d),{x:g[0],y:g[1],r:h/2||f||5}),className:"link-point-left",name:"link-point-left"}))}if(c){var y=null;v=p*Math.sin(1/3*Math.PI),m=p*Math.sin(1/3*Math.PI),a==="up"?y=[m,v]:a==="down"?y=[m,-v]:a==="right"&&(y=[m,m-v]),y&&(n.shapeMap["link-point-right"]=n.addShape("circle",{attrs:F(F({},d),{x:y[0],y:y[1],r:h/2||f||5}),className:"link-point-right",name:"link-point-right"}))}if(s){var b=null;v=p*Math.sin(1/3*Math.PI),m=p*Math.sin(1/3*Math.PI),a==="up"?b=[m-v,-v]:a==="left"?b=[m,-v]:a==="right"&&(b=[-m,-v]),b&&(n.shapeMap["link-point-top"]=n.addShape("circle",{attrs:F(F({},d),{x:b[0],y:b[1],r:h/2||f||5}),className:"link-point-top",name:"link-point-top"}))}if(l){var x=null;v=p*Math.sin(1/3*Math.PI),m=p*Math.sin(1/3*Math.PI),a==="down"?x=[-m+v,v]:a==="left"?x=[m,v]:a==="right"&&(x=[-m,v]),x&&(n.shapeMap["link-point-bottom"]=n.addShape("circle",{attrs:F(F({},d),{x:x[0],y:x[1],r:h/2||f||5}),className:"link-point-bottom",name:"link-point-bottom"}))}},getPath:function(e){var n=(this.mergeStyle||this.getOptions(e)).direction,t=e.direction||n,r=this.getSize(e)[0],i=r*Math.sin(1/3*Math.PI),o=r*Math.sin(1/3*Math.PI),a=[["M",-o,i],["L",0,-i],["L",o,i],["Z"]];return t==="down"?a=[["M",-o,-i],["L",o,-i],["L",0,i],["Z"]]:t==="left"?a=[["M",-o,o-i],["L",o,-o],["L",o,o],["Z"]]:t==="right"&&(a=[["M",o,o-i],["L",-o,o],["L",-o,-o],["Z"]]),a},getShapeStyle:function(e){var n=St({},(this.mergeStyle||this.getOptions(e)).style,{stroke:e.color}),t=this.getPath(e);return F({path:t},n)},update:function(e,n,t){var r=n.getContainer(),i=this.getOptions({}).style,o=this.getPath(e),a={stroke:e.color,path:o},s=St({},i,n.get("keyShape").attr(),a);s=St(s,e.style),this.updateShape(e,n,s,!0,t),this.updateLinkPoints(e,r)},updateLinkPoints:function(e,n){var t=this.getOptions({}),r=t.linkPoints,i=t.direction,o=e.direction||i,a=n.shapeMap["link-point-left"]||n.find(function(D){return D.get("className")==="link-point-left"}),s=n.shapeMap["link-point-right"]||n.find(function(D){return D.get("className")==="link-point-right"}),u=n.shapeMap["link-point-top"]||n.find(function(D){return D.get("className")==="link-point-top"}),c=n.shapeMap["link-point-bottom"]||n.find(function(D){return D.get("className")==="link-point-bottom"}),l=r,h=a||s||u||c;h&&(l=h.attr());var f=St({},l,e.linkPoints),d=f.fill,p=f.stroke,g=f.lineWidth,v=f.size/2;v||(v=f.r);var m=e.linkPoints?e.linkPoints:{left:void 0,right:void 0,top:void 0,bottom:void 0},y=m.left,b=m.right,x=m.top,w=m.bottom,E=this.getSize(e)[0],M={r:v,fill:d,stroke:p,lineWidth:g},_=null,k=E*Math.sin(1/3*Math.PI),S=E*Math.sin(1/3*Math.PI);o==="up"?_=[-S,k]:o==="down"?_=[-S,-k]:o==="left"&&(_=[-S,S-k]),_&&(a?y||y===void 0?a.attr(F(F({},M),{x:_[0],y:_[1]})):(a.remove(),delete n.shapeMap["link-point-left"]):y&&(n.shapeMap["link-point-left"]=n.addShape("circle",{attrs:F(F({},M),{x:_[0],y:_[1]}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})));var C=null;o==="up"?C=[S,k]:o==="down"?C=[S,-k]:o==="right"&&(C=[S,S-k]),C&&(s?b||b===void 0?s.attr(F(F({},M),{x:C[0],y:C[1]})):(s.remove(),delete n.shapeMap["link-point-right"]):b&&(n.shapeMap["link-point-right"]=n.addShape("circle",{attrs:F(F({},M),{x:C[0],y:C[1]}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})));var T=null;o==="up"?T=[S-k,-k]:o==="left"?T=[S,-k]:o==="right"&&(T=[-S,-k]),T&&(u?x||x===void 0?u.attr(F(F({},M),{x:T[0],y:T[1]})):(u.remove(),delete n.shapeMap["link-point-top"]):x&&(n.shapeMap["link-point-top"]=n.addShape("circle",{attrs:F(F({},M),{x:T[0],y:T[1]}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})));var A=null;o==="down"?A=[-S+k,k]:o==="left"?A=[S,k]:o==="right"&&(A=[-S,k]),A&&(c?w||w===void 0?c.attr(F(F({},M),{x:A[0],y:A[1]})):(c.remove(),delete n.shapeMap["link-point-bottom"]):w&&(n.shapeMap["link-point-bottom"]=n.addShape("circle",{attrs:F(F({},M),{x:A[0],y:A[1]}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0})))}},"single-node"),mo("modelRect",{options:{size:[185,70],style:{radius:5,stroke:"#69c0ff",fill:"#ffffff",lineWidth:it.defaultNode.style.lineWidth,fillOpacity:1},labelCfg:{style:{fill:"#595959",fontSize:14,fontFamily:it.windowFontFamily},offset:30},descriptionCfg:{style:{fontSize:12,fill:"#bfbfbf",fontFamily:it.windowFontFamily},paddingTop:0},preRect:{show:!0,width:4,fill:"#40a9ff",radius:2},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:10,lineWidth:1,fill:"#72CC4A",stroke:"#72CC4A"},logoIcon:{show:!0,x:0,y:0,img:"https://gw.alipayobjects.com/zos/basement_prod/4f81893c-1806-4de4-aff3-9a6b266bc8a2.svg",width:16,height:16,offset:0},stateIcon:{show:!0,x:0,y:0,img:"https://gw.alipayobjects.com/zos/basement_prod/300a2523-67e0-4cbf-9d4a-67c077b40395.svg",width:16,height:16,offset:-5},anchorPoints:[[0,.5],[1,.5]]},shapeType:"modelRect",drawShape:function(e,n){var t=(this.mergeStyle||this.getOptions(e)).preRect,r=t===void 0?{}:t,i=this.getShapeStyle(e),o=this.getSize(e),a=o[0],s=o[1],u=n.addShape("rect",{attrs:i,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});n.shapeMap["".concat(this.type,"-keyShape")]=u;var c=r.show,l=Yn(r,["show"]);return c&&(n.shapeMap["pre-rect"]=n.addShape("rect",{attrs:F({x:-a/2,y:-s/2,height:s},l),className:"pre-rect",name:"pre-rect",draggable:!0})),this.drawLogoIcon(e,n),this.drawStateIcon(e,n),this.drawLinkPoints(e,n),u},drawLogoIcon:function(e,n){var t=(this.mergeStyle||this.getOptions(e)).logoIcon,r=t===void 0?{}:t,i=this.getSize(e)[0];if(r.show){var o=r.width,a=r.height,s=r.x,u=r.y,c=r.offset,l=r.text,h=Yn(r,["width","height","x","y","offset","text"]);n.shapeMap["rect-logo-icon"]=l?n.addShape("text",{attrs:F({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},h),className:"rect-logo-icon",name:"rect-logo-icon",draggable:!0}):n.addShape("image",{attrs:F(F({},h),{x:s||-i/2+o+c,y:u||-a/2,width:o,height:a}),className:"rect-logo-icon",name:"rect-logo-icon",draggable:!0})}},drawStateIcon:function(e,n){var t=(this.mergeStyle||this.getOptions(e)).stateIcon,r=t===void 0?{}:t,i=this.getSize(e)[0];if(r.show){var o=r.width,a=r.height,s=r.x,u=r.y,c=r.offset,l=r.text,h=Yn(r,["width","height","x","y","offset","text"]);n.shapeMap["rect-state-icon"]=l?n.addShape("text",{attrs:F({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},h),className:"rect-state-icon",name:"rect-state-icon",draggable:!0}):n.addShape("image",{attrs:F(F({},h),{x:s||i/2-o+c,y:u||-a/2,width:o,height:a}),className:"rect-state-icon",name:"rect-state-icon",draggable:!0})}},drawLinkPoints:function(e,n){var t=(this.mergeStyle||this.getOptions(e)).linkPoints,r=t===void 0?{}:t,i=r.top,o=r.left,a=r.right,s=r.bottom,u=r.size,c=r.r,l=Yn(r,["top","left","right","bottom","size","r"]),h=this.getSize(e),f=h[0],d=h[1];o&&(n.shapeMap["link-point-left"]=n.addShape("circle",{attrs:F(F({},l),{x:-f/2,y:0,r:u/2||c||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),a&&(n.shapeMap["link-point-right"]=n.addShape("circle",{attrs:F(F({},l),{x:f/2,y:0,r:u/2||c||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),i&&(n.shapeMap["link-point-top"]=n.addShape("circle",{attrs:F(F({},l),{x:0,y:-d/2,r:u/2||c||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),s&&(n.shapeMap["link-point-bottom"]=n.addShape("circle",{attrs:F(F({},l),{x:0,y:d/2,r:u/2||c||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},drawLabel:function(e,n){var t=this.getOptions(e),r=t.labelCfg,i=r===void 0?{}:r,o=t.logoIcon,a=o===void 0?{}:o,s=t.descriptionCfg,u=s===void 0?{}:s,c=this.getSize(e)[0],l=null,h=a.show,f=a.width,d=-c/2+i.offset;h&&(d=-c/2+f+i.offset);var p=i.style,g=u.style,v=u.paddingTop;return Re(e.description)?(l=n.addShape("text",{attrs:F(F({},p),{x:d,y:-5,text:e.label}),className:"text-shape",name:"text-shape",draggable:!0,labelRelated:!0}),n.shapeMap["text-shape"]=l,n.shapeMap["rect-description"]=n.addShape("text",{attrs:F(F({},g),{x:d,y:17+(v||0),text:e.description}),className:"rect-description",name:"rect-description",draggable:!0,labelRelated:!0})):(l=n.addShape("text",{attrs:F(F({},p),{x:d,y:7,text:e.label}),className:"text-shape",name:"text-shape",draggable:!0,labelRelated:!0}),n.shapeMap["text-shape"]=l),l},getShapeStyle:function(e){var n=St({},(this.mergeStyle||this.getOptions(e)).style,{stroke:e.color}),t=this.getSize(e),r=n.width||t[0],i=n.height||t[1];return F({x:-r/2,y:-i/2,width:r,height:i},n)},update:function(e,n){var t=this.mergeStyle||this.getOptions(e),r=t.style,i=r===void 0?{}:r,o=t.labelCfg,a=o===void 0?{}:o,s=t.descriptionCfg,u=s===void 0?{}:s,c=this.getSize(e),l=c[0],h=c[1];n.get("keyShape").attr(F(F({},i),{x:-l/2,y:-h/2,width:l,height:h}));var f=n.getContainer(),d=f.shapeMap["rect-logo-icon"]||f.find(function(ne){return ne.get("className")==="rect-logo-icon"}),p=St({},d?d.attr():{},e.logoIcon),g=p.width;g===void 0&&(g=this.options.logoIcon.width);var v=e.logoIcon?e.logoIcon.show:void 0,m=a.offset,y=-l/2+g+m;v||v===void 0||(y=-l/2+m);var b=f.shapeMap["node-label"]||f.find(function(ne){return ne.get("className")==="node-label"}),x=f.shapeMap["rect-description"]||f.find(function(ne){return ne.get("className")==="rect-description"});if(e.label)if(b){var w=e.labelCfg?e.labelCfg.style:{},E=St({},b.attr(),w);e.label&&(E.text=e.label),E.x=y,Re(e.description)&&(E.y=-5),x&&(x.resetMatrix(),x.attr({x:y})),b.resetMatrix(),b.attr(E)}else f.shapeMap["node-label"]=f.addShape("text",{attrs:F(F({},a.style),{x:y,y:e.description?-5:7,text:e.label}),className:"node-label",name:"node-label",draggable:!0,labelRelated:!0});if(Re(e.description)){var M=u.paddingTop;if(x){w=e.descriptionCfg?e.descriptionCfg.style:{};var _=St({},x.attr(),w);Re(e.description)&&(_.text=e.description),_.x=y,x.resetMatrix(),x.attr(F(F({},_),{y:17+(M||0)}))}else f.shapeMap["rect-description"]=f.addShape("text",{attrs:F(F({},u.style),{x:y,y:17+(M||0),text:e.description}),className:"rect-description",name:"rect-description",draggable:!0,labelRelated:!0})}var k=f.shapeMap["pre-rect"]||f.find(function(ne){return ne.get("className")==="pre-rect"});if(k&&!k.destroyed){var S=St({},k.attr(),e.preRect);k.attr(F(F({},S),{x:-l/2,y:-h/2,height:h}))}if(d&&!d.destroyed)if(v||v===void 0){var C=p.width,T=p.height,A=p.x,D=p.y,j=p.offset,L=Yn(p,["width","height","x","y","offset"]);d.attr(F(F({},L),{x:A||-l/2+C+j,y:D||-T/2,width:C,height:T}))}else d.remove(),delete f.shapeMap["pre-rect"];else v&&this.drawLogoIcon(e,f);var B=f.shapeMap["rect-state-icon"]||f.find(function(ne){return ne.get("className")==="rect-state-icon"}),N=St({},B?B.attr():{},e.stateIcon);if(B){N.show||N.show===void 0||(B.remove(),delete f.shapeMap["rect-state-icon"]);var R=N.width,P=(T=N.height,A=N.x,D=N.y,N.offset),H=Yn(N,["width","height","x","y","offset"]);B.attr(F(F({},H),{x:A||l/2-R+P,y:D||-T/2,width:R,height:T}))}else N.show&&this.drawStateIcon(e,f);this.updateLinkPoints(e,f)},getOptions:function(e,n){return n==="move"?e:fn({},this.options,this.getCustomConfig(e)||{},e)}},"single-node"),mo("star",{options:{size:60,style:{stroke:it.defaultNode.style.stroke,fill:it.defaultNode.style.fill,lineWidth:it.defaultNode.style.lineWidth},labelCfg:{style:{fill:it.nodeLabel.style.fill,fontSize:it.nodeLabel.style.fontSize,fontFamily:it.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:it.defaultNode.linkPoints.size,lineWidth:it.defaultNode.linkPoints.lineWidth,fill:it.defaultNode.linkPoints.fill,stroke:it.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:F({},it.nodeStateStyles)},shapeType:"star",labelPosition:"center",drawShape:function(e,n){var t=(this.mergeStyle||this.getOptions(e)).icon,r=t===void 0?{}:t,i=this.getShapeStyle(e),o=n.addShape("path",{attrs:i,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});n.shapeMap["".concat(this.type,"-keyShape")]=o;var a=r.width,s=r.height,u=r.show,c=r.text;return u&&(n.shapeMap["".concat(this.type,"-icon")]=c?n.addShape("text",{attrs:F({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},r),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):n.addShape("image",{attrs:F({x:-a/2,y:-s/2},r),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(e,n),o},drawLinkPoints:function(e,n){var t=(this.mergeStyle||this.getOptions(e)).linkPoints,r=t===void 0?{}:t,i=r.top,o=r.left,a=r.right,s=r.leftBottom,u=r.rightBottom,c=r.size,l=r.r,h=Yn(r,["top","left","right","leftBottom","rightBottom","size","r"]),f=this.getSize(e)[0];if(a){var d=Math.cos(.1*Math.PI)*f,p=Math.sin(.1*Math.PI)*f;n.shapeMap["link-point-right"]=n.addShape("circle",{attrs:F(F({},h),{x:d,y:-p,r:c/2||l||5}),className:"link-point-right",name:"link-point-right"})}i&&(d=Math.cos(.5*Math.PI)*f,p=Math.sin(.5*Math.PI)*f,n.shapeMap["link-point-top"]=n.addShape("circle",{attrs:F(F({},h),{x:d,y:-p,r:c/2||l||5}),className:"link-point-top",name:"link-point-top"})),o&&(d=Math.cos(.9*Math.PI)*f,p=Math.sin(.9*Math.PI)*f,n.shapeMap["link-point-left"]=n.addShape("circle",{attrs:F(F({},h),{x:d,y:-p,r:c/2||l||5}),className:"link-point-left",name:"link-point-left"})),s&&(d=Math.cos(1.3*Math.PI)*f,p=Math.sin(1.3*Math.PI)*f,n.shapeMap["link-point-bottom"]=n.addShape("circle",{attrs:F(F({},h),{x:d,y:-p,r:c/2||l||5}),className:"link-point-left-bottom",name:"link-point-left-bottom"})),u&&(d=Math.cos(1.7*Math.PI)*f,p=Math.sin(1.7*Math.PI)*f,n.shapeMap["link-point-right-bottom"]=n.addShape("circle",{attrs:F(F({},h),{x:d,y:-p,r:c/2||l||5}),className:"link-point-right-bottom",name:"link-point-right-bottom"}))},getPath:function(e){var n=this.getSize(e)[0],t=3*n/8,r=e.innerR||t;return gr.getStarPath(n,r)},getShapeStyle:function(e){var n=St({},(this.mergeStyle||this.getOptions(e)).style,{stroke:e.color}),t=this.getPath(e);return F({path:t},n)},update:function(e,n,t){var r=n.getContainer(),i=this.getOptions({}).style,o=this.getPath(e),a={stroke:e.color,path:o},s=St({},i,n.get("keyShape").attr(),a);s=St(s,e.style),this.updateShape(e,n,s,!0,t),this.updateLinkPoints(e,r)},updateLinkPoints:function(e,n){var t=this.getOptions({}).linkPoints,r=n.shapeMap["link-point-left"]||n.find(function(k){return k.get("className")==="link-point-left"}),i=n.shapeMap["link-point-right"]||n.find(function(k){return k.get("className")==="link-point-right"}),o=n.shapeMap["link-point-top"]||n.find(function(k){return k.get("className")==="link-point-top"}),a=n.shapeMap["link-point-left-bottom"]||n.find(function(k){return k.get("className")==="link-point-left-bottom"}),s=n.shapeMap["link-point-left-bottom"]||n.find(function(k){return k.get("className")==="link-point-right-bottom"}),u=t,c=r||i||o||a||s;c&&(u=c.attr());var l=St({},u,e.linkPoints),h=l.fill,f=l.stroke,d=l.lineWidth,p=l.size/2;p||(p=l.r);var g=e.linkPoints?e.linkPoints:{left:void 0,right:void 0,top:void 0,leftBottom:void 0,rightBottom:void 0},v=g.left,m=g.right,y=g.top,b=g.leftBottom,x=g.rightBottom,w=this.getSize(e)[0],E={r:p,fill:h,stroke:f,lineWidth:d},M=Math.cos(.1*Math.PI)*w,_=Math.sin(.1*Math.PI)*w;i?m||m===void 0?i.attr(F(F({},E),{x:M,y:-_})):(i.remove(),delete n.shapeMap["link-point-right"]):m&&(n.shapeMap["link-point-right"]=n.addShape("circle",{attrs:F(F({},E),{x:M,y:-_}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),M=Math.cos(.5*Math.PI)*w,_=Math.sin(.5*Math.PI)*w,o?y||y===void 0?o.attr(F(F({},E),{x:M,y:-_})):(o.remove(),delete n.shapeMap["link-point-top"]):y&&(n.shapeMap["link-point-top"]=n.addShape("circle",{attrs:F(F({},E),{x:M,y:-_}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),M=Math.cos(.9*Math.PI)*w,_=Math.sin(.9*Math.PI)*w,r?v||v===void 0?r.attr(F(F({},E),{x:M,y:-_})):(r.remove(),delete n.shapeMap["link-point-left"]):v&&(n.shapeMap["link-point-left"]=n.addShape("circle",{attrs:F(F({},E),{x:M,y:-_}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),M=Math.cos(1.3*Math.PI)*w,_=Math.sin(1.3*Math.PI)*w,a?b||b===void 0?a.attr(F(F({},E),{x:M,y:-_})):(a.remove(),delete n.shapeMap["link-point-left-bottom"]):b&&(n.shapeMap["link-point-left-bottom"]=n.addShape("circle",{attrs:F(F({},E),{x:M,y:-_}),className:"link-point-left-bottom",name:"link-point-left-bottom",isAnchorPoint:!0})),M=Math.cos(1.7*Math.PI)*w,_=Math.sin(1.7*Math.PI)*w,s?x||x===void 0?s.attr(F(F({},E),{x:M,y:-_})):(s.remove(),delete n.shapeMap["link-point-right-bottom"]):x&&(n.shapeMap["link-point-right-bottom"]=n.addShape("circle",{attrs:F(F({},E),{x:M,y:-_}),className:"link-point-right-bottom",name:"link-point-right-bottom",isAnchorPoint:!0}))}},"single-node");var d5=gr.defaultSubjectColors,eh="fan-shape-";mo("donut",{options:{size:it.defaultNode.size,style:{x:0,y:0,stroke:it.defaultNode.style.stroke,fill:it.defaultNode.style.fill,lineWidth:it.defaultNode.style.lineWidth},labelCfg:{style:{fill:it.nodeLabel.style.fill,fontSize:it.nodeLabel.style.fontSize,fontFamily:it.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:it.defaultNode.linkPoints.size,lineWidth:it.defaultNode.linkPoints.lineWidth,fill:it.defaultNode.linkPoints.fill,stroke:it.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:F({},it.nodeStateStyles)},shapeType:"circle",labelPosition:"center",drawShape:function(e,n){var t=(this.mergeStyle||this.getOptions(e)).icon,r=t===void 0?{}:t,i=this.getShapeStyle(e),o=fn({},r,e.icon),a=n.addShape("circle",{attrs:i,className:"".concat(this.type,"-keyShape"),draggable:!0,name:"".concat(this.type,"-keyShape")});n.shapeMap["".concat(this.type,"-keyShape")]=a;var s=o.width,u=o.height,c=o.show,l=o.text;return c&&(n.shapeMap["".concat(this.type,"-icon")]=l?n.addShape("text",{attrs:F({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},o),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):n.addShape("image",{attrs:F({x:-s/2,y:-u/2},o),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),JV(e,n,a),this.drawLinkPoints(e,n),a},updateShape:function(e,n,t,r,i){var o=n.get("keyShape");o.attr(F({},t)),eH(e,n,o),this.updateLabel(e,n,i),r&&this.updateIcon(e,n)}},"circle");var JV=function(e,n,t){var r=e.donutAttrs,i=r===void 0?{}:r,o=e.donutColorMap,a=o===void 0?{}:o,s=Object.keys(i).length;if(i&&s>1){var u=p5(i,a),c=u.configs,l=u.totalValue;if(l){var h=g5(t),f=h.lineWidth,d=h.arcR,p=[d,0],g=0;if(s===1)return void Q1(n,{arcR:d,arcBegin:p,beginAngle:g,config:c[0],fanIndex:0,lineWidth:f,totalValue:l,drawWhole:!0});for(var v=0;v<c.length;v++){var m=Q1(n,{arcR:d,arcBegin:p,beginAngle:g,config:c[v],fanIndex:v,lineWidth:f,totalValue:l});if(m.shouldEnd)return;p=m.arcBegin,g=m.beginAngle}}}},Q1=function(e,n){var t,r,i,o=n.arcR,a=n.arcBegin,s=n.beginAngle,u=n.config,c=n.fanIndex,l=n.lineWidth,h=n.totalValue,f=n.drawWhole,d=f!==void 0&&f,p=n.updateShape,g=p===void 0?void 0:p,v=u.value/h;if(v<.001)return{beginAngle:s,arcBegin:a,shape:void 0,shouldEnd:!1};if(d||v>.999)t=[o,1e-4],i=1;else{var m=v*Math.PI*2;r=s+m,t=[o*Math.cos(r),-o*Math.sin(r)],i=m>Math.PI?1:0}var y={path:[["M",a[0],a[1]],["A",o,o,0,i,0,t[0],t[1]]],stroke:u.color||(g==null?void 0:g.attr("stroke"))||d5[c%d5.length],lineWidth:l};return g?g.attr(y):e.shapeMap["".concat(eh).concat(c)]=e.addShape("path",{attrs:y,name:"".concat(eh).concat(c),draggable:!0}),{beginAngle:r,arcBegin:t,shape:e.shapeMap["".concat(eh).concat(c)],shouldEnd:d||v>.999}},eH=function(e,n,t){var r=e.donutAttrs,i=e.donutColorMap,o=i===void 0?{}:i,a={},s=n.getContainer();if(r){var u=p5(r,o),c=u.configs,l=u.totalValue;if(l)for(var h=g5(t),f=h.lineWidth,d=h.arcR,p=[d,0],g=0,v=0;v<c.length;v++){var m="".concat(eh).concat(v),y=Q1(s,{arcR:d,arcBegin:p,beginAngle:g,config:c[v],fanIndex:v,lineWidth:f,totalValue:l,drawWhole:c.length===1,updateShape:s.shapeMap[m]});if(y.shape&&(a[m]=!0),y.shouldEnd)break;p=y.arcBegin,g=y.beginAngle}}var b=Object.keys(s.shapeMap).filter(function(x){return x.includes(eh)});b.forEach(function(x){a[x]||(s.shapeMap[x].remove(!0),delete s.shapeMap[x])})},p5=function(e,n){var t=0,r=[];return Object.keys(e).forEach(function(i){var o=+e[i];isNaN(o)||(r.push({key:i,value:o,color:n[i]}),t+=o)}),{totalValue:t,configs:r}},g5=function(e){var n=e.attr("r"),t=.6*n;return{lineWidth:n-t,arcR:(n+t)/2}},Yp=function(e){var n=e.x,t=e.y;return{x:n,y:t,centerX:n,centerY:t,minX:n,minY:t,maxX:n,maxY:t,height:0,width:0}},J1=function(e){for(var n=[],t={},r=e.length-1;r>=0;r--){var i=e[r];i.id="".concat(i.x,"|||").concat(i.y),t[i.id]||(t[i.id]=i,n.push(i))}return n},v5=function(e){return J1(e)},Wp=function(e,n){return e.width||e.height?{centerX:e.centerX,centerY:e.centerY,minX:e.minX-n,minY:e.minY-n,maxX:e.maxX+n,maxY:e.maxY+n,height:e.height+2*n,width:e.width+2*n}:e},eb=function(e,n,t){var r=function(a,s){var u=Math.abs(a.x-s.centerX),c=Math.abs(a.y-s.centerY);return u===0&&c===0?0:u/s.width>c/s.height}(n,e);if(r===0){var i=e.centerX,o=e.centerY;return t.y<n.y?o=e.minY:t.x>n.x?i=e.maxX:t.x<n.x?i=e.minX:t.x===n.x&&(o=e.maxY),{x:i,y:o}}return r?{x:n.x>e.centerX?e.maxX:e.minX,y:n.y}:{x:n.x,y:n.y>e.centerY?e.maxY:e.minY}},m5=function(e,n){var t=Math.min(e.minX,n.minX),r=Math.min(e.minY,n.minY),i=Math.max(e.maxX,n.maxX),o=Math.max(e.maxY,n.maxY);return{centerX:(t+i)/2,centerY:(r+o)/2,minX:t,minY:r,maxX:i,maxY:o,height:o-r,width:i-t}},tb=function(e){return[{x:e.minX,y:e.minY},{x:e.maxX,y:e.minY},{x:e.maxX,y:e.maxY},{x:e.minX,y:e.maxY}]},Vp=function(e,n){var t=e.x,r=e.y;return t<n.minX||t>n.maxX||r<n.minY||r>n.maxY},th=function(e,n){return Math.abs(e.x-n.x)+Math.abs(e.y-n.y)},y5=function(e,n,t,r,i){return th(e,n)+th(e,t)+function(o,a){var s=0;return a.forEach(function(u){u&&(o.x===u.x&&(s+=-2),o.y===u.y&&(s+=-2))}),s}(e,[n,t,r,i])},tH=function e(n,t,r,i,o){o===void 0&&(o=0),n.unshift(t[i]),r[i]&&r[i]!==i&&o<=100&&e(n,t,r,r[i],o+1)},Hp=function(e,n,t,r){var i=t.x-e.x,o=t.y-e.y,a=r.x-e.x,s=r.y-e.y,u=t.x-n.x,c=t.y-n.y,l=r.x-n.x,h=r.y-n.y;return(i*s-o*a)*(u*h-c*l)<=0&&(i*c-o*u)*(a*h-s*l)<=0},nb=function(e,n,t){if(t.width||t.height){var r=tb(t),i=r[0],o=r[1],a=r[2],s=r[3];return Hp(e,n,i,o)||Hp(e,n,i,s)||Hp(e,n,o,a)||Hp(e,n,a,s)}return!1},nH=function(e,n,t,r){var i=[];return e.forEach(function(o){if(o!==n&&(o.x===n.x||o.y===n.y)){if(nb(o,n,t)||nb(o,n,r))return;i.push(o)}}),J1(i)},b5=function(e,n){var t=[],r=e[0];return t.push("M".concat(r.x," ").concat(r.y)),e.forEach(function(i,o){var a=e[o+1],s=e[o+2];if(a&&s)if(function(h,f,d){return!(h.x===f.x&&f.x===d.x||h.y===f.y&&f.y===d.y)}(i,a,s)){var u=function(h,f,d,p){var g=th(h,f),v=th(d,f);return g<p&&(p=g),v<p&&(p=v),[{x:f.x-p/g*(f.x-h.x),y:f.y-p/g*(f.y-h.y)},{x:f.x-p/v*(f.x-d.x),y:f.y-p/v*(f.y-d.y)}]}(i,a,s,n),c=u[0],l=u[1];t.push("L".concat(c.x," ").concat(c.y)),t.push("Q".concat(a.x," ").concat(a.y," ").concat(l.x," ").concat(l.y)),t.push("L".concat(l.x," ").concat(l.y))}else t.push("L".concat(a.x," ").concat(a.y));else a&&t.push("L".concat(a.x," ").concat(a.y))}),t.join("")},x5=function(e,n,t,r,i){var o,a;if(t&&t.getType())if(t.getType()==="combo"){var s=t.getKeyShape().getBBox();if(s){var u=t.getModel(),c=u.x,l=u.y;(o={x:c,y:l,width:s.width,height:s.height,minX:s.minX+c,maxX:s.maxX+c,minY:s.minY+l,maxY:s.maxY+l}).centerX=(o.minX+o.maxX)/2,o.centerY=(o.minY+o.maxY)/2}else o=Yp(e)}else o=t&&t.getBBox();else o=Yp(e);if(r&&r.getType())if(r.getType()==="combo"){var h=r.getKeyShape().getBBox();if(h){var f=r.getModel(),d=f.x,p=f.y;(a={x:d,y:p,width:h.width,height:h.height,minX:h.minX+d,maxX:h.maxX+d,minY:h.minY+p,maxY:h.maxY+p}).centerX=(a.minX+a.maxX)/2,a.centerY=(a.minY+a.maxY)/2}else a=Yp(n)}else a=r&&r.getBBox();else a=Yp(n);var g=Wp(o,i),v=Wp(a,i),m=eb(g,e,n),y=eb(v,n,e),b=function(k){k===void 0&&(k=[]);var S=[],C=[];k.forEach(function(L){S.push(L.x),C.push(L.y)});var T=Math.min.apply(Math,S),A=Math.max.apply(Math,S),D=Math.min.apply(Math,C),j=Math.max.apply(Math,C);return{centerX:(T+A)/2,centerY:(D+j)/2,maxX:A,maxY:j,minX:T,minY:D,height:j-D,width:A-T}}([m,y]),x=m5(g,b),w=m5(v,b),E=[];E=E.concat(tb(x)).concat(tb(w));var M={x:(e.x+n.x)/2,y:(e.y+n.y)/2};[b,x,w].forEach(function(k){E=E.concat(function(S,C){return function(T,A){return A<T.minX||A>T.maxX?[]:[{x:A,y:T.minY},{x:A,y:T.maxY}]}(S,C.x).concat(function(T,A){return A<T.minY||A>T.maxY?[]:[{x:T.minX,y:A},{x:T.maxX,y:A}]}(S,C.y))}(k,M).filter(function(S){return Vp(S,g)&&Vp(S,v)}))}),[{x:m.x,y:y.y},{x:y.x,y:m.y}].forEach(function(k){Vp(k,g)&&Vp(k,v)&&E.push(k)}),E.unshift(m),E.push(y);var _=function(k,S,C,T,A,D,j){var L,B=[],N=((L={})[S.id]=S,L),R={},P={},H={};P[S.id]=0,H[S.id]=y5(S,C,S);var ne=new w5;ne.add({id:S.id,value:H[S.id]});var Z,q={};for(k.forEach(function(pe){q[pe.id]=pe});Object.keys(N).length;){var te=ne.minId(!1);if(!te)break;if((Z=N[te])===C){var we=[];return tH(we,q,R,C.id),we}delete N[Z.id],ne.remove(Z.id),B.push(Z),nH(k,Z,T,A).forEach(function(pe){if(B.indexOf(pe)===-1){var Me=pe.id;N[Me]||(N[Me]=pe);var Be=H[Z.id]+th(Z,pe);P[Me]&&Be>=P[Me]||(R[Me]=Z.id,P[Me]=Be,H[Me]=P[Me]+y5(pe,C,S,D,j)),ne.add({id:Me,value:H[Me]})}})}return[S,C]}(E=J1(E),m,y,o,a,e,n);return _.unshift(e),_.push(n),v5(_)},w5=function(){function e(){this.arr=[],this.map={},this.arr=[],this.map={}}return e.prototype._innerAdd=function(n,t){for(var r=[0,t-1];r[1]-r[0]>1;){var i=Math.floor((r[0]+r[1])/2);if(this.arr[i].value>n.value)r[1]=i;else{if(!(this.arr[i].value<n.value))return this.arr.splice(i,0,n),void(this.map[n.id]=!0);r[0]=i}}this.arr.splice(r[1],0,n),this.map[n.id]=!0},e.prototype.add=function(n){delete this.map[n.id];var t=this.arr.length;return t?this.arr[t-1].value<n.value?(this.arr.push(n),void(this.map[n.id]=!0)):void this._innerAdd(n,t):(this.arr.push(n),void(this.map[n.id]=!0))},e.prototype.remove=function(n){this.map[n]&&delete this.map[n]},e.prototype._clearAndGetMinId=function(){for(var n,t=this.arr.length-1;t>=0;t--)this.map[this.arr[t].id]?n=this.arr[t].id:this.arr.splice(t,1);return n},e.prototype._findFirstId=function(){for(;this.arr.length;){var n=this.arr.shift();if(this.map[n.id])return n.id}},e.prototype.minId=function(n){return n?this._clearAndGetMinId():this._findFirstId()},e}(),rH={offset:20,maxAllowedDirectionChange:Math.PI/2,maximumLoops:2e3,gridSize:10,directions:[{stepX:1,stepY:0},{stepX:-1,stepY:0},{stepX:0,stepY:1},{stepX:0,stepY:-1}],get penalties(){return{0:0,45:this.gridSize/2,90:this.gridSize/2}},distFunc:function(e,n){return Math.abs(e.x-n.x)+Math.abs(e.y-n.y)},fallbackRoute:function(e,n,t,r,i){return v5(x5(e,n,t,r,i.offset))}},zo=function(e,n){var t=Math.round(Math.abs(e/n));return t<0?0:(e<0?-1:1)*t},rb=function(e,n){var t=n.x-e.x,r=n.y-e.y;return t||r?Math.atan2(r,t):0},E5=function(e,n){var t=Math.abs(e-n);return t>Math.PI?2*Math.PI-t:t},M5=function(e,n,t){for(var r=1/0,i=0,o=n.length;i<o;i++){var a=t(e,n[i]);a<r&&(r=a)}return r},S5=function(e,n,t,r,i){var o=[];if(!t)return[e];var a=i.directions,s=i.offset,u=t.getBBox(),c=n.x>u.minX&&n.x<u.maxX&&n.y>u.minY&&n.y<u.maxY,l=Wp(u,s);for(var h in l)l[h]=zo(l[h],i.gridSize);if(c){for(var f=0,d=a;f<d.length;f++){var p=d[f],g=[[{x:l.minX,y:l.minY},{x:l.maxX,y:l.minY}],[{x:l.minX,y:l.minY},{x:l.minX,y:l.maxY}],[{x:l.maxX,y:l.minY},{x:l.maxX,y:l.maxY}],[{x:l.minX,y:l.maxY},{x:l.maxX,y:l.maxY}]];for(h=0;h<4;h++){var v=g[h],m=gr.getLineIntersect(e,{x:e.x+p.stepX*l.width,y:e.y+p.stepY*l.height},v[0],v[1]);m&&!nb(e,m,u)&&(m.id="".concat(m.x,"|||").concat(m.y),o.push(m))}}return o}var y=eb(l,e,r);return y.id="".concat(y.x,"|||").concat(y.y),[y]},ib=function(e,n,t,r){var i=rb(e,n),o=t[e.id];if(!o){var a=rb(r,e);return E5(a,i)}var s=rb({x:o.x,y:o.y},e);return E5(s,i)},iH=function(e,n,t,r,i,o,a){var s=[r],u=r,c=e.id,l=e.x,h=e.y,f={x:l,y:h,id:c};ib(f,o,n,t)&&(u={x:o.x===r.x?r.x:f.x*a,y:o.y===r.y?r.y:f.y*a},s.unshift(u));for(var d=n[c];d&&d.id!==c;){var p={x:l,y:h,id:c},g={x:d.x,y:d.y,id:d.id};ib(g,p,n,t)&&(u={x:g.x===p.x?u.x:g.x*a,y:g.y===p.y?u.y:g.y*a},s.unshift(u)),l=g.x,h=g.y,d=n[c=g.id]}return s[0].x=l===t.x?i.x:u.x,s[0].y=h===t.y?i.y:u.y,s.unshift(i),s},oH=function(e,n,t,r,i){if(isNaN(e.x)||isNaN(n.x))return[];var o=fn(rH,i);o.obstacles=o.obstacles||[];var a=o.penalties,s=o.gridSize,u=function(N,R,P){var H={};return N.forEach(function(ne){if(ne)for(var Z=Wp(ne.getBBox(),P),q=zo(Z.minX,R);q<=zo(Z.maxX,R);q+=1)for(var te=zo(Z.minY,R);te<=zo(Z.maxY,R);te+=1)H["".concat(q,"|||").concat(te)]=!0}),H}(o.obstacles.concat([t,r]),s,o.offset),c={x:zo(e.x,s),y:zo(e.y,s)},l={x:zo(n.x,s),y:zo(n.y,s)};e.id="".concat(c.x,"|||").concat(c.y),n.id="".concat(l.x,"|||").concat(l.y);var h=S5(c,e,t,l,o),f=S5(l,n,r,c,o);h.forEach(function(N){delete u[N.id]}),f.forEach(function(N){delete u[N.id]});for(var d={},p={},g={},v={},m={},y=new w5,b=0;b<h.length;b++){var x=h[b];d[x.id]=x,v[x.id]=0,m[x.id]=M5(x,f,o.distFunc),y.add({id:x.id,value:m[x.id]})}var w,E,M,_,k,S,C=o.maximumLoops,T=1/0,A={};for(f.forEach(function(N){A["".concat(N.x,"|||").concat(N.y)]=!0}),Object.keys(d).forEach(function(N){var R=d[N].id;m[R]<=T&&(T=m[R],w=d[R])});Object.keys(d).length>0&&C>0;){var D=y.minId((C+1)%30==0);if(!D)break;if(w=d[D],A["".concat(w.x,"|||").concat(w.y)])return iH(w,g,c,n,e,l,s);for(delete d[w.id],y.remove(w.id),p[w.id]=!0,b=0;b<o.directions.length;b++){E=o.directions[b];var j="".concat(Math.round(w.x)+E.stepX,"|||").concat(Math.round(w.y)+E.stepY);if(M={x:w.x+E.stepX,y:w.y+E.stepY,id:j},!p[j]&&!((S=ib(w,M,g,c))>o.maxAllowedDirectionChange||u[j])){d[j]||(d[j]=M);var L=a[S];_=o.distFunc(w,M)+(isNaN(L)?s:L),k=v[w.id]+_;var B=v[j];B&&k>=B||(g[j]=w,v[j]=k,m[j]=k+M5(M,f,o.distFunc),y.add({id:j,value:m[j]}))}}C-=1}return o.fallbackRoute(e,n,t,r,o)};s_("polyline",{options:{color:it.defaultEdge.color,size:it.defaultEdge.size,style:{radius:0,offset:15,x:0,y:0,stroke:it.defaultEdge.style.stroke,lineAppendWidth:it.defaultEdge.style.lineAppendWidth},labelCfg:{style:{fill:it.edgeLabel.style.fill,fontSize:it.edgeLabel.style.fontSize,fontFamily:it.windowFontFamily}},routeCfg:{obstacles:[],maxAllowedDirectionChange:Math.PI,maximumLoops:500,gridSize:10},stateStyles:F({},it.edgeStateStyles)},shapeType:"polyline",labelPosition:"center",drawShape:function(e,n){var t=this.getShapeStyle(e);t.radius===0&&delete t.radius;var r=n.addShape("path",{className:"edge-shape",name:"edge-shape",attrs:t});return n.shapeMap["edge-shape"]=r,r},getShapeStyle:function(e){var n=St({},this.options.style,{stroke:e.color},e.style);e=this.getPathPoints(e),this.radius=n.radius,this.offset=n.offset;var t=e.startPoint,r=e.endPoint,i=this.getControlPoints(e),o=[t];i&&(o=o.concat(i)),o.push(r);var a=e.sourceNode,s=e.targetNode,u=n.radius,c=St({},this.options.routeCfg,e.routeCfg);c.offset=n.offset;var l=this.getPath(o,a,s,u,c,!i);return(Mt(l)&&l.length<=1||Re(l)&&l.indexOf("L")===-1)&&(l="M0 0, L0 0"),(isNaN(t.x)||isNaN(t.y)||isNaN(r.x)||isNaN(r.y))&&(l="M0 0, L0 0"),St({},it.defaultEdge.style,n,{lineWidth:e.size,path:l})},updateShapeStyle:function(e,n){var t=n.getContainer();if(n.isVisible()){var r={stroke:e.color},i=t.shapeMap["edge-shape"]||t.find(function(y){return y.get("className")==="edge-shape"})||n.getKeyShape(),o=e.size,a=(e=this.getPathPoints(e)).startPoint,s=e.endPoint,u=this.getControlPoints(e),c=[a];u&&(c=c.concat(u)),c.push(s);var l=i.attr(),h=St({},r,l,e.style),f=e.sourceNode,d=e.targetNode,p=h.radius,g=St({},this.options.routeCfg,e.routeCfg);g.offset=h.offset;var v=this.getPath(c,f,d,p,g,!u);(Mt(v)&&v.length<=1||Re(v)&&v.indexOf("L")===-1)&&(v="M0 0, L0 0"),(isNaN(a.x)||isNaN(a.y)||isNaN(s.x)||isNaN(s.y))&&(v="M0 0, L0 0"),l.endArrow&&h.endArrow===!1&&(e.style.endArrow={path:""}),l.startArrow&&h.startArrow===!1&&(e.style.startArrow={path:""});var m=St(r,i.attr(),{lineWidth:o,path:v},e.style);i&&i.attr(m)}},getPath:function(e,n,t,r,i,o){var a=i.offset,s=i.obstacles,u=i.simple;if(!a||e.length>2||o===!1){if(r)return b5(e,r);var c=[];return ye(e,function(h,f){f===0?c.push(["M",h.x,h.y]):c.push(["L",h.x,h.y])}),c}u===!1||s!=null&&s.length||(u=!0);var l=u?x5(e[e.length-1],e[0],t,n,a):oH(e[0],e[e.length-1],n,t,i);return l&&l.length?r?b5(l,r):(l=function(h){if(!(h!=null&&h.length))return h;for(var f=h[h.length-1],d={x:f.x,y:f.y},p=[f],g=[f],v=h.length-2;v>=0;v--){var m,y=h[v];y.x===d.x?p.push(y):(p=[y],d.x=y.x),y.y===d.y?g.push(y):(g=[y],d.y=y.y),p.length>2?(m=h.indexOf(p[1]))>-1&&h.splice(m,1):g.length>2&&(m=h.indexOf(g[1]))>-1&&h.splice(m,1)}return h}(l),gr.pointsToPolygon(l)):"M0 0, L0 0"}},"single-edge");var _5=Ro.cloneEvent,k5=Ro.isNaN,C5=Math.abs,aH=["shift","ctrl","alt","control"];const sH={getDefaultCfg:function(){return{direction:"both",enableOptimize:!1,scalableRange:0,allowDragOnItem:!1}},getEvents:function(){return{mousedown:"onMouseDown",drag:"onDragMove",dragend:"onMouseUp","canvas:click":"onMouseUp",keyup:"onKeyUp",focus:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onMouseUp"}},updateViewport:function(e){var n=this.origin,t=+e.clientX,r=+e.clientY;if(!k5(t)&&!k5(r)){var i=t-n.x,o=r-n.y;this.get("direction")==="x"?o=0:this.get("direction")==="y"&&(i=0),this.origin={x:t,y:r};var a=this.graph.get("width"),s=this.graph.get("height"),u=this.graph.get("canvas").getCanvasBBox(),c=this.scalableRange,l=this.scalableRange;c<1&&c>-1&&(c*=a,l*=s),(u.minX<=a+c&&u.minX+i>a+c||u.maxX+c>=0&&u.maxX+c+i<0)&&(i=0),(u.minY<=s+l&&u.minY+o>s+l||u.maxY+l>=0&&u.maxY+l+o<0)&&(o=0),this.graph.translate(i,o)}},onTouchStart:function(e){var n=e.originalEvent.touches,t=n[0],r=n[1];t&&r||(e.preventDefault(),this.mousedown=!0,this.onDragStart(e))},onMouseDown:function(e){this.mousedown=!0},onDragMove:function(e){this.mousedown&&(this.dragstart?this.onDrag(e):(this.dragstart=!0,this.onDragStart(e)))},onDragStart:function(e){var n=this,t=e.originalEvent;if((!t||e.name==="touchstart"||t.button===0)&&(e.name==="touchstart"||typeof window>"u"||!window.event||window.event.buttons||window.event.button)&&this.shouldBegin(e,this)&&!n.keydown&&this.allowDrag(e)){if(n.origin={x:e.clientX,y:e.clientY},n.dragging=!1,this.enableOptimize){for(var r=this.graph,i=r.getEdges(),o=0,a=i.length;o<a;o++){var s=i[o].get("group").get("children");s&&s.forEach(function(g){g.set("ori-visibility",g.get("ori-visibility")||g.get("visible")),g.hide()})}for(var u=r.getNodes(),c=0,l=u.length;c<l;c++)for(var h=0,f=u[c].getContainer().get("children");h<f.length;h++){var d=f[h];d.get("isKeyShape")||(d.set("ori-visibility",d.get("ori-visibility")||d.get("visible")),d.hide())}}if(typeof window<"u"){var p=this;this.handleDOMContextMenu=function(g){return p.onMouseUp(g)},document.body.addEventListener("contextmenu",this.handleDOMContextMenu)}}},onTouchMove:function(e){var n=e.originalEvent.touches,t=n[0],r=n[1];t&&r?this.onMouseUp(e):(e.preventDefault(),this.onDrag(e))},onDrag:function(e){if(this.mousedown){var n=this.graph;if(!this.keydown&&this.allowDrag(e)&&(e=_5(e),this.origin)){if(this.dragging)e.type="drag",n.emit("canvas:drag",e);else{if(C5(this.origin.x-e.clientX)+C5(this.origin.y-e.clientY)<10)return;this.shouldBegin(e,this)&&(e.type="dragstart",n.emit("canvas:dragstart",e),this.originPosition={x:e.clientX,y:e.clientY},this.dragging=!0)}this.shouldUpdate(e,this)&&this.updateViewport(e)}}},onMouseUp:function(e){var n,t;this.mousedown=!1,this.dragstart=!1;var r=this.graph;if(!this.keydown){var i=r.getZoom(),o=r.get("modeController"),a=(t=(n=o==null?void 0:o.modes[o.mode])===null||n===void 0?void 0:n.filter(function(b){return b.type==="zoom-canvas"}))===null||t===void 0?void 0:t[0],s=a?a.optimizeZoom||.1:0;if(this.enableOptimize){for(var u=r.getEdges(),c=0,l=u.length;c<l;c++){var h=u[c].get("group").get("children");h&&h.forEach(function(b){var x=b.get("ori-visibility");b.set("ori-visibility",void 0),x&&b.show()})}if(i>s)for(var f=r.getNodes(),d=0,p=f.length;d<p;d++)for(var g=0,v=f[d].getContainer().get("children");g<v.length;g++){var m=v[g];if(!m.get("isKeyShape")){var y=m.get("ori-visibility");m.set("ori-visibility",void 0),y&&m.show()}}}this.dragging?(e=_5(e),this.shouldEnd(e,this)&&this.updateViewport(e),e.type="dragend",e.dx=e.clientX-this.originPosition.x,e.dy=e.clientY-this.originPosition.y,r.emit("canvas:dragend",e),this.endDrag(),typeof window<"u"&&document.body.removeEventListener("contextmenu",this.handleDOMContextMenu)):this.origin=null}},endDrag:function(){this.origin=null,this.dragging=!1,this.dragbegin=!1,this.mousedown=!1,this.dragstart=!1},onKeyDown:function(e){var n=e.key;n&&(aH.indexOf(n.toLowerCase())>-1?this.keydown=!0:this.keydown=!1)},onKeyUp:function(){this.keydown=!1,this.origin=null,this.dragging=!1,this.dragbegin=!1},allowDrag:function(e){var n,t,r=e.target,i=r&&r.isCanvas&&r.isCanvas();if(hc(this.allowDragOnItem)&&!this.allowDragOnItem&&!i)return!1;if(tr(this.allowDragOnItem)){var o=this.allowDragOnItem,a=o.node,s=o.edge,u=o.combo,c=(t=(n=e.item)===null||n===void 0?void 0:n.getType)===null||t===void 0?void 0:t.call(n);if(!a&&c==="node"||!s&&c==="edge"||!u&&c==="combo")return!1}return!0}},uH={getDefaultCfg:function(){return{updateEdge:!0,delegateStyle:{},enableDelegate:!1,onlyChangeComboSize:!1,comboActiveState:"",selectedState:"selected",enableOptimize:!1,enableDebounce:!1,enableStack:!0}},getEvents:function(){return{"node:mousedown":"onMouseDown",drag:"onDragMove",dragend:"onDragEnd","combo:dragenter":"onDragEnter","combo:dragleave":"onDragLeave","combo:drop":"onDropCombo","node:drop":"onDropNode","canvas:drop":"onDropCanvas",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onDragEnd",afterchangedata:"onDragEnd"}},validationCombo:function(e){return!(!this.origin||!e||e.destroyed)&&e.getType()==="combo"},onTouchStart:function(e){if(e.item){try{var n=e.originalEvent.touches,t=n[0],r=n[1];if(t&&r)return;e.preventDefault()}catch{}this.mousedown={item:e.item,target:e.target,origin:{x:e.x,y:e.y}},this.dragstart=!0,this.onDragStart(e)}},onTouchMove:function(e){try{var n=e.originalEvent.touches,t=n[0],r=n[1];if(t&&r)return void this.onDragEnd(e);e.preventDefault()}catch{}this.onDrag(e)},onMouseDown:function(e){this.mousedown={item:e.item,target:e.target,origin:{x:e.x,y:e.y}},typeof window>"u"||this.windowEventBinded||(this.windowEventBinded=!0,document.body.addEventListener("contextmenu",this.onDragEnd.bind(this)),document.body.addEventListener("mouseup",this.onDragEnd.bind(this)))},onDragMove:function(e){var n,t;((t=(n=e.item)===null||n===void 0?void 0:n.getType)===null||t===void 0?void 0:t.call(n))==="node"?this.mousedown&&(this.dragstart?this.onDrag(F(F({},e),this.mousedown)):(this.dragstart=!0,this.onDragStart(e))):this.onDragEnd()},onDragStart:function(e){var n=this;if(this.currentShouldEnd=!0,this.shouldBegin(F(F({},e),this.mousedown),this)){var t=this.mousedown,r=t.item,i=t.target;if(r&&!r.destroyed&&!r.hasLocked()){if(r.getContainer().set("capture",!1),this.cachedCaptureItems||(this.cachedCaptureItems=[]),this.cachedCaptureItems.push(r),i&&i.get("isAnchorPoint"))return;var o=this.graph;this.targets=[],this.targetCombo=null;var a=o.findAllByState("node",this.selectedState),s=r.get("id");if(a.filter(function(c){var l=c.get("id");return s===l}).length===0?this.targets.push(r):a.length>1?a.forEach(function(c){c.hasLocked()||n.targets.push(c)}):this.targets.push(r),this.graph.get("enabledStack")&&this.enableStack){var u=[];this.targets.forEach(function(c){var l=c.getModel(),h=l.x,f=l.y,d=l.id;u.push({x:h,y:f,id:d})}),this.set("beforeDragNodes",u)}this.hidenEdge={},this.get("updateEdge")&&this.enableOptimize&&!this.enableDelegate&&this.targets.forEach(function(c){c.getEdges().forEach(function(l){l.isVisible()&&(n.hidenEdge[l.getID()]=!0,l.hide())})}),this.origin=this.mousedown.origin,this.point={},this.originPoint={}}}},onDrag:function(e){var n=this;if(this.mousedown&&this.origin&&this.shouldUpdate(e,this))if(this.get("enableDelegate"))this.updateDelegate(e);else if(this.enableDebounce)this.debounceUpdate({targets:this.targets,graph:this.graph,point:this.point,origin:this.origin,evt:e,updateEdge:this.get("updateEdge"),onlyChangeComboSize:this.onlyChangeComboSize,updateParentCombos:this.updateParentCombos});else{var t={};this.targets.map(function(r){n.update(r,e);var i=r.getModel().comboId;i&&(t[i]=n.graph.findById(i))}),this.onlyChangeComboSize&&this.updateParentCombos()}},onDragEnd:function(e){var n,t=this;if(this.mousedown=!1,this.dragstart=!1,typeof window<"u"&&this.windowEventBinded&&(this.windowEventBinded=!1,document.body.removeEventListener("contextmenu",this.onDragEnd.bind(this)),document.body.removeEventListener("mouseup",this.onDragEnd.bind(this))),this.origin){(n=this.cachedCaptureItems)===null||n===void 0||n.forEach(function(o){o.getContainer().set("capture",!0)}),this.cachedCaptureItems=[],this.delegateRect&&(this.delegateRect.remove(),this.delegateRect=null),this.get("updateEdge")&&this.enableOptimize&&!this.enableDelegate&&this.targets.forEach(function(o){o.getEdges().forEach(function(a){t.hidenEdge[a.getID()]&&a.show(),a.refresh()})}),this.hidenEdge={};var r=this.graph;if(r.get("enabledStack")&&this.enableStack){var i={before:{nodes:[],edges:[],combos:[]},after:{nodes:[],edges:[],combos:[]}};this.get("beforeDragNodes").forEach(function(o){i.before.nodes.push(o)}),this.targets.forEach(function(o){var a=o.getModel(),s=a.x,u=a.y,c=a.id;i.after.nodes.push({x:s,y:u,id:c})}),r.pushStack("update",Kt(i))}r.emit("dragnodeend",{items:this.targets,targetItem:null}),this.point={},this.origin=null,this.originPoint={},this.targets.length=0,this.targetCombo=null}},onDropCombo:function(e){var n=e.item;if(this.currentShouldEnd=this.shouldEnd(e,n,this),this.updatePositions(e,!this.currentShouldEnd),this.currentShouldEnd&&this.validationCombo(n)){var t=this.graph;if(this.comboActiveState&&t.setItemState(n,this.comboActiveState,!1),this.targetCombo=n,this.onlyChangeComboSize)t.updateCombos();else{var r=n.getModel();this.targets.map(function(i){i.getModel().comboId!==r.id&&t.updateComboTree(i,r.id)}),t.updateCombo(n)}t.emit("dragnodeend",{items:this.targets,targetItem:this.targetCombo})}},onDropCanvas:function(e){var n=this.graph;this.currentShouldEnd=this.shouldEnd(e,void 0,this),this.updatePositions(e,!this.currentShouldEnd),this.targets&&this.targets.length!==0&&this.currentShouldEnd&&(this.onlyChangeComboSize?this.updateParentCombos():this.targets.map(function(t){t.getModel().comboId&&n.updateComboTree(t)}))},onDropNode:function(e){if(this.targets&&this.targets.length!==0){var n=this,t=e.item,r=n.graph,i=t.getModel().comboId,o=i?r.findById(i):void 0;if(this.currentShouldEnd=this.shouldEnd(e,o,this),this.updatePositions(e,!this.currentShouldEnd),this.currentShouldEnd){if(this.onlyChangeComboSize)this.updateParentCombos();else if(i){var a=r.findById(i);n.comboActiveState&&r.setItemState(a,n.comboActiveState,!1),this.targets.map(function(s){var u=s.getModel();i!==u.comboId&&r.updateComboTree(s,i)}),r.updateCombo(a)}else this.targets.map(function(s){s.getModel().comboId&&r.updateComboTree(s)});r.emit("dragnodeend",{items:this.targets,targetItem:t})}}},onDragEnter:function(e){var n=e.item;if(this.validationCombo(n)){var t=this.graph;this.comboActiveState&&t.setItemState(n,this.comboActiveState,!0)}},onDragLeave:function(e){var n=e.item;if(this.validationCombo(n)){var t=this.graph;this.comboActiveState&&t.setItemState(n,this.comboActiveState,!1)}},updatePositions:function(e,n){var t=this;this.targets&&this.targets.length!==0&&(this.get("enableDelegate")?this.enableDebounce?this.debounceUpdate({targets:this.targets,graph:this.graph,point:this.point,origin:this.origin,evt:e,updateEdge:this.get("updateEdge"),onlyChangeComboSize:this.onlyChangeComboSize,updateParentCombos:this.updateParentCombos}):n||this.targets.map(function(r){return t.update(r,e)}):this.targets.map(function(r){return t.update(r,e,n)}))},update:function(e,n,t){var r=this.origin,i=e.get("model"),o=e.get("id");this.point[o]||(this.point[o]={x:i.x||0,y:i.y||0});var a=n.x-r.x+this.point[o].x,s=n.y-r.y+this.point[o].y;t&&(a+=r.x-n.x,s+=r.y-n.y);var u={x:a,y:s};this.get("updateEdge")?this.graph.updateItem(e,u,!1):e.updatePosition(u)},debounceUpdate:fc(function(e){var n=e.targets,t=e.graph,r=e.point,i=e.origin,o=e.evt,a=e.updateEdge,s=e.onlyChangeComboSize,u=e.updateParentCombos;n.map(function(c){var l=c.get("model"),h=c.get("id");r[h]||(r[h]={x:l.x||0,y:l.y||0});var f={x:o.x-i.x+r[h].x,y:o.y-i.y+r[h].y};a?t.updateItem(c,f,!1):c.updatePosition(f)}),s&&u(t,n)},50,!0),updateDelegate:function(e){var n=this.graph;if(this.delegateRect){var t=e.x-this.origin.x+this.originPoint.minX,r=e.y-this.origin.y+this.originPoint.minY;this.delegateRect.attr({x:t,y:r})}else{var i=n.get("group"),o=fn({},is.delegateStyle,this.delegateStyle),a=this.calculationGroupPosition(e),s=a.x,u=a.y,c=a.width,l=a.height,h=a.minX,f=a.minY;this.originPoint={x:s,y:u,width:c,height:l,minX:h,minY:f},this.delegateRect=i.addShape("rect",{attrs:F({width:c,height:l,x:s,y:u},o),name:"rect-delegate-shape"}),this.delegate=this.delegateRect,this.delegateRect.set("capture",!1)}},calculationGroupPosition:function(e){var n=this.targets;n.length===0&&n.push(e.item);for(var t=1/0,r=-1/0,i=1/0,o=-1/0,a=0;a<n.length;a++){var s=n[a].getBBox(),u=s.minX,c=s.minY,l=s.maxX,h=s.maxY;u<t&&(t=u),c<i&&(i=c),l>r&&(r=l),h>o&&(o=h)}return{x:Math.floor(t),y:Math.floor(i),width:Math.ceil(r)-Math.floor(t),height:Math.ceil(o)-Math.floor(i),minX:t,minY:i}},updateParentCombos:function(e,n){var t=e||this.graph,r=n||this.targets,i={};r==null||r.forEach(function(o){var a=o.getModel().comboId;a&&(i[a]=t.findById(a))}),Object.values(i).forEach(function(o){o&&t.updateCombo(o)})}};var qp=null;const cH={getDefaultCfg:function(){return{trigger:"mouseenter",activeState:"active",inactiveState:"inactive",resetSelected:!1,shouldClearStatusOnSecond:!1,shouldUpdate:function(){return!0}}},getEvents:function(){return this.get("trigger")==="mouseenter"?{"node:mouseenter":"setAllItemStates","combo:mouseenter":"setAllItemStates","node:mouseleave":"clearActiveState","combo:mouseleave":"clearActiveState"}:{"node:click":"setAllItemStates","combo:click":"setAllItemStates","canvas:click":"clearActiveState","node:touchstart":"setOnTouchStart","combo:touchstart":"setOnTouchStart","canvas:touchstart":"clearOnTouchStart"}},setOnTouchStart:function(e){try{var n=e.originalEvent.touches,t=n[0],r=n[1];if(t&&r)return;e.preventDefault()}catch{}this.setAllItemStates(e)},clearOnTouchStart:function(e){try{var n=e.originalEvent.touches,t=n[0],r=n[1];if(t&&r)return;e.preventDefault()}catch{}this.clearActiveState(e)},setAllItemStates:function(e){clearTimeout(this.timer),this.throttleSetAllItemStates(e,this)},clearActiveState:function(e){var n=this;this.shouldClearStatusOnSecond&&(qp=null),this.timer=setTimeout(function(){n.throttleClearActiveState(e,n)},50)},throttleSetAllItemStates:dc(function(e,n){var t=e.item,r=n.graph;if(r&&!r.destroyed&&(n.item=t,n.shouldUpdate(e.item,{event:e,action:"activate"},n))){var i=n.shouldClearStatusOnSecond,o=t.getModel().id;if(qp===o&&i)return n.throttleClearActiveState(e,n),void(qp=null);for(var a=n.activeState,s=n.inactiveState,u=r.getNodes(),c=r.getCombos(),l=r.getEdges(),h=r.get("vedges"),f=u.length,d=c.length,p=l.length,g=h.length,v=n.inactiveItems||{},m=n.activeItems||{},y=0;y<f;y++){var b=u[y],x=b.getID(),w=b.hasState("selected");n.resetSelected&&w&&r.setItemState(b,"selected",!1),m[x]&&(r.setItemState(b,a,!1),delete m[x]),s&&!v[x]&&(r.setItemState(b,s,!0),v[x]=b)}for(y=0;y<d;y++){var E=c[y],M=E.getID();w=E.hasState("selected"),n.resetSelected&&w&&r.setItemState(E,"selected",!1),m[M]&&(r.setItemState(E,a,!1),delete m[M]),s&&!v[M]&&(r.setItemState(E,s,!0),v[M]=E)}for(y=0;y<p;y++)m[A=(T=l[y]).getID()]&&(r.setItemState(T,a,!1),delete m[A]),s&&!v[A]&&(r.setItemState(T,s,!0),v[A]=T);for(y=0;y<g;y++){var _=h[y],k=_.getID();m[k]&&(r.setItemState(_,a,!1),delete m[k]),s&&!v[k]&&(r.setItemState(_,s,!0),v[k]=_)}if(t&&!t.destroyed){s&&(r.setItemState(t,s,!1),delete v[t.getID()]),m[t.getID()]||(r.setItemState(t,a,!0),m[t.getID()]=t);var S=t.getEdges(),C=S.length;for(y=0;y<C;y++){var T,A=(T=S[y]).getID(),D=void 0,j=(D=T.getSource()===t?T.getTarget():T.getSource()).getID();s&&v[j]&&(r.setItemState(D,s,!1),delete v[j]),m[j]||(r.setItemState(D,a,!0),m[j]=D),v[A]&&(r.setItemState(T,s,!1),delete v[A]),m[A]||(r.setItemState(T,a,!0),m[A]=T),T.toFront()}}n.activeItems=m,n.inactiveItems=v,i&&(qp=t.getModel().id),r.emit("afteractivaterelations",{item:e.item,action:"activate"})}},50,{trailing:!0,leading:!0}),throttleClearActiveState:dc(function(e,n){var t=n.get("graph");if(t&&!t.destroyed&&n.shouldUpdate(e.item,{event:e,action:"deactivate"},n)){var r=n.activeState,i=n.inactiveState,o=n.activeItems||{},a=n.inactiveItems||{};Object.values(o).filter(function(s){return!s.destroyed}).forEach(function(s){t.clearItemStates(s,r)}),Object.values(a).filter(function(s){return!s.destroyed}).forEach(function(s){t.clearItemStates(s,i)}),n.activeItems={},n.inactiveItems={},t.emit("afteractivaterelations",{item:e.item||n.get("item"),action:"deactivate"})}},50,{trailing:!0,leading:!0})};var Zp=Math.min,A5=Math.max,I5=Math.abs,T5="shift",lH=["drag","shift","ctrl","alt","control"];const hH={getDefaultCfg:function(){return{brushStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},selectedState:"selected",trigger:T5,includeEdges:!0,includeCombos:!1,selectOnCombo:!1,selectedEdges:[],selectedNodes:[],selectedCombos:[]}},getEvents:function(){return lH.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=T5),this.trigger==="drag"?{dragstart:"onMouseDown",drag:"onMouseMove",dragend:"onMouseUp","canvas:click":"clearStates"}:{dragstart:"onMouseDown",drag:"onMouseMove",dragend:"onMouseUp","canvas:click":"clearStates",keyup:"onKeyUp",keydown:"onKeyDown"}},onMouseDown:function(e){var n=e.item,t=this.brush,r=this.selectOnCombo,i=(n==null?void 0:n.getType())==="combo";i&&!r||!i&&n||(this.trigger==="drag"||this.keydown)&&(this.selectedNodes&&this.selectedNodes.length!==0&&this.clearStates(),t||(t=this.createBrush()),this.originPoint={x:e.canvasX,y:e.canvasY},t.attr({width:0,height:0}),t.show(),this.dragging=!0)},onMouseMove:function(e){this.dragging&&(this.trigger==="drag"||this.keydown)&&this.updateBrush(e)},onMouseUp:function(e){this.graph,(this.brush||this.dragging)&&(this.trigger==="drag"||this.keydown)&&(this.brush.remove(!0),this.brush=null,this.getSelectedNodes(e),this.dragging=!1)},clearStates:function(){var e=this.graph,n=this.selectedState,t=e.findAllByState("node",n),r=e.findAllByState("edge",n),i=e.findAllByState("combo",n);t.forEach(function(o){return e.setItemState(o,n,!1)}),r.forEach(function(o){return e.setItemState(o,n,!1)}),i.forEach(function(o){return e.setItemState(o,n,!1)}),this.selectedNodes=[],this.selectedEdges=[],this.selectedCombos=[],this.onDeselect&&this.onDeselect(this.selectedNodes,this.selectedEdges,this.selectedCombos),e.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[],combos:[]},select:!1})},isBBoxCenterInRect:function(e,n,t,r,i){var o=e.getBBox();return o.centerX>=n&&o.centerX<=t&&o.centerY>=r&&o.centerY<=i},getSelectedNodes:function(e){var n=this,t=this,r=t.graph,i=t.originPoint,o=t.shouldUpdate,a=t.isBBoxCenterInRect,s=this.selectedState,u={x:e.x,y:e.y},c=r.getPointByCanvas(i.x,i.y),l=Zp(u.x,c.x),h=A5(u.x,c.x),f=Zp(u.y,c.y),d=A5(u.y,c.y),p=[],g=[];r.getNodes().forEach(function(y){if(y.isVisible()&&a(y,l,h,f,d)&&o(y,"select",n)){p.push(y);var b=y.getModel();g.push(b.id),r.setItemState(y,s,!0)}});var v=[];this.includeEdges&&p.forEach(function(y){y.getOutEdges().forEach(function(b){if(b.isVisible()){var x=b.getModel(),w=x.source,E=x.target;g.includes(w)&&g.includes(E)&&o(b,"select",n)&&(v.push(b),r.setItemState(b,n.selectedState,!0))}})});var m=[];this.includeCombos&&r.getCombos().forEach(function(y){if(y.isVisible()&&a(y,l,h,f,d)&&o(y,"select",n)){m.push(y);var b=y.getModel();g.push(b.id),r.setItemState(y,s,!0)}}),this.selectedEdges=v,this.selectedNodes=p,this.selectedCombos=m,this.onSelect&&this.onSelect(p,v,m),r.emit("nodeselectchange",{selectedItems:{nodes:p,edges:v,combos:m},select:!0})},createBrush:function(){var e=this.graph.get("canvas").addShape("rect",{attrs:this.brushStyle,capture:!1,name:"brush-shape"});return this.brush=e,this.delegate=e,e},updateBrush:function(e){var n=this.originPoint;this.brush.attr({width:I5(e.canvasX-n.x),height:I5(e.canvasY-n.y),x:Zp(e.canvasX,n.x),y:Zp(e.canvasY,n.y)})},onKeyDown:function(e){var n=e.key;if(n){var t=this.trigger.toLowerCase(),r=n.toLowerCase();this.keydown=r===t||r==="control"&&t==="ctrl"||r==="ctrl"&&t==="control"}},onKeyUp:function(){this.brush&&(this.brush.remove(!0),this.brush=null,this.dragging=!1),this.keydown=!1}};var O5="shift",fH=["shift","ctrl","alt","control"];const dH={getDefaultCfg:function(){return{multiple:!0,trigger:O5,selectedState:"selected",selectNode:!0,selectEdge:!1,selectCombo:!0}},getEvents:function(){var e=this;return fH.indexOf(e.trigger.toLowerCase())>-1||(e.trigger=O5),e.multiple?{"node:click":"onClick","combo:click":"onClick","edge:click":"onClick","canvas:click":"onCanvasClick",keyup:"onKeyUp",keydown:"onKeyDown"}:{"node:click":"onClick","combo:click":"onClick","edge:click":"onClick","canvas:click":"onCanvasClick"}},onClick:function(e){var n=this,t=e.item;if(t&&!t.destroyed){var r=t.getType(),i=n.graph,o=n.keydown,a=n.multiple,s=n.shouldUpdate;if((0,n.shouldBegin)(e,n))if((!o||!a)&&ye(i.findAllByState("node",n.selectedState).concat(i.findAllByState("edge",n.selectedState)).concat(i.findAllByState("combo",n.selectedState)),function(h){h!==t&&i.setItemState(h,n.selectedState,!1)}),function(){switch(r){case"node":return n.selectNode;case"edge":return n.selectEdge;case"combo":return n.selectCombo;default:return!1}}())t.hasState(n.selectedState)?(s(e,n)&&i.setItemState(t,n.selectedState,!1),u=i.findAllByState("node",n.selectedState),c=i.findAllByState("edge",n.selectedState),l=i.findAllByState("combo",n.selectedState),i.emit("nodeselectchange",{target:t,selectedItems:{nodes:u,edges:c,combos:l},select:!1})):(s(e,n)&&i.setItemState(t,n.selectedState,!0),u=i.findAllByState("node",n.selectedState),c=i.findAllByState("edge",n.selectedState),l=i.findAllByState("combo",n.selectedState),i.emit("nodeselectchange",{target:t,selectedItems:{nodes:u,edges:c,combos:l},select:!0}));else{var u=i.findAllByState("node",n.selectedState),c=i.findAllByState("edge",n.selectedState),l=i.findAllByState("combo",n.selectedState);i.emit("nodeselectchange",{selectedItems:{nodes:u,edges:c,combos:l},select:!1})}}},onCanvasClick:function(e){var n=this,t=this.graph;(0,this.shouldBegin)(e,this)&&(ye(t.findAllByState("node",this.selectedState),function(r){t.setItemState(r,n.selectedState,!1)}),ye(t.findAllByState("edge",this.selectedState),function(r){t.setItemState(r,n.selectedState,!1)}),ye(t.findAllByState("combo",this.selectedState),function(r){t.setItemState(r,n.selectedState,!1)}),t.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[],combos:[]},select:!1}))},onKeyDown:function(e){var n=e.key;n&&(n.toLowerCase()===this.trigger.toLowerCase()||n.toLowerCase()==="control"?this.keydown=!0:this.keydown=!1)},onKeyUp:function(){this.keydown=!1}};var pH=Qr,Kp=.05;const gH={getDefaultCfg:function(){return this.isFireFox=fO()==="firefox",{sensitivity:2,minZoom:void 0,maxZoom:void 0,enableOptimize:!1,optimizeZoom:.1,fixSelectedItems:{fixAll:!1,fixLineWidth:!1,fixLabel:!1,fixState:"selected"},animate:!1,animateCfg:{duration:500}}},getEvents:function(){var e=this.fixSelectedItems;return e.fixState||(e.fixState="selected"),e.fixAll&&(e.fixLineWidth=!0,e.fixLabel=!0),{wheel:"onWheel",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd"}},onTouchStart:function(e){var n=e.originalEvent.touches,t=n[0],r=n[1];e.preventDefault(),r&&(this.shouldBegin&&!this.shouldBegin(e,this)||(this.startPoint={pageX:t.pageX,pageY:t.pageY},this.moveable=!0,r&&(this.endPoint={pageX:r.pageX,pageY:r.pageY}),this.originScale=this.graph.getZoom()||this.currentScale||1))},onTouchMove:function(e){if(this.moveable){e.preventDefault();var n=e.originalEvent.touches,t=n[0],r=n[1];if(r){this.endPoint||(this.endPoint={pageX:r.pageX,pageY:r.pageY});var i=function(h,f){return Math.hypot(f.x-h.x,f.y-h.y)},o=i({x:t.pageX,y:t.pageY},{x:r.pageX,y:r.pageY})/i({x:this.startPoint.pageX,y:this.startPoint.pageY},{x:this.endPoint.pageX,y:this.endPoint.pageY}),a=this.originScale*o;this.currentScale=a;var s=this.get("minZoom")||this.graph.get("minZoom");if(!(a>(this.get("maxZoom")||this.graph.get("maxZoom"))||a<s)){var u=this.get("animate"),c=this.get("animateCfg"),l=this.graph.get("canvas").getPointByClient(e.clientX,e.clientY);this.graph.zoomTo(a,{x:l.x,y:l.y},u,c),this.graph.emit("wheelzoom",e)}}}},onTouchEnd:function(){this.moveable=!1,this.endPoint=null},onWheel:function(e){var n=this,t=this.graph,r=this.fixSelectedItems;if((!this.shouldBegin||this.shouldBegin(e,this))&&this.shouldUpdate(e,this)){e.preventDefault();var i=t.get("canvas").getPointByClient(e.clientX,e.clientY),o=this.get("sensitivity"),a=t.getZoom(),s=a;s=a*(this.isFireFox?e.deltaY>0||e.wheelDelta<0?1-Kp*o:1/(1-Kp*o):e.wheelDelta<0?1-Kp*o:1/(1-Kp*o));var u=this.get("minZoom")||t.get("minZoom"),c=this.get("maxZoom")||t.get("maxZoom");if(s>c?s=c:s<u&&(s=u),this.get("enableOptimize")){var l=this.get("optimizeZoom"),h=this.get("optimized"),f=t.getNodes(),d=t.getEdges(),p=f.length,g=d.length;if(!h){for(var v=0;v<p;v++)if(!(S=f[v]).destroyed)for(var m=(at=S.get("group").get("children")).length,y=0;y<m;y++)(P=at[y]).destoryed||P.get("isKeyShape")||(P.set("ori-visibility",P.get("ori-visibility")||P.get("visible")),P.hide());for(var b=0;b<g;b++)for(m=(at=(It=d[b]).get("group").get("children")).length,y=0;y<m;y++)(P=at[y]).set("ori-visibility",P.get("ori-visibility")||P.get("visible")),P.hide();this.set("optimized",!0)}clearTimeout(this.get("timeout"));var x=setTimeout(function(){var Xe=t.getZoom();if(n.get("optimized")){n.set("optimized",!1);for(var Oe=0;Oe<p;Oe++){var Se=f[Oe],We=(_e=Se.get("group").get("children")).length;if(Xe<l){var Ve=(Je=Se.getKeyShape()).get("ori-visibility");Je.set("ori-visibility",void 0),Ve&&Je.show()}else for(var O=0;O<We;O++)Ve=(qe=_e[O]).get("ori-visibility"),qe.set("ori-visibility",void 0),!qe.get("visible")&&Ve&&Ve&&qe.show()}for(var he=0;he<g;he++){var _e,Ze=d[he];if(We=(_e=Ze.get("group").get("children")).length,Xe<l){var Je;Ve=(Je=Ze.getKeyShape()).get("ori-visibility"),Je.set("ori-visibility",void 0),Ve&&Je.show()}else for(O=0;O<We;O++){var qe;(qe=_e[O]).get("visible")||(Ve=qe.get("ori-visibility"),qe.set("ori-visibility",void 0),Ve&&qe.show())}}}},100);this.set("timeout",x)}if(a<=1){var w=void 0,E=void 0;if(r.fixAll||r.fixLineWidth||r.fixLabel){w=t.findAllByState("node",r.fixState),E=t.findAllByState("edge",r.fixState);for(var M=a/s,_=w.length,k=0;k<_;k++){var S,C=(S=w[k]).getContainer(),T=S.getModel(),A=S.getOriginStyle(),D=S.getStateStyle(r.fixState),j=S.get("shapeFactory").getShape(T.type).getStateStyle(r.fixState,S)[r.fixState];if(r.fixAll){if(s<=1){var L=Kt(C.getMatrix());L||(L=[1,0,0,0,1,0,0,0,1]);var B=S.getModel(),N=B.x,R=B.y;L=pH(L,[["t",-N,-R],["s",M,M],["t",N,R]]),C.setMatrix(L)}}else for(m=(at=C.get("children")).length,y=0;y<m;y++){var P=at[y],H=void 0,ne=void 0;if(r.fixLabel&&P.get("type")==="text"){H=P.attr("fontSize")||12;var Z=D[P.get("name")],q=j[P.get("name")],te=Z?Z.fontSize:12,we=q?q.fontSize:12,pe=te||we||12;if(s<=1&&P.attr("fontSize",pe/s),ne)break}if(r.fixLineWidth&&P.get("isKeyShape")){ne=P.attr("lineWidth")||0;var Me=D.lineWidth||j.lineWidth||A.lineWidth||0;if(s<=1&&P.attr("lineWidth",Me/s),H)break}}}for(var Be=E.length,dt=0;dt<Be;dt++){var It,at=(C=(It=E[dt]).getContainer()).get("children");for(T=It.getModel(),D=It.getStateStyle(r.fixState),j=It.get("shapeFactory").getShape(T.type).getStateStyle(r.fixState,It)[r.fixState],m=at.length,y=0;y<m&&(P=at[y],H=void 0,ne=void 0,!((r.fixLabel||r.fixAll)&&P.get("type")==="text"&&(H=P.attr("fontSize")||12,Z=D[P.get("name")],q=j[P.get("name")],te=Z?Z.fontSize:12,we=q?q.fontSize:12,pe=te||we||12,s<=1&&P.attr("fontSize",pe/s),ne)||(r.fixLineWidth||r.fixAll)&&P.get("isKeyShape")&&(ne=P.attr("lineWidth")||0,Me=D.lineWidth||j.lineWidth||1,s<=1&&P.attr("lineWidth",Me/s),H)));y++);}}}var Ue=this.get("animate"),Te=this.get("animateCfg");t.zoomTo(s,{x:i.x,y:i.y},Ue,Te),t.emit("wheelzoom",e)}}},N5={onMouseEnter:function(e){var n=e.item;this.currentTarget=n,this.showTooltip(e),this.graph.emit("tooltipchange",{item:e.item,action:"show"})},onMouseMove:function(e){this.shouldUpdate(e,this)?this.currentTarget&&e.item===this.currentTarget&&this.updatePosition(e):this.hideTooltip()},onMouseLeave:function(e){this.shouldEnd(e,this)&&(this.hideTooltip(),this.graph.emit("tooltipchange",{item:this.currentTarget,action:"hide"}),this.currentTarget=null)},showTooltip:function(e){var n=this.container;if(e.item&&!e.item.destroyed){n||(n=this.createTooltip(this.graph.get("canvas")),this.container=n);var t=this.formatText(e.item.get("model"),e);n.innerHTML=t,qt(this.container,{visibility:"visible"}),this.updatePosition(e)}},hideTooltip:function(){qt(this.container,{visibility:"hidden"})},updatePosition:function(e){var n=this.get("shouldBegin"),t=this,r=t.width,i=t.height,o=t.container,a=t.graph;if(n(e,this)){var s=a.getPointByClient(e.clientX,e.clientY),u=a.getCanvasByPoint(s.x,s.y),c=u.x,l=u.y,h=o.getBoundingClientRect();c>r/2?c-=h.width:c+=this.offset,l>i/2?l-=h.height:l+=this.offset;var f="".concat(c,"px"),d="".concat(l,"px");qt(this.container,{left:f,top:d,visibility:"visible"})}else qt(o,{visibility:"hidden"})},createTooltip:function(e){var n=e.get("el");n.style.position="relative";var t=gn('<div class="g6-tooltip g6-'.concat(this.item,'-tooltip"></div>'));return n.parentNode.appendChild(t),qt(t,{position:"absolute",visibility:"visible"}),this.width=e.get("width"),this.height=e.get("height"),this.container=t,this.graph.get("tooltips").push(t),t}},vH=F({getDefaultCfg:function(){return{item:"node",offset:12,formatText:function(e){return e.label}}},getEvents:function(){return{"node:mouseenter":"onMouseEnter","node:mouseleave":"onMouseLeave","node:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave"}}},N5),mH=F({getDefaultCfg:function(){return{item:"edge",offset:12,formatText:function(e){return"source: ".concat(e.source," target: ").concat(e.target)}}},getEvents:function(){return{"edge:mouseenter":"onMouseEnter","edge:mouseleave":"onMouseLeave","edge:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave"}}},N5);var D5="click",yH=["click","dblclick"];const bH={getDefaultCfg:function(){return{trigger:D5,onChange:function(){}}},getEvents:function(){var e,n;return n=yH.includes(this.trigger)?this.trigger:D5,(e={})["node:".concat(n)]="onNodeClick",e.touchstart="onNodeClick",e},onNodeClick:function(e){var n=this;if(this.trigger==="click"){if(this.timer)return clearTimeout(this.timer),void(this.timer=0);this.timer=setTimeout(function(){n.toggle(e),clearTimeout(n.timer),n.timer=0},200)}else this.toggle(e)},toggle:function(e){var n=e.item;if(n){var t=this.graph.findDataById(n.get("id"));if(t){var r=t.children;if(r&&r.length!==0){var i=!t.collapsed;this.shouldBegin(e,i,this)&&(t.collapsed=i,n.getModel().collapsed=i,this.graph.emit("itemcollapsed",{item:e.item,collapsed:i}),this.shouldUpdate(e,i,this)&&(this.onChange(n,i,this),this.graph.layout()))}}}}};var xH=Ro.calculationItemsBBox,wH=function e(n,t){if(t(n)!==!1&&n){var r=n.get("combos");if(r.length===0)return!1;ye(r,function(i){e(i,t)})}};const EH={getDefaultCfg:function(){return{enableDelegate:!1,delegateStyle:{},onlyChangeComboSize:!1,activeState:"",selectedState:"selected",enableStack:!0}},getEvents:function(){return{"combo:mousedown":"onMouseDown","combo:dragstart":"onDragStart","combo:drag":"onDrag","combo:dragend":"onDragEnd","combo:drop":"onDrop","node:drop":"onNodeDrop","combo:dragenter":"onDragEnter","combo:dragleave":"onDragLeave"}},validationCombo:function(e){var n=e.item;return!(!n||n.destroyed)&&!!this.shouldUpdate(e,this)&&n.getType()==="combo"},onMouseDown:function(e){this.origin={x:e.x,y:e.y}},onDragStart:function(e){var n=this,t=this.graph,r=e.item;if(this.currentShouldEnd=!0,this.validationCombo(e)){this.targets=[];var i=t.findAllByState("combo",this.selectedState),o=r.get("id");i.filter(function(s){var u=s.get("id");return o===u}).length===0?this.targets.push(r):this.targets=i;var a=[];this.targets.forEach(function(s){var u=s.getModel(),c=u.x,l=u.y,h=u.id;a.push({x:c,y:l,id:h})}),this.set("beforeDragItems",a),this.activeState&&this.targets.map(function(s){var u=s.getModel();if(u.parentId){var c=t.findById(u.parentId);c&&t.setItemState(c,n.activeState,!0)}}),this.point={},this.originPoint={},this.currentItemChildCombos=[],wH(r,function(s){if(s.destroyed)return!1;var u=s.getModel();return n.currentItemChildCombos.push(u.id),!0})}},onDrag:function(e){var n=this;if(this.origin&&this.validationCombo(e))if(this.enableDelegate)this.updateDelegate(e);else{if(this.activeState){var t=this.graph,r=e.item,i=r.getModel(),o=t.getCombos(),a=r.getBBox(),s=a.centerX,u=a.centerY,c=a.width;o.filter(function(l){var h=l.getModel();return i.parentId,h.id!==i.id&&!n.currentItemChildCombos.includes(h.id)}).map(function(l){var h=l.getBBox(),f=h.centerX,d=h.centerY,p=h.width,g=s-f,v=u-d,m=2*Math.sqrt(g*g+v*v);c+p-m>.8*c?t.setItemState(l,n.activeState,!0):t.setItemState(l,n.activeState,!1)})}ye(this.targets,function(l){n.updateCombo(l,e)}),this.onlyChangeComboSize&&this.updateParentCombos()}},updatePositions:function(e,n){var t=this;(this.enableDelegate||n)&&ye(this.targets,function(r){t.updateCombo(r,e,n)})},onDrop:function(e){var n=this,t=e.item;if(this.currentShouldEnd=this.shouldEnd(e,t,this),this.updatePositions(e,!this.currentShouldEnd),this.currentShouldEnd&&t&&this.targets&&!t.destroyed){var r=this.graph,i=t.getModel();this.targets.map(function(o){o.getModel().parentId!==i.id?(n.activeState&&r.setItemState(t,n.activeState,!1),n.onlyChangeComboSize?r.updateCombo(o):r.updateComboTree(o,i.id,!1)):r.updateCombo(t)}),this.end(t,e),this.endComparison=!0}},onNodeDrop:function(e){var n=this;if(this.targets&&this.targets.length!==0){var t=this.graph,r=e.item.getModel().comboId,i=r?t.findById(r):void 0;if(this.currentShouldEnd=this.shouldEnd(e,i,this),this.updatePositions(e,!this.currentShouldEnd),this.currentShouldEnd){var o;if(r){if(this.activeState){var a=t.findById(r);t.setItemState(a,this.activeState,!1)}this.targets.map(function(s){n.onlyChangeComboSize?t.updateCombo(s):r!==s.getID()&&(o=t.findById(r),r!==s.getModel().parentId&&t.updateComboTree(s,r,!1))})}else this.targets.map(function(s){n.onlyChangeComboSize?t.updateCombo(s):s.getModel().comboId&&t.updateComboTree(s,void 0,!1)});this.endComparison=!0,this.end(o,e)}}},onDragEnter:function(e){if(this.origin&&this.validationCombo(e)){var n=e.item,t=this.graph;this.activeState&&t.setItemState(n,this.activeState,!0)}},onDragLeave:function(e){if(this.origin&&this.validationCombo(e)){var n=e.item,t=this.graph;this.activeState&&t.setItemState(n,this.activeState,!1)}},onDragEnd:function(e){if(this.targets&&this.targets.length!==0){var n=e.item;this.currentShouldEnd&&this.updatePositions(e);var t=this.getParentCombo(n.getModel().parentId),r=this.graph;t&&this.activeState&&r.setItemState(t,this.activeState,!1),this.end(void 0,e)}},end:function(e,n){var t=this;if(this.origin){var r=this.graph;if(this.delegateShape&&(r.get("delegateGroup").clear(),this.delegateShape=null),e&&this.activeState&&r.setItemState(e,this.activeState,!1),!e){var i=r.get("enabledStack")&&this.enableStack,o={before:{nodes:[],edges:[],combos:[].concat(this.get("beforeDragItems"))},after:{nodes:[],edges:[],combos:[]}};this.targets.map(function(a){if(t.onlyChangeComboSize){r.updateCombo(a);var s=a.getModel(),u=s.x,c=s.y,l=s.id;o.after.combos.push({x:u,y:c,id:l}),r.pushStack("update",o)}else r.updateComboTree(a,void 0,i)})}this.point=[],this.origin=null,this.originPoint=null,this.targets.length=0}},traverse:function(e,n,t){var r=this;t===void 0&&(t={}),n(e,t)!==!1&&e&&(ye(e.get("combos"),function(i){r.traverse(i,n,t)}),ye(e.get("nodes"),function(i){r.traverse(i,n,t)}))},updateCombo:function(e,n,t){this.updateSingleItem(e,n,t);var r={};this.traverse(e,function(i,o){return!i.destroyed&&(i.getEdges().forEach(function(a){return o[a.getID()]=a}),!0)},r),Object.values(r).forEach(function(i){return i.refresh()})},updateSingleItem:function(e,n,t){var r=this.origin,i=this.graph,o=e.getModel(),a=e.get("id");this.point[a]||(this.point[a]={x:o.x,y:o.y});var s=n.x-r.x+this.point[a].x,u=n.y-r.y+this.point[a].y;t&&(s+=r.x-n.x,u+=r.y-n.y),i.updateItem(e,{x:s,y:u},!1)},getParentCombo:function(e){var n=this.graph;if(e){var t=n.findById(e);if(t)return t}},updateDelegate:function(e){var n=this.graph;if(this.delegateShape){var t=e.x-this.origin.x+this.originPoint.minX,r=e.y-this.origin.y+this.originPoint.minY;this.delegateShape.attr({x:t,y:r})}else{var i=n.get("delegateGroup"),o=null,a=(o=this.targets.length>1?xH(this.targets):this.targets[0].getBBox()).x,s=o.y,u=o.width,c=o.height,l=o.minX,h=o.minY;this.originPoint={x:a,y:s,width:u,height:c,minX:l,minY:h};var f=F(F({},is.delegateStyle),this.delegateStyle);this.delegateShape=i.addShape("rect",{attrs:F({width:o.width,height:o.height,x:o.x,y:o.y},f),name:"combo-delegate-shape"}),this.delegateShape.set("capture",!1),this.delegate=this.delegateShape}},updateParentCombos:function(){var e=this.graph,n=this.targets,t={};n==null||n.forEach(function(r){var i=r.getModel().parentId;i&&(t[i]=e.findById(i))}),Object.values(t).forEach(function(r){r&&e.updateCombo(r)})}};var P5="dblclick",MH=["click","dblclick"];const SH={getDefaultCfg:function(){return{trigger:P5,relayout:!0}},getEvents:function(){var e,n;return n=MH.includes(this.trigger)?this.trigger:P5,(e={})["combo:".concat(n)]="onComboClick",e},onComboClick:function(e){var n=e.item,t=this.graph,r=this.relayout;if(n&&!n.destroyed&&n.getType()==="combo"){var i=n.getModel().id;i&&(t.collapseExpandCombo(i),r&&t.get("layout")?t.layout():t.refreshPositions())}}};var _H=Ro.isPolygonsIntersect,kH=Ro.pathToPoints,L5="shift",CH=["drag","shift","ctrl","alt","control"];const AH={getDefaultCfg:function(){return{delegateStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},shouldDeselect:void 0,selectedState:"selected",trigger:L5,includeEdges:!0,selectedEdges:[],selectedNodes:[]}},getEvents:function(){return CH.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=L5),this.trigger==="drag"?{dragstart:"onDragStart",drag:"onDragMove",dragend:"onDragEnd","canvas:click":"clearStates"}:{dragstart:"onDragStart",drag:"onDragMove",dragend:"onDragEnd",keyup:"onKeyUp",keydown:"onKeyDown","canvas:click":"clearStates"}},onDragStart:function(e){var n=this.lasso;e.item||(this.trigger==="drag"||this.keydown)&&(this.selectedNodes&&this.selectedNodes.length!==0&&this.clearStates("dragstart"),n||(n=this.createLasso()),this.dragging=!0,this.originPoint={x:e.x,y:e.y},this.points.push(this.originPoint),n.show())},onDragMove:function(e){this.dragging&&(this.trigger==="drag"||this.keydown)&&(this.points.push({x:e.x,y:e.y}),this.updateLasso(e))},onDragEnd:function(e){(this.lasso||this.dragging)&&(this.trigger==="drag"||this.keydown)&&(this.points.push(this.originPoint),this.getSelectedItems(),this.lasso.remove(!0),this.lasso=null,this.points=[],this.dragging=!1)},getLassoPath:function(){var e=this.points,n=[];return e.length&&(e.forEach(function(t,r){r===0?n.push(["M",t.x,t.y]):n.push(["L",t.x,t.y])}),n.push(["L",e[0].x,e[0].y])),n},clearStates:function(e){e===void 0&&(e="canvas:click");var n=this,t=n.graph,r=n.selectedState,i=n.shouldDeselect,o=t.findAllByState("node",r),a=t.findAllByState("edge",r);i&&!i({action:e,nodes:o,edges:a})||(o.forEach(function(s){return t.setItemState(s,r,!1)}),a.forEach(function(s){return t.setItemState(s,r,!1)})),this.onDeselect&&this.onDeselect(this.selectedNodes,this.selectedEdges),this.selectedNodes=[],this.selectedEdges=[],t.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[]},select:!1})},getSelectedItems:function(){var e=this,n=this.graph,t=this.shouldUpdate,r=this.points.map(function(u){return[n.getCanvasByPoint(u.x,u.y).x,n.getCanvasByPoint(u.x,u.y).y]}),i=this.selectedState,o=[],a=[];n.getNodes().forEach(function(u){if(u.isVisible()&&function(l,h){var f,d=l.getKeyShape();if(l.get("type")==="path")f=kH(d.attr("path"));else{var p=d.getCanvasBBox();f=[[p.minX,p.minY],[p.maxX,p.minY],[p.maxX,p.maxY],[p.minX,p.maxY]]}return _H(h,f)}(u,r)&&t(u,"select",e)){o.push(u);var c=u.getModel();a.push(c.id),n.setItemState(u,i,!0)}});var s=[];this.includeEdges&&o.forEach(function(u){u.getOutEdges().forEach(function(c){if(c.isVisible()){var l=c.getModel(),h=l.source,f=l.target;a.includes(h)&&a.includes(f)&&t(c,"select",e)&&(s.push(c),n.setItemState(c,e.selectedState,!0))}})}),this.selectedEdges=s,this.selectedNodes=o,this.onSelect&&this.onSelect(o,s),n.emit("nodeselectchange",{selectedItems:{nodes:o,edges:s},select:!0})},createLasso:function(){var e=this.graph.get("delegateGroup").addShape("path",{attrs:F({path:[]},this.delegateStyle),capture:!1,name:"lasso-shape"});return this.lasso=e,this.delegate=e,this.points=[],e},updateLasso:function(e){this.lasso.attr({path:this.getLassoPath()})},onKeyDown:function(e){var n=e.key;n&&(n.toLowerCase()===this.trigger.toLowerCase()?this.keydown=!0:this.keydown=!1)},onKeyUp:function(){this.lasso&&(this.lasso.remove(!0),this.lasso=null,this.points=[],this.dragging=!1),this.keydown=!1}};var R5="click",IH=["click","drag"],j5=void 0,TH=["shift","ctrl","control","alt","meta",void 0];const OH={getDefaultCfg:function(){return{trigger:R5,key:j5,edgeConfig:{},getEdgeConfig:void 0}},getEvents:function(){var e,n=this;return IH.indexOf(n.trigger.toLowerCase())>-1||(n.trigger=R5),n.key&&TH.indexOf(n.key.toLowerCase())===-1&&(n.trigger=j5),n.trigger==="drag"?e={"node:dragstart":"onClick","combo:dragstart":"onClick",drag:"updateEndPoint","node:drop":"onClick","combo:drop":"onClick",dragend:"onDragEnd"}:n.trigger==="click"&&(e={"node:click":"onClick",mousemove:"updateEndPoint","edge:click":"cancelCreating","canvas:click":"cancelCreating","combo:click":"onClick"}),n.key&&(e.keydown="onKeyDown",e.keyup="onKeyUp"),e},onDragEnd:function(e){var n=this;if(!n.key||n.keydown){var t=e.item;t&&t.getID()!==n.source&&t.getType()==="node"||n.cancelCreating({item:n.edge,x:e.x,y:e.y})}},onClick:function(e){var n=this;if(!n.key||n.keydown){var t=e.item,r=n.graph,i=t.getModel(),o=n.getEdgeConfig;if(n.addingEdge&&n.edge){if(!n.shouldEnd(e,n))return;var a=void 0;a=o&&mn(o)?o({source:n.source,target:i.id},n):n.edgeConfig;var s=F({target:i.id},a);if(n.source===i.id&&(s.type="loop"),r.emit("beforecreateedge",{}),r.updateItem(n.edge,s,!1),r.get("enabledStack")){var u=F(F({},n.edge.getModel()),{itemType:"edge"}),c={};c.edges=[u],r.pushStack("add",{before:{},after:c})}r.emit("aftercreateedge",{edge:n.edge}),n.edge.getKeyShape().set("capture",!0),n.edge=null,n.addingEdge=!1}else{if(!n.shouldBegin(e,n))return;a=void 0,a=o&&mn(o)?o({source:i.id,target:i.id},n):n.edgeConfig,n.edge=r.addItem("edge",F({source:i.id,target:i.id},a),!1),n.source=i.id,n.addingEdge=!0,n.edge.getKeyShape().set("capture",!1)}}},updateEndPoint:function(e){var n=this;if(!n.key||n.keydown){n.edge&&n.edge.destroyed&&n.cancelCreating({item:n.edge});var t={x:e.x,y:e.y};n.graph.findById(n.source)?n.addingEdge&&n.edge&&n.graph.updateItem(n.edge,{target:t},!1):n.addingEdge=!1}},cancelCreating:function(e){var n,t,r=this;if(!r.key||r.keydown){var i=r.graph,o=e.item;return r.addingEdge&&(r.edge===o||!((t=(n=e.target)===null||n===void 0?void 0:n.isCanvas)===null||t===void 0)&&t.call(n))?(r.edge&&!r.edge.destroyed&&i.removeItem(r.edge,!1),r.edge=null,void(r.addingEdge=!1)):void 0}},onKeyDown:function(e){var n=this,t=e.key;t&&(t.toLowerCase()===n.key.toLowerCase()?n.keydown=!0:n.keydown=!1)},onKeyUp:function(){var e=this;e.addingEdge&&e.edge&&(e.graph.removeItem(e.edge,!1),e.addingEdge=!1,e.edge=null),this.keydown=!1}};var B5="ctrl",NH=["shift","ctrl","alt","control"];const DH={getDefaultCfg:function(){return{trigger:B5,combinedKey:"1",functionName:"fitView",functionParams:[]}},getEvents:function(){return NH.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=B5),this.combinedKey===this.trigger&&(this.combinedKey=void 0),{keyup:"onKeyUp",keydown:"onKeyDown"}},onKeyDown:function(e){var n=e.key;if(n){var t=this.trigger.toLowerCase(),r=n.toLowerCase();this.triggerKeydown||(this.triggerKeydown=r===t||r==="control"&&t==="ctrl"||r==="ctrl"&&t==="control");var i=this.graph;if(!i[this.functionName])return{};if(!this.triggerKeydown||this.combinedKey){var o=this.combinedKey.toLowerCase();this.triggerKeydown&&(r===o||r==="control"&&o==="ctrl"||r==="ctrl"&&o==="control")&&(this.functionParams&&this.functionParams.length?i[this.functionName].apply(i,this.functionParams):i[this.functionName]())}else this.functionParams&&this.functionParams.length?i[this.functionName].apply(i,this.functionParams):i[this.functionName]()}},onKeyUp:function(){this.brush&&(this.brush.remove(!0),this.brush=null,this.dragging=!1),this.triggerKeydown=!1}};var PH=["shift","ctrl","alt","control","meta"];const LH={getDefaultCfg:function(){return{direction:"both",enableOptimize:!1,zoomKey:"ctrl",scalableRange:0,allowDragOnItem:!0}},getEvents:function(){return this.zoomKey&&PH.indexOf(this.zoomKey)!==-1||(this.zoomKey="ctrl"),{wheel:"onWheel"}},onWheel:function(e){var n=this;if(this.allowDrag(e)){var t=this.graph,r=Array.isArray(this.zoomKey)?[].concat(this.zoomKey):[this.zoomKey];if(r.includes("control")&&r.push("ctrl"),r.some(function(j){return e["".concat(j,"Key")]})){var i=t.get("canvas").getPointByClient(e.clientX,e.clientY),o=t.getZoom();e.wheelDelta>0?o+=.05*o:o-=.05*o,t.zoomTo(o,{x:i.x,y:i.y})}else{var a=e.deltaX||e.movementX,s=e.deltaY||e.movementY;!s&&navigator.userAgent.indexOf("Firefox")>-1&&(s=125*-e.wheelDelta/3);var u=this.graph.get("width"),c=this.graph.get("height"),l=this.graph.get("canvas").getCanvasBBox(),h=this.scalableRange,f=this.scalableRange;h<1&&h>-1&&(h*=u,f*=c);var d=l.minX,p=l.maxX,g=l.minY,v=l.maxY;a>0?p<-h?a=0:p-a<-h&&(a=p+h):a<0&&(d>u+h?a=0:d-a>u+h&&(a=d-(u+h))),s>0?v<-f?s=0:v-s<-f&&(s=v+f):s<0&&(g>c+f?s=0:g-s>c+f&&(s=g-(c+f))),this.get("direction")==="x"?s=0:this.get("direction")==="y"&&(a=0),t.translate(-a,-s)}if(e.preventDefault(),this.get("enableOptimize")){var m=this.get("optimizeZoom"),y=this.get("optimized"),b=t.getNodes(),x=t.getEdges(),w=b.length,E=x.length;if(!y){for(var M=0;M<w;M++){var _=b[M];if(!_.destroyed)for(var k=(T=_.get("group").get("children")).length,S=0;S<k;S++)(A=T[S]).destoryed||A.get("isKeyShape")||(A.set("ori-visibility",A.get("ori-visibility")||A.get("visible")),A.hide())}for(var C=0;C<E;C++){var T;for(k=(T=x[C].get("group").get("children")).length,S=0;S<k;S++){var A;(A=T[S]).set("ori-visibility",A.get("ori-visibility")||A.get("visible")),A.hide()}}this.set("optimized",!0)}clearTimeout(this.get("timeout"));var D=setTimeout(function(){var j=t.getZoom();if(n.get("optimized")){n.set("optimized",!1);for(var L=0;L<w;L++){var B=b[L],N=(ne=B.get("group").get("children")).length;if(j<m)(P=(Z=B.getKeyShape()).get("ori-visibility"))&&Z.show();else for(var R=0;R<N;R++){var P=(te=ne[R]).get("ori-visibility");!te.get("visible")&&P&&P&&te.show()}}for(var H=0;H<E;H++){var ne,Z,q=x[H];if(N=(ne=q.get("group").get("children")).length,j<m)(P=(Z=q.getKeyShape()).get("ori-visibility"))&&Z.show();else for(R=0;R<N;R++){var te;(te=ne[R]).get("visible")||(P=te.get("ori-visibility"))&&te.show()}}}},100);this.set("timeout",D)}}},allowDrag:function(e){var n,t,r=e.target,i=r&&r.isCanvas&&r.isCanvas();if(hc(this.allowDragOnItem)&&!this.allowDragOnItem&&!i)return!1;if(tr(this.allowDragOnItem)){var o=this.allowDragOnItem,a=o.node,s=o.edge,u=o.combo,c=(t=(n=e.item)===null||n===void 0?void 0:n.getType)===null||t===void 0?void 0:t.call(n);if(!a&&c==="node"||!s&&c==="edge"||!u&&c==="combo")return!1}return!0}};ye({"drag-canvas":sH,"zoom-canvas":gH,"drag-node":uH,"activate-relations":cH,"brush-select":hH,"click-select":dH,"lasso-select":AH,tooltip:vH,"edge-tooltip":mH,"collapse-expand":bH,"drag-combo":EH,"collapse-expand-combo":SH,"create-edge":OH,"shortcuts-call":DH,"scroll-canvas":LH},function(e,n){u_(n,e)});var RH=F(F({},g4),dj),jH=Zr.Fisheye,BH=Zr.TimeBar,zH=Zr.ImageMinimap,FH=Zr.EdgeFilterLens,GH=Zr.SnapLine,UH=Zr.Annotation;const nh={version:is.version,Graph:yO,TreeGraph:wW,Util:Ro,Layout:$t.Layouts,TreeLayout:aW,registerLayout:function(e,n){n.isCustomLayout=!0,$t.Layouts[e]=$t.registerLayout(e,n)},Global:is,registerBehavior:u_,registerCombo:hR,registerEdge:s_,registerNode:mo,Minimap:Zr.Minimap,Grid:Zr.Grid,Bundling:Zr.Bundling,Menu:Zr.Menu,ToolBar:Zr.ToolBar,Tooltip:Zr.Tooltip,Legend:Zr.Legend,TimeBar:BH,SnapLine:GH,Fisheye:jH,ImageMinimap:zH,EdgeFilterLens:FH,Annotation:UH,Algorithm:RH,Arrow:{triangle:function(e,n,t){e===void 0&&(e=10),n===void 0&&(n=15),t===void 0&&(t=0);var r=2*t;return"M ".concat(r,",0 L ").concat(r+n,",-").concat(e/2," L ").concat(r+n,",").concat(e/2," Z")},vee:function(e,n,t){e===void 0&&(e=15),n===void 0&&(n=20),t===void 0&&(t=0);var r=2*t;return"M ".concat(r,",0 L ").concat(r+n,",-").concat(e/2,`
        L `).concat(r+2*n/3,",0 L ").concat(r+n,",").concat(e/2," Z")},circle:function(e,n){return e===void 0&&(e=5),n===void 0&&(n=0),"M ".concat(2*n,`, 0
            a `).concat(e,",").concat(e," 0 1,0 ").concat(2*e,`,0
            a `).concat(e,",").concat(e," 0 1,0 ").concat(2*-e,",0")},rect:function(e,n,t){e===void 0&&(e=10),n===void 0&&(n=10),t===void 0&&(t=0);var r=2*t;return"M ".concat(r,",").concat(-e/2,` 
        L `).concat(r+n,",").concat(-e/2,` 
        L `).concat(r+n,",").concat(e/2,` 
        L `).concat(r,",").concat(e/2," Z")},diamond:function(e,n,t){e===void 0&&(e=15),n===void 0&&(n=15),t===void 0&&(t=0);var r=2*t;return"M ".concat(r,`,0 
        L `).concat(r+n/2,",").concat(-e/2,` 
        L `).concat(r+n,`,0 
        L `).concat(r+n/2,",").concat(e/2," Z")},triangleRect:function(e,n,t,r,i,o){e===void 0&&(e=15),n===void 0&&(n=15),t===void 0&&(t=15),r===void 0&&(r=3),i===void 0&&(i=5),o===void 0&&(o=0);var a=2*o,s=a+n+i;return"M ".concat(a,",0 L ").concat(a+n,",-").concat(e/2," L ").concat(a+n,",").concat(e/2,` Z
            M `).concat(s,", -").concat(t/2,`
            L `).concat(s+r," -").concat(t/2,`
            L `).concat(s+r," ").concat(t/2,`
            L `).concat(s," ").concat(t/2,`
            Z`)}},Marker:oR,Shape:dn};nh.version="4.8.23";const XH={id:"box"},YH=cP({__name:"index",props:{config:{type:Array,default:()=>[]},defaultIp:{type:String,default:""}},setup(e){const n=Lr(!1),t=Lr({x:0,y:0}),r=Lr([]),i=Lr({});lP();const{push:o}=hP();nh.registerNode("img-node",{draw(k,S){const{imageUrl:C,height:T=40,width:A=40,title:D,labelBgColor:j="#fff"}=k,L=S.addShape("image",{attrs:{x:-A/2,y:-T/2,width:A,height:T,img:w(C)}}),B=T/2+10;return S.addShape("text",{attrs:{x:0,y:B+9,text:D,fontSize:12,fill:"#333",textAlign:"center",textBaseline:"middle"}}),L}}),nh.registerEdge("animated-line",{draw(k,S){const{startPoint:C,endPoint:T,controlPoints:A,startOffset:D={x:0,y:0},endOffset:j={x:0,y:0}}=k,L={x:C.x+D.x,y:C.y+D.y},B={x:T.x+j.x,y:T.y+j.y},N=A?[["M",L.x,L.y],...A.map(Z=>["L",Z.x,Z.y]),["L",B.x,B.y]]:[["M",L.x,L.y],["L",B.x,B.y]],R=S.addShape("path",{attrs:{path:N,stroke:"#ddd",lineWidth:2}});let P,H,ne;if(S.addShape("path",{attrs:{path:N,stroke:k.color||"#1890ff",lineWidth:3,lineDash:[10,6]}}).animate(Z=>({lineDashOffset:140*-Z}),{repeat:!0,duration:k.animationSpeed||5e3}),A&&A.length>0){const Z=A[A.length-1];P=B.x-Z.x,H=B.y-Z.y}else P=B.x-L.x,H=B.y-L.y;return ne=k.key==="line1"||k.key==="line3"||k.key==="line10"?0:Math.atan2(H,P),S.addShape("marker",{attrs:{x:B.x,y:B.y,r:6,fill:k.color||"#1890ff",symbol:(Z,q,te)=>ne>Math.PI/2?[["M",Z+te,q+te],["L",Z-te,q],["L",Z+te,q-te],["Z"]]:ne>0?[["M",Z-te,q-te],["L",Z,q+te],["L",Z+te,q-te],["Z"]]:ne==0?[["M",Z-te,q-te],["L",Z+te,q],["L",Z-te,q+te],["Z"]]:[["M",Z-te,q+te],["L",Z,q-te],["L",Z+te,q+te],["Z"]],rotate:ne},name:"arrow"}),R},setState(k,S,C){const T=C.getContainer(),A=T.get("children")[1],D=T.find(j=>j.get("name")==="arrow");k==="hover"&&(S?(A.attr("stroke","#0cf332"),D.attr("fill","#0cf332")):(A.attr("stroke",C.getModel().color||"#1890ff"),D.attr("fill",C.getModel().color||"#1890ff")))}}),nh.registerEdge("animated-line-abnormal",{draw(k,S){const{startPoint:C,endPoint:T,controlPoints:A,startOffset:D={x:0,y:0},endOffset:j={x:0,y:0}}=k,L={x:C.x+D.x,y:C.y+D.y},B={x:T.x+j.x,y:T.y+j.y},N=A?[["M",L.x,L.y],...A.map(Be=>["L",Be.x,Be.y]),["L",B.x,B.y]]:[["M",L.x,L.y],["L",B.x,B.y]],R=S.addShape("path",{attrs:{path:N,stroke:"red",lineWidth:3,lineDash:[10,6],opacity:1}}),P=[L,...A||[],B];let H=0;const ne=[];for(let Be=1;Be<P.length;Be++){const dt=P[Be].x-P[Be-1].x,It=P[Be].y-P[Be-1].y,at=Math.sqrt(dt*dt+It*It);ne.push(at),H+=at}let Z,q=0;const te=H/2;for(let Be=0;Be<ne.length;Be++){if(q+ne[Be]>=te){const dt=(te-q)/ne[Be];Z={x:P[Be].x+(P[Be+1].x-P[Be].x)*dt,y:P[Be].y+(P[Be+1].y-P[Be].y)*dt};break}q+=ne[Be]}let we,pe,Me;if(S.addShape("image",{attrs:{x:Z.x-20,y:Z.y-20,img:"http://hxui.tenghuazhineng.com:20080/admin-api/infra/file/29/get/867e0023fd78a3029b439ce46b9796718b062df7eb272e77e491d5e2d2afaf8b.png",width:40,height:40,cursor:"pointer",opacity:1},name:"error-icon"}).animate(Be=>({opacity:Be<.5?1:0}),{repeat:!0,duration:k.animationSpeed||1e3,easing:"easeCubic"}),A&&A.length>0){const Be=A[A.length-1];we=B.x-Be.x,pe=B.y-Be.y}else we=B.x-L.x,pe=B.y-L.y;return Me=k.key==="line1"||k.key==="line3"||k.key==="line10"?0:Math.atan2(pe,we),S.addShape("marker",{attrs:{x:B.x,y:B.y,r:6,fill:"red",symbol:(Be,dt,It)=>Me>Math.PI/2?[["M",Be+It,dt+It],["L",Be-It,dt],["L",Be+It,dt-It],["Z"]]:Me>0?[["M",Be-It,dt-It],["L",Be,dt+It],["L",Be+It,dt-It],["Z"]]:Me==0?[["M",Be-It,dt-It],["L",Be+It,dt],["L",Be-It,dt+It],["Z"]]:[["M",Be-It,dt+It],["L",Be,dt-It],["L",Be+It,dt+It],["Z"]],rotate:Me}}),R}});const a={camera:[{id:"node1",catalogId:3,key:0,x:350,y:300,title:"\u5B66\u751F\u6444\u50CF\u59341",labelBgColor:"#f0f0f0",height:50,width:50,type:"img-node",imageUrl:"image3.png"},{id:"node2",catalogId:3,key:0,x:350,y:400,title:"\u5B66\u751F\u6444\u50CF\u59342",labelBgColor:"#f0f0f0",height:50,width:50,type:"img-node",imageUrl:"image3.png"},{id:"node3",catalogId:3,key:0,x:350,y:500,title:"\u5B66\u751F\u6444\u50CF\u59343",labelBgColor:"#f0f0f0",height:50,width:50,type:"img-node",imageUrl:"image3.png"}],speaker:[{id:"node4",catalogId:3,key:0,x:500,y:50,title:"\u97F3\u54CD1",labelBgColor:"#f0f0f0",height:200,width:50,type:"img-node",imageUrl:"image2.png"},{id:"node5",catalogId:3,key:0,x:1400,y:50,title:"\u97F3\u54CD2",labelBgColor:"#f0f0f0",height:200,width:50,type:"img-node",imageUrl:"image2.png"}],screen:[{id:"node6",catalogId:3,key:0,x:700,y:50,title:"\u5C4F\u5E551",labelBgColor:"#f0f0f0",height:200,width:300,type:"img-node",imageUrl:"image1.png"},{id:"node7",catalogId:3,key:0,x:1200,y:50,title:"\u5C4F\u5E552",labelBgColor:"#f0f0f0",height:200,width:300,type:"img-node",imageUrl:"image1.png"}],microphone:[{id:"node8",catalogId:3,key:0,x:560,y:700,title:"\u9EA6\u514B\u98CE",labelBgColor:"#f0f0f0",height:100,width:100,type:"img-node",imageUrl:"image7.png"},{id:"node9",catalogId:3,key:0,x:710,y:700,title:"\u9EA6\u514B\u98CE",labelBgColor:"#f0f0f0",height:100,width:100,type:"img-node",imageUrl:"image7.png"},{id:"node10",catalogId:3,key:0,x:860,y:700,title:"\u9EA6\u514B\u98CE",labelBgColor:"#f0f0f0",height:100,width:100,type:"img-node",imageUrl:"image7.png"},{id:"node11",catalogId:3,key:0,x:1060,y:700,title:"\u9EA6\u514B\u98CE",labelBgColor:"#f0f0f0",height:100,width:100,type:"img-node",imageUrl:"image7.png"},{id:"node12",catalogId:3,key:0,x:1210,y:700,title:"\u9EA6\u514B\u98CE",labelBgColor:"#f0f0f0",height:100,width:100,type:"img-node",imageUrl:"image7.png"},{id:"node13",catalogId:3,key:0,x:1360,y:700,title:"\u9EA6\u514B\u98CE",labelBgColor:"#f0f0f0",height:100,width:100,type:"img-node",imageUrl:"image7.png"}],convergenceMedia:[{id:"node14",catalogId:3,key:0,x:960,y:200,title:"\u878D\u5A92\u4F53\u4E3B\u673A",labelBgColor:"#f0f0f0",height:80,width:200,type:"img-node",imageUrl:"image4.png"}],switchboard:[{id:"node15",catalogId:3,key:0,x:960,y:400,title:"\u4EA4\u6362\u673A",labelBgColor:"#f0f0f0",height:80,width:200,type:"img-node",imageUrl:"image5.png"}],centralControl:[{id:"node16",catalogId:3,key:0,x:1570,y:400,title:"Android\u4E2D\u63A7",labelBgColor:"#f0f0f0",height:100,width:100,type:"img-node",imageUrl:"image6.png"}],edges:[{source:"node1",target:"node15",type:"animated-line",key:"line1",color:"#FFBA0B",animationSpeed:2500,startOffset:{x:20,y:0},endOffset:{x:-20,y:-15},controlPoints:[{x:550,y:300},{x:550,y:380}]},{source:"node2",target:"node15",type:"animated-line",key:"line2",color:"#FFBA0B",animationSpeed:2500,startOffset:{x:20,y:0},endOffset:{x:-20,y:0},controlPoints:[]},{source:"node3",target:"node15",type:"animated-line",key:"line3",color:"#FFBA0B",animationSpeed:2500,startOffset:{x:20,y:0},endOffset:{x:-20,y:15},controlPoints:[{x:550,y:500},{x:550,y:420}]},{source:"node15",target:"node4",type:"animated-line",key:"line4",color:"#1F88FF",animationSpeed:2500,startOffset:{x:-20,y:-35},endOffset:{x:0,y:30},controlPoints:[{x:585,y:350},{x:585,y:250},{x:500,y:250}]},{source:"node15",target:"node5",type:"animated-line",key:"line5",color:"#1F88FF",animationSpeed:2500,startOffset:{x:20,y:-20},endOffset:{x:0,y:30},controlPoints:[{x:1400,y:370}]},{source:"node14",target:"node15",type:"animated-line",key:"line6",color:"#8d2bc6",animationSpeed:2500,startOffset:{x:0,y:30},endOffset:{x:0,y:-20},controlPoints:[]},{source:"node14",target:"node6",type:"animated-line",key:"line7",color:"#FFBA0B",animationSpeed:2500,startOffset:{x:-22,y:-20},endOffset:{x:20,y:0},controlPoints:[{x:930,y:50}]},{source:"node14",target:"node7",type:"animated-line",key:"line8",color:"#FFBA0B",animationSpeed:2500,startOffset:{x:22,y:-20},endOffset:{x:-20,y:0},controlPoints:[{x:990,y:50}]},{source:"node16",target:"node15",type:"animated-line",key:"line9",color:"#8d2bc6",animationSpeed:2500,startOffset:{x:-20,y:0},endOffset:{x:20,y:0},controlPoints:[]},{source:"node8",target:"node15",type:"animated-line",key:"line10",color:"#1F88FF",animationSpeed:2500,startOffset:{x:15,y:-20},endOffset:{x:-20,y:35},controlPoints:[{x:580,y:447}]},{source:"node9",target:"node15",type:"animated-line",key:"line11",color:"#1F88FF",animationSpeed:2500,startOffset:{x:0,y:-20},endOffset:{x:-25,y:30},controlPoints:[{x:710,y:550},{x:925,y:550}]},{source:"node10",target:"node15",type:"animated-line",key:"line12",color:"#1F88FF",animationSpeed:2500,startOffset:{x:-20,y:0},endOffset:{x:-10,y:30},controlPoints:[{x:950,y:700}]},{source:"node11",target:"node15",type:"animated-line",key:"line13",color:"#1F88FF",animationSpeed:2500,startOffset:{x:0,y:0},endOffset:{x:15,y:30},controlPoints:[{x:980,y:700}]},{source:"node12",target:"node15",type:"animated-line",key:"line14",color:"#1F88FF",animationSpeed:2500,startOffset:{x:0,y:-20},endOffset:{x:30,y:30},controlPoints:[{x:1210,y:550},{x:1002,y:550}]},{source:"node13",target:"node15",type:"animated-line",key:"line15",color:"#1F88FF",animationSpeed:2500,startOffset:{x:0,y:-20},endOffset:{x:20,y:20},controlPoints:[{x:1355,y:425}]}]},s=Lr(!1),u=Lr("\u8BE6\u60C5"),c=()=>{},l=()=>{n.value=!1},h=Lr(),f=(k,S)=>{const C=new nh.Graph({container:"box",width:m.value,height:y.value,defaultEdge:{type:"animated-line"},defaultNode:{type:"img-node"}});h.value=C,C.data({nodes:k,edges:S}),C.render();const T=C.getGroup(),A=["\u9519\u8BEF\u4FE1\u53F7","\u5176\u4ED6\u4FE1\u53F7","\u97F3\u9891\u4FE1\u53F7","\u89C6\u9891\u4FE1\u53F7"],D=["red","#8d2bc6","#1F88FF","#FFBA0B"];for(let j=0;j<4;j++){const L=100-50*j;T.addShape("circle",{attrs:{x:250,y:L,r:4,fill:D[j]}}),T.addShape("text",{attrs:{x:320,y:L,text:A[j],fontSize:14,fill:"#333",textAlign:"right",textBaseline:"middle"}})}C.on("node:click",j=>{const{item:L}=j,B=L.getModel();var N;(B.config.hadAudio||B.config.hadVideo)&&(i.value=B.config,N=j,t.value={x:N.canvasX,y:N.canvasY},u.value=r.value.name,s.value=!0,n.value=!0)}),C.on("edge:click",j=>{}),b()},d=Lr(null),p=Lr(!1),g=()=>{p.value?document.exitFullscreen().then(()=>{p.value=!1}).catch(k=>{}):d.value.requestFullscreen().then(()=>{p.value=!0}).catch(k=>{})},v=()=>{p.value=!!document.fullscreenElement},m=Lr(""),y=Lr("");Lr(1);const b=()=>{m.value=window.innerWidth-140,y.value=window.innerHeight-110,h.value.changeSize(m.value,y.value),h.value.fitView(25)},x=((k,S)=>{let C=null;return function(...T){C&&clearTimeout(C),C=setTimeout(()=>{k.apply(this,T)},S)}})(b,300),w=k=>`/${k}`,E=Lr(!0),M=k=>{if(r.value=k.linkList,!E.value&&!k.isChange)return;const S=k.linkList,C=[],T=[],A=S==null?void 0:S.filter(P=>P.type=="camera"),D=S==null?void 0:S.filter(P=>P.type=="speaker"),j=S==null?void 0:S.filter(P=>P.type=="screen"),L=S==null?void 0:S.filter(P=>P.type=="mic"),B=S==null?void 0:S.filter(P=>P.type=="AvSwitch"),N=S==null?void 0:S.filter(P=>P.type=="switch"),R=S==null?void 0:S.filter(P=>P.type=="androidCtrl");A.length>0&&A.forEach((P,H)=>{H>3||C.push({...a.camera[H],title:P.showName,config:P})}),D.length>0&&D.forEach((P,H)=>{H>3||C.push({...a.speaker[H],title:P.showName,config:P})}),j.length>0&&j.forEach((P,H)=>{H>3||C.push({...a.screen[H],title:P.showName,config:P})}),L.length>0&&L.forEach((P,H)=>{H>6||C.push({...a.microphone[H],title:P.showName,config:P})}),B.length>0&&B.forEach((P,H)=>{H>1||C.push({...a.convergenceMedia[H],title:P.showName,config:P})}),N.length>0&&N.forEach((P,H)=>{H>1||C.push({...a.switchboard[H],title:P.showName,config:P})}),R.length>0&&R.forEach((P,H)=>{H>2||C.push({...a.centralControl[H],title:P.showName,config:P})}),a.edges.forEach(P=>{const H=C.find(Z=>Z.id==P.source),ne=C.find(Z=>Z.id==P.target);H&&ne&&(ne.config.onLine&&H.config.onLine?P.type="animated-line":P.type="animated-line-abnormal",T.push(P))}),E.value?(f(C,T),E.value=!1):h.value.changeData({nodes:C,edges:T})},_=async k=>{const S=JSON.parse(k);SP.emit("LinkDiagramMessage",{message:k}),S&&M(S)};return fP(async()=>{m.value=window.innerWidth-140,y.value=window.innerHeight-140;const k=await wP.getLinkList();M({linkList:k,isChange:!1}),setTimeout(async()=>{try{await Qx.connect({});const{subscribe:S}=MP();S("/meeting/deviceLink",_)}catch{}},0),document.addEventListener("fullscreenchange",v),window.addEventListener("resize",x)}),dP(()=>{document.removeEventListener("fullscreenchange",v),window.removeEventListener("resize",x),Qx.disconnect()}),(k,S)=>{const C=mP,T=yP;return gP(),pP(bP,null,[$x("div",{class:"content",ref_key:"fullscreenElement",ref:d},[$x("div",XH,[Wg(T,{class:"box-item",effect:"dark",content:"\u5168\u5C4F",placement:"top-start"},{default:vP(()=>[Wg(C,{class:"full-screen",icon:"ep:full-screen",onClick:g})]),_:1})])],512),Wg(EP,{visible:n.value,position:t.value,onConfirm:c,onCancel:l,item:i.value},null,8,["visible","position","item"])],64)}}}),WH=xP(YH,[["__scopeId","data-v-a23338b0"]]);export{WH as default};

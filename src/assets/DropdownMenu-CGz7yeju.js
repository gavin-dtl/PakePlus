import{d as U,r as v,h as V,b as X,Y as Z,c as k,o as f,f as _,C as $,j as T,g as ee,Q as te,s as C,a5 as E,n as L,F as W,i as P,A as ae,v as R,t as z,J as le,a as oe,W as ne,T as B,ae as H,bb as ue,_ as se}from"./index-DzCoMBOl.js";import{_ as ie}from"./TransformationEditDialog.vue_vue_type_script_setup_true_lang-BWnvtynt.js";import"./Dialog.vue_vue_type_style_index_0_lang-v5RKlSVj.js";import"./index-q5044CqW.js";const re=["onClick","onTouchstart","onMouseenter","data-id"],ce=["onMouseenter"],de=["onClick","onTouchstart"],ve=se(U({__name:"DropdownMenu",props:{items:{},placement:{default:"bottom"},offset:{default:5},closeDelay:{default:300}},emits:["item-click","subitem-click"],setup(O,{emit:j}){const i=O,b=j,q=v(),y=v(null),d=v(null),w=v(!1),n=v(null),r=v(!1),A=v(0),c=v(!1);let m=null;const p=e=>!!e.children&&e.children.length>0,F=V(()=>{if(!y.value||!d.value)return{};const e=y.value.getBoundingClientRect(),s=window.innerHeight,g=window.innerWidth,l=d.value.offsetHeight||90,o=d.value.offsetWidth||160;let t=0,a=0,u="";switch(i.placement){case"top":t=e.top-l-i.offset,a=e.left,u="center bottom",t<0&&(t=e.bottom+i.offset,u="center top");break;case"left":t=e.top,a=e.left-o-i.offset,u="right center",a<0&&(a=e.right+i.offset,u="left center");break;case"right":t=e.top,a=e.right+i.offset,u="left center",a+o>g&&(a=e.left-o-i.offset,u="right center");break;default:t=e.bottom+i.offset,a=e.left,u="center top",t+l>s&&(t=e.top-l-i.offset,u="center bottom")}return{top:`${t}px`,left:`${a}px`,transformOrigin:u,"min-width":`${e.width}px`}}),I=e=>{if(!d.value||!n.value)return{};const s=d.value.querySelector(`[data-id="${e.id}"]`);if(!s)return{};const g=s.getBoundingClientRect(),l=window.innerWidth;let o=g.width,t="left center";return g.right+160>l&&(o=-160,t="right center"),{left:`${o}px`,top:"0",transformOrigin:t,"min-width":"160px"}},J=e=>{e.type!=="touchstart"&&M()},Q=()=>{r.value&&(c.value=!0,A.value=Date.now(),M())},S=e=>{r.value&&(e.preventDefault(),c.value=!1)},M=()=>{w.value=!w.value,n.value=null},Y=()=>{clearTimeout(m)},G=()=>{r.value||N()},K=()=>{r.value?setTimeout(()=>{c.value||(n.value=null)},300):n.value=null},N=()=>{m=setTimeout(()=>{w.value=!1,n.value=null},i.closeDelay)},h=()=>{w.value=!1,n.value=null,c.value=!1},x=e=>{var s;(s=d.value)!=null&&s.contains(e.target)||h()},D=e=>{var s;c.value||(s=d.value)!=null&&s.contains(e.target)||h()};return X(()=>{r.value="ontouchstart"in window||navigator.maxTouchPoints>0,document.addEventListener("mousedown",x),document.addEventListener("touchstart",D,{passive:!1})}),Z(()=>{document.removeEventListener("mousedown",x),document.removeEventListener("touchstart",D),m&&clearTimeout(m)}),(e,s)=>{const g=le;return f(),k("div",{class:"dropdown-container",ref_key:"container",ref:y},[_("div",{class:"trigger-wrapper",onClick:te(J,["stop"]),onTouchstartPassive:Q,onTouchend:S},[ee(e.$slots,"trigger",{},void 0,!0)],32),(f(),$(ue,{to:"body"},[T(B,{name:"el-zoom-in-top"},{default:C(()=>[E(_("div",{ref_key:"menuPanel",ref:d,class:"dropdown-menu",style:L(F.value),onMouseenter:Y,onMouseleave:G},[(f(!0),k(W,null,P(e.items,l=>(f(),k("div",{key:l.id,class:ae(["menu-item",{"has-children":p(l)}]),onClick:o=>((t,a)=>{t.type==="touchstart"||r.value&&c.value?t.preventDefault():p(a)?n.value=n.value===a.id?null:a.id:(b("item-click",a),h())})(o,l),onTouchstart:o=>(t=>{if(r.value)if(clearTimeout(m),p(t)){const a=n.value!==t.id;n.value=a?t.id:null,a&&(c.value=!0,setTimeout(()=>{c.value=!1},500))}else b("item-click",t),h()})(l),onMouseenter:o=>(t=>{!r.value&&p(t)&&(clearTimeout(m),n.value=t.id)})(l),"data-id":l.id},[_("span",null,z(l.label),1),p(l)?(f(),$(g,{key:0,class:"arrow-icon"},{default:C(()=>[T(oe(ne))]),_:1})):R("",!0),T(B,{name:"el-zoom-in-left"},{default:C(()=>[p(l)?E((f(),k("div",{key:0,class:"sub-menu",style:L(I(l)),onMouseenter:o=>(t=>{clearTimeout(m),n.value=t.id,r.value&&(c.value=!0)})(l),onMouseleave:K},[(f(!0),k(W,null,P(l.children,o=>(f(),k("div",{key:o.id,class:"sub-menu-item",onClick:t=>((a,u)=>{u.id,b("subitem-click",u),h()})(0,o),onTouchstart:t=>(a=>{r.value&&(b("subitem-click",a),h())})(o)},z(o.label),41,de))),128))],44,ce)),[[H,n.value===l.id]]):R("",!0)]),_:2},1024)],42,re))),128))],36),[[H,w.value]])]),_:1})])),T(ie,{ref_key:"TransformationEditDialogRef",ref:q},null,512)],512)}}}),[["__scopeId","data-v-4c452d84"]]);export{ve as default};

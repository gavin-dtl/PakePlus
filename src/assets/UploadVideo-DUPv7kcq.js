import{d as U,ar as s,p as w,r,as as z,aW as n,c as L,v as M,o as T,j as m,aV as j,a as $,ap as k,s as f,H as q,x as R,t as A,_ as B}from"./index-Cv_H95TD.js";import{M as F}from"./index-DEncObm-.js";const H={key:0,class:"upload-file"},N=B(U({name:"UploadFile",__name:"UploadVideo",props:{modelValue:s.oneOfType([String,Array]).isRequired,fileType:s.array.def([]),fileSize:s.number.def(1024),limit:s.number.def(5),autoUpload:s.bool.def(!0),drag:s.bool.def(!1),isShowTip:s.bool.def(!0),disabled:s.bool.def(!1),title:s.string.def("\u9009\u53D6\u6587\u4EF6"),activeListId:{type:Number,default:0}},emits:["update:modelValue","uploadSuccess"],setup(d,{emit:c}){const u=w(),p=c,i=d,v=r();r([]);const l=r([]),b=r(0),g=e=>{if(l.value.length>=i.limit)return u.error(`\u4E0A\u4F20\u6587\u4EF6\u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7${i.limit}\u4E2A!`),!1;if(e.name.lastIndexOf(".")>-1&&e.name.slice(e.name.lastIndexOf(".")+1),!(e.size<1024*i.fileSize*1024))return u.error(`\u4E0A\u4F20\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7${i.fileSize}MB!`),!1;u.success("\u6B63\u5728\u4E0A\u4F20\u6587\u4EF6\uFF0C\u8BF7\u7A0D\u5019..."),b.value++},h=e=>{u.success("\u4E0A\u4F20\u6210\u529F"),l.value=[],p("uploadSuccess")},y=()=>{u.error(`\u4E0A\u4F20\u6587\u4EF6\u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7${i.limit}\u4E2A!`)},x=()=>{},V=e=>{const a=l.value.map(o=>o.name).indexOf(e.name);a>-1&&(l.value.splice(a,1),S())},_=e=>{},I=e=>new Promise((a,o)=>{F.MeetingVideouUpload({file:e.file,id:i.activeListId}).then(t=>{t.code===0?a(t):o(t)}).catch(t=>{o(t)})});z(()=>i.modelValue,e=>{e?(l.value=[],n(e)?l.value.push(...e.split(",").map(a=>({name:a.substring(a.lastIndexOf("/")+1),url:a}))):l.value.push(...e.map(a=>({name:a.substring(a.lastIndexOf("/")+1),url:a})))):l.value=[]},{immediate:!0,deep:!0});const S=()=>{let e=l.value.map(a=>a.url);(i.limit===1||n(i.modelValue))&&(e=e.join(",")),p("update:modelValue",e)};return(e,a)=>{const o=q,t=j;return d.disabled?M("",!0):(T(),L("div",H,[m(t,{ref_key:"uploadRef",ref:v,"file-list":$(l),"onUpdate:fileList":a[0]||(a[0]=O=>k(l)?l.value=O:null),action:"/api/core/file/meeting/upload","auto-upload":d.autoUpload,"before-upload":g,disabled:d.disabled,drag:d.drag,"http-request":I,limit:i.limit,multiple:i.limit>1,"on-error":x,"on-exceed":y,"on-preview":_,"on-remove":V,"on-success":h,"show-file-list":!1,class:"upload-file-uploader",name:"file"},{default:f(()=>[m(o,{type:"primary"},{default:f(()=>[R(A(d.title),1)]),_:1})]),_:1},8,["file-list","auto-upload","disabled","drag","limit","multiple"])]))}}}),[["__scopeId","data-v-e6943a7d"]]);export{N as default};

import{d as H,l as O,k as Y,a2 as j,r as u,b as A,e as G,c as v,o as s,f as d,F as J,y as K,p as b,t as x,a as i,m as l,aR as M,w as t,aS as Q,H as W,z as w,aT as X,aU as Z,C as $,O as F,q as k,aE as aa,ao as ea,_ as la}from"./index-h2IMwmcw.js";import{U as ta,F as P}from"./UploadFile-CVp29_BB.js";const oa={class:"f1le-main"},sa={class:"filePath"},ia=["onClick"],na={style:{"background-color":"rgba(35,110,214,0.26)","border-radius":"4px",padding:"5px 10px","margin-left":"5px"}},ra={key:0},ca={style:{"margin-top":"15px"}},da={style:{"margin-left":"5px"}},pa={class:"footer"},ua=la(H({name:"DeviceTypeForm",__name:"globalFiles",props:{catalogSelection:{type:Boolean,default:!1}},emits:["success"],setup(U,{emit:V}){const{t:T}=O(),g=Y(),q=V,D=U,E=j(()=>D.catalogSelection),n=(u({}),u([])),z=u([]),c=async r=>{const e=await P.commonFileList({path:r});n.value=e.filePath,z.value=e.fileList,m.value=n.value[n.value.length-1].path},I=async r=>{r.directory&&c(r.path)},L=async()=>{const r=await g.validatePrompt("\u8BF7\u8F93\u5165\u6587\u4EF6\u5939\u540D\u79F0",T("\u521B\u5EFA\u6587\u4EF6\u5939"),{inputValue:"",validator:_=>!!_||"\u6587\u4EF6\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}),e=n.value[n.value.length-1].path;await P.createDirectory({dirName:r.value,basePath:e}),c(e),g.success("\u65B0\u589E\u6210\u529F")},C=u(),m=u(""),N={title:"\u6587\u4EF6\u4E0A\u4F20",isShowTip:!1},R=()=>{c(m.value)};return A(()=>{c("")}),G(()=>{}),(r,e)=>{const _=W,y=Q,f=$,B=M;return s(),v("div",oa,[d("div",sa,[(s(!0),v(J,null,K(i(n),(a,h)=>(s(),v("p",{onClick:o=>{c(a.path)},key:a.path},[d("span",na,x(a.name),1),i(n).length!=h+1?(s(),v("span",ra," > ")):b("",!0)],8,ia))),128))]),d("div",ca,[l(B,{data:i(z),height:"700px",style:{width:"100%"},onCellClick:I},{default:t(()=>[l(y,{prop:"name",label:"\u540D\u79F0"},{default:t(a=>[l(_,null,{default:t(()=>[a.row.directory?(s(),w(i(X),{key:0})):(s(),w(i(Z),{key:1}))]),_:2},1024),d("span",da,x(a.row.name),1)]),_:1}),l(y,{prop:"size",label:"\u5927\u5C0F",width:"200px",align:"center"}),l(y,{prop:"format",label:"\u7C7B\u578B",width:"150px",align:"center"},{default:t(a=>[d("span",null,x(a.row.directory?"\u6587\u4EF6\u5939":a.row.format),1)]),_:1}),l(y,{label:"\u64CD\u4F5C",align:"center"},{default:t(a=>[l(f,{size:"small",type:"danger",onClick:F(h=>(async o=>{await g.delConfirm("\u786E\u8BA4\u5220\u9664\u6587\u4EF6?"),await P.deleteFile({filePath:o.path}),c(m.value)})(a.row),["stop"])},{default:t(()=>e[1]||(e[1]=[k(" \u5220\u9664 ")])),_:2},1032,["onClick"]),a.row.directory?b("",!0):(s(),w(f,{key:0,size:"small",onClick:F(h=>(async o=>{try{const S="/api/core/file/download?filePath="+encodeURIComponent(o.path),p=document.createElement("a");p.href=S,p.download=o.playName,document.body.appendChild(p),p.click(),document.body.removeChild(p)}catch{}})(a.row),["stop"])},{default:t(()=>e[2]||(e[2]=[k(" \u4E0B\u8F7D ")])),_:2},1032,["onClick"])),i(E)||!a.row.directory?(s(),w(f,{key:1,type:"primary",size:"small",onClick:F(h=>{return o=a.row,void q("success",o);var o},["stop"])},{default:t(()=>e[3]||(e[3]=[k(" \u9009\u62E9 ")])),_:2},1032,["onClick"])):b("",!0)]),_:1})]),_:1},8,["data"])]),d("div",pa,[l(f,{type:"primary",onClick:L},{default:t(()=>e[4]||(e[4]=[k("\u521B\u5EFA\u6587\u4EF6\u5939")])),_:1}),l(ta,aa({style:{display:"inline-block","margin-left":"10px",transform:"translateY(4px)"},onUploadSuccess:R},N,{dir:i(m),modelValue:i(C),"onUpdate:modelValue":e[0]||(e[0]=a=>ea(C)?C.value=a:null),limit:1}),null,16,["dir","modelValue"])])])}}}),[["__scopeId","data-v-7214a5f4"]]);export{ua as default};

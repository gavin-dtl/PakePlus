import{d as V,r as v,a2 as X,b as Y,W as Z,c as w,o as f,f as _,z as $,m as y,g as ee,O as te,w as M,a4 as E,n as L,F as W,y as z,v as ae,p as H,t as O,H as le,a as oe,U as ne,T as P,ad as R,bb as ue,_ as se}from"./index-h2IMwmcw.js";import{_ as ie}from"./TransformationEditDialog.vue_vue_type_script_setup_true_lang-Wc1mZLX-.js";import"./Dialog.vue_vue_type_style_index_0_lang-Gezqvh3u.js";import"./index-B9iskDNg.js";const re=["onClick","onTouchstart","onMouseenter","data-id"],ce=["onMouseenter"],de=["onClick","onTouchstart"],ve=se(V({__name:"DropdownMenu",props:{items:{},placement:{default:"bottom"},offset:{default:5},closeDelay:{default:300}},emits:["item-click","subitem-click"],setup(B,{emit:j}){const i=B,b=j,q=v(),T=v(null),d=v(null),k=v(!1),n=v(null),r=v(!1),F=v(0),c=v(!1);let m=null;const p=e=>!!e.children&&e.children.length>0,I=X(()=>{if(!T.value||!d.value)return{};const e=T.value.getBoundingClientRect(),s=window.innerHeight,g=window.innerWidth,l=d.value.offsetHeight||90,o=d.value.offsetWidth||160;let t=0,a=0,u="";switch(i.placement){case"top":t=e.top-l-i.offset,a=e.left,u="center bottom",t<0&&(t=e.bottom+i.offset,u="center top");break;case"left":t=e.top,a=e.left-o-i.offset,u="right center",a<0&&(a=e.right+i.offset,u="left center");break;case"right":t=e.top,a=e.right+i.offset,u="left center",a+o>g&&(a=e.left-o-i.offset,u="right center");break;default:t=e.bottom+i.offset,a=e.left,u="center top",t+l>s&&(t=e.top-l-i.offset,u="center bottom")}return{top:`${t}px`,left:`${a}px`,transformOrigin:u,"min-width":`${e.width}px`}}),S=e=>{if(!d.value||!n.value)return{};const s=d.value.querySelector(`[data-id="${e.id}"]`);if(!s)return{};const g=s.getBoundingClientRect(),l=window.innerWidth;let o=g.width,t="left center";return g.right+160>l&&(o=-160,t="right center"),{left:`${o}px`,top:"0",transformOrigin:t,"min-width":"160px"}},U=e=>{e.type!=="touchstart"&&x()},A=()=>{r.value&&(c.value=!0,F.value=Date.now(),x())},G=e=>{r.value&&(e.preventDefault(),c.value=!1)},x=()=>{k.value=!k.value,n.value=null},J=()=>{clearTimeout(m)},K=()=>{r.value||Q()},N=()=>{r.value?setTimeout(()=>{c.value||(n.value=null)},300):n.value=null},Q=()=>{m=setTimeout(()=>{k.value=!1,n.value=null},i.closeDelay)},h=()=>{k.value=!1,n.value=null,c.value=!1},C=e=>{var s;(s=d.value)!=null&&s.contains(e.target)||h()},D=e=>{var s;c.value||(s=d.value)!=null&&s.contains(e.target)||h()};return Y(()=>{r.value="ontouchstart"in window||navigator.maxTouchPoints>0,document.addEventListener("mousedown",C),document.addEventListener("touchstart",D,{passive:!1})}),Z(()=>{document.removeEventListener("mousedown",C),document.removeEventListener("touchstart",D),m&&clearTimeout(m)}),(e,s)=>{const g=le;return f(),w("div",{class:"dropdown-container",ref_key:"container",ref:T},[_("div",{class:"trigger-wrapper",onClick:te(U,["stop"]),onTouchstartPassive:A,onTouchend:G},[ee(e.$slots,"trigger",{},void 0,!0)],32),(f(),$(ue,{to:"body"},[y(P,{name:"el-zoom-in-top"},{default:M(()=>[E(_("div",{ref_key:"menuPanel",ref:d,class:"dropdown-menu",style:L(I.value),onMouseenter:J,onMouseleave:K},[(f(!0),w(W,null,z(e.items,l=>(f(),w("div",{key:l.id,class:ae(["menu-item",{"has-children":p(l)}]),onClick:o=>((t,a)=>{t.type==="touchstart"||r.value&&c.value?t.preventDefault():p(a)?n.value=n.value===a.id?null:a.id:(b("item-click",a),h())})(o,l),onTouchstart:o=>(t=>{if(r.value)if(clearTimeout(m),p(t)){const a=n.value!==t.id;n.value=a?t.id:null,a&&(c.value=!0,setTimeout(()=>{c.value=!1},500))}else b("item-click",t),h()})(l),onMouseenter:o=>(t=>{!r.value&&p(t)&&(clearTimeout(m),n.value=t.id)})(l),"data-id":l.id},[_("span",null,O(l.label),1),p(l)?(f(),$(g,{key:0,class:"arrow-icon"},{default:M(()=>[y(oe(ne))]),_:1})):H("",!0),y(P,{name:"el-zoom-in-left"},{default:M(()=>[p(l)?E((f(),w("div",{key:0,class:"sub-menu",style:L(S(l)),onMouseenter:o=>(t=>{clearTimeout(m),n.value=t.id,r.value&&(c.value=!0)})(l),onMouseleave:N},[(f(!0),w(W,null,z(l.children,o=>(f(),w("div",{key:o.id,class:"sub-menu-item",onClick:t=>((a,u)=>{u.id,b("subitem-click",u),h()})(0,o),onTouchstart:t=>(a=>{r.value&&(b("subitem-click",a),h())})(o)},O(o.label),41,de))),128))],44,ce)),[[R,n.value===l.id]]):H("",!0)]),_:2},1024)],42,re))),128))],36),[[R,k.value]])]),_:1})])),y(ie,{ref_key:"TransformationEditDialogRef",ref:q},null,512)],512)}}}),[["__scopeId","data-v-4c452d84"]]);export{ve as default};
